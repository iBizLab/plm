# 序号表格

该插件基于表格部件增强，主要是用于重写表格行选中控制逻辑、重写单双击激活逻辑，重写表格中序号列显示逻辑等。**该插件隶属于数据表格绘制插件（基于表格部件进行扩展）**

## 页面展示

![image](./public/assets/images/scene.png)

## 功能说明

以下是序号表格区别标准表格和标准树表格的主要功能

### 选中控制

- 单击行或单击单元格时不再同时选中该行，只有点击复选框时才选中该行

- UI维护了一个curSelectedData用于保存界面选中数据，以便维护界面所需要呈现的选中行；
  控制器中维护的selectedData，对界面选中的数据进行过滤，排除一些模拟的行数据，使得控制器中的选中数据都是实体数据

- 选择联动：
  表格分组：分组选中时，选中该分组下的所有子数据
  树表格父节点：父节点选中时，不会选中子节点

- 全选：
  表格中选中的是当前页的所有实体数据
  树表格中选中的是当前页所有根节点往下的所有数据

- 在表格初始化加载时会重置选中数据，应用场景：表格视图切换快速分组时

**注意**

选中联动的区别是：
表格分组行是模拟的行数据，不是实体数据，是不可操作的，分组行选中实际上操作的应该是分组下的实体数据
树表格的父节点是实际存在的实体数据，是可操作的

### 序号显示

- 在行悬浮和选中时显示复选框，其他时候显示行序号

- 在表格分组折叠或树表格父节点折叠时重新计算序号，以确保可见行的序号是连续的

### 表格分组

- 表格分组时，分组属性所在的列可以不配置，分组名称默认在第一列上绘制

- 表格分组名称不存在时默认为【其他】

- 表格分组支持配置分组图标，通过控件动态参数【GROUPICON】配置，目前仅支持ion-icon图标，值为ion-icon图标的name

### 单击/双击激活

- 表格分组行不会触发表格的行单击/双击

- 树表格视图模型不支持激活模式的配置，因此需要在树表格部件上配置控件动态参数【GRIDROWACTIVEMODE】来控制（控制模式和表格一致）

| GRIDROWACTIVEMODE值 | 说明                                                        |
| ------------------- | ----------------------------------------------------------- |
| 0                   | 无激活，树表格没有配置GRIDROWACTIVEMODE动态参数默认为无激活 |
| 1                   | 单击激活（单选）                                            |
| 2                   | 双击激活                                                    |

### 树表格新增功能

- 树表格的单元格超出呈现模式默认为【ellipsis】（超出并隐藏）

- 标准的树表格没有新建行功能，该树表格已支持，需要通过界面逻辑调用树表格的【newRow】来新建行数据
  newRow接收一个参数对象，如果该参数对象中有data则默认是在该data行下创建子行

- 树表格新增一个【switchShowMode】方法用于切换显示模式，方便用户通过界面逻辑控制树表格的显示
  该方法必须传递一个参数对象，对象中必须有showMode属性，值为【tree | grid】，切换显示模式之后会调用一次表格刷新

- 树表格加载时，如果当前的显示模式为树时，会默认在视图参数中合入【{srfshowmode: 'tree'}】

- 首次渲染时，会通过localStorage存储的值设置默认显示模式，存储的key为 `SHOW_MODE_${产品id}_${视图codeName}`

## 输入参数

| 属性名            | 类型   | 默认值 | 说明                     |
| ----------------- | ------ | ------ | ------------------------ |
| EXPANDCOLUMNINDEX | number | ---    | 绘制树表时指定展开列下标 |

## 附录

### 序号表格插件

```json
[
  {
    "plugintype": "GRID_RENDER",
    "rtobjectrepo": "@ibiz-template-plugin/number-grid@0.1.3-alpha.45",
    "codename": "UsrPFPlugin1229039663",
    "plugintag": "NUMBER_GRID",
    "rtobjectmode": 2,
    "rtobjectname": "IBizNumberGridControl",
    "pssyspfpluginname": "序号表格"
  }
]
```
