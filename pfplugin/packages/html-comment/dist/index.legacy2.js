!function(){var e=["children"],t=["withoutSavingOrigin","trackedOrigins"];function n(e){var t="function"==typeof Map?new Map:void 0;return n=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return r(e,arguments,g(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},n(e)}function r(e,t,n){return r=d()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&u(i,n.prototype),i},r.apply(null,arguments)}function i(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},s.apply(this,arguments)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e){var t=d();return function(){var n,r=g(e);if(t){var i=g(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function p(e){return function(e){if(Array.isArray(e))return C(e)}(e)||y(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function m(e,t){return b(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return s}}(e,t)||x(e,t)||w()}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e){if(Array.isArray(e))return e}function k(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function x(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */E=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new L(r||[]);return i(a,"_invoke",{value:M(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var f="suspendedStart",d="suspendedYield",g="executing",p="completed",y={};function m(){}function w(){}function b(){}var k={};u(k,a,(function(){return this}));var x=Object.getPrototypeOf,C=x&&x(x(j([])));C&&C!==n&&r.call(C,a)&&(k=C);var S=b.prototype=m.prototype=Object.create(k);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function n(i,o,a,s){var l=h(e[i],e,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==v(c)&&r.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(l.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function M(t,n,r){var i=f;return function(o,a){if(i===g)throw new Error("Generator is already running");if(i===p){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=g;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?p:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=p,r.method="throw",r.arg=u.arg)}}}function P(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function j(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(v(t)+" is not iterable")}return w.prototype=b,i(S,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:w,configurable:!0}),w.displayName=u(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},_(A.prototype),u(A.prototype,s,(function(){return this})),t.AsyncIterator=A,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new A(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(S),u(S,l,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=j,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:j(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function S(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(r,i)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){S(o,r,i,a,s,"next",e)}function s(e){S(o,r,i,a,s,"throw",e)}a(void 0)}))}}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,T(r.key),r)}}function P(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function O(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){var t=function(e,t){if("object"!==v(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===v(t)?t:String(t)}System.register(["vue","@ibiz-template/runtime","@ibiz-template/vue3-util","@wangeditor/editor-for-vue","@wangeditor/editor","qx-util","ramda","@ibiz-template/core","element-plus","lodash-es","dayjs"],(function(o,u){"use strict";var d,C,S,M,T,L,j,N,R,D,I,B,z,F,V,H,U,q,G,J,W,Y,Z,X,K,$,Q,ee,te,ne,re,ie,oe,ae,se,le,ue,ce,he,fe,de,ge,ve,pe,ye,me,we,be,ke,xe,Ce,Ee,Se,_e,Ae,Me,Pe,Oe,Te,Le,je,Ne,Re,De,Ie,Be,ze,Fe,Ve,He,Ue,qe,Ge,Je,We,Ye,Ze,Xe,Ke,$e,Qe,et,tt,nt,rt,it,ot,at,st,lt,ut,ct,ht,ft,dt,gt;return{setters:[function(e){d=e.defineComponent,C=e.ref,S=e.shallowRef,M=e.watch,T=e.onBeforeUnmount,L=e.onMounted,j=e.nextTick,N=e.createVNode,R=e.resolveComponent,D=e.createTextVNode,I=e.computed,B=e.Fragment,z=e.onUnmounted,F=e.mergeProps,V=e.reactive,H=e.withDirectives,U=e.resolveDirective,q=e.vModelText,G=e.h,J=e.createApp,W=e.defineAsyncComponent},function(e){Y=e.ScriptFactory,Z=e.Srfuf,X=e.PluginStaticResource,K=e.ControllerEvent,$=e.convertNavData,Q=e.EditorController,ee=e.getDeACMode,te=e.registerEditorProvider},function(e){ne=e.getHtmlProps,re=e.useNamespace,ie=e.useClickOutside,oe=e.getEditorEmits,ae=e.withInstall},function(e){se=e.Editor,le=e.Toolbar},function(e){ue=e.SlateEditor,ce=e.SlateElement,he=e.SlateText,fe=e.SlateNode,de=e.SlatePath,ge=e.SlateTransforms,ve=e.SlateRange,pe=e.DomEditor,ye=e.SlatePoint,me=e.Boot,we=e.createEditor},function(e){be=e.getCookie,ke=e.createUUID,xe=e.QXEvent},function(e){Ce=e.isNil},function(e){Ee=e.CoreConst,Se=e.debounce,_e=e.getToken,Ae=e.awaitTimeout,Me=e.RuntimeError,Pe=e.listenJSEvent,Oe=e.NOOP,Te=e.strToBase64,Le=e.HttpError,je=e.base64ToStr,Ne=e.clone,Re=e.downloadFileFromBlob},function(e){De=e.ElMessageBox,Ie=e.default,Be=e.ElInput,ze=e.ElSlider,Fe=e.ElButton},function(e){Ve=e.debounce,He=e.startCase,Ue=e.camelCase,qe=e.isObject,Ge=e.clamp,Je=e.upperFirst,We=e.lowerFirst,Ye=e.isPlainObject,Ze=e.defaultsDeep,Xe=e.cloneDeep,Ke=e.sortedIndex,$e=e.merge,Qe=e.uniq,et=e.difference,tt=e.sortedIndexBy,nt=e.union,rt=e.isEqual,it=e.defaults,ot=e.isEmpty,at=e.sortBy,st=e.groupBy,lt=e.max,ut=e.has,ct=e.clone,ht=e.isNumber,ft=e.throttle,dt=e.toNumber},function(e){gt=e.default}],execute:function(){var vt=E().mark(Ii);o("g",jw);var pt=function(){function e(t,n){A(this,e),O(this,"modalOrPanel",void 0),O(this,"htmlRef",void 0),this.modalOrPanel=t,this.htmlRef=n,this.calcModalPosition(),window.addEventListener("resize",this.handleResize.bind(this))}return P(e,[{key:"calcModalPosition",value:function(){if(["dropPanel","selectList"].includes(this.modalOrPanel.type)){var e=this.modalOrPanel.$elem[0],t=this.htmlRef.$el,n=t.querySelector(".w-e-bar"),r=e.previousElementSibling,i=r.getAttribute("data-menu-key"),o=e.parentNode.parentNode.parentNode;if(["bgColor","color","headerSelect"].includes(i)&&t&&n&&r&&"true"!==o.getAttribute("data-w-e-toolbar")){var a=e.clientWidth,s=e.clientHeight,l=n.clientHeight,u=r.getBoundingClientRect(),c=u.bottom,h=u.right,f=u.top,d=u.left,g="".concat(f+l,"px"),v="".concat(d,"px"),p="".concat(c-s-l,"px"),y="".concat(h-a,"px"),m={position:"fixed",left:v,top:g},w=window.innerWidth,b=window.innerHeight;w-d<a&&Object.assign(m,{left:y}),b-f-l<s&&Object.assign(m,{top:p}),Object.assign(e.style,{top:"",bottom:"",left:"",right:""}),Object.assign(e.style,m)}}}},{key:"handleResize",value:function(){this.calcModalPosition()}},{key:"destroy",value:function(){window.removeEventListener("resize",this.handleResize)}}]),e}(),yt=d({name:"IBizHtmlContent",props:ne(),emits:["change","blur","focus","enter","infoTextChange","link"],setup:function(e,t){var n=t.emit,r=re("html"),i=e.controller,o=C(),a=C({}),s=0,l=C(),c=C(),h=S(),f=C(),d=C(""),g=C({Authorization:"Bearer ".concat(be(Ee.TOKEN))}),v=C(""),p=C(""),y=C(!0),w=C(!1),b=C(!1),x=C(!1),A=C(!1),P=C(""),I=C([]),B=C(!1),z=i.model;z.editorParams&&(z.editorParams.enableEdit&&(w.value=!0,b.value=!0,y.value=i.toBoolean(z.editorParams.enableEdit)&&!e.readonly&&!e.disabled),z.editorParams.enableFullScreen&&(x.value=i.toBoolean(z.editorParams.enableFullScreen)));var F=function(e){if(h.value){var t=e.eventArg;t&&(h.value.setHtml(t),j((function(){h.value.focus(!0),n("focus")})))}},V=function(){h.value&&(h.value.blur(),h.value.setHtml(""))},H=function(){h.value&&(h.value.focus(!0),n("focus"))};i.evt.on("setHtml",F),i.evt.on("clear",V),i.evt.on("onSetReply",H),M((function(){return e.data}),(function(e){if(e){var t=ibiz.util.file.calcFileUpDownUrl(i.context,i.params,e);v.value=t.uploadUrl,p.value=t.downloadUrl}}),{immediate:!0,deep:!0});var U=function(e,t){if(t)return!0},q=function(e){return e},G={toolbarKeys:[{key:"group-add-style",title:"添加",iconSvg:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="arvaction/plus-circle-fill" stroke-width="1" fill-rule="evenodd"><path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm-.6-8.6H4v1.2h3.4V12h1.2V8.6H12V7.4H8.6V4H7.4v3.4z" id="arv形状结合"></path></g></svg>',menuKeys:["attachments","codesnippet","page"]},"|",{key:"group-inline-style",title:"文本格式",iconSvg:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="ahdeditor/color-tt" stroke-width="1" fill-rule="evenodd"><path id="ahdsecondary-color" d="M1.999 15.011h11.998V13.81H1.999z"></path><path d="M6.034 7.59h4.104L8.086 2.297 6.034 7.59zm-.465 1.2l-1.437 3.707H2.845L7.301 1h1.287l-.001.004h.286l4.454 11.492h-1.288L10.603 8.79H5.569z" id="ahd合并形状"></path></g></svg>',menuKeys:["bold","italic","underline","through","code","numberedList","bulletedList","insertLink"]},"codeBlock","mention","marker","emoji"]};i.chatCompletion&&G.toolbarKeys.push("aichart");var J,W={placeholder:i.placeHolder,readOnly:w.value?b.value:e.readonly,MENU_CONF:{uploadImage:{server:v.value,fieldName:"file",maxFileSize:10485760,maxNumberOfFiles:10,allowedFileTypes:[],headers:g.value,withCredentials:!0,onBeforeUpload:function(e){return e},onProgress:function(e){console.log("progress",e)},onSuccess:function(e,t){console.log("".concat(e.name," 上传成功"),t)},onFailed:function(e,t){console.log("".concat(e.name," 上传失败"),t)},onError:function(e,t,n){console.log("".concat(e.name," 上传出错"),t,n)},customInsert:function(e,t){return _(E().mark((function n(){var r,i;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=p.value.replace("%fileId%",e.id),i=e.filename,t(r,i,"");case 3:case"end":return n.stop()}}),n)})))()}},insertLink:{checkLink:U,parseLinkUrl:q},editLink:{checkLink:U,parseLinkUrl:q}},hoverbarKeys:{link:{menuKeys:["editLink","unLink","customViewLink"]}}},Z=function(){var e=_(E().mark((function e(t){var n,r,i,o,a,s,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.src,b.value)X(n);else if(r=ue.nodes(h.value,{match:function(e){return!(!ce.isElement(e)||"image"!==e.type)},universal:!0}),r){i=k(r);try{for(i.s();!(o=i.n()).done;)a=o.value,s=m(a,1),"image"===(l=s[0]).type&&n.endsWith(l.src)&&X(l.src)}catch(u){i.e(u)}finally{i.f()}}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=_(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P.value=t,I.value=[t],e.next=4,j();case 4:f.value&&(n=f.value.$refs.container)&&n.children[0].click();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){if(f.value){var t=f.value.$refs.container;if(t){var n=t.querySelector(".el-image-viewer__wrapper");null==n||n[e]("keydown",$)}}},$=function(){var e=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Escape"!==t.key&&27!==t.keyCode){e.next=7;break}return t.stopPropagation(),t.preventDefault(),e.next=5,j();case 5:K("removeEventListener"),I.value=[];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:K("addEventListener");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var t=_(E().mark((function t(){var r,o,a,s,l;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i.deService){t.next=11;break}return t.next=3,u.import("@ibiz-template-plugin/ai-chat");case 3:return o=t.sent,a=o.chat||o.default.chat,J=a,s=a.create({question:function(){var e=_(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ke(),e.next=3,null===(n=i.deService)||void 0===n?void 0:n.aiChatSse((function(e){if(ibiz.log.info("aiChatSse",e),20===e.actionstate&&e.actionresult)s.addMessage({messageid:r,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:e.actionresult});else if(30===e.actionstate&&e.actionresult){var t=JSON.parse(e.actionresult).choices;t&&t.length>0&&s.replaceMessage({messageid:r,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:t[0].content||""})}else 40===e.actionstate&&s.replaceMessage({messageid:r,state:e.actionstate,type:"ERROR",role:"ASSISTANT",content:e.actionresult})}),i.context,{},{messages:t});case 3:return s.addMessage({messageid:r,state:10,type:"DEFAULT",role:"ASSISTANT",content:""}),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),action:function(e,t){"backfill"===e&&(n("change",t.content),B.value=!0)},closed:function(){h.value&&e.value&&h.value&&h.value.focus(!0)}}),t.next=9,null===(r=i.deService)||void 0===r?void 0:r.aiChatHistory(i.context,{});case 9:(l=t.sent).data&&Array.isArray(l.data)&&l.data.forEach((function(e){var t={messageid:ke(),state:30,type:"DEFAULT",role:e.role,content:e.content};s.addMessage(t)}));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();T((function(){J&&J.close();var e=h.value;null!=e&&e.destroy()}));var te=function(t){var n;h.value=t,t.on("modalOrPanelShow",(function(e){n=new pt(e,c.value)})),t.on("modalOrPanelHide",(function(){n&&n.destroy()})),t.setHtml(d.value),t.on("aiClick",(function(){ee()})),i.onCreated(h.value,e.data,G)},ne=function(t){var r=t.getHtml();!function(e){var t=e.getEditableContainer();t&&t.querySelectorAll("img").forEach((function(e){e.onclick=function(e){var t=e.target;t&&Z(t)}}))}(t);var o="<p><br></p>"===r?"":r;o===e.value||""===o&&Ce(e.value)||w.value||(n("change",o),i.evt.emit("onChange",{eventArg:o}))},ie=function(e){i.evt.off("setHtml",F),i.evt.off("clear",V),i.evt.off("onSetReply",H)},oe=function(){n("focus"),i.evt.emit("onFocus",{eventArg:e.value})},ae=function(){n("blur"),i.evt.emit("onBlur",{eventArg:e.value})},he=function(e,t){alert("【自定义提示】".concat(t," - ").concat(e))},fe=function(e,t,n){n(!0)},de=function(){var e=h.value;null!=e&&e.disable()},ge=function(){var e=h.value;null!=e&&e.enable()},ve=function(){b.value=!b.value,b.value?de():(ge(),h.value.focus(),function(){if(e.value){var t=e.value.indexOf("</p>");if(t>=0){var n,r,i=null===(n=h.value.selection.anchor)||void 0===n?void 0:n.offset,o=null===(r=h.value.selection.anchor)||void 0===r?void 0:r.path;0===i&&o.length>0&&0===o[0]&&h.value.move(t-3)}}}())},pe=function(){A.value=!A.value,j((function(){b.value?de():(ge(),h.value.focus())}))},ye=function(){if(i.reply.value){var e=Y.execScriptFn({value:i.reply.value},i.replyScript,{singleRowReturn:!0,isAsync:!1});return N("div",{class:r.b("reply")},[N("div",{class:r.be("reply","content"),innerHTML:e},null),N(R("ion-icon"),{name:"close-outline",onClick:function(){return i.removeReply()}},null)])}};return L((function(){!function(){if(o.value&&l.value){var e=o.value.offsetHeight;new ResizeObserver((function(t){var n=t[0].contentRect.height;if(n!==s){var i={height:"".concat(e-t[0].contentRect.height,"px")};a.value=r.cssVarBlock(i),s=n}})).observe(l.value.selector)}}(),M((function(){return e.value}),(function(t,n){t===n||"string"!=typeof e.value&&null!=t||(d.value=null==t?"":t,B.value&&(h.value&&j((function(){h.value.focus(!0)})),B.value=!1))}),{immediate:!0}),M((function(){return e.disabled}),(function(e,t){e!==t&&(!0===e?de():ge())}),{immediate:!0})})),{ns:r,editorRef:h,previewRef:f,mode:"default",valueHtml:d,toolbarConfig:G,editorConfig:W,handleCreated:te,handleChange:ne,handleDestroyed:ie,handleFocus:oe,handleBlur:ae,customAlert:he,customPaste:fe,insertText:function(e){var t=h.value;null!=t&&t.insertText(e)},printHtml:function(){var e=h.value;null!=e&&console.log(e.getHtml())},disable:de,enable:ge,renderHeaserToolbar:function(){return w.value||x.value?N("div",{class:r.b("custom-toolbar")},[w.value&&y.value&&b.value?N("i",{class:"fa fa-edit","aria-hidden":"true",title:"启用编辑",onClick:function(){return ve()}},null):null,x.value?A.value?N("i",{class:"fa fa-compress","aria-hidden":"true",title:"缩小",onClick:function(){return pe()}},null):N("i",{class:"fa fa-expand","aria-hidden":"true",title:"放大",onClick:function(){return pe()}},null):null]):null},renderEditorContent:function(){return i.hidden.value?null:N("div",{class:r.b("content"),ref:"htmlContent",style:a.value},[N(se,{ref:"htmlRef",class:r.b("editor"),modelValue:d.value,"onUpdate:modelValue":function(e){return d.value=e},"default-config":W,mode:"default",onOnCreated:te,onOnChange:ne,onOnDestroyed:ie,onOnFocus:oe,onOnBlur:ae,oncustomAlert:he,oncustomPaste:fe},null),ye(),N(le,{ref:"toolbarRef",editor:h.value,"default-config":G,mode:"default",class:r.b("toolbar")},null)])},renderFooter:function(){return w.value?N("div",{class:[r.b("footer"),O({},r.b("footer-dialog"),A.value)]},[N("div",{class:r.be("footer","cancel"),onClick:function(){e.value!==d.value?De({title:"确认取消",type:"warning",customClass:r.b("message"),message:N("div",{class:r.be("message","message-content")},[N("p",null,[D("确定要取消编辑吗？")]),N("p",{class:r.bem("message","message-content","message-tip")},[D("取消编辑将无法保存修改的内容，且不能找回。")])]),showCancelButton:!0,cancelButtonClass:r.be("message","message-cancel"),confirmButtonClass:r.be("message","message-comfire")}).then((function(){if(e.value){var t=i.parseNode(e.value);d.value=t}else d.value="";ve()})).catch((function(){h.value.focus()})):ve()}},[D("取消")]),N("div",{class:r.be("footer","save"),onClick:function(){return function(){b.value=!0,h.value.disable();var e=d.value;n("change",e),A.value&&(A.value=!1)}()}},[D("保存")])]):null},htmlContent:o,hasEnableEdit:w,cssVars:a,toolbarRef:l,htmlRef:c,isFullScreen:A,readonlyState:b,changeFullScreenState:pe,renderPreview:function(){return N(R("el-image"),{class:r.e("preview"),ref:"previewRef","zoom-rate":1.1,src:P.value,"preview-src-list":I.value,"hide-on-click-modal":!0,onShow:Q,fit:"cover"},null)}}},render:function(){var e=this;return this.isFullScreen?N(R("el-dialog"),{modelValue:this.isFullScreen,"onUpdate:modelValue":function(t){return e.isFullScreen=t},width:"80%",top:"10vh",class:this.ns.b("dialog-full-screen"),onClose:function(){return e.changeFullScreenState()}},{default:function(){return[N("div",{class:[e.ns.b(),O({},e.ns.b("editor-readonly"),e.readonlyState)]},[e.renderHeaserToolbar(),e.renderEditorContent(),e.hasEnableEdit&&!e.readonlyState?e.renderFooter():null])]}}):N("div",{class:[this.ns.b(),O({},this.ns.b("editor-readonly"),this.readonlyState)]},[this.renderHeaserToolbar(),this.renderEditorContent(),this.renderPreview(),this.hasEnableEdit&&!this.readonlyState?this.renderFooter():null])}}),mt=Object.freeze(Object.defineProperty({__proto__:null,default:yt},Symbol.toStringTag,{value:"Module"})),wt=["insert","|","headerSelect","blockquote","|","bold","underline","italic",{key:"group-more-style",title:"更多",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M204.8 505.6m-76.8 0a76.8 76.8 0 1 0 153.6 0 76.8 76.8 0 1 0-153.6 0Z"></path><path d="M505.6 505.6m-76.8 0a76.8 76.8 0 1 0 153.6 0 76.8 76.8 0 1 0-153.6 0Z"></path><path d="M806.4 505.6m-76.8 0a76.8 76.8 0 1 0 153.6 0 76.8 76.8 0 1 0-153.6 0Z"></path></svg>',menuKeys:["through","code","sup","sub","clearStyle"]},"color","bgColor","|","fontSize","fontFamily","lineHeight","|","bulletedList","numberedList","todo",{key:"group-justify",title:"对齐",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M768 793.6v102.4H51.2v-102.4h716.8z m204.8-230.4v102.4H51.2v-102.4h921.6z m-204.8-230.4v102.4H51.2v-102.4h716.8zM972.8 102.4v102.4H51.2V102.4h921.6z"></path></svg>',menuKeys:["justifyLeft","justifyRight","justifyCenter","justifyJustify"]},{key:"group-indent",title:"缩进",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M0 64h1024v128H0z m384 192h640v128H384z m0 192h640v128H384z m0 192h640v128H384zM0 832h1024v128H0z m0-128V320l256 192z"></path></svg>',menuKeys:["indent","delIndent"]},"|","emoji","insertLink",{key:"group-image",title:"图片",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M959.877 128l0.123 0.123v767.775l-0.123 0.122H64.102l-0.122-0.122V128.123l0.122-0.123h895.775zM960 64H64C28.795 64 0 92.795 0 128v768c0 35.205 28.795 64 64 64h896c35.205 0 64-28.795 64-64V128c0-35.205-28.795-64-64-64zM832 288.01c0 53.023-42.988 96.01-96.01 96.01s-96.01-42.987-96.01-96.01S682.967 192 735.99 192 832 234.988 832 288.01zM896 832H128V704l224.01-384 256 320h64l224.01-192z"></path></svg>',menuKeys:["insertImage","uploadImage"]},{key:"group-video",title:"视频",iconSvg:'<svg viewBox="0 0 1024 1024"><path d="M981.184 160.096C837.568 139.456 678.848 128 512 128S186.432 139.456 42.816 160.096C15.296 267.808 0 386.848 0 512s15.264 244.16 42.816 351.904C186.464 884.544 345.152 896 512 896s325.568-11.456 469.184-32.096C1008.704 756.192 1024 637.152 1024 512s-15.264-244.16-42.816-351.904zM384 704V320l320 192-320 192z"></path></svg>',menuKeys:["insertVideo","uploadVideo"]},"insertTable","codeBlock","divider","|","undo","redo"],bt=function(){return new Map},kt=function(e){var t=bt();return e.forEach((function(e,n){t.set(n,e)})),t},xt=function(e,t,n){var r=e.get(t);return void 0===r&&e.set(t,r=n()),r},Ct=function(){return new Set},Et=function(e){return e[e.length-1]},St=function(e,t){for(var n=0;n<t.length;n++)e.push(t[n])},_t=Array.from,At=Array.isArray,Mt=function(){function e(){A(this,e),this._observers=bt()}return P(e,[{key:"on",value:function(e,t){return xt(this._observers,e,Ct).add(t),t}},{key:"once",value:function(e,t){var n=this;this.on(e,(function r(){n.off(e,r),t.apply(void 0,arguments)}))}},{key:"off",value:function(e,t){var n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}},{key:"emit",value:function(e,t){return _t((this._observers.get(e)||bt()).values()).forEach((function(e){return e.apply(void 0,p(t))}))}},{key:"destroy",value:function(){this._observers=bt()}}]),e}(),Pt=Math.floor,Ot=Math.abs,Tt=function(e,t){return e<t?e:t},Lt=function(e,t){return e>t?e:t},jt=function(e){return 0!==e?e<0:1/e<0},Nt=32,Rt=64,Dt=128,It=31,Bt=127,zt=Number.MAX_SAFE_INTEGER,Ft=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Pt(e)===e},Vt=/^\s*/g,Ht=/([A-Z])/g,Ut=function(e,t){return function(e){return e.replace(Vt,"")}(e.replace(Ht,(function(e){return"".concat(t).concat(function(e){return e.toLowerCase()}(e))})))},qt="undefined"!=typeof TextEncoder?new TextEncoder:null,Gt=qt?function(e){return qt.encode(e)}:function(e){for(var t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.codePointAt(i);return r},Jt="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});Jt&&1===Jt.decode(new Uint8Array).length&&(Jt=null);var Wt=P((function e(){A(this,e),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]})),Yt=function(){return new Wt},Zt=function(e){for(var t=new Uint8Array(function(e){for(var t=e.cpos,n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t}(e)),n=0,r=0;r<e.bufs.length;r++){var i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},Xt=function(e,t){var n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},Kt=Xt,$t=function(e,t){for(;t>Bt;)Xt(e,Dt|Bt&t),t=Pt(t/128);Xt(e,Bt&t)},Qt=function(e,t){var n=jt(t);for(n&&(t=-t),Xt(e,(t>63?Dt:0)|(n?Rt:0)|63&t),t=Pt(t/64);t>0;)Xt(e,(t>Bt?Dt:0)|Bt&t),t=Pt(t/128)},en=new Uint8Array(3e4),tn=en.length/3,nn=qt&&qt.encodeInto?function(e,t){if(t.length<tn){var n=qt.encodeInto(t,en).written||0;$t(e,n);for(var r=0;r<n;r++)Xt(e,en[r])}else on(e,Gt(t))}:function(e,t){var n=unescape(encodeURIComponent(t)),r=n.length;$t(e,r);for(var i=0;i<r;i++)Xt(e,n.codePointAt(i))},rn=function(e,t){var n=e.cbuf.length,r=e.cpos,i=Tt(n-r,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),r),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(Lt(2*n,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},on=function(e,t){$t(e,t.byteLength),rn(e,t)},an=function(e,t){!function(e,t){var n=e.cbuf.length;n-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*Lt(n,t)),e.cpos=0)}(e,t);var n=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,n},sn=new DataView(new ArrayBuffer(4)),ln=function(e,t){switch(v(t)){case"string":Xt(e,119),nn(e,t);break;case"number":Ft(t)&&Ot(t)<=2147483647?(Xt(e,125),Qt(e,t)):(a=t,sn.setFloat32(0,a),sn.getFloat32(0)===a?(Xt(e,124),function(e,t){an(e,4).setFloat32(0,t,!1)}(e,t)):(Xt(e,123),function(e,t){an(e,8).setFloat64(0,t,!1)}(e,t)));break;case"bigint":Xt(e,122),function(e,t){an(e,8).setBigInt64(0,t,!1)}(e,t);break;case"object":if(null===t)Xt(e,126);else if(At(t)){Xt(e,117),$t(e,t.length);for(var n=0;n<t.length;n++)ln(e,t[n])}else if(t instanceof Uint8Array)Xt(e,116),on(e,t);else{Xt(e,118);var r=Object.keys(t);$t(e,r.length);for(var i=0;i<r.length;i++){var o=r[i];nn(e,o),ln(e,t[o])}}break;case"boolean":Xt(e,t?120:121);break;default:Xt(e,127)}var a},un=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this)).w=e,r.s=null,r.count=0,r}return P(n,[{key:"write",value:function(e){this.s===e?this.count++:(this.count>0&&$t(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}]),n}(Wt),cn=function(e){e.count>0&&(Qt(e.encoder,1===e.count?e.s:-e.s),e.count>1&&$t(e.encoder,e.count-2))},hn=function(){function e(){A(this,e),this.encoder=new Wt,this.s=0,this.count=0}return P(e,[{key:"write",value:function(e){this.s===e?this.count++:(cn(this),this.count=1,this.s=e)}},{key:"toUint8Array",value:function(){return cn(this),Zt(this.encoder)}}]),e}(),fn=function(e){if(e.count>0){var t=2*e.diff+(1===e.count?0:1);Qt(e.encoder,t),e.count>1&&$t(e.encoder,e.count-2)}},dn=function(){function e(){A(this,e),this.encoder=new Wt,this.s=0,this.count=0,this.diff=0}return P(e,[{key:"write",value:function(e){this.diff===e-this.s?(this.s=e,this.count++):(fn(this),this.count=1,this.diff=e-this.s,this.s=e)}},{key:"toUint8Array",value:function(){return fn(this),Zt(this.encoder)}}]),e}(),gn=function(){function e(){A(this,e),this.sarr=[],this.s="",this.lensE=new hn}return P(e,[{key:"write",value:function(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}},{key:"toUint8Array",value:function(){var e=new Wt;return this.sarr.push(this.s),this.s="",nn(e,this.sarr.join("")),rn(e,this.lensE.toUint8Array()),Zt(e)}}]),e}(),vn=function(e){return new Error(e)},pn=function(){throw vn("Method unimplemented")},yn=function(){throw vn("Unexpected case")},mn=vn("Unexpected end of array"),wn=vn("Integer out of Range"),bn=P((function e(t){A(this,e),this.arr=t,this.pos=0})),kn=function(e){return new bn(e)},xn=function(e){return e.pos!==e.arr.length},Cn=function(e){return function(e,t){var n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n}(e,Sn(e))},En=function(e){return e.arr[e.pos++]},Sn=function(e){for(var t=0,n=1,r=e.arr.length;e.pos<r;){var i=e.arr[e.pos++];if(t+=(i&Bt)*n,n*=128,i<Dt)return t;if(t>zt)throw wn}throw mn},_n=function(e){var t=e.arr[e.pos++],n=63&t,r=64,i=(t&Rt)>0?-1:1;if(0==(t&Dt))return i*n;for(var o=e.arr.length;e.pos<o;){if(n+=((t=e.arr[e.pos++])&Bt)*r,r*=128,t<Dt)return i*n;if(n>zt)throw wn}throw mn},An=Jt?function(e){return Jt.decode(Cn(e))}:function(e){var t=Sn(e);if(0===t)return"";var n=String.fromCodePoint(En(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(En(e));else for(;t>0;){var r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))},Mn=function(e,t){var n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},Pn=[function(e){},function(e){return null},_n,function(e){return Mn(e,4).getFloat32(0,!1)},function(e){return Mn(e,8).getFloat64(0,!1)},function(e){return Mn(e,8).getBigInt64(0,!1)},function(e){return!1},function(e){return!0},An,function(e){for(var t=Sn(e),n={},r=0;r<t;r++){n[An(e)]=On(e)}return n},function(e){for(var t=Sn(e),n=[],r=0;r<t;r++)n.push(On(e));return n},Cn],On=function(e){return Pn[127-En(e)](e)},Tn=function(e){l(n,e);var t=c(n);function n(e,r){var i;return A(this,n),(i=t.call(this,e)).reader=r,i.s=null,i.count=0,i}return P(n,[{key:"read",value:function(){return 0===this.count&&(this.s=this.reader(this),xn(this)?this.count=Sn(this)+1:this.count=-1),this.count--,this.s}}]),n}(bn),Ln=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).s=0,r.count=0,r}return P(n,[{key:"read",value:function(){if(0===this.count){this.s=_n(this);var e=jt(this.s);this.count=1,e&&(this.s=-this.s,this.count=Sn(this)+2)}return this.count--,this.s}}]),n}(bn),jn=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).s=0,r.count=0,r.diff=0,r}return P(n,[{key:"read",value:function(){if(0===this.count){var e=_n(this),t=1&e;this.diff=Pt(e/2),this.count=1,t&&(this.count=Sn(this)+2)}return this.s+=this.diff,this.count--,this.s}}]),n}(bn),Nn=function(){function e(t){A(this,e),this.decoder=new Ln(t),this.str=An(this.decoder),this.spos=0}return P(e,[{key:"read",value:function(){var e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}]),e}(),Rn=crypto.getRandomValues.bind(crypto),Dn=function(){return Rn(new Uint32Array(1))[0]},In=[1e7]+-1e3+-4e3+-8e3+-1e11,Bn=Date.now,zn=function(e){return new Promise(e)};Promise.all.bind(Promise);var Fn=function(e){return void 0===e?null:e},Vn=function(){function e(){A(this,e),this.map=new Map}return P(e,[{key:"setItem",value:function(e,t){this.map.set(e,t)}},{key:"getItem",value:function(e){return this.map.get(e)}}]),e}(),Hn=new Vn;try{"undefined"!=typeof localStorage&&localStorage&&(Hn=localStorage,!1)}catch(Kk){}var Un,qn=Hn,Gn=Object.assign,Jn=Object.keys,Wn=function(e){return Jn(e).length},Yn=function(e,t){return e===t||Wn(e)===Wn(t)&&function(e,t){for(var n in e)if(!t(e[n],n))return!1;return!0}(e,(function(e,n){return(void 0!==e||function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(t,n))&&t[n]===e}))},Zn=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{for(;r<t.length;r++)t[r].apply(t,p(n))}finally{r<t.length&&e(t,n,r+1)}},Xn=function(e){return e},Kn="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),$n=function(e){return function(){if(void 0===Un)if(Kn){Un=bt();for(var e=process.argv,t=null,n=0;n<e.length;n++){var r=e[n];"-"===r[0]?(null!==t&&Un.set(t,""),t=r):null!==t&&(Un.set(t,r),t=null)}null!==t&&Un.set(t,"")}else"object"===("undefined"==typeof location?"undefined":v(location))?(Un=bt(),(location.search||"?").slice(1).split("&").forEach((function(e){if(0!==e.length){var t=m(e.split("="),2),n=t[0],r=t[1];Un.set("--".concat(Ut(n,"-")),r),Un.set("-".concat(Ut(n,"-")),r)}}))):Un=bt();return Un}().has(e)},Qn=function(e){return Fn(Kn?process.env[e.toUpperCase().replaceAll("-","_")]:qn.getItem(e))},er=function(e){return $n("--"+e)||null!==Qn(e)};er("production");var tr=Kn&&function(e,t){return t.includes(e)}(process.env.FORCE_COLOR,["true","1","2"]),nr=tr||!$n("--no-colors")&&!er("no-color")&&(!Kn||process.stdout.isTTY)&&(!Kn||$n("--color")||null!==Qn("COLORTERM")||(Qn("TERM")||"").includes("color")),rr=function(e){var t,n=(t=e.byteLength,new Uint8Array(t));return n.set(e),n},ir=P((function e(t,n){A(this,e),this.left=t,this.right=n})),or=function(e,t){return new ir(e,t)};"undefined"!=typeof DOMParser&&new DOMParser;var ar=function(e){return function(e,t){var n,r=[],i=k(e);try{for(i.s();!(n=i.n()).done;){var o=m(n.value,2),a=o[0],s=o[1];r.push(t(s,a))}}catch(l){i.e(l)}finally{i.f()}return r}(e,(function(e,t){return"".concat(t,":").concat(e,";")})).join("")},sr=Symbol,lr=sr(),ur=sr(),cr=sr(),hr=sr(),fr=sr(),dr=sr(),gr=sr(),vr=sr(),pr=sr(),yr=O(O(O(O(O(O(O(O(O({},lr,or("font-weight","bold")),ur,or("font-weight","normal")),cr,or("color","blue")),fr,or("color","green")),hr,or("color","grey")),dr,or("color","red")),gr,or("color","purple")),vr,or("color","orange")),pr,or("color","black")),mr=nr?function(e){var t;1===e.length&&(null===(t=e[0])||void 0===t?void 0:t.constructor)===Function&&(e=e[0]());for(var n=[],r=[],i=bt(),o=[],a=0;a<e.length;a++){var s=e[a],l=yr[s];if(void 0!==l)i.set(l.left,l.right);else{if(void 0===s)break;if(s.constructor!==String&&s.constructor!==Number)break;var u=ar(i);a>0||u.length>0?(n.push("%c"+s),r.push(u)):n.push(s)}}for(a>0&&(o=r).unshift(n.join(""));a<e.length;a++){var c=e[a];c instanceof Symbol||o.push(c)}return o}:function(e){var t;1===e.length&&(null===(t=e[0])||void 0===t?void 0:t.constructor)===Function&&(e=e[0]());for(var n=[],r=[],i=0;i<e.length;i++){var o=e[i];if(void 0===o)break;if(o.constructor===String||o.constructor===Number)n.push(o);else if(o.constructor===Object)break}for(i>0&&r.push(n.join(""));i<e.length;i++){var a=e[i];a instanceof Symbol||r.push(a)}return r},wr=Ct(),br=function(e){return O(O({},Symbol.iterator,(function(){return this})),"next",e)},kr=function(e,t){return br((function(){var n=e.next(),r=n.done,i=n.value;return{done:r,value:r?void 0:t(i)}}))},xr=P((function e(t,n){A(this,e),this.clock=t,this.len=n})),Cr=P((function e(){A(this,e),this.clients=new Map})),Er=function(e,t,n){return t.clients.forEach((function(t,r){for(var i=e.doc.store.clients.get(r),o=0;o<t.length;o++){var a=t[o];_i(e,i,a.clock,a.len,n)}}))},Sr=function(e,t){var n=e.clients.get(t.client);return void 0!==n&&null!==function(e,t){for(var n=0,r=e.length-1;n<=r;){var i=Pt((n+r)/2),o=e[i],a=o.clock;if(a<=t){if(t<a+o.len)return i;n=i+1}else r=i-1}return null}(n,t.clock)},_r=function(e){e.clients.forEach((function(e){var t,n;for(e.sort((function(e,t){return e.clock-t.clock})),t=1,n=1;t<e.length;t++){var r=e[n-1],i=e[t];r.clock+r.len>=i.clock?r.len=Lt(r.len,i.clock+i.len-r.clock):(n<t&&(e[n]=i),n++)}e.length=n}))},Ar=function(e){for(var t=new Cr,n=function(n){e[n].clients.forEach((function(r,i){if(!t.clients.has(i)){for(var o=r.slice(),a=n+1;a<e.length;a++)St(o,e[a].clients.get(i)||[]);t.clients.set(i,o)}}))},r=0;r<e.length;r++)n(r);return _r(t),t},Mr=function(e,t,n,r){xt(e.clients,t,(function(){return[]})).push(new xr(n,r))},Pr=function(e){var t=new Cr;return e.clients.forEach((function(e,n){for(var r=[],i=0;i<e.length;i++){var o=e[i];if(o.deleted){var a=o.id.clock,s=o.length;if(i+1<e.length)for(var l=e[i+1];i+1<e.length&&l.deleted;l=e[1+ ++i])s+=l.length;r.push(new xr(a,s))}}r.length>0&&t.clients.set(n,r)})),t},Or=function(e,t){$t(e.restEncoder,t.clients.size),_t(t.clients.entries()).sort((function(e,t){return t[0]-e[0]})).forEach((function(t){var n=m(t,2),r=n[0],i=n[1];e.resetDsCurVal(),$t(e.restEncoder,r);var o=i.length;$t(e.restEncoder,o);for(var a=0;a<o;a++){var s=i[a];e.writeDsClock(s.clock),e.writeDsLen(s.len)}}))},Tr=function(e){for(var t=new Cr,n=Sn(e.restDecoder),r=0;r<n;r++){e.resetDsCurVal();var i=Sn(e.restDecoder),o=Sn(e.restDecoder);if(o>0)for(var a=xt(t.clients,i,(function(){return[]})),s=0;s<o;s++)a.push(new xr(e.readDsClock(),e.readDsLen()))}return t},Lr=function(e,t,n){for(var r=new Cr,i=Sn(e.restDecoder),o=0;o<i;o++){e.resetDsCurVal();for(var a=Sn(e.restDecoder),s=Sn(e.restDecoder),l=n.clients.get(a)||[],u=wi(n,a),c=0;c<s;c++){var h=e.readDsClock(),f=h+e.readDsLen();if(h<u){u<f&&Mr(r,a,u,f-u);var d=ki(l,h),g=l[d];for(!g.deleted&&g.id.clock<h&&(l.splice(d+1,0,ga(t,g,h-g.id.clock)),d++);d<l.length&&(g=l[d++]).id.clock<f;)g.deleted||(f<g.id.clock+g.length&&l.splice(d,0,ga(t,g,f-g.id.clock)),g.delete(t))}else Mr(r,a,h,f-h)}}if(r.clients.size>0){var v=new Vr;return $t(v.restEncoder,0),Or(v,r),v.toUint8Array()}return null},jr=Dn,Nr=function(e){l(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.guid,o=void 0===i?In.replace(/[018]/g,(function(e){return(e^Dn()&15>>e/4).toString(16)})):i,a=r.collectionid,s=void 0===a?null:a,l=r.gc,u=void 0===l||l,c=r.gcFilter,h=void 0===c?function(){return!0}:c,d=r.meta,g=void 0===d?null:d,v=r.autoLoad,p=void 0!==v&&v,y=r.shouldLoad,m=void 0===y||y;A(this,n),(e=t.call(this)).gc=u,e.gcFilter=h,e.clientID=jr(),e.guid=o,e.collectionid=s,e.share=new Map,e.store=new yi,e._transaction=null,e._transactionCleanups=[],e.subdocs=new Set,e._item=null,e.shouldLoad=m,e.autoLoad=p,e.meta=g,e.isLoaded=!1,e.isSynced=!1,e.whenLoaded=zn((function(t){e.on("load",(function(){e.isLoaded=!0,t(f(e))}))}));var w=function(){return zn((function(t){e.on("sync",(function n(r){void 0!==r&&!0!==r||(e.off("sync",n),t())}))}))};return e.on("sync",(function(t){!1===t&&e.isSynced&&(e.whenSynced=w()),e.isSynced=void 0===t||!0===t,e.isSynced&&!e.isLoaded&&e.emit("load",[f(e)])})),e.whenSynced=w(),e}return P(n,[{key:"load",value:function(){var e=this,t=this._item;null===t||this.shouldLoad||Li(t.parent.doc,(function(t){t.subdocsLoaded.add(e)}),null,!0),this.shouldLoad=!0}},{key:"getSubdocs",value:function(){return this.subdocs}},{key:"getSubdocGuids",value:function(){return new Set(_t(this.subdocs).map((function(e){return e.guid})))}},{key:"transact",value:function(e){return Li(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}},{key:"get",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ro,r=xt(this.share,e,(function(){var e=new n;return e._integrate(t,null),e})),i=r.constructor;if(n!==ro&&i!==n){if(i===ro){var o=new n;o._map=r._map,r._map.forEach((function(e){for(;null!==e;e=e.left)e.parent=o})),o._start=r._start;for(var a=o._start;null!==a;a=a.right)a.parent=o;return o._length=r._length,this.share.set(e,o),o._integrate(this,null),o}throw new Error("Type with the name ".concat(e," has already been defined with a different constructor"))}return r}},{key:"getArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,ko)}},{key:"getText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,zo)}},{key:"getMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Co)}},{key:"getXmlElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Ho)}},{key:"getXmlFragment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.get(e,Vo)}},{key:"toJSON",value:function(){var e={};return this.share.forEach((function(t,n){e[n]=t.toJSON()})),e}},{key:"destroy",value:function(){var e=this;_t(this.subdocs).forEach((function(e){return e.destroy()}));var t=this._item;if(null!==t){this._item=null;var r=t.content;r.doc=new n(a(a({guid:this.guid},r.opts),{},{shouldLoad:!1})),r.doc._item=t,Li(t.parent.doc,(function(n){var i=r.doc;t.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(e)}),null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),s(g(n.prototype),"destroy",this).call(this)}}]),n}(Mt),Rr=function(){function e(t){A(this,e),this.restDecoder=t}return P(e,[{key:"resetDsCurVal",value:function(){}},{key:"readDsClock",value:function(){return Sn(this.restDecoder)}},{key:"readDsLen",value:function(){return Sn(this.restDecoder)}}]),e}(),Dr=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"readLeftID",value:function(){return ni(Sn(this.restDecoder),Sn(this.restDecoder))}},{key:"readRightID",value:function(){return ni(Sn(this.restDecoder),Sn(this.restDecoder))}},{key:"readClient",value:function(){return Sn(this.restDecoder)}},{key:"readInfo",value:function(){return En(this.restDecoder)}},{key:"readString",value:function(){return An(this.restDecoder)}},{key:"readParentInfo",value:function(){return 1===Sn(this.restDecoder)}},{key:"readTypeRef",value:function(){return Sn(this.restDecoder)}},{key:"readLen",value:function(){return Sn(this.restDecoder)}},{key:"readAny",value:function(){return On(this.restDecoder)}},{key:"readBuf",value:function(){return rr(Cn(this.restDecoder))}},{key:"readJSON",value:function(){return JSON.parse(An(this.restDecoder))}},{key:"readKey",value:function(){return An(this.restDecoder)}}]),n}(Rr),Ir=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this,e)).keys=[],Sn(e),r.keyClockDecoder=new jn(Cn(e)),r.clientDecoder=new Ln(Cn(e)),r.leftClockDecoder=new jn(Cn(e)),r.rightClockDecoder=new jn(Cn(e)),r.infoDecoder=new Tn(Cn(e),En),r.stringDecoder=new Nn(Cn(e)),r.parentInfoDecoder=new Tn(Cn(e),En),r.typeRefDecoder=new Ln(Cn(e)),r.lenDecoder=new Ln(Cn(e)),r}return P(n,[{key:"readLeftID",value:function(){return new ei(this.clientDecoder.read(),this.leftClockDecoder.read())}},{key:"readRightID",value:function(){return new ei(this.clientDecoder.read(),this.rightClockDecoder.read())}},{key:"readClient",value:function(){return this.clientDecoder.read()}},{key:"readInfo",value:function(){return this.infoDecoder.read()}},{key:"readString",value:function(){return this.stringDecoder.read()}},{key:"readParentInfo",value:function(){return 1===this.parentInfoDecoder.read()}},{key:"readTypeRef",value:function(){return this.typeRefDecoder.read()}},{key:"readLen",value:function(){return this.lenDecoder.read()}},{key:"readAny",value:function(){return On(this.restDecoder)}},{key:"readBuf",value:function(){return Cn(this.restDecoder)}},{key:"readJSON",value:function(){return On(this.restDecoder)}},{key:"readKey",value:function(){var e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];var t=this.stringDecoder.read();return this.keys.push(t),t}}]),n}(function(){function e(t){A(this,e),this.dsCurrVal=0,this.restDecoder=t}return P(e,[{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"readDsClock",value:function(){return this.dsCurrVal+=Sn(this.restDecoder),this.dsCurrVal}},{key:"readDsLen",value:function(){var e=Sn(this.restDecoder)+1;return this.dsCurrVal+=e,e}}]),e}()),Br=function(){function e(){A(this,e),this.restEncoder=Yt()}return P(e,[{key:"toUint8Array",value:function(){return Zt(this.restEncoder)}},{key:"resetDsCurVal",value:function(){}},{key:"writeDsClock",value:function(e){$t(this.restEncoder,e)}},{key:"writeDsLen",value:function(e){$t(this.restEncoder,e)}}]),e}(),zr=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"writeLeftID",value:function(e){$t(this.restEncoder,e.client),$t(this.restEncoder,e.clock)}},{key:"writeRightID",value:function(e){$t(this.restEncoder,e.client),$t(this.restEncoder,e.clock)}},{key:"writeClient",value:function(e){$t(this.restEncoder,e)}},{key:"writeInfo",value:function(e){Kt(this.restEncoder,e)}},{key:"writeString",value:function(e){nn(this.restEncoder,e)}},{key:"writeParentInfo",value:function(e){$t(this.restEncoder,e?1:0)}},{key:"writeTypeRef",value:function(e){$t(this.restEncoder,e)}},{key:"writeLen",value:function(e){$t(this.restEncoder,e)}},{key:"writeAny",value:function(e){ln(this.restEncoder,e)}},{key:"writeBuf",value:function(e){on(this.restEncoder,e)}},{key:"writeJSON",value:function(e){nn(this.restEncoder,JSON.stringify(e))}},{key:"writeKey",value:function(e){nn(this.restEncoder,e)}}]),n}(Br),Fr=function(){function e(){A(this,e),this.restEncoder=Yt(),this.dsCurrVal=0}return P(e,[{key:"toUint8Array",value:function(){return Zt(this.restEncoder)}},{key:"resetDsCurVal",value:function(){this.dsCurrVal=0}},{key:"writeDsClock",value:function(e){var t=e-this.dsCurrVal;this.dsCurrVal=e,$t(this.restEncoder,t)}},{key:"writeDsLen",value:function(e){0===e&&yn(),$t(this.restEncoder,e-1),this.dsCurrVal+=e}}]),e}(),Vr=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.call(this)).keyMap=new Map,e.keyClock=0,e.keyClockEncoder=new dn,e.clientEncoder=new hn,e.leftClockEncoder=new dn,e.rightClockEncoder=new dn,e.infoEncoder=new un(Kt),e.stringEncoder=new gn,e.parentInfoEncoder=new un(Kt),e.typeRefEncoder=new hn,e.lenEncoder=new hn,e}return P(n,[{key:"toUint8Array",value:function(){var e=Yt();return $t(e,0),on(e,this.keyClockEncoder.toUint8Array()),on(e,this.clientEncoder.toUint8Array()),on(e,this.leftClockEncoder.toUint8Array()),on(e,this.rightClockEncoder.toUint8Array()),on(e,Zt(this.infoEncoder)),on(e,this.stringEncoder.toUint8Array()),on(e,Zt(this.parentInfoEncoder)),on(e,this.typeRefEncoder.toUint8Array()),on(e,this.lenEncoder.toUint8Array()),rn(e,Zt(this.restEncoder)),Zt(e)}},{key:"writeLeftID",value:function(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}},{key:"writeRightID",value:function(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}},{key:"writeClient",value:function(e){this.clientEncoder.write(e)}},{key:"writeInfo",value:function(e){this.infoEncoder.write(e)}},{key:"writeString",value:function(e){this.stringEncoder.write(e)}},{key:"writeParentInfo",value:function(e){this.parentInfoEncoder.write(e?1:0)}},{key:"writeTypeRef",value:function(e){this.typeRefEncoder.write(e)}},{key:"writeLen",value:function(e){this.lenEncoder.write(e)}},{key:"writeAny",value:function(e){ln(this.restEncoder,e)}},{key:"writeBuf",value:function(e){on(this.restEncoder,e)}},{key:"writeJSON",value:function(e){ln(this.restEncoder,e)}},{key:"writeKey",value:function(e){var t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}]),n}(Fr),Hr=function(e,t,n){var r=new Map;n.forEach((function(e,n){wi(t,n)>e&&r.set(n,e)})),mi(t).forEach((function(e,t){n.has(t)||r.set(t,0)})),$t(e.restEncoder,r.size),_t(r.entries()).sort((function(e,t){return t[0]-e[0]})).forEach((function(n){var r=m(n,2),i=r[0],o=r[1];!function(e,t,n,r){r=Lt(r,t[0].id.clock);var i=ki(t,r);$t(e.restEncoder,t.length-i),e.writeClient(n),$t(e.restEncoder,r);var o=t[i];o.write(e,r-o.id.clock);for(var a=i+1;a<t.length;a++)t[a].write(e,0)}(e,t.clients.get(i),i,o)}))},Ur=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ir(e);return Li(t,(function(e){e.local=!1;var t=!1,n=e.doc,i=n.store,o=function(e,t){for(var n=bt(),r=Sn(e.restDecoder),i=0;i<r;i++){var o=Sn(e.restDecoder),a=new Array(o),s=e.readClient(),l=Sn(e.restDecoder);n.set(s,{i:0,refs:a});for(var u=0;u<o;u++){var c=e.readInfo();switch(It&c){case 0:var h=e.readLen();a[u]=new Wo(ni(s,l),h),l+=h;break;case 10:var f=Sn(e.restDecoder);a[u]=new ba(ni(s,l),f),l+=f;break;default:var d=0==(c&(Rt|Dt)),g=new ya(ni(s,l),null,(c&Dt)===Dt?e.readLeftID():null,null,(c&Rt)===Rt?e.readRightID():null,d?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,d&&(c&Nt)===Nt?e.readString():null,ma(e,c));a[u]=g,l+=g.length}}}return n}(r,n),a=function(e,t,n){var r=[],i=_t(n.keys()).sort((function(e,t){return e-t}));if(0===i.length)return null;var o=function(){if(0===i.length)return null;for(var e=n.get(i[i.length-1]);e.refs.length===e.i;){if(i.pop(),!(i.length>0))return null;e=n.get(i[i.length-1])}return e},a=o();if(null===a)return null;for(var s=new yi,l=new Map,u=function(e,t){var n=l.get(e);(null==n||n>t)&&l.set(e,t)},c=a.refs[a.i++],h=new Map,f=function(){for(var e=function(){var e=o[t],r=e.id.client,a=n.get(r);a?(a.i--,s.clients.set(r,a.refs.slice(a.i)),n.delete(r),a.i=0,a.refs=[]):s.clients.set(r,[e]),i=i.filter((function(e){return e!==r}))},t=0,o=r;t<o.length;t++)e();r.length=0};;){if(c.constructor!==ba){var d=xt(h,c.id.client,(function(){return wi(t,c.id.client)}))-c.id.clock;if(d<0)r.push(c),u(c.id.client,c.id.clock-1),f();else{var g=c.getMissing(e,t);if(null!==g){r.push(c);var v=n.get(g)||{refs:[],i:0};if(v.refs.length!==v.i){c=v.refs[v.i++];continue}u(g,wi(t,g)),f()}else(0===d||d<c.length)&&(c.integrate(e,d),h.set(c.id.client,c.id.clock+c.length))}}if(r.length>0)c=r.pop();else if(null!==a&&a.i<a.refs.length)c=a.refs[a.i++];else{if(null===(a=o()))break;c=a.refs[a.i++]}}if(s.clients.size>0){var p=new Vr;return Hr(p,s,new Map),$t(p.restEncoder,0),{missing:l,update:p.toUint8Array()}}return null}(e,i,o),s=i.pendingStructs;if(s){var l,u=k(s.missing);try{for(u.s();!(l=u.n()).done;){var c=m(l.value,2),h=c[0];if(c[1]<wi(i,h)){t=!0;break}}}catch(E){u.e(E)}finally{u.f()}if(a){var f,d=k(a.missing);try{for(d.s();!(f=d.n()).done;){var g=m(f.value,2),v=g[0],p=g[1],y=s.missing.get(v);(null==y||y>p)&&s.missing.set(v,p)}}catch(E){d.e(E)}finally{d.f()}s.update=Hi([s.update,a.update])}}else i.pendingStructs=a;var w=Lr(r,e,i);if(i.pendingDs){var b=new Ir(kn(i.pendingDs));Sn(b.restDecoder);var x=Lr(b,e,i);i.pendingDs=w&&x?Hi([w,x]):w||x}else i.pendingDs=w;if(t){var C=i.pendingStructs.update;i.pendingStructs=null,qr(e.doc,C)}}),n,!1)},qr=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ir,i=kn(t);Ur(i,e,n,new r(i))},Gr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array([0]),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Vr;!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;Hr(e,t.store,n),Or(e,Pr(t.store))}(n,e,Jr(t));var r=[n.toUint8Array()];if(e.store.pendingDs&&r.push(e.store.pendingDs),e.store.pendingStructs&&r.push(Ui(e.store.pendingStructs.update,t)),r.length>1){if(n.constructor===zr)return Fi(r.map((function(e,t){return 0===t?e:Wi(e)})));if(n.constructor===Vr)return Hi(r)}return r[0]},Jr=function(e){return function(e){for(var t=new Map,n=Sn(e.restDecoder),r=0;r<n;r++){var i=Sn(e.restDecoder),o=Sn(e.restDecoder);t.set(i,o)}return t}(new Rr(kn(e)))},Wr=function(e,t){return $t(e.restEncoder,t.size),_t(t.entries()).sort((function(e,t){return t[0]-e[0]})).forEach((function(t){var n=m(t,2),r=n[0],i=n[1];$t(e.restEncoder,r),$t(e.restEncoder,i)})),e},Yr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Fr;return e instanceof Map?Wr(t,e):function(e,t){Wr(e,mi(t.store))}(t,e),t.toUint8Array()},Zr=P((function e(){A(this,e),this.l=[]})),Xr=function(){return new Zr},Kr=function(e,t){return e.l.push(t)},$r=function(e,t){var n=e.l,r=n.length;e.l=n.filter((function(e){return t!==e})),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Qr=function(e,t,n){return Zn(e.l,[t,n])},ei=P((function e(t,n){A(this,e),this.client=t,this.clock=n})),ti=function(e,t){return e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock},ni=function(e,t){return new ei(e,t)},ri=function(e,t){$t(e,t.client),$t(e,t.clock)},ii=function(e){return ni(Sn(e),Sn(e))},oi=function(e){var t,n=k(e.doc.share.entries());try{for(n.s();!(t=n.n()).done;){var r=m(t.value,2),i=r[0];if(r[1]===e)return i}}catch(o){n.e(o)}finally{n.f()}throw yn()},ai=function(e,t){for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1},si=P((function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;A(this,e),this.type=t,this.tname=n,this.item=r,this.assoc=i})),li=P((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;A(this,e),this.type=t,this.index=n,this.assoc=r})),ui=function(e,t,n){var r=null,i=null;return null===e._item?i=oi(e):r=ni(e._item.id.client,e._item.id.clock),new si(r,i,t,n)},ci=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e._start;if(n<0){if(0===t)return ui(e,null,n);t--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>t)return ui(e,ni(r.id.client,r.id.clock+t),n);t-=r.length}if(null===r.right&&n<0)return ui(e,r.lastId,n);r=r.right}return ui(e,null,n)},hi=function(e){var t=Yt();return function(e,t){var n=t.type,r=t.tname,i=t.item,o=t.assoc;if(null!==i)$t(e,0),ri(e,i);else if(null!==r)Kt(e,1),nn(e,r);else{if(null===n)throw yn();Kt(e,2),ri(e,n)}Qt(e,o)}(t,e),Zt(t)},fi=function(e){return function(e){var t=null,n=null,r=null;switch(Sn(e)){case 0:r=ii(e);break;case 1:n=An(e);break;case 2:t=ii(e)}var i=xn(e)?_n(e):0;return new si(t,n,r,i)}(kn(e))},di=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.store,i=e.item,o=e.type,a=e.tname,s=e.assoc,l=null,u=0;if(null!==i){if(wi(r,i.client)<=i.clock)return null;var c=n?fa(r,i):{item:xi(r,i),diff:0},h=c.item;if(!(h instanceof ya))return null;if(null===(l=h.parent)._item||!l._item.deleted){u=h.deleted||!h.countable?0:c.diff+(s>=0?0:1);for(var f=h.left;null!==f;)!f.deleted&&f.countable&&(u+=f.length),f=f.left}}else{if(null!==a)l=t.get(a);else{if(null===o)throw yn();if(wi(r,o.client)<=o.clock)return null;var d=(n?fa(r,o):{item:xi(r,o)}).item;if(!(d instanceof ya&&d.content instanceof ha))return null;l=d.content.type}u=s>=0?l._length:0}return function(e,t){return new li(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)}(l,u,e.assoc)},gi=function(e,t){return e===t||null!==e&&null!==t&&e.tname===t.tname&&ti(e.item,t.item)&&ti(e.type,t.type)&&e.assoc===t.assoc},vi=function(e,t){return void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Sr(t.ds,e.id)},pi=function e(t,n){var r=xt(t.meta,e,Ct),i=t.doc.store;r.has(n)||(n.sv.forEach((function(e,n){e<wi(i,n)&&Ei(t,ni(n,e))})),Er(t,n.ds,(function(e){})),r.add(n))},yi=P((function e(){A(this,e),this.clients=new Map,this.pendingStructs=null,this.pendingDs=null})),mi=function(e){var t=new Map;return e.clients.forEach((function(e,n){var r=e[e.length-1];t.set(n,r.id.clock+r.length)})),t},wi=function(e,t){var n=e.clients.get(t);if(void 0===n)return 0;var r=n[n.length-1];return r.id.clock+r.length},bi=function(e,t){var n=e.clients.get(t.id.client);if(void 0===n)n=[],e.clients.set(t.id.client,n);else{var r=n[n.length-1];if(r.id.clock+r.length!==t.id.clock)throw yn()}n.push(t)},ki=function(e,t){var n=0,r=e.length-1,i=e[r],o=i.id.clock;if(o===t)return r;for(var a=Pt(t/(o+i.length-1)*r);n<=r;){if((o=(i=e[a]).id.clock)<=t){if(t<o+i.length)return a;n=a+1}else r=a-1;a=Pt((n+r)/2)}throw yn()},xi=function(e,t){var n=e.clients.get(t.client);return n[ki(n,t.clock)]},Ci=function(e,t,n){var r=ki(t,n),i=t[r];return i.id.clock<n&&i instanceof ya?(t.splice(r+1,0,ga(e,i,n-i.id.clock)),r+1):r},Ei=function(e,t){var n=e.doc.store.clients.get(t.client);return n[Ci(e,n,t.clock)]},Si=function(e,t,n){var r=t.clients.get(n.client),i=ki(r,n.clock),o=r[i];return n.clock!==o.id.clock+o.length-1&&o.constructor!==Wo&&r.splice(i+1,0,ga(e,o,n.clock-o.id.clock+1)),o},_i=function(e,t,n,r,i){if(0!==r){var o,a=n+r,s=Ci(e,t,n);do{a<(o=t[s++]).id.clock+o.length&&Ci(e,t,a),i(o)}while(s<t.length&&t[s].id.clock<a)}},Ai=P((function e(t,n,r){A(this,e),this.doc=t,this.deleteSet=new Cr,this.beforeState=mi(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1})),Mi=function(e,t){return!(0===t.deleteSet.clients.size&&!function(e,t){var n,r=k(e);try{for(r.s();!(n=r.n()).done;){var i=m(n.value,2),o=i[0];if(t(i[1],o))return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(t.afterState,(function(e,n){return t.beforeState.get(n)!==e})))&&(_r(t.deleteSet),function(e,t){Hr(e,t.doc.store,t.beforeState)}(e,t),Or(e,t.deleteSet),!0)},Pi=function(e,t,n){var r=t._item;(null===r||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&xt(e.changed,t,Ct).add(n)},Oi=function(e,t){for(var n=e[t],r=e[t-1],i=t;i>0&&(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n));n=r,r=e[--i-1])n instanceof ya&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);var o=t-i;return o&&e.splice(t+1-o,o),o},Ti=function e(t,n){if(n<t.length){var r=t[n],i=r.doc,o=i.store,a=r.deleteSet,s=r._mergeStructs;try{_r(a),r.afterState=mi(r.doc.store),i.emit("beforeObserverCalls",[r,i]);var l=[];r.changed.forEach((function(e,t){return l.push((function(){null!==t._item&&t._item.deleted||t._callObserver(r,e)}))})),l.push((function(){r.changedParentTypes.forEach((function(e,t){t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter((function(e){return null===e.target._item||!e.target._item.deleted}))).forEach((function(e){e.currentTarget=t,e._path=null})),e.sort((function(e,t){return e.path.length-t.path.length})),Qr(t._dEH,e,r))}))})),l.push((function(){return i.emit("afterTransaction",[r,i])})),Zn(l,[]),r._needFormattingCleanup&&Do(r)}finally{i.gc&&function(e,t,n){var r,i=k(e.clients.entries());try{for(i.s();!(r=i.n()).done;)for(var o=m(r.value,2),a=o[0],s=o[1],l=t.clients.get(a),u=s.length-1;u>=0;u--)for(var c=s[u],h=c.clock+c.len,f=ki(l,c.clock),d=l[f];f<l.length&&d.id.clock<h;d=l[++f]){var g=l[f];if(c.clock+c.len<=g.id.clock)break;g instanceof ya&&g.deleted&&!g.keep&&n(g)&&g.gc(t,!1)}}catch(v){i.e(v)}finally{i.f()}}(a,o,i.gcFilter),function(e,t){e.clients.forEach((function(e,n){for(var r=t.clients.get(n),i=e.length-1;i>=0;i--)for(var o=e[i],a=Tt(r.length-1,1+ki(r,o.clock+o.len-1)),s=r[a];a>0&&s.id.clock>=o.clock;s=r[a])a-=1+Oi(r,a)}))}(a,o),r.afterState.forEach((function(e,t){var n=r.beforeState.get(t)||0;if(n!==e)for(var i=o.clients.get(t),a=Lt(ki(i,n),1),s=i.length-1;s>=a;)s-=1+Oi(i,s)}));for(var u=s.length-1;u>=0;u--){var c=s[u].id,h=c.client,f=c.clock,d=o.clients.get(h),g=ki(d,f);g+1<d.length&&Oi(d,g+1)>1||g>0&&Oi(d,g)}if(r.local||r.afterState.get(i.clientID)===r.beforeState.get(i.clientID)||(!function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,p(mr(n))),wr.forEach((function(e){return e.print(n)}))}(vr,lr,"[yjs] ",ur,dr,"Changed the client-id because another client seems to be using it."),i.clientID=jr()),i.emit("afterTransactionCleanup",[r,i]),i._observers.has("update")){var v=new zr;Mi(v,r)&&i.emit("update",[v.toUint8Array(),r.origin,i,r])}if(i._observers.has("updateV2")){var y=new Vr;Mi(y,r)&&i.emit("updateV2",[y.toUint8Array(),r.origin,i,r])}var w=r.subdocsAdded,b=r.subdocsLoaded,x=r.subdocsRemoved;(w.size>0||x.size>0||b.size>0)&&(w.forEach((function(e){e.clientID=i.clientID,null==e.collectionid&&(e.collectionid=i.collectionid),i.subdocs.add(e)})),x.forEach((function(e){return i.subdocs.delete(e)})),i.emit("subdocs",[{loaded:b,added:w,removed:x},i,r]),x.forEach((function(e){return e.destroy()}))),t.length<=n+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,t])):e(t,n+1)}}},Li=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=e._transactionCleanups,o=!1,a=null;null===e._transaction&&(o=!0,e._transaction=new Ai(e,n,r),i.push(e._transaction),1===i.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{a=t(e._transaction)}finally{if(o){var s=e._transaction===i[0];e._transaction=null,s&&Ti(i,0)}}return a},ji=P((function e(t,n){A(this,e),this.insertions=n,this.deletions=t,this.meta=new Map})),Ni=function(e,t,n){Er(e,n.deletions,(function(e){e instanceof ya&&t.scope.some((function(t){return ai(t,e)}))&&da(e,!1)}))},Ri=function(e,t,n){var r=null,i=e.doc,o=e.scope;Li(i,(function(n){for(var a=function(){var r=i.store,a=t.pop(),s=new Set,l=[],u=!1;Er(n,a.insertions,(function(e){if(e instanceof ya){if(null!==e.redone){var t=fa(r,e.id),i=t.item,a=t.diff;a>0&&(i=Ei(n,ni(i.id.client,i.id.clock+a))),e=i}!e.deleted&&o.some((function(t){return ai(t,e)}))&&l.push(e)}})),Er(n,a.deletions,(function(e){e instanceof ya&&o.some((function(t){return ai(t,e)}))&&!Sr(a.insertions,e.id)&&s.add(e)})),s.forEach((function(t){u=null!==pa(n,t,s,a.insertions,e.ignoreRemoteMapChanges,e)||u}));for(var c=l.length-1;c>=0;c--){var h=l[c];e.deleteFilter(h)&&(h.delete(n),u=!0)}e.currStackItem=u?a:null};t.length>0&&null===e.currStackItem;)a();n.changed.forEach((function(e,t){e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)})),r=n}),e);var a=e.currStackItem;if(null!=a){var s=r.changedParentTypes;e.emit("stack-item-popped",[{stackItem:a,type:n,changedParentTypes:s,origin:e},e]),e.currStackItem=null}return a},Di=function(e){l(n,e);var t=c(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.captureTimeout,a=void 0===o?500:o,s=i.captureTransaction,l=void 0===s?function(e){return!0}:s,u=i.deleteFilter,c=void 0===u?function(){return!0}:u,h=i.trackedOrigins,d=void 0===h?new Set([null]):h,g=i.ignoreRemoteMapChanges,v=void 0!==g&&g,p=i.doc,y=void 0===p?At(e)?e[0].doc:e.doc:p;return A(this,n),(r=t.call(this)).scope=[],r.doc=y,r.addToScope(e),r.deleteFilter=c,d.add(f(r)),r.trackedOrigins=d,r.captureTransaction=l,r.undoStack=[],r.redoStack=[],r.undoing=!1,r.redoing=!1,r.currStackItem=null,r.lastChange=0,r.ignoreRemoteMapChanges=v,r.captureTimeout=a,r.afterTransactionHandler=function(e){if(r.captureTransaction(e)&&r.scope.some((function(t){return e.changedParentTypes.has(t)}))&&(r.trackedOrigins.has(e.origin)||e.origin&&r.trackedOrigins.has(e.origin.constructor))){var t=r.undoing,n=r.redoing,i=t?r.redoStack:r.undoStack;t?r.stopCapturing():n||r.clear(!1,!0);var o=new Cr;e.afterState.forEach((function(t,n){var r=e.beforeState.get(n)||0,i=t-r;i>0&&Mr(o,n,r,i)}));var a=Bn(),s=!1;if(r.lastChange>0&&a-r.lastChange<r.captureTimeout&&i.length>0&&!t&&!n){var l=i[i.length-1];l.deletions=Ar([l.deletions,e.deleteSet]),l.insertions=Ar([l.insertions,o])}else i.push(new ji(e.deleteSet,o)),s=!0;t||n||(r.lastChange=a),Er(e,e.deleteSet,(function(e){e instanceof ya&&r.scope.some((function(t){return ai(t,e)}))&&da(e,!0)}));var u=[{stackItem:i[i.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},f(r)];s?r.emit("stack-item-added",u):r.emit("stack-item-updated",u)}},r.doc.on("afterTransaction",r.afterTransactionHandler),r.doc.on("destroy",(function(){r.destroy()})),r}return P(n,[{key:"addToScope",value:function(e){var t=this;(e=At(e)?e:[e]).forEach((function(e){t.scope.every((function(t){return t!==e}))&&(e.doc!==t.doc&&function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).warn.apply(e,p(mr(n))),n.unshift(vr),wr.forEach((function(e){return e.print(n)}))}("[yjs#509] Not same Y.Doc"),t.scope.push(e))}))}},{key:"addTrackedOrigin",value:function(e){this.trackedOrigins.add(e)}},{key:"removeTrackedOrigin",value:function(e){this.trackedOrigins.delete(e)}},{key:"clear",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(t&&this.canUndo()||n&&this.canRedo())&&this.doc.transact((function(r){t&&(e.undoStack.forEach((function(t){return Ni(r,e,t)})),e.undoStack=[]),n&&(e.redoStack.forEach((function(t){return Ni(r,e,t)})),e.redoStack=[]),e.emit("stack-cleared",[{undoStackCleared:t,redoStackCleared:n}])}))}},{key:"stopCapturing",value:function(){this.lastChange=0}},{key:"undo",value:function(){var e;this.undoing=!0;try{e=Ri(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}},{key:"redo",value:function(){var e;this.redoing=!0;try{e=Ri(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}},{key:"canUndo",value:function(){return this.undoStack.length>0}},{key:"canRedo",value:function(){return this.redoStack.length>0}},{key:"destroy",value:function(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),s(g(n.prototype),"destroy",this).call(this)}}]),n}(Mt);function Ii(e){var t,n,r,i,o,a,s,l,u,c,h;return E().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:t=Sn(e.restDecoder),n=0;case 2:if(!(n<t)){f.next=34;break}r=Sn(e.restDecoder),i=e.readClient(),o=Sn(e.restDecoder),a=0;case 7:if(!(a<r)){f.next=31;break}if(10!==(s=e.readInfo())){f.next=16;break}return l=Sn(e.restDecoder),f.next=13,new ba(ni(i,o),l);case 13:o+=l,f.next=28;break;case 16:if(0==(It&s)){f.next=24;break}return u=0==(s&(Rt|Dt)),c=new ya(ni(i,o),null,(s&Dt)===Dt?e.readLeftID():null,null,(s&Rt)===Rt?e.readRightID():null,u?e.readParentInfo()?e.readString():e.readLeftID():null,u&&(s&Nt)===Nt?e.readString():null,ma(e,s)),f.next=21,c;case 21:o+=c.length,f.next=28;break;case 24:return h=e.readLen(),f.next=27,new Wo(ni(i,o),h);case 27:o+=h;case 28:a++,f.next=7;break;case 31:n++,f.next=2;break;case 34:case"end":return f.stop()}}),vt)}var Bi=function(){function e(t,n){A(this,e),this.gen=Ii(t),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}return P(e,[{key:"next",value:function(){do{this.curr=this.gen.next().value||null}while(this.filterSkips&&null!==this.curr&&this.curr.constructor===ba);return this.curr}}]),e}(),zi=P((function e(t){A(this,e),this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]})),Fi=function(e){return Hi(e,Dr,zr)},Vi=function(e,t){if(e.constructor===Wo){var n=e.id,r=n.client,i=n.clock;return new Wo(ni(r,i+t),e.length-t)}if(e.constructor===ba){var o=e.id,a=o.client,s=o.clock;return new ba(ni(a,s+t),e.length-t)}var l=e,u=l.id,c=u.client,h=u.clock;return new ya(ni(c,h+t),null,ni(c,h+t-1),null,l.rightOrigin,l.parent,l.parentSub,l.content.splice(t))},Hi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ir,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vr;if(1===e.length)return e[0];for(var r=e.map((function(e){return new t(kn(e))})),i=r.map((function(e){return new Bi(e,!0)})),o=null,a=new n,s=new zi(a);(i=i.filter((function(e){return null!==e.curr}))).sort((function(e,t){if(e.curr.id.client===t.curr.id.client){var n=e.curr.id.clock-t.curr.id.clock;return 0===n?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===ba?1:-1:n}return t.curr.id.client-e.curr.id.client})),0!==i.length;){var l=i[0],u=l.curr.id.client;if(null!==o){for(var c=l.curr,h=!1;null!==c&&c.id.clock+c.length<=o.struct.id.clock+o.struct.length&&c.id.client>=o.struct.id.client;)c=l.next(),h=!0;if(null===c||c.id.client!==u||h&&c.id.clock>o.struct.id.clock+o.struct.length)continue;if(u!==o.struct.id.client)Gi(s,o.struct,o.offset),o={struct:c,offset:0},l.next();else if(o.struct.id.clock+o.struct.length<c.id.clock)if(o.struct.constructor===ba)o.struct.length=c.id.clock+c.length-o.struct.id.clock;else{Gi(s,o.struct,o.offset);var f=c.id.clock-o.struct.id.clock-o.struct.length;o={struct:new ba(ni(u,o.struct.id.clock+o.struct.length),f),offset:0}}else{var d=o.struct.id.clock+o.struct.length-c.id.clock;d>0&&(o.struct.constructor===ba?o.struct.length-=d:c=Vi(c,d)),o.struct.mergeWith(c)||(Gi(s,o.struct,o.offset),o={struct:c,offset:0},l.next())}}else o={struct:l.curr,offset:0},l.next();for(var g=l.curr;null!==g&&g.id.client===u&&g.id.clock===o.struct.id.clock+o.struct.length&&g.constructor!==ba;g=l.next())Gi(s,o.struct,o.offset),o={struct:g,offset:0}}null!==o&&(Gi(s,o.struct,o.offset),o=null),Ji(s);var v=r.map((function(e){return Tr(e)})),p=Ar(v);return Or(a,p),a.toUint8Array()},Ui=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ir,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Vr,i=Jr(t),o=new r,a=new zi(o),s=new n(kn(e)),l=new Bi(s,!1);l.curr;){var u=l.curr,c=u.id.client,h=i.get(c)||0;if(l.curr.constructor!==ba)if(u.id.clock+u.length>h)for(Gi(a,u,Lt(h-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===c;)Gi(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===c&&l.curr.id.clock+l.curr.length<=h;)l.next();else l.next()}Ji(a);var f=Tr(s);return Or(o,f),o.toUint8Array()},qi=function(e){e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:Zt(e.encoder.restEncoder)}),e.encoder.restEncoder=Yt(),e.written=0)},Gi=function(e,t,n){e.written>0&&e.currClient!==t.id.client&&qi(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),$t(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},Ji=function(e){qi(e);var t=e.encoder.restEncoder;$t(t,e.clientStructs.length);for(var n=0;n<e.clientStructs.length;n++){var r=e.clientStructs[n];$t(t,r.written),rn(t,r.restEncoder)}},Wi=function(e){return function(e,t,n,r){for(var i=new n(kn(e)),o=new Bi(i,!1),a=new r,s=new zi(a),l=o.curr;null!==l;l=o.next())Gi(s,t(l),0);Ji(s);var u=Tr(i);return Or(a,u),a.toUint8Array()}(e,Xn,Ir,zr)},Yi="You must not compute changes after the event-handler fired.",Zi=function(){function e(t,n){A(this,e),this.target=t,this.currentTarget=t,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}return P(e,[{key:"path",get:function(){return this._path||(this._path=Xi(this.currentTarget,this.target))}},{key:"deletes",value:function(e){return Sr(this.transaction.deleteSet,e.id)}},{key:"keys",get:function(){var e=this;if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw vn(Yi);var t=new Map,n=this.target;this.transaction.changed.get(n).forEach((function(r){if(null!==r){var i,o,a=n._map.get(r);if(e.adds(a)){for(var s=a.left;null!==s&&e.adds(s);)s=s.left;if(e.deletes(a)){if(null===s||!e.deletes(s))return;i="delete",o=Et(s.content.getContent())}else null!==s&&e.deletes(s)?(i="update",o=Et(s.content.getContent())):(i="add",o=void 0)}else{if(!e.deletes(a))return;i="delete",o=Et(a.content.getContent())}t.set(r,{action:i,oldValue:o})}})),this._keys=t}return this._keys}},{key:"delta",get:function(){return this.changes.delta}},{key:"adds",value:function(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}},{key:"changes",get:function(){var e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw vn(Yi);var t=this.target,n=Ct(),r=Ct(),i=[];if(e={added:n,deleted:r,delta:i,keys:this.keys},this.transaction.changed.get(t).has(null)){for(var o=null,a=function(){o&&i.push(o)},s=t._start;null!==s;s=s.right)s.deleted?this.deletes(s)&&!this.adds(s)&&(null!==o&&void 0!==o.delete||(a(),o={delete:0}),o.delete+=s.length,r.add(s)):this.adds(s)?(null!==o&&void 0!==o.insert||(a(),o={insert:[]}),o.insert=o.insert.concat(s.content.getContent()),n.add(s)):(null!==o&&void 0!==o.retain||(a(),o={retain:0}),o.retain+=s.length);null!==o&&void 0===o.retain&&a()}this._changes=e}return e}}]),e}(),Xi=function(e,t){for(var n=[];null!==t._item&&t!==e;){if(null!==t._item.parentSub)n.unshift(t._item.parentSub);else{for(var r=0,i=t._item.parent._start;i!==t._item&&null!==i;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;n.unshift(r)}t=t._item.parent}return n},Ki=0,$i=P((function e(t,n){A(this,e),t.marker=!0,this.p=t,this.index=n,this.timestamp=Ki++})),Qi=function(e,t,n){e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=Ki++},eo=function(e,t){if(null===e._start||0===t||null===e._searchMarker)return null;var n=0===e._searchMarker.length?null:e._searchMarker.reduce((function(e,n){return Ot(t-e.index)<Ot(t-n.index)?e:n})),r=e._start,i=0;for(null!==n&&(r=n.p,i=n.index,function(e){e.timestamp=Ki++}(n));null!==r.right&&i<t;){if(!r.deleted&&r.countable){if(t<i+r.length)break;i+=r.length}r=r.right}for(;null!==r.left&&i>t;)!(r=r.left).deleted&&r.countable&&(i-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)!(r=r.left).deleted&&r.countable&&(i-=r.length);return null!==n&&Ot(n.index-i)<r.parent.length/80?(Qi(n,r,i),n):function(e,t,n){if(e.length>=80){var r=e.reduce((function(e,t){return e.timestamp<t.timestamp?e:t}));return Qi(r,t,n),r}var i=new $i(t,n);return e.push(i),i}(e._searchMarker,r,i)},to=function(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r];if(n>0){var o=i.p;for(o.marker=!1;o&&(o.deleted||!o.countable);)(o=o.left)&&!o.deleted&&o.countable&&(i.index-=o.length);if(null===o||!0===o.marker){e.splice(r,1);continue}i.p=o,o.marker=!0}(t<i.index||n>0&&t===i.index)&&(i.index=Lt(t,i.index+n))}},no=function(e,t,n){for(var r=e,i=t.changedParentTypes;xt(i,e,(function(){return[]})).push(n),null!==e._item;)e=e._item.parent;Qr(r._eH,n,t)},ro=function(){function e(){A(this,e),this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Xr(),this._dEH=Xr(),this._searchMarker=null}return P(e,[{key:"parent",get:function(){return this._item?this._item.parent:null}},{key:"_integrate",value:function(e,t){this.doc=e,this._item=t}},{key:"_copy",value:function(){throw pn()}},{key:"clone",value:function(){throw pn()}},{key:"_write",value:function(e){}},{key:"_first",get:function(){for(var e=this._start;null!==e&&e.deleted;)e=e.right;return e}},{key:"_callObserver",value:function(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}},{key:"observe",value:function(e){Kr(this._eH,e)}},{key:"observeDeep",value:function(e){Kr(this._dEH,e)}},{key:"unobserve",value:function(e){$r(this._eH,e)}},{key:"unobserveDeep",value:function(e){$r(this._dEH,e)}},{key:"toJSON",value:function(){}}]),e}(),io=function(e,t,n){t<0&&(t=e._length+t),n<0&&(n=e._length+n);for(var r=n-t,i=[],o=e._start;null!==o&&r>0;){if(o.countable&&!o.deleted){var a=o.content.getContent();if(a.length<=t)t-=a.length;else{for(var s=t;s<a.length&&r>0;s++)i.push(a[s]),r--;t=0}}o=o.right}return i},oo=function(e){for(var t=[],n=e._start;null!==n;){if(n.countable&&!n.deleted)for(var r=n.content.getContent(),i=0;i<r.length;i++)t.push(r[i]);n=n.right}return t},ao=function(e,t){for(var n=0,r=e._start;null!==r;){if(r.countable&&!r.deleted)for(var i=r.content.getContent(),o=0;o<i.length;o++)t(i[o],n++,e);r=r.right}},so=function(e,t){var n=[];return ao(e,(function(r,i){n.push(t(r,i,e))})),n},lo=function(e,t){var n=eo(e,t),r=e._start;for(null!==n&&(r=n.p,t-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},uo=function(e,t,n,r){var i=n,o=e.doc,a=o.clientID,s=o.store,l=null===n?t._start:n.right,u=[],c=function(){u.length>0&&((i=new ya(ni(a,wi(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new ta(u))).integrate(e,0),u=[])};r.forEach((function(n){if(null===n)u.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(n);break;default:switch(c(),n.constructor){case Uint8Array:case ArrayBuffer:(i=new ya(ni(a,wi(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new Yo(new Uint8Array(n)))).integrate(e,0);break;case Nr:(i=new ya(ni(a,wi(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new Ko(n))).integrate(e,0);break;default:if(!(n instanceof ro))throw new Error("Unexpected content type in insert operation");(i=new ya(ni(a,wi(s,a)),i,i&&i.lastId,l,l&&l.id,t,null,new ha(n))).integrate(e,0)}}})),c()},co=function(){return vn("Length exceeded!")},ho=function(e,t,n,r){if(n>t._length)throw co();if(0===n)return t._searchMarker&&to(t._searchMarker,n,r.length),uo(e,t,null,r);var i=n,o=eo(t,n),a=t._start;for(null!==o&&(a=o.p,0===(n-=o.index)&&(n+=(a=a.prev)&&a.countable&&!a.deleted?a.length:0));null!==a;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&Ei(e,ni(a.id.client,a.id.clock+n));break}n-=a.length}return t._searchMarker&&to(t._searchMarker,i,r.length),uo(e,t,a,r)},fo=function(e,t,n,r){if(0!==r){var i=n,o=r,a=eo(t,n),s=t._start;for(null!==a&&(s=a.p,n-=a.index);null!==s&&n>0;s=s.right)!s.deleted&&s.countable&&(n<s.length&&Ei(e,ni(s.id.client,s.id.clock+n)),n-=s.length);for(;r>0&&null!==s;)s.deleted||(r<s.length&&Ei(e,ni(s.id.client,s.id.clock+r)),s.delete(e),r-=s.length),s=s.right;if(r>0)throw co();t._searchMarker&&to(t._searchMarker,i,-o+r)}},go=function(e,t,n){var r=t._map.get(n);void 0!==r&&r.delete(e)},vo=function(e,t,n,r){var i,o=t._map.get(n)||null,a=e.doc,s=a.clientID;if(null==r)i=new ta([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:i=new ta([r]);break;case Uint8Array:i=new Yo(r);break;case Nr:i=new Ko(r);break;default:if(!(r instanceof ro))throw new Error("Unexpected content type");i=new ha(r)}new ya(ni(s,wi(a.store,s)),o,o&&o.lastId,null,null,t,n,i).integrate(e,0)},po=function(e,t){var n=e._map.get(t);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},yo=function(e){var t={};return e._map.forEach((function(e,n){e.deleted||(t[n]=e.content.getContent()[e.length-1])})),t},mo=function(e,t){var n=e._map.get(t);return void 0!==n&&!n.deleted},wo=function(e){return function(e,t){return br((function(){var n;do{n=e.next()}while(!n.done&&!t(n.value));return n}))}(e.entries(),(function(e){return!e[1].deleted}))},bo=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n)}(Zi),ko=function(e,t){l(r,e);var n=c(r);function r(){var e;return A(this,r),(e=n.call(this))._prelimContent=[],e._searchMarker=[],e}return P(r,[{key:"_integrate",value:function(e,t){s(g(r.prototype),"_integrate",this).call(this,e,t),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new r}},{key:"clone",value:function(){var e=new r;return e.insert(0,this.toArray().map((function(e){return e instanceof ro?e.clone():e}))),e}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"_callObserver",value:function(e,t){s(g(r.prototype),"_callObserver",this).call(this,e,t),no(this,e,new bo(this,e))}},{key:"insert",value:function(e,t){var n,r=this;null!==this.doc?Li(this.doc,(function(n){ho(n,r,e,t)})):(n=this._prelimContent).splice.apply(n,[e,0].concat(p(t)))}},{key:"push",value:function(e){var t,n=this;null!==this.doc?Li(this.doc,(function(t){!function(e,t,n){var r=(t._searchMarker||[]).reduce((function(e,t){return t.index>e.index?t:e}),{index:0,p:t._start}).p;if(r)for(;r.right;)r=r.right;uo(e,t,r,n)}(t,n,e)})):(t=this._prelimContent).push.apply(t,p(e))}},{key:"unshift",value:function(e){this.insert(0,e)}},{key:"delete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?Li(this.doc,(function(r){fo(r,t,e,n)})):this._prelimContent.splice(e,n)}},{key:"get",value:function(e){return lo(this,e)}},{key:"toArray",value:function(){return oo(this)}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return io(this,e,t)}},{key:"toJSON",value:function(){return this.map((function(e){return e instanceof ro?e.toJSON():e}))}},{key:"map",value:function(e){return so(this,e)}},{key:"forEach",value:function(e){ao(this,e)}},{key:t,value:function(){return e=this._start,t=null,n=0,O(O({},Symbol.iterator,(function(){return this})),"next",(function(){if(null===t){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};t=e.content.getContent(),n=0,e=e.right}var r=t[n++];return t.length<=n&&(t=null),{done:!1,value:r}}));var e,t,n}},{key:"_write",value:function(e){e.writeTypeRef(ia)}}],[{key:"from",value:function(e){var t=new r;return t.push(e),t}}]),r}(ro,Symbol.iterator),xo=function(e){l(n,e);var t=c(n);function n(e,r,i){var o;return A(this,n),(o=t.call(this,e,r)).keysChanged=i,o}return P(n)}(Zi),Co=function(e,t){l(r,e);var n=c(r);function r(e){var t;return A(this,r),(t=n.call(this))._prelimContent=null,t._prelimContent=void 0===e?new Map:new Map(e),t}return P(r,[{key:"_integrate",value:function(e,t){var n=this;s(g(r.prototype),"_integrate",this).call(this,e,t),this._prelimContent.forEach((function(e,t){n.set(t,e)})),this._prelimContent=null}},{key:"_copy",value:function(){return new r}},{key:"clone",value:function(){var e=new r;return this.forEach((function(t,n){e.set(n,t instanceof ro?t.clone():t)})),e}},{key:"_callObserver",value:function(e,t){no(this,e,new xo(this,e,t))}},{key:"toJSON",value:function(){var e={};return this._map.forEach((function(t,n){if(!t.deleted){var r=t.content.getContent()[t.length-1];e[n]=r instanceof ro?r.toJSON():r}})),e}},{key:"size",get:function(){return p(wo(this._map)).length}},{key:"keys",value:function(){return kr(wo(this._map),(function(e){return e[0]}))}},{key:"values",value:function(){return kr(wo(this._map),(function(e){return e[1].content.getContent()[e[1].length-1]}))}},{key:"entries",value:function(){return kr(wo(this._map),(function(e){return[e[0],e[1].content.getContent()[e[1].length-1]]}))}},{key:"forEach",value:function(e){var t=this;this._map.forEach((function(n,r){n.deleted||e(n.content.getContent()[n.length-1],r,t)}))}},{key:t,value:function(){return this.entries()}},{key:"delete",value:function(e){var t=this;null!==this.doc?Li(this.doc,(function(n){go(n,t,e)})):this._prelimContent.delete(e)}},{key:"set",value:function(e,t){var n=this;return null!==this.doc?Li(this.doc,(function(r){vo(r,n,e,t)})):this._prelimContent.set(e,t),t}},{key:"get",value:function(e){return po(this,e)}},{key:"has",value:function(e){return mo(this,e)}},{key:"clear",value:function(){var e=this;null!==this.doc?Li(this.doc,(function(t){e.forEach((function(e,n,r){go(t,r,n)}))})):this._prelimContent.clear()}},{key:"_write",value:function(e){e.writeTypeRef(oa)}}]),r}(ro,Symbol.iterator),Eo=function(e,t){return e===t||"object"===v(e)&&"object"===v(t)&&e&&t&&Yn(e,t)},So=function(){function e(t,n,r,i){A(this,e),this.left=t,this.right=n,this.index=r,this.currentAttributes=i}return P(e,[{key:"forward",value:function(){if(null===this.right&&yn(),this.right.content.constructor===Qo)this.right.deleted||Po(this.currentAttributes,this.right.content);else this.right.deleted||(this.index+=this.right.length);this.left=this.right,this.right=this.right.right}}]),e}(),_o=function(e,t,n){for(;null!==t.right&&n>0;){if(t.right.content.constructor===Qo)t.right.deleted||Po(t.currentAttributes,t.right.content);else t.right.deleted||(n<t.right.length&&Ei(e,ni(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length);t.left=t.right,t.right=t.right.right}return t},Ao=function(e,t,n,r){var i=new Map,o=r?eo(t,n):null;if(o){var a=new So(o.p.left,o.p,o.index,i);return _o(e,a,n-o.index)}var s=new So(null,t._start,0,i);return _o(e,s,n)},Mo=function(e,t,n,r){for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===Qo&&Eo(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();var i=e.doc,o=i.clientID;r.forEach((function(r,a){var s=n.left,l=n.right,u=new ya(ni(o,wi(i.store,o)),s,s&&s.lastId,l,l&&l.id,t,null,new Qo(a,r));u.integrate(e,0),n.right=u,n.forward()}))},Po=function(e,t){var n=t.key,r=t.value;null===r?e.delete(n):e.set(n,r)},Oo=function(e,t){for(;;){var n;if(null===e.right)break;if(!(e.right.deleted||e.right.content.constructor===Qo&&Eo(null!==(n=t[e.right.content.key])&&void 0!==n?n:null,e.right.content.value)))break;e.forward()}},To=function(e,t,n,r){var i=e.doc,o=i.clientID,a=new Map;for(var s in r){var l,u=r[s],c=null!==(l=n.currentAttributes.get(s))&&void 0!==l?l:null;if(!Eo(c,u)){a.set(s,c);var h=n.left,f=n.right;n.right=new ya(ni(o,wi(i.store,o)),h,h&&h.lastId,f,f&&f.id,t,null,new Qo(s,u)),n.right.integrate(e,0),n.forward()}}return a},Lo=function(e,t,n,r,i){n.currentAttributes.forEach((function(e,t){void 0===i[t]&&(i[t]=null)}));var o=e.doc,a=o.clientID;Oo(n,i);var s=To(e,t,n,i),l=r.constructor===String?new na(r):r instanceof ro?new ha(r):new $o(r),u=n.left,c=n.right,h=n.index;t._searchMarker&&to(t._searchMarker,n.index,l.getLength()),(c=new ya(ni(a,wi(o.store,a)),u,u&&u.lastId,c,c&&c.id,t,null,l)).integrate(e,0),n.right=c,n.index=h,n.forward(),Mo(e,t,n,s)},jo=function(e,t,n,r,i){var o=e.doc,a=o.clientID;Oo(n,i);var s=To(e,t,n,i);e:for(;null!==n.right&&(r>0||s.size>0&&(n.right.deleted||n.right.content.constructor===Qo));){if(!n.right.deleted)if(n.right.content.constructor===Qo){var l=n.right.content,u=l.key,c=l.value,h=i[u];if(void 0!==h){if(Eo(h,c))s.delete(u);else{if(0===r)break e;s.set(u,c)}n.right.delete(e)}else n.currentAttributes.set(u,c)}else r<n.right.length&&Ei(e,ni(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;n.forward()}if(r>0){for(var f="";r>0;r--)f+="\n";n.right=new ya(ni(a,wi(o.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new na(f)),n.right.integrate(e,0),n.forward()}Mo(e,t,n,s)},No=function(e,t,n,r,i){for(var o=t,a=bt();o&&(!o.countable||o.deleted);){if(!o.deleted&&o.content.constructor===Qo){var s=o.content;a.set(s.key,s)}o=o.right}for(var l=0,u=!1;t!==o;){if(n===t&&(u=!0),!t.deleted){var c=t.content;if(c.constructor===Qo){var h,f,d=c.key,g=c.value,v=null!==(h=r.get(d))&&void 0!==h?h:null;a.get(d)===c&&v!==g||(t.delete(e),l++,u||(null!==(f=i.get(d))&&void 0!==f?f:null)!==g||v===g||(null===v?i.delete(d):i.set(d,v))),u||t.deleted||Po(i,c)}}t=t.right}return l},Ro=function(e){var t=0;return Li(e.doc,(function(n){for(var r=e._start,i=e._start,o=bt(),a=kt(o);i;){if(!1===i.deleted)if(i.content.constructor===Qo)Po(a,i.content);else t+=No(n,r,i,o,a),o=kt(a),r=i;i=i.right}})),t},Do=function(e){var t,n=new Set,r=e.doc,i=k(e.afterState.entries());try{for(i.s();!(t=i.n()).done;){var o=m(t.value,2),a=o[0],s=o[1],l=e.beforeState.get(a)||0;s!==l&&_i(e,r.store.clients.get(a),l,s,(function(e){e.deleted||e.content.constructor!==Qo||e.constructor===Wo||n.add(e.parent)}))}}catch(u){i.e(u)}finally{i.f()}Li(r,(function(t){Er(e,e.deleteSet,(function(e){if(!(e instanceof Wo||!e.parent._hasFormatting||n.has(e.parent))){var r=e.parent;e.content.constructor===Qo?n.add(r):function(e,t){for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;for(var n=new Set;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===Qo){var r=t.content.key;n.has(r)?t.delete(e):n.add(r)}t=t.left}}(t,e)}}));var r,i=k(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;Ro(o)}}catch(u){i.e(u)}finally{i.f()}}))},Io=function(e,t,n){for(var r=n,i=kt(t.currentAttributes),o=t.right;n>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case ha:case $o:case na:n<t.right.length&&Ei(e,ni(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e)}t.forward()}o&&No(e,o,t.right,i,t.currentAttributes);var a=(t.left||t.right).parent;return a._searchMarker&&to(a._searchMarker,t.index,-r+n),t},Bo=function(e){l(n,e);var t=c(n);function n(e,r,i){var o;return A(this,n),(o=t.call(this,e,r)).childListChanged=!1,o.keysChanged=new Set,i.forEach((function(e){null===e?o.childListChanged=!0:o.keysChanged.add(e)})),o}return P(n,[{key:"changes",get:function(){if(null===this._changes){var e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}},{key:"delta",get:function(){var e=this;if(null===this._delta){var t=this.target.doc,n=[];Li(t,(function(t){for(var r=new Map,i=new Map,o=e.target._start,a=null,s={},l="",u=0,c=0,h=function(){if(null!==a){var e=null;switch(a){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"===v(l)||l.length>0)&&(e={insert:l},r.size>0&&(e.attributes={},r.forEach((function(t,n){null!==t&&(e.attributes[n]=t)})))),l="";break;case"retain":u>0&&(e={retain:u},function(e){for(var t in e)return!1;return!0}(s)||(e.attributes=Gn({},s))),u=0}e&&n.push(e),a=null}};null!==o;){switch(o.content.constructor){case ha:case $o:e.adds(o)?e.deletes(o)||(h(),a="insert",l=o.content.getContent()[0],h()):e.deletes(o)?("delete"!==a&&(h(),a="delete"),c+=1):o.deleted||("retain"!==a&&(h(),a="retain"),u+=1);break;case na:e.adds(o)?e.deletes(o)||("insert"!==a&&(h(),a="insert"),l+=o.content.str):e.deletes(o)?("delete"!==a&&(h(),a="delete"),c+=o.length):o.deleted||("retain"!==a&&(h(),a="retain"),u+=o.length);break;case Qo:var f=o.content,d=f.key,g=f.value;if(e.adds(o)){if(!e.deletes(o)){var p,y,m=null!==(p=r.get(d))&&void 0!==p?p:null;if(Eo(m,g))null!==g&&o.delete(t);else"retain"===a&&h(),Eo(g,null!==(y=i.get(d))&&void 0!==y?y:null)?delete s[d]:s[d]=g}}else if(e.deletes(o)){var w;i.set(d,g);var b=null!==(w=r.get(d))&&void 0!==w?w:null;Eo(b,g)||("retain"===a&&h(),s[d]=b)}else if(!o.deleted){i.set(d,g);var k=s[d];void 0!==k&&(Eo(k,g)?null!==k&&o.delete(t):("retain"===a&&h(),null===g?delete s[d]:s[d]=g))}o.deleted||("insert"===a&&h(),Po(r,o.content))}o=o.right}for(h();n.length>0;){var x=n[n.length-1];if(void 0===x.retain||void 0!==x.attributes)break;n.pop()}})),this._delta=n}return this._delta}}]),n}(Zi),zo=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this))._pending=void 0!==e?[function(){return r.insert(0,e)}]:[],r._searchMarker=[],r._hasFormatting=!1,r}return P(n,[{key:"length",get:function(){return this._length}},{key:"_integrate",value:function(e,t){s(g(n.prototype),"_integrate",this).call(this,e,t);try{this._pending.forEach((function(e){return e()}))}catch(Kk){console.error(Kk)}this._pending=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var e=new n;return e.applyDelta(this.toDelta()),e}},{key:"_callObserver",value:function(e,t){s(g(n.prototype),"_callObserver",this).call(this,e,t);var r=new Bo(this,e,t);no(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}},{key:"toString",value:function(){for(var e="",t=this._start;null!==t;)!t.deleted&&t.countable&&t.content.constructor===na&&(e+=t.content.str),t=t.right;return e}},{key:"toJSON",value:function(){return this.toString()}},{key:"applyDelta",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).sanitize,r=void 0===n||n;null!==this.doc?Li(this.doc,(function(n){for(var i=new So(null,t._start,0,new Map),o=0;o<e.length;o++){var a=e[o];if(void 0!==a.insert){var s=r||"string"!=typeof a.insert||o!==e.length-1||null!==i.right||"\n"!==a.insert.slice(-1)?a.insert:a.insert.slice(0,-1);("string"!=typeof s||s.length>0)&&Lo(n,t,i,s,a.attributes||{})}else void 0!==a.retain?jo(n,t,i,a.retain,a.attributes||{}):void 0!==a.delete&&Io(n,i,a.delete)}})):this._pending.push((function(){return t.applyDelta(e)}))}},{key:"toDelta",value:function(e,t,n){var r=[],i=new Map,o=this.doc,a="",s=this._start;function l(){if(a.length>0){var e={},t=!1;i.forEach((function(n,r){t=!0,e[r]=n}));var n={insert:a};t&&(n.attributes=e),r.push(n),a=""}}var u=function(){for(var o=function(){if(vi(s,e)||void 0!==t&&vi(s,t))switch(s.content.constructor){case na:var o=i.get("ychange");void 0===e||vi(s,e)?void 0===t||vi(s,t)?void 0!==o&&(l(),i.delete("ychange")):void 0!==o&&o.user===s.id.client&&"added"===o.type||(l(),i.set("ychange",n?n("added",s.id):{type:"added"})):void 0!==o&&o.user===s.id.client&&"removed"===o.type||(l(),i.set("ychange",n?n("removed",s.id):{type:"removed"})),a+=s.content.str;break;case ha:case $o:l();var u={insert:s.content.getContent()[0]};if(i.size>0){var c={};u.attributes=c,i.forEach((function(e,t){c[t]=e}))}r.push(u);break;case Qo:vi(s,e)&&(l(),Po(i,s.content))}s=s.right};null!==s;)o();l()};return e||t?Li(o,(function(n){e&&pi(n,e),t&&pi(n,t),u()}),"cleanup"):u(),r}},{key:"insert",value:function(e,t,n){var r=this;if(!(t.length<=0)){var i=this.doc;null!==i?Li(i,(function(i){var o=Ao(i,r,e,!n);n||(n={},o.currentAttributes.forEach((function(e,t){n[t]=e}))),Lo(i,r,o,t,n)})):this._pending.push((function(){return r.insert(e,t,n)}))}}},{key:"insertEmbed",value:function(e,t,n){var r=this,i=this.doc;null!==i?Li(i,(function(i){var o=Ao(i,r,e,!n);Lo(i,r,o,t,n||{})})):this._pending.push((function(){return r.insertEmbed(e,t,n||{})}))}},{key:"delete",value:function(e,t){var n=this;if(0!==t){var r=this.doc;null!==r?Li(r,(function(r){Io(r,Ao(r,n,e,!0),t)})):this._pending.push((function(){return n.delete(e,t)}))}}},{key:"format",value:function(e,t,n){var r=this;if(0!==t){var i=this.doc;null!==i?Li(i,(function(i){var o=Ao(i,r,e,!1);null!==o.right&&jo(i,r,o,t,n)})):this._pending.push((function(){return r.format(e,t,n)}))}}},{key:"removeAttribute",value:function(e){var t=this;null!==this.doc?Li(this.doc,(function(n){go(n,t,e)})):this._pending.push((function(){return t.removeAttribute(e)}))}},{key:"setAttribute",value:function(e,t){var n=this;null!==this.doc?Li(this.doc,(function(r){vo(r,n,e,t)})):this._pending.push((function(){return n.setAttribute(e,t)}))}},{key:"getAttribute",value:function(e){return po(this,e)}},{key:"getAttributes",value:function(){return yo(this)}},{key:"_write",value:function(e){e.writeTypeRef(aa)}}]),n}(ro),Fo=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};A(this,t),this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0}return P(t,[{key:Symbol.iterator,value:function(){return this}},{key:"next",value:function(){var e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do{if(t=e.content.type,e.deleted||t.constructor!==Ho&&t.constructor!==Vo||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start}while(null!==e&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,null===e?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}]),t}(),Vo=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.call(this))._prelimContent=[],e}return P(n,[{key:"firstChild",get:function(){var e=this._first;return e?e.content.getContent()[0]:null}},{key:"_integrate",value:function(e,t){s(g(n.prototype),"_integrate",this).call(this,e,t),this.insert(0,this._prelimContent),this._prelimContent=null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var e=new n;return e.insert(0,this.toArray().map((function(e){return e instanceof ro?e.clone():e}))),e}},{key:"length",get:function(){return null===this._prelimContent?this._length:this._prelimContent.length}},{key:"createTreeWalker",value:function(e){return new Fo(this,e)}},{key:"querySelector",value:function(e){e=e.toUpperCase();var t=new Fo(this,(function(t){return t.nodeName&&t.nodeName.toUpperCase()===e})).next();return t.done?null:t.value}},{key:"querySelectorAll",value:function(e){return e=e.toUpperCase(),_t(new Fo(this,(function(t){return t.nodeName&&t.nodeName.toUpperCase()===e})))}},{key:"_callObserver",value:function(e,t){no(this,e,new Uo(this,t,e))}},{key:"toString",value:function(){return so(this,(function(e){return e.toString()})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"toDOM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),ao(this,(function(i){r.insertBefore(i.toDOM(e,t,n),null)})),r}},{key:"insert",value:function(e,t){var n,r=this;null!==this.doc?Li(this.doc,(function(n){ho(n,r,e,t)})):(n=this._prelimContent).splice.apply(n,[e,0].concat(p(t)))}},{key:"insertAfter",value:function(e,t){var n=this;if(null!==this.doc)Li(this.doc,(function(r){var i=e&&e instanceof ro?e._item:e;uo(r,n,i,t)}));else{var r=this._prelimContent,i=null===e?0:r.findIndex((function(t){return t===e}))+1;if(0===i&&null!==e)throw vn("Reference item not found");r.splice.apply(r,[i,0].concat(p(t)))}}},{key:"delete",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;null!==this.doc?Li(this.doc,(function(r){fo(r,t,e,n)})):this._prelimContent.splice(e,n)}},{key:"toArray",value:function(){return oo(this)}},{key:"push",value:function(e){this.insert(this.length,e)}},{key:"unshift",value:function(e){this.insert(0,e)}},{key:"get",value:function(e){return lo(this,e)}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return io(this,e,t)}},{key:"forEach",value:function(e){ao(this,e)}},{key:"_write",value:function(e){e.writeTypeRef(la)}}]),n}(ro),Ho=function(e){l(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"UNDEFINED";return A(this,n),(e=t.call(this)).nodeName=r,e._prelimAttrs=new Map,e}return P(n,[{key:"nextSibling",get:function(){var e=this._item?this._item.next:null;return e?e.content.type:null}},{key:"prevSibling",get:function(){var e=this._item?this._item.prev:null;return e?e.content.type:null}},{key:"_integrate",value:function(e,t){var r=this;s(g(n.prototype),"_integrate",this).call(this,e,t),this._prelimAttrs.forEach((function(e,t){r.setAttribute(t,e)})),this._prelimAttrs=null}},{key:"_copy",value:function(){return new n(this.nodeName)}},{key:"clone",value:function(){var e=new n(this.nodeName);return function(e,t){for(var n in e)t(e[n],n)}(this.getAttributes(),(function(t,n){"string"==typeof t&&e.setAttribute(n,t)})),e.insert(0,this.toArray().map((function(e){return e instanceof ro?e.clone():e}))),e}},{key:"toString",value:function(){var e=this.getAttributes(),t=[],r=[];for(var i in e)r.push(i);r.sort();for(var o=r.length,a=0;a<o;a++){var l=r[a];t.push(l+'="'+e[l]+'"')}var u=this.nodeName.toLocaleLowerCase(),c=t.length>0?" "+t.join(" "):"";return"<".concat(u).concat(c,">").concat(s(g(n.prototype),"toString",this).call(this),"</").concat(u,">")}},{key:"removeAttribute",value:function(e){var t=this;null!==this.doc?Li(this.doc,(function(n){go(n,t,e)})):this._prelimAttrs.delete(e)}},{key:"setAttribute",value:function(e,t){var n=this;null!==this.doc?Li(this.doc,(function(r){vo(r,n,e,t)})):this._prelimAttrs.set(e,t)}},{key:"getAttribute",value:function(e){return po(this,e)}},{key:"hasAttribute",value:function(e){return mo(this,e)}},{key:"getAttributes",value:function(e){return e?function(e,t){var n={};return e._map.forEach((function(e,r){for(var i=e;null!==i&&(!t.sv.has(i.id.client)||i.id.clock>=(t.sv.get(i.id.client)||0));)i=i.left;null!==i&&vi(i,t)&&(n[r]=i.content.getContent()[i.length-1])})),n}(this,e):yo(this)}},{key:"toDOM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e.createElement(this.nodeName),i=this.getAttributes();for(var o in i){var a=i[o];"string"==typeof a&&r.setAttribute(o,a)}return ao(this,(function(i){r.appendChild(i.toDOM(e,t,n))})),void 0!==n&&n._createAssociation(r,this),r}},{key:"_write",value:function(e){e.writeTypeRef(sa),e.writeKey(this.nodeName)}}]),n}(Vo),Uo=function(e){l(n,e);var t=c(n);function n(e,r,i){var o;return A(this,n),(o=t.call(this,e,i)).childListChanged=!1,o.attributesChanged=new Set,r.forEach((function(e){null===e?o.childListChanged=!0:o.attributesChanged.add(e)})),o}return P(n)}(Zi),qo=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this)).hookName=e,r}return P(n,[{key:"_copy",value:function(){return new n(this.hookName)}},{key:"clone",value:function(){var e=new n(this.hookName);return this.forEach((function(t,n){e.set(n,t)})),e}},{key:"toDOM",value:function(){arguments.length>0&&void 0!==arguments[0]||document;var e,t=arguments.length>2?arguments[2]:void 0,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})[this.hookName];return(e=void 0!==n?n.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==t&&t._createAssociation(e,this),e}},{key:"_write",value:function(e){e.writeTypeRef(ua),e.writeKey(this.hookName)}}]),n}(Co),Go=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"nextSibling",get:function(){var e=this._item?this._item.next:null;return e?e.content.type:null}},{key:"prevSibling",get:function(){var e=this._item?this._item.prev:null;return e?e.content.type:null}},{key:"_copy",value:function(){return new n}},{key:"clone",value:function(){var e=new n;return e.applyDelta(this.toDelta()),e}},{key:"toDOM",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>2?arguments[2]:void 0,n=e.createTextNode(this.toString());return void 0!==t&&t._createAssociation(n,this),n}},{key:"toString",value:function(){return this.toDelta().map((function(e){var t=[];for(var n in e.attributes){var r=[];for(var i in e.attributes[n])r.push({key:i,value:e.attributes[n][i]});r.sort((function(e,t){return e.key<t.key?-1:1})),t.push({nodeName:n,attrs:r})}t.sort((function(e,t){return e.nodeName<t.nodeName?-1:1}));for(var o="",a=0;a<t.length;a++){var s=t[a];o+="<".concat(s.nodeName);for(var l=0;l<s.attrs.length;l++){var u=s.attrs[l];o+=" ".concat(u.key,'="').concat(u.value,'"')}o+=">"}o+=e.insert;for(var c=t.length-1;c>=0;c--)o+="</".concat(t[c].nodeName,">");return o})).join("")}},{key:"toJSON",value:function(){return this.toString()}},{key:"_write",value:function(e){e.writeTypeRef(ca)}}]),n}(zo),Jo=function(){function e(t,n){A(this,e),this.id=t,this.length=n}return P(e,[{key:"deleted",get:function(){throw pn()}},{key:"mergeWith",value:function(e){return!1}},{key:"write",value:function(e,t,n){throw pn()}},{key:"integrate",value:function(e,t){throw pn()}}]),e}(),Wo=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}},{key:"integrate",value:function(e,t){t>0&&(this.id.clock+=t,this.length-=t),bi(e.doc.store,this)}},{key:"write",value:function(e,t){e.writeInfo(0),e.writeLen(this.length-t)}},{key:"getMissing",value:function(e,t){return null}}]),n}(Jo),Yo=function(){function e(t){A(this,e),this.content=t}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.content]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.content)}},{key:"splice",value:function(e){throw pn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeBuf(this.content)}},{key:"getRef",value:function(){return 3}}]),e}(),Zo=function(){function e(t){A(this,e),this.len=t}return P(e,[{key:"getLength",value:function(){return this.len}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new e(this.len)}},{key:"splice",value:function(t){var n=new e(this.len-t);return this.len=t,n}},{key:"mergeWith",value:function(e){return this.len+=e.len,!0}},{key:"integrate",value:function(e,t){Mr(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeLen(this.len-t)}},{key:"getRef",value:function(){return 1}}]),e}(),Xo=function(e,t){return new Nr(a(a({guid:e},t),{},{shouldLoad:t.shouldLoad||t.autoLoad||!1}))},Ko=function(){function e(t){A(this,e),t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;var n={};this.opts=n,t.gc||(n.gc=!1),t.autoLoad&&(n.autoLoad=!0),null!==t.meta&&(n.meta=t.meta)}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.doc]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(Xo(this.doc.guid,this.opts))}},{key:"splice",value:function(e){throw pn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}},{key:"delete",value:function(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}},{key:"getRef",value:function(){return 9}}]),e}(),$o=function(){function e(t){A(this,e),this.embed=t}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.embed]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.embed)}},{key:"splice",value:function(e){throw pn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeJSON(this.embed)}},{key:"getRef",value:function(){return 5}}]),e}(),Qo=function(){function e(t,n){A(this,e),this.key=t,this.value=n}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[]}},{key:"isCountable",value:function(){return!1}},{key:"copy",value:function(){return new e(this.key,this.value)}},{key:"splice",value:function(e){throw pn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){var n=t.parent;n._searchMarker=null,n._hasFormatting=!0}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeKey(this.key),e.writeJSON(this.value)}},{key:"getRef",value:function(){return 6}}]),e}(),ea=function(){function e(t){A(this,e),this.arr=t}return P(e,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.arr)}},{key:"splice",value:function(t){var n=new e(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}},{key:"mergeWith",value:function(e){return this.arr=this.arr.concat(e.arr),!0}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){var n=this.arr.length;e.writeLen(n-t);for(var r=t;r<n;r++){var i=this.arr[r];e.writeString(void 0===i?"undefined":JSON.stringify(i))}}},{key:"getRef",value:function(){return 2}}]),e}(),ta=function(){function e(t){A(this,e),this.arr=t}return P(e,[{key:"getLength",value:function(){return this.arr.length}},{key:"getContent",value:function(){return this.arr}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.arr)}},{key:"splice",value:function(t){var n=new e(this.arr.slice(t));return this.arr=this.arr.slice(0,t),n}},{key:"mergeWith",value:function(e){return this.arr=this.arr.concat(e.arr),!0}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){var n=this.arr.length;e.writeLen(n-t);for(var r=t;r<n;r++){var i=this.arr[r];e.writeAny(i)}}},{key:"getRef",value:function(){return 8}}]),e}(),na=function(){function e(t){A(this,e),this.str=t}return P(e,[{key:"getLength",value:function(){return this.str.length}},{key:"getContent",value:function(){return this.str.split("")}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.str)}},{key:"splice",value:function(t){var n=new e(this.str.slice(t));this.str=this.str.slice(0,t);var r=this.str.charCodeAt(t-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,t-1)+"�",n.str="�"+n.str.slice(1)),n}},{key:"mergeWith",value:function(e){return this.str+=e.str,!0}},{key:"integrate",value:function(e,t){}},{key:"delete",value:function(e){}},{key:"gc",value:function(e){}},{key:"write",value:function(e,t){e.writeString(0===t?this.str:this.str.slice(t))}},{key:"getRef",value:function(){return 4}}]),e}(),ra=[function(e){return new ko},function(e){return new Co},function(e){return new zo},function(e){return new Ho(e.readKey())},function(e){return new Vo},function(e){return new qo(e.readKey())},function(e){return new Go}],ia=0,oa=1,aa=2,sa=3,la=4,ua=5,ca=6,ha=function(){function e(t){A(this,e),this.type=t}return P(e,[{key:"getLength",value:function(){return 1}},{key:"getContent",value:function(){return[this.type]}},{key:"isCountable",value:function(){return!0}},{key:"copy",value:function(){return new e(this.type._copy())}},{key:"splice",value:function(e){throw pn()}},{key:"mergeWith",value:function(e){return!1}},{key:"integrate",value:function(e,t){this.type._integrate(e.doc,t)}},{key:"delete",value:function(e){for(var t=this.type._start;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach((function(t){t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)})),e.changed.delete(this.type)}},{key:"gc",value:function(e){for(var t=this.type._start;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach((function(t){for(;null!==t;)t.gc(e,!0),t=t.left})),this.type._map=new Map}},{key:"write",value:function(e,t){this.type._write(e)}},{key:"getRef",value:function(){return 7}}]),e}(),fa=function(e,t){var n,r=t,i=0;do{i>0&&(r=ni(r.client,r.clock+i)),n=xi(e,r),i=r.clock-n.id.clock,r=n.redone}while(null!==r&&n instanceof ya);return{item:n,diff:i}},da=function(e,t){for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},ga=function(e,t,n){var r=t.id,i=r.client,o=r.clock,a=new ya(ni(i,o+n),t,ni(i,o+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&a.markDeleted(),t.keep&&(a.keep=!0),null!==t.redone&&(a.redone=ni(t.redone.client,t.redone.clock+n)),t.right=a,null!==a.right&&(a.right.left=a),e._mergeStructs.push(a),null!==a.parentSub&&null===a.right&&a.parent._map.set(a.parentSub,a),t.length=n,a},va=function(e,t){return function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1}(e,(function(e){return Sr(e.deletions,t)}))},pa=function e(t,n,r,i,o,a){var s=t.doc,l=s.store,u=s.clientID,c=n.redone;if(null!==c)return Ei(t,c);var h,f=n.parent._item,d=null;if(null!==f&&!0===f.deleted){if(null===f.redone&&(!r.has(f)||null===e(t,f,r,i,o,a)))return null;for(;null!==f.redone;)f=Ei(t,f.redone)}var g=null===f?n.parent:f.content.type;if(null===n.parentSub){for(d=n.left,h=n;null!==d;){for(var v=d;null!==v&&v.parent._item!==f;)v=null===v.redone?null:Ei(t,v.redone);if(null!==v&&v.parent._item===f){d=v;break}d=d.left}for(;null!==h;){for(var p=h;null!==p&&p.parent._item!==f;)p=null===p.redone?null:Ei(t,p.redone);if(null!==p&&p.parent._item===f){h=p;break}h=h.right}}else if(h=null,n.right&&!o){for(d=n;null!==d&&null!==d.right&&(d.right.redone||Sr(i,d.right.id)||va(a.undoStack,d.right.id)||va(a.redoStack,d.right.id));)for(d=d.right;d.redone;)d=Ei(t,d.redone);if(d&&null!==d.right)return null}else d=g._map.get(n.parentSub)||null;var y=wi(l,u),m=ni(u,y),w=new ya(m,d,d&&d.lastId,h,h&&h.id,g,n.parentSub,n.content.copy());return n.redone=m,da(w,!0),w.integrate(t,0),w},ya=function(e){l(n,e);var t=c(n);function n(e,r,i,o,a,s,l,u){var c;return A(this,n),(c=t.call(this,e,u.getLength())).origin=i,c.left=r,c.right=o,c.rightOrigin=a,c.parent=s,c.parentSub=l,c.redone=null,c.content=u,c.info=c.content.isCountable()?2:0,c}return P(n,[{key:"marker",get:function(){return(8&this.info)>0},set:function(e){(8&this.info)>0!==e&&(this.info^=8)}},{key:"keep",get:function(){return(1&this.info)>0},set:function(e){this.keep!==e&&(this.info^=1)}},{key:"countable",get:function(){return(2&this.info)>0}},{key:"deleted",get:function(){return(4&this.info)>0},set:function(e){this.deleted!==e&&(this.info^=4)}},{key:"markDeleted",value:function(){this.info|=4}},{key:"getMissing",value:function(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=wi(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=wi(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ei&&this.id.client!==this.parent.client&&this.parent.clock>=wi(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Si(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ei(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Wo||this.right&&this.right.constructor===Wo)this.parent=null;else if(this.parent){if(this.parent.constructor===ei){var r=xi(t,this.parent);r.constructor===Wo?this.parent=null:this.parent=r.content.type}}else this.left&&this.left.constructor===n&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===n&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}},{key:"integrate",value:function(e,t){if(t>0&&(this.id.clock+=t,this.left=Si(e,e.doc.store,ni(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){var n,r=this.left;if(null!==r)n=r.right;else if(null!==this.parentSub)for(n=this.parent._map.get(this.parentSub)||null;null!==n&&null!==n.left;)n=n.left;else n=this.parent._start;for(var i=new Set,o=new Set;null!==n&&n!==this.right;){if(o.add(n),i.add(n),ti(this.origin,n.origin)){if(n.id.client<this.id.client)r=n,i.clear();else if(ti(this.rightOrigin,n.rightOrigin))break}else{if(null===n.origin||!o.has(xi(e.doc.store,n.origin)))break;i.has(xi(e.doc.store,n.origin))||(r=n,i.clear())}n=n.right}this.left=r}if(null!==this.left){var a=this.left.right;this.right=a,this.left.right=this}else{var s;if(null!==this.parentSub)for(s=this.parent._map.get(this.parentSub)||null;null!==s&&null!==s.left;)s=s.left;else s=this.parent._start,this.parent._start=this;this.right=s}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),bi(e.doc.store,this),this.content.integrate(e,this),Pi(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new Wo(this.id,this.length).integrate(e,0)}},{key:"next",get:function(){for(var e=this.right;null!==e&&e.deleted;)e=e.right;return e}},{key:"prev",get:function(){for(var e=this.left;null!==e&&e.deleted;)e=e.left;return e}},{key:"lastId",get:function(){return 1===this.length?this.id:ni(this.id.client,this.id.clock+this.length-1)}},{key:"mergeWith",value:function(e){var t=this;if(this.constructor===e.constructor&&ti(e.origin,this.lastId)&&this.right===e&&ti(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){var n=this.parent._searchMarker;return n&&n.forEach((function(n){n.p===e&&(n.p=t,!t.deleted&&t.countable&&(n.index-=t.length))})),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}},{key:"delete",value:function(e){if(!this.deleted){var t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),Mr(e.deleteSet,this.id.client,this.id.clock,this.length),Pi(e,t,this.parentSub),this.content.delete(e)}}},{key:"gc",value:function(e,t){if(!this.deleted)throw yn();this.content.gc(e),t?function(e,t,n){var r=e.clients.get(t.id.client);r[ki(r,t.id.clock)]=n}(e,this,new Wo(this.id,this.length)):this.content=new Zo(this.length)}},{key:"write",value:function(e,t){var n=t>0?ni(this.id.client,this.id.clock+t-1):this.origin,r=this.rightOrigin,i=this.parentSub,o=this.content.getRef()&It|(null===n?0:Dt)|(null===r?0:Rt)|(null===i?0:Nt);if(e.writeInfo(o),null!==n&&e.writeLeftID(n),null!==r&&e.writeRightID(r),null===n&&null===r){var a=this.parent;if(void 0!==a._item){var s=a._item;if(null===s){var l=oi(a);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(s.id)}else a.constructor===String?(e.writeParentInfo(!0),e.writeString(a)):a.constructor===ei?(e.writeParentInfo(!1),e.writeLeftID(a)):yn();null!==i&&e.writeString(i)}this.content.write(e,t)}}]),n}(Jo),ma=function(e,t){return wa[t&It](e)},wa=[function(){yn()},function(e){return new Zo(e.readLen())},function(e){for(var t=e.readLen(),n=[],r=0;r<t;r++){var i=e.readString();"undefined"===i?n.push(void 0):n.push(JSON.parse(i))}return new ea(n)},function(e){return new Yo(e.readBuf())},function(e){return new na(e.readString())},function(e){return new $o(e.readJSON())},function(e){return new Qo(e.readKey(),e.readJSON())},function(e){return new ha(ra[e.readTypeRef()](e))},function(e){for(var t=e.readLen(),n=[],r=0;r<t;r++)n.push(e.readAny());return new ta(n)},function(e){return new Ko(Xo(e.readString(),e.readAny()))},function(){yn()}],ba=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"deleted",get:function(){return!0}},{key:"delete",value:function(){}},{key:"mergeWith",value:function(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}},{key:"integrate",value:function(e,t){yn()}},{key:"write",value:function(e,t){e.writeInfo(10),$t(e.restEncoder,this.length-t)}},{key:"getMissing",value:function(e,t){return null}}]),n}(Jo),ka="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},xa="__ $YJS$ __";function Ca(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ea(e){if(!Ca(e))return!1;var t=e.constructor;if(void 0===t)return!0;var n=t.prototype;return!1!==Ca(n)&&!1!==n.hasOwnProperty("isPrototypeOf")}function Sa(e,t){for(var n in e){var r=e[n],i=t[n];if(Ea(r)&&Ea(i)){if(!Sa(r,i))return!1}else if(Array.isArray(r)&&Array.isArray(i)){if(r.length!==i.length)return!1;for(var o=0;o<r.length;o++)if(r[o]!==i[o])return!1}else if(r!==i)return!1}for(var a in t)if(void 0===e[a]&&void 0!==t[a])return!1;return!0}function _a(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.fromEntries(Object.entries(e).filter((function(e){var t=m(e,1)[0];return n.includes(t)})))}function Aa(e){return function(e){var t,n=[],r=k(e);try{for(r.s();!(t=r.n()).done;){var i,o,a=t.value;if("string"!=typeof a.insert||0!==a.insert.length){var s=n[n.length-1];s&&"string"==typeof s.insert&&"string"==typeof a.insert&&(s.attributes===a.attributes||!s.attributes==!a.attributes&&Sa(null!==(i=s.attributes)&&void 0!==i?i:{},null!==(o=a.attributes)&&void 0!==o?o:{}))?s.insert+=a.insert:n.push(a)}}}catch(l){r.e(l)}finally{r.f()}return n}(e.toDelta())}function Ma(e){var t=e.insert;return"string"==typeof t?t.length:1}function Pa(e){return e.reduce((function(e,t){return e+Ma(t)}),0)}function Oa(e,t,n){if(n<1)return[];for(var r=0,i=[],o=t+n,s=0;s<e.length&&!(r>=o);s++){var l=e[s],u=Ma(l);if(r+u<=t)r+=u;else if("string"==typeof l.insert){var c=Math.max(0,t-r),h=Math.min(u,u-(r+u-o));i.push(a(a({},l),{},{insert:l.insert.slice(c,h)})),r+=u}else r+=u,i.push(l)}return i}function Ta(e){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.fromEntries(Object.entries(e).filter((function(e){var t=m(e,1)[0];return!n.includes(t)})))}(e,he.isText(e)?"text":"children")}function La(e){var t=Aa(e),n=t.length>0?t.map(ja):[{text:""}];return a(a({},e.getAttributes()),{},{children:n})}function ja(e){return"string"==typeof e.insert?a(a({},e.attributes),{},{text:e.insert}):La(e.insert)}function Na(e){return e.map((function(e){return he.isText(e)?{insert:e.text,attributes:Ta(e)}:{insert:Ra(e)}}))}function Ra(t){var n=t.children,r=i(t,e),o=new Go;return Object.entries(r).forEach((function(e){var t=m(e,2),n=t[0],r=t[1];o.setAttribute(n,r)})),o.applyDelta(Na(n),{sanitize:!1}),o}function Da(e){return e?he.isText(e)?e.text.length:1:0}function Ia(e,t,n){var r;if(0===n.length)throw new Error("Path has to a have a length >= 1");if(he.isText(t))throw new Error("Cannot descent into slate text");var i,o=b(i=n)||y(i)||x(i)||w(),a=o[0],s=o.slice(1),l=function(e,t){return e.children.slice(0,t).reduce((function(e,t){return e+Da(t)}),0)}(t,a),u=t.children[a],c=Aa(e),h=Da(u),f=Oa(c,l,h);if(f.length>1)throw new Error("Path doesn't match yText, yTarget spans multiple nodes");var d=null===(r=f[0])||void 0===r?void 0:r.insert;if(s.length>0){if(!(d instanceof Go))throw new Error("Path doesn't match yText, cannot descent into non-yText");return Ia(d,u,s)}return{yParent:e,textRange:{start:l,end:l+h},yTarget:d instanceof Go?d:void 0,slateParent:t,slateTarget:u,targetDelta:f}}function Ba(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.assoc,i=void 0===r?0:r,o=n.insert,a=void 0!==o&&o,s=0,l=0,u=0;u<e.children.length;u++){var c=e.children[u],h=he.isText(c)?c.text.length:1;h>0&&(l=u);var f=s+h;if(h>0&&(i>=0?f>t:f>=t))return[u,t-s];s+=h}if(t>s+(a?1:0))throw new Error("yOffset out of bounds");if(a)return[e.children.length,0];var d=e.children[l];return[l,he.isText(d)?d.text.length:1]}function za(e,t,n){for(var r=[n];r[0]!==e;){var i=r[0].parent;if(!i)throw new Error("yText isn't a descendant of root element");if(!(i instanceof Go))throw new Error("Unexpected y parent type");r.unshift(i)}if(r.length<2)return[];var o=t;return r.reduce((function(e,t,n){var i=r[n+1];if(!i)return e;var a,s=0,l=k(Aa(t));try{for(l.s();!(a=l.n()).done;){var u=a.value;if(u.insert===i)break;s+="string"==typeof u.insert?u.insert.length:1}}catch(h){l.e(h)}finally{l.f()}if(he.isText(o))throw new Error("Cannot descent into slate text");var c=m(Ba(o,s),1)[0];return o=o.children[c],e.concat(c)}),[])}function Fa(e){if(!e.doc)throw new Error("shared type isn't attached to a document")}!0===ka[xa]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),ka[xa]=!0;var Va="__slateYjsStoredPosition_";function Ha(e,t,n){var r=Ia(e,t,n.path),i=r.yTarget,o=r.yParent,a=r.textRange;if(i)throw new Error("Slate point points to a non-text element inside sharedRoot");var s=a.start+n.offset;return ci(o,s,s===a.end?-1:0)}function Ua(e,t,n){if(!e.doc)throw new Error("sharedRoot isn't attach to a yDoc");var r=di(n,e.doc);return r&&function(e,t,n){var r=n.type,i=n.index,o=n.assoc;if(!(r instanceof Go))throw new Error("Absolute position points to a non-XMLText");var a=za(e,t,r),s=fe.get(t,a);if(he.isText(s))throw new Error("Absolute position doesn't match slateRoot, cannot descent into text");var l=m(Ba(s,i,{assoc:o}),2),u=l[0],c=l[1],h=s.children[u];return he.isText(h)?{path:[].concat(p(a),[u]),offset:c}:null}(e,t,r)}function qa(e,t,n){e.setAttribute(Va+t,hi(n))}function Ga(e,t,n){return Object.fromEntries(Object.entries(e).filter((function(e){var r=m(e,2)[1];return r.type===t&&(!n||(r.assoc>=0?r.index>=n.start&&r.index<n.end:r.index>n.start&&r.index>=n.end))})))}function Ja(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=O({},n,Ga(e,t));return Aa(t).forEach((function(t,i){var o=t.insert;o instanceof Go&&Object.assign(r,Ja(e,o,n?"".concat(n,".").concat(i):i.toString()))})),r}function Wa(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=function(e){return Fa(e),Object.fromEntries(Object.entries(e.getAttributes()).filter((function(e){return m(e,1)[0].startsWith(Va)})).map((function(t){var n=m(t,2),r=n[0],i=n[1];return[r.slice(Va.length),di(fi(i),e.doc)]})).filter((function(e){return m(e,2)[1]})))}(e),o={"":Ga(i,t,{start:r,end:r+Pa(n)})};return n.forEach((function(e,t){var n=e.insert;n instanceof Go&&Object.assign(o,Ja(i,n,t.toString()))})),o}function Ya(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",s=n[a];s&&Object.entries(s).forEach((function(n){var r=m(n,2),a=r[0],s=r[1];qa(e,a,ci(t,s.index-o+i,s.assoc))})),r.forEach((function(t,r){var i=t.insert;i instanceof Go&&Ya(e,i,n,Aa(i),0,0,a?"".concat(a,".").concat(r):r.toString())}))}function Za(e,t,n){return{anchor:Ha(e,t,n.anchor),focus:Ha(e,t,n.focus)}}function Xa(e,t,n){var r=Ua(e,t,n.anchor);if(!r)return null;var i=Ua(e,t,n.focus);return i?{anchor:r,focus:i}:null}function Ka(e,t,n){var r=n.target,i=n.changes,o=n.delta;if(!(r instanceof Go))throw new Error("Unexpected target node type");var s=[],l=za(e,t,r),u=fe.get(t,l);if(he.isText(u))throw new Error("Cannot apply yTextEvent to text node");var c=Array.from(i.keys.entries());if(l.length>0&&c.length>0){var h=Object.fromEntries(c.map((function(e){var t=m(e,2),n=t[0];return[n,"delete"===t[1].action?null:r.getAttribute(n)]}))),f=Object.fromEntries(c.map((function(e){var t=m(e,1)[0];return[t,u[t]]})));s.push({type:"set_node",newProperties:h,properties:f,path:l})}return o.length>0&&s.push.apply(s,p(function(e,t,n){var r=[],i=n.reduce((function(e,t){return"retain"in t?e+t.retain:"delete"in t?e+t.delete:e}),0);return n.reverse().forEach((function(n){if("attributes"in n&&"retain"in n)for(var o=m(Ba(e,i-n.retain),2),s=o[0],l=o[1],u=m(Ba(e,i,{assoc:-1}),2),c=u[0],h=u[1],f=c;f>=s;f--){var d=e.children[f],g=[].concat(p(t),[f]);if(he.isText(d)){var v=n.attributes,y=_a.apply(void 0,[e].concat(p(Object.keys(n.attributes))));if(f===s||f===c){var w=f===s?l:0,b=f===c?h:d.text.length;if(b!==d.text.length&&r.push({type:"split_node",path:g,position:b,properties:Ta(d)}),0!==w){r.push({type:"split_node",path:g,position:w,properties:(k=a(a({},Ta(d)),v),Object.fromEntries(Object.entries(k).filter((function(e){return null!==m(e,2)[1]}))))});continue}}r.push({type:"set_node",newProperties:v,path:g,properties:y})}}var k;if("retain"in n&&(i-=n.retain),"delete"in n)for(var x=m(Ba(e,i-n.delete),2),C=x[0],E=x[1],S=m(Ba(e,i,{assoc:-1}),2),_=S[0],A=S[1],M=0===A?_-1:_;M>=C;M--){var P=e.children[M],O=[].concat(p(t),[M]);if(!he.isText(P)||M!==C&&M!==_)r.push({type:"remove_node",node:P,path:O}),i-=Da(P);else{var T=M===C?E:0,L=M===_?A:P.text.length;r.push({type:"remove_text",offset:T,text:P.text.slice(T,L),path:O}),i-=L-T}}else if("insert"in n){var j=m(Ba(e,i,{insert:!0}),2),N=j[0],R=j[1],D=e.children[N],I=[].concat(p(t),[N]);if(he.isText(D)){var B,z=r[r.length-1],F=null!=z&&"insert_node"===z.type?z.node:Ta(D),V=[];if(null==z||"insert_node"!==z.type&&"insert_text"!==z.type&&"split_node"!==z.type&&"set_node"!==z.type||(V=z.path),"string"==typeof n.insert&&Sa(null!==(B=n.attributes)&&void 0!==B?B:{},F)&&de.equals(I,V))return r.push({type:"insert_text",offset:R,text:n.insert,path:I});var H=ja(n);return 0===R?r.push({type:"insert_node",path:I,node:H}):(R<D.text.length&&r.push({type:"split_node",path:I,position:R,properties:Ta(D)}),r.push({type:"insert_node",path:de.next(I),node:H}))}return r.push({type:"insert_node",path:I,node:ja(n)})}})),r}(u,l,o))),s}function $a(e,t,n){ue.withoutNormalizing(t,(function(){n.forEach((function(n){(function(e,t,n){if(n instanceof Bo)return Ka(e,t,n);throw new Error("Unexpected Y event type")})(e,t,n).forEach((function(e){t.apply(e)}))}))}))}function Qa(e){var t=new Go,n=e.getAttributes();return Object.entries(n).forEach((function(e){var n=m(e,2),r=n[0],i=n[1];t.setAttribute(r,i)})),t.applyDelta(es(Aa(e)),{sanitize:!1}),t}function es(e){return e.map((function(e){return"string"==typeof e.insert?e:a(a({},e),{},{insert:Qa(e.insert)})}))}var ts={insert_node:function(e,t,n){var r=Ia(e,t,n.path),i=r.yParent,o=r.textRange;if(he.isText(n.node))return i.insert(o.start,n.node.text,Ta(n.node));i.insertEmbed(o.start,Ra(n.node))},remove_node:function(e,t,n){var r=Ia(e,t,n.path),i=r.yParent,o=r.textRange;i.delete(o.start,o.end-o.start)},set_node:function(e,t,n){var r=Ia(e,t,n.path),i=r.yTarget,o=r.textRange,s=r.yParent;if(i)return Object.entries(n.newProperties).forEach((function(e){var t=m(e,2),n=t[0],r=t[1];if(null===r)return i.removeAttribute(n);i.setAttribute(n,r)})),Object.entries(n.properties).forEach((function(e){var t=m(e,1)[0];n.newProperties.hasOwnProperty(t)||i.removeAttribute(t)}));var l=a(a({},Object.fromEntries(Object.keys(n.properties).map((function(e){return[e,null]})))),n.newProperties);s.format(o.start,o.end-o.start,l)},merge_node:function(e,t,n){var r=Ia(e,t,n.path),i=Ia(r.yParent,r.slateParent,de.previous(n.path.slice(-1)));if(!r.yTarget!=!i.yTarget)throw new Error("Cannot merge y text with y element");if(!i.yTarget||!r.yTarget){var o=r.yParent,s=r.textRange,l=r.slateTarget;if(!l)throw new Error("Expected Slate target node for merge op.");var u=fe.get(t,de.previous(n.path));if(!he.isText(u))throw new Error("Path points to Y.Text but not a Slate text node.");var c=Ta(l),h=Ta(u),f=Object.keys(c).reduce((function(e,t){return t in h?e:a(a({},e),{},O({},t,null))}),{});return o.format(s.start,s.end-s.start,a(a({},f),h))}var d=i.yTarget.length,g=Aa(r.yTarget),v=es(g),y=Wa(e,r.yTarget,g,d),m=[{retain:d}].concat(p(v));i.yTarget.applyDelta(m,{sanitize:!1}),r.yParent.delete(r.textRange.start,r.textRange.end-r.textRange.start),Ya(e,i.yTarget,y,v,d)},move_node:function(e,t,n){var r=de.parent(n.newPath),i=n.newPath[n.newPath.length-1],o=fe.get(t,r);if(he.isText(o))throw new Error("Cannot move slate node into text element");var a=[].concat(p(r),[Math.min(i,o.children.length)]),s=Ia(e,t,n.path),l=Ia(e,t,a),u=es(s.targetDelta),c=Wa(e,s.yParent,s.targetDelta);s.yParent.delete(s.textRange.start,s.textRange.end-s.textRange.start);var h=Pa(Aa(l.yParent)),f=Math.min(l.textRange.start,h),d=[{retain:f}].concat(p(u));l.yParent.applyDelta(d,{sanitize:!1}),Ya(e,l.yParent,c,u,f,s.textRange.start)},split_node:function(e,t,n){var r=Ia(e,t,n.path);if(!r.slateTarget)throw new Error("Y target without corresponding slate node");if(!r.yTarget){if(!he.isText(r.slateTarget))throw new Error("Mismatch node type between y target and slate node");var i={};return r.targetDelta.forEach((function(e){e.attributes&&Object.keys(e.attributes).forEach((function(e){i[e]=null}))})),r.yParent.format(r.textRange.start,r.textRange.end-r.textRange.start,a(a({},i),n.properties))}if(he.isText(r.slateTarget))throw new Error("Mismatch node type between y target and slate node");var o=Ia(r.yTarget,r.slateTarget,[n.position]),s=r.slateTarget.children.slice(0,n.position).reduce((function(e,t){return e+Da(t)}),0),l=r.slateTarget.children.reduce((function(e,t){return e+Da(t)}),0),u=Oa(Aa(r.yTarget),s,l-s),c=es(u),h=Wa(e,r.yTarget,u,s),f=new Go;f.applyDelta(c,{sanitize:!1}),Object.entries(n.properties).forEach((function(e){var t=m(e,2),n=t[0],r=t[1];f.setAttribute(n,r)})),r.yTarget.delete(o.textRange.start,r.yTarget.length-o.textRange.start),r.yParent.insertEmbed(r.textRange.end,f),Ya(e,f,h,c,0,s)}};var ns=a(a(a({},{insert_text:function(e,t,n){var r=Ia(e,t,n.path),i=r.yParent,o=r.textRange,a=fe.get(t,n.path);if(!he.isText(a))throw new Error("Cannot insert text into non-text node");i.insert(o.start+n.offset,n.text,Ta(a))},remove_text:function(e,t,n){var r=Ia(e,t,n.path),i=r.yParent,o=r.textRange;i.delete(o.start+n.offset,n.text.length)}}),ts),{},{set_selection:function(){}});var rs=Symbol("slate-yjs-operation"),is=Symbol("slate-yjs-position-storage"),os=new WeakMap,as=new WeakMap,ss=new WeakSet,ls={isYjsEditor:function(e){return ue.isEditor(e)&&e.sharedRoot instanceof Go&&"localOrigin"in e&&"positionStorageOrigin"in e&&"function"==typeof e.applyRemoteEvents&&"function"==typeof e.storeLocalChange&&"function"==typeof e.flushLocalChanges&&"function"==typeof e.isLocalOrigin&&"function"==typeof e.connect&&"function"==typeof e.disconnect},localChanges:function(e){var t;return null!==(t=as.get(e))&&void 0!==t?t:[]},applyRemoteEvents:function(e,t,n){e.applyRemoteEvents(t,n)},storeLocalChange:function(e,t){e.storeLocalChange(t)},flushLocalChanges:function(e){e.flushLocalChanges()},connected:function(e){return ss.has(e)},connect:function(e){e.connect()},disconnect:function(e){e.disconnect()},isLocal:function(e){return e.isLocalOrigin(ls.origin(e))},origin:function(e){var t=os.get(e);return void 0!==t?t:e.localOrigin},withOrigin:function(e,t,n){var r=ls.origin(e);os.set(e,t),n(),os.set(e,r)},storePosition:function(e,t,n){var r,i=e.sharedRoot,o=e.positionStorageOrigin;Fa(i);var a=Ha(i,e,n);null===(r=i.doc)||void 0===r||r.transact((function(){qa(i,t,a)}),o)},removeStoredPosition:function(e,t){var n,r=e.sharedRoot,i=e.positionStorageOrigin;Fa(r),null===(n=r.doc)||void 0===n||n.transact((function(){!function(e,t){e.removeAttribute(Va+t)}(r,t)}),i)},position:function(e,t){var n=function(e,t){var n=e.getAttribute(Va+t);return n?fi(n):null}(e.sharedRoot,t);if(n)return Ua(e.sharedRoot,e,n)},storedPositionsRelative:function(e){return t=e.sharedRoot,Object.fromEntries(Object.entries(t.getAttributes()).filter((function(e){return m(e,1)[0].startsWith(Va)})).map((function(e){var t,n,r=m(e,2),i=r[0],o=r[1];return[i.slice(Va.length),(t=o,new si(null==t.type?null:ni(t.type.client,t.type.clock),null!==(n=t.tname)&&void 0!==n?n:null,null==t.item?null:ni(t.item.client,t.item.clock),null==t.assoc?0:t.assoc))]})));var t}};function us(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.localOrigin,o=r.positionStorageOrigin,a=r.autoConnect,s=void 0!==a&&a,l=e;l.sharedRoot=t,l.editorWindow=n,l.localOrigin=null!=i?i:rs,l.positionStorageOrigin=null!=o?o:is,l.applyRemoteEvents=function(e,t){ls.flushLocalChanges(l),ue.withoutNormalizing(l,(function(){ls.withOrigin(l,t,(function(){$a(l.sharedRoot,l,e)}))}))},l.isLocalOrigin=function(e){return e===l.localOrigin};var u=function(e,t){l.isLocalOrigin(t.origin)||ls.applyRemoteEvents(l,e,t.origin)},c=null;s&&(c=setTimeout((function(){c=null,ls.connect(l)}))),l.connect=function(){if(ls.connected(l))throw new Error("already connected");l.sharedRoot.observeDeep(u);var t=La(l.sharedRoot);l.children=t.children,ss.add(l),ue.normalize(e,{force:!0}),e.operations.length||e.onChange()},l.disconnect=function(){c&&clearTimeout(c),ls.flushLocalChanges(l),l.sharedRoot.unobserveDeep(u),ss.delete(l)},l.storeLocalChange=function(t){as.set(l,[].concat(p(ls.localChanges(l)),[{op:t,doc:e.children,origin:ls.origin(l)}]))},l.flushLocalChanges=function(){Fa(l.sharedRoot);var e=ls.localChanges(l);as.delete(l);var t=[];e.forEach((function(e){var n=t[t.length-1];if(n&&n[0].origin===e.origin)return n.push(e);t.push([e])})),t.forEach((function(e){var t;Fa(l.sharedRoot),null===(t=l.sharedRoot.doc)||void 0===t||t.transact((function(){e.forEach((function(e){Fa(l.sharedRoot),function(e,t,n){var r=ns[n.type];if(!r)throw new Error("Unknown operation: ".concat(n.type));r(e,t,n)}(l.sharedRoot,{children:e.doc},e.op)}))}),e[0].origin)}))};var h=l.apply,f=l.onChange;return l.apply=function(e){ls.connected(l)&&ls.isLocal(l)&&ls.storeLocalChange(l,e),h(e)},l.onChange=function(){ls.connected(l)&&ls.flushLocalChanges(l),f()},l}var cs=new WeakMap,hs=Symbol("slate-yjs-history-without-saving");function fs(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.withoutSavingOrigin,o=void 0===r?hs:r,s=n.trackedOrigins,l=void 0===s?new Set([e.localOrigin]):s,u=i(n,t),c=e,h=new Di(c.sharedRoot,a({trackedOrigins:l},u));c.undoManager=h,c.withoutSavingOrigin=o;var f=c.onChange,d=c.isLocalOrigin;c.onChange=function(){f(),cs.set(c,c.selection&&Za(c.sharedRoot,c,c.selection))},c.isLocalOrigin=function(e){return e===c.withoutSavingOrigin||d(e)};var g=function(e){var t=e.stackItem;t.meta.set("selection",c.selection&&Za(c.sharedRoot,c,c.selection)),t.meta.set("selectionBefore",cs.get(c))},v=function(e){e.stackItem.meta.set("selection",c.selection&&Za(c.sharedRoot,c,c.selection))},p=function(e){var t=e.stackItem,n="undo"===e.type?c.undoManager.redoStack:c.undoManager.undoStack,r=n[n.length-1];r&&(r.meta.set("selection",t.meta.get("selectionBefore")),r.meta.set("selectionBefore",t.meta.get("selection")));var i=t.meta.get("selectionBefore");if(i){var o=Xa(c.sharedRoot,c,i);o&&ge.select(c,o)}},y=c.connect,m=c.disconnect;return c.connect=function(){y(),c.undoManager.on("stack-item-added",g),c.undoManager.on("stack-item-popped",p),c.undoManager.on("stack-item-updated",v)},c.disconnect=function(){c.undoManager.off("stack-item-added",g),c.undoManager.off("stack-item-popped",p),c.undoManager.off("stack-item-updated",v),m()},c.undo=function(){ls.connected(c)&&(ls.flushLocalChanges(c),c.undoManager.undo())},c.redo=function(){ls.connected(c)&&(ls.flushLocalChanges(c),c.undoManager.redo())},c}var ds=new WeakMap,gs=new xe,vs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.selection;e.sendCursorPosition(t)},ps=function(e,t){e.sendCursorData(t)},ys=function(e,t,n){var r;if("change"===t){var i=null!==(r=ds.get(e))&&void 0!==r?r:new Set;i.add(n),ds.set(e,i)}},ms=function(e,t,n){if("change"===t){var r=ds.get(e);r&&r.delete(n)}},ws=function(e,t){var n;if(t===e.awareness.clientID||!ls.connected(e))return null;var r=e.awareness.getStates().get(t);return r?{relativeSelection:null!==(n=r[e.selectionStateField])&&void 0!==n?n:null,data:r[e.cursorDataField],clientId:t}:null},bs=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gs.emit.apply(gs,[e].concat(n))},ks=function(e,t){gs.on(e,t)},xs=function(){gs.reset()};function Cs(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.cursorStateField,i=void 0===r?"selection":r,o=n.cursorDataField,a=void 0===o?"data":o,s=n.autoSend,l=void 0===s||s,u=n.data,c=e;c.awareness=t,c.cursorDataField=a,c.selectionStateField=i,c.sendCursorData=function(e){c.awareness.setLocalStateField(c.cursorDataField,e)},c.sendCursorPosition=function(e){var t=c.awareness.getLocalState(),n=null==t?void 0:t[i];if(e){var r=Za(c.sharedRoot,c,e),o=r.anchor,a=r.focus;n&&gi(o,n)&&gi(a,n)||c.awareness.setLocalStateField(c.selectionStateField,{anchor:o,focus:a})}else n&&c.awareness.setLocalStateField(c.selectionStateField,null)};var h=function(e){var t=ds.get(c);if(t){var n=c.awareness.clientID,r={added:e.added.filter((function(e){return e!==n})),removed:e.removed.filter((function(e){return e!==n})),updated:e.updated.filter((function(e){return e!==n}))};(r.added.length>0||r.removed.length>0||r.updated.length>0)&&t.forEach((function(e){return e(r)}))}},f=c.connect,d=c.disconnect;return c.connect=function(){if(f(),c.awareness.on("change",h),h({removed:[],added:Array.from(c.awareness.getStates().keys()),updated:[]}),l){u&&ps(c,u);var e=c.onChange;c.onChange=function(){e(),ls.connected(c)&&(vs(c),bs("updateCursor"))}}},c.disconnect=function(){c.awareness.off("change",h),xs(),h({removed:Array.from(c.awareness.getStates().keys()),added:[],updated:[]}),d()},c}function Es(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Ss(e){var t=Es(e);return new RegExp("(".concat(t,").+?(").concat(t,")$"))}function _s(e){var t=Es(e);return new RegExp("^(".concat(t,")$"))}function As(e){return function(t,n){ge.setNodes(t,{type:e},{match:function(e){return ue.isBlock(t,e)},at:n})}}function Ms(e){return function(t,n){ge.insertNodes(t,{text:" "},{match:he.isText,at:ve.end(n),select:!0}),ge.setNodes(t,O({},e,!0),{match:he.isText,at:n,split:!0})}}var Ps,Os=[{trigger:_s("#"),apply:As("heading-one")},{trigger:_s("##"),apply:As("heading-two")},{trigger:_s(">"),apply:As("block-quote")},{trigger:Ss("`"),apply:(Ps="inline-code",function(e,t){var n=ue.rangeRef(e,t);ge.unwrapNodes(e,{at:t,match:function(t){return ue.isInline(e,t)},mode:"all",split:!0}),n.current&&ge.insertNodes(e,{text:" "},{match:he.isText,at:ve.end(n.current),select:!0});var r=n.unref();r&&ge.wrapNodes(e,{type:Ps,children:[]},{at:r,split:!0})})},{trigger:Ss("**"),apply:Ms("bold")},{trigger:Ss("__"),apply:Ms("bold")},{trigger:Ss("*"),apply:Ms("italic")},{trigger:Ss("_"),apply:Ms("italic")},{trigger:Ss("~~"),apply:Ms("strikethrough")}];function Ts(e,t,n){if(t.offset>=n)return{offset:t.offset-n,path:t.path};var r=ue.previous(e,{at:t.path,match:he.isText});if(r){var i=m(r,2),o=i[0],a=i[1];return Ts(e,{offset:o.text.length,path:a},n-t.offset)}}function Ls(e){var t=e.deleteBackward,n=e.insertText,r=e.isInline,i=e.insertBreak;return e.insertText=function(t){var r=e.selection;if(" "!==t||!r||!ve.isCollapsed(r))return n(t);for(var i,o=r.anchor,a=ue.above(e,{match:function(t){return ue.isBlock(e,t)}}),s=a?a[1]:[],l={anchor:o,focus:ue.start(e,s)},u=ue.string(e,l),c=function(){var t=f[h],n=t.trigger,r=t.apply,i=n.exec(u);if(!i)return 0;var a=m(i,3),s=a[0],l=a[1],c=a[2];return ue.withoutNormalizing(e,(function(){var t=o,n=c&&Ts(e,t,c.length),i=l&&Ts(e,t,s.length-l.length),a=Ts(e,t,s.length);if(t&&a){var u=ue.rangeRef(e,{anchor:a,focus:t});n&&ge.delete(e,{at:{anchor:n,focus:t}}),i&&ge.delete(e,{at:{anchor:a,focus:i}});var h=u.unref();h&&r(e,h)}})),{v:void 0}},h=0,f=Os;h<f.length;h++)if(0!==(i=c())&&i)return i.v;n(t)},e.insertBreak=function(){var t=e.selection;if(pe.getSelectedNodeByType(e,"layout"))i();else if(t){var n=ue.above(e,{match:function(t){return ue.isBlock(e,t)}}),r=n?n[1]:[],o=ue.end(e,r),a=ye.equals(o,ve.end(t));if(ge.splitNodes(e,{always:!0}),a){var s;ge.unwrapNodes(e,{match:function(t){return ue.isInline(e,t)},mode:"all"}),ge.setNodes(e,{type:"paragraph"},{match:function(t){return ue.isBlock(e,t)}});var l=null!==(s=ue.marks(e))&&void 0!==s?s:{};ge.unsetNodes(e,Object.keys(l),{match:he.isText})}}},e.deleteBackward=function(){if(pe.getSelectedNodeByType(e,"layout"))t.apply(void 0,arguments);else{var n=e.selection;if(n&&ve.isCollapsed(n)){var r=ue.above(e,{match:function(t){return ue.isBlock(e,t)}});if(r){var i=m(r,2),o=i[0],a=i[1],s=ue.start(e,a);if(!ue.isEditor(o)&&ce.isElement(o)&&"paragraph"!==o.type&&ye.equals(n.anchor,s)){return void ge.setNodes(e,{type:"paragraph"})}}t.apply(void 0,arguments)}}},e.isInline=function(e){return ce.isElement(e)&&"inline-code"===e.type||r(e)},e}function js(e){var t=e.normalizeNode;return e.normalizeNode=function(n){var r=m(n,1)[0];if(!ue.isEditor(r)||r.children.length>0)return t(n);ge.insertNodes(e,{type:"paragraph",children:[{text:""}]},{at:[0]})},e}var Ns=function(){function e(){A(this,e)}return P(e,null,[{key:"getThemeVar",value:function(){var e=document.documentElement;return e?getComputedStyle(e).getPropertyValue("--ibiz-color-primary"):null}},{key:"isChineseCharacter",value:function(e){return/[\u4e00-\u9fa5]/.test(e)}},{key:"hasChineseAndEnglish",value:function(e){return/[\u4e00-\u9fa5]+.*[a-zA-Z]+|[a-zA-Z]+.*[\u4e00-\u9fa5]+/.test(e)}},{key:"stringToHexColor",value:function(e){if(!e)return"";for(var t=0,n=0;n<e.length;n++){if(this.isChineseCharacter(e))t=e.charCodeAt(n)+((t<<5)-t),t&=t;else t+=e.charCodeAt(n).toString(16)}var r=String(t).substring(0,6),i=parseInt(r.substring(0,2),16),o=parseInt(r.substring(2,4),16),a=parseInt(r.substring(4,6),16);i<0&&(i=10),o<0&&(o=10),a<0&&(a=10);var s="#".concat(i.toString(16).padStart(2,"0")).concat(o.toString(16).padStart(2,"0")).concat(a.toString(16).padStart(2,"0"));return"#FFFFFF"===s&&this.getThemeVar()||s}},{key:"avatarName",value:function(e){if(e&&e.toString().length<2)return e;if(e&&e.toString().length>=2){if(this.hasChineseAndEnglish(e)){var t=e.split("").find((function(e){return/[a-zA-Z]/.test(e)}))||"",n=e.split("").find((function(e){return/[\u4E00-\u9FA5]/.test(e)}))||"";return"".concat(t).concat(n).toLowerCase()}return/[a-zA-Z]/.test(e)?e.split("").filter((function(e){return/[a-zA-Z]/.test(e)})).slice(0,2).join("").toUpperCase():/[\u4E00-\u9FA5]/.test(e)?e.split("").filter((function(e){return/[\u4E00-\u9FA5]/.test(e)})).slice(-2).join(""):e.replaceAll(" ","").substring(0,2)}}},{key:"getEmojiCustomHtml",value:function(e){return e.replaceAll(/{"emoji":"(.+?)"}/g,(function(e,t){var n=decodeURIComponent(atob(t));return'<span class="emoji-tag">'.concat(n,"</span>")})).replaceAll(/<span data-w-e-type="emoji" class='emoji'>(.+?)<\/span>/g,(function(e,t){var n=decodeURIComponent(atob(t));return"<span data-w-e-type=\"emoji\" class='emoji'>".concat(n,"</span>")}))}}]),e}();function Rs(e,t){return e+Math.round(255*Math.min(Math.max(t,0),1)).toString(16).toUpperCase()}var Ds=globalThis.Text,Is=function(e){var t,n;return null!==(t=null==e||null===(n=e.ownerDocument)||void 0===n?void 0:n.defaultView)&&void 0!==t?t:null},Bs=function(e){return function(e){var t=Is(e);return!!t&&e instanceof t.Node}(e)&&1===e.nodeType};function zs(e,t){var n,r=m(ue.node(e,t.path),1)[0],i=e.toDOMNode(r);ue.void(e,{at:t})&&(t={path:t.path,offset:0});for(var o=Array.from(i.querySelectorAll("[data-slate-string], [data-slate-zero-width]")),a=0,s=0;s<o.length;s++){var l=o[s],u=l.childNodes[0];if(null!=u&&null!=u.textContent){var c=u.textContent.length,h=l.getAttribute("data-slate-length"),f=a+(null==h?c:parseInt(h,10)),d=o[s+1];if(t.offset===f&&null!=d&&d.hasAttribute("data-slate-mark-placeholder")){var g,v=d.childNodes[0];n=[v instanceof Ds?v:d,null!==(g=d.textContent)&&void 0!==g&&g.startsWith("\ufeff")?1:0];break}if(t.offset<=f){n=[u,Math.min(c,Math.max(0,t.offset-a))];break}a=f}}if(!n)throw new Error("Cannot resolve a DOM point from Slate point: ".concat(JSON.stringify(t)));return n}function Fs(e,t){try{return function(e,t){var n=t.anchor,r=t.focus,i=ve.isBackward(t),o=zs(e,n),a=ve.isCollapsed(t)?o:zs(e,r),s=e.editorWindow.document.createRange(),l=m(i?a:o,2),u=l[0],c=l[1],h=m(i?o:a,2),f=h[0],d=h[1],g=!!(Bs(u)?u:u.parentElement).getAttribute("data-slate-zero-width"),v=!!(Bs(f)?f:f.parentElement).getAttribute("data-slate-zero-width");return s.setStart(u,g?1:c),s.setEnd(f,v?1:d),s}(e,t)}catch(Kk){return null}}var Vs=new WeakMap;function Hs(e,t){if(!t.relativeSelection||!e)return null;var n=Vs.get(e.children);n||(n=new WeakMap,Vs.set(e.children,n));var r=n.get(t);if(void 0===r)try{r=Xa(e.sharedRoot,e,t.relativeSelection),n.set(t,r)}catch(Kk){return null}return r}var Us=d({name:"CursorCaret",props:{data:{type:Object,required:!0},caretPosition:Object},setup:function(e){return{ns:re("cursor-caret"),caretStyle:I((function(){return a(a({},e.caretPosition),{},{background:e.data.color})})),labelStyle:I((function(){return{transform:"translateY(-100%)",background:e.data.color}}))}},render:function(){return N("div",{style:this.caretStyle,class:this.ns.b()},[N("div",{class:this.ns.e("text"),style:this.labelStyle},[this.data.name])])}}),qs=d({name:"CursorSelection",props:{data:Object,selectionRects:Array,caretPosition:Object},setup:function(e){return{ns:re("cursor-selection"),selectionStyle:I((function(){return{backgroundColor:Rs(e.data.color,.5)}}))}},render:function(){var e,t=this;return this.data?N(B,null,[null===(e=this.selectionRects)||void 0===e?void 0:e.map((function(e,n){return N("div",{style:a(a({},t.selectionStyle),e),class:t.ns.b(),key:n},null)})),this.caretPosition&&N(Us,{caretPosition:this.caretPosition,data:this.data},null)]):null}});var Gs=Object.freeze([]);function Js(e){var t,n=e.slateYjs,r=e.containerRef,i=e.shouldGenerateOverlay,o=!("refreshOnResize"in e)||(null===(t=e.refreshOnResize)||void 0===t||t),s=new Map,l=C({}),u=function(){var e,t,o;if((!r||r.value)&&n.yjsEditor){var a=null==r||null===(e=r.value)||void 0===e?void 0:e.getBoundingClientRect(),u=null!==(t=null==a?void 0:a.x)&&void 0!==t?t:0,c=null!==(o=null==a?void 0:a.y)&&void 0!==o?o:0,h=Object.keys(l.value).length!==Object.keys(n.cursorStates).length,f=Object.fromEntries(Object.entries(n.cursorStates).map((function(e){var t=m(e,2),r=t[0],o=t[1],a=o.relativeSelection&&Hs(n.yjsEditor,o);if(!a)return[r,Gs];var l=s.get(a);if(l)return[r,l];var f=function(e,t,n){var r=n.yOffset,i=n.xOffset,o=n.shouldGenerateOverlay,a=m(ve.edges(t),2),s=a[0],l=a[1],u=Fs(e,t);if(!u)return{caretPosition:null,selectionRects:[]};var c,h=[],f=ue.nodes(e,{at:t,match:function(e,t){return he.isText(e)&&(!o||o(e,t))}}),d=null,g=ve.isBackward(t),v=k(f);try{for(v.s();!(c=v.n()).done;){var p=m(c.value,2),y=p[0],w=p[1],b=e.toDOMNode(y),x=de.equals(w,s.path),C=de.equals(w,l.path),E=null;if(x||C){var S=document.createRange();S.selectNode(b),x&&S.setStart(u.startContainer,u.startOffset),C&&S.setEnd(u.endContainer,u.endOffset),E=S.getClientRects()}else E=b.getClientRects();for(var _=g?x:C,A=0;A<E.length;A++){var M=E.item(A);if(M){var P=_&&(g?0===A:A===E.length-1),O=M.top-r,T=M.left-i;P&&(d={height:"".concat(M.height,"px"),top:"".concat(O,"px"),left:"".concat(T+(g||ve.isCollapsed(t)?0:M.width),"px")}),h.push({width:"".concat(M.width,"px"),height:"".concat(M.height,"px"),top:"".concat(O,"px"),left:"".concat(T,"px")})}}}}catch(L){v.e(L)}finally{v.f()}return{selectionRects:h,caretPosition:d}}(n.yjsEditor,a,{xOffset:u,yOffset:c,shouldGenerateOverlay:i});return h=!0,s.set(a,f),[r,f]})));h&&(l.value=f)}},c=function(){s.clear(),u()};return o&&function(e,t){var n=null;L((function(){e.value&&(n=new ResizeObserver((function(){t()}))).observe(e.value)})),z((function(){n&&e.value&&n.unobserve(e.value)}))}(r,c),ks("updateCursor",Se(u,0)),M((function(){return n.cursorStates}),(function(){return u()}),{deep:!0,immediate:!0}),{overlayData:I((function(){return Object.entries(n.cursorStates).map((function(e){var t,r,i=m(e,2),o=i[0],s=i[1],u=s.relativeSelection&&Hs(n.yjsEditor,s),c=l.value[o];return a(a({},s),{},{range:u,caretPosition:null!==(t=null==c?void 0:c.caretPosition)&&void 0!==t?t:null,selectionRects:null!==(r=null==c?void 0:c.selectionRects)&&void 0!==r?r:Gs})}))})),refresh:c}}var Ws=d({name:"CursorOverlay",props:{slateYjs:{type:Object,required:!0}},setup:function(e){var t=re("cursor-overlay"),n=C();return{ns:t,overlayData:Js({slateYjs:e.slateYjs,containerRef:n}).overlayData,containerRef:n}},render:function(){var e,t;return N("div",{class:this.ns.b(),ref:"containerRef"},[null===(e=(t=this.$slots).default)||void 0===e?void 0:e.call(t),this.overlayData.map((function(e){return N(qs,F({key:e.clientId},e),null)}))])}}),Ys=function(){function e(t,n,r,i){A(this,e),O(this,"collaborateUrl","/portal/collaborate"),O(this,"readyState",void 0),O(this,"evt",new xe),O(this,"client",void 0),O(this,"options",{connectTimeout:6e3,clientId:ke(),username:"",password:"",keepalive:60,clean:!0}),this.id=t,this.mqttTopic=n,this.token=r,this.appId=i,this.options.username=n,this.options.password=r,this.readyState=0}var t;return P(e,[{key:"send",value:function(e){ibiz.net.post("".concat(this.collaborateUrl,"/ROOM/").concat(this.id),{data:e})}},{key:"connect",value:(t=_(E().mark((function e(){var t,n,r,i,o=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.import("./mqtt.min.legacy.js").then((function(e){return e.m}));case 2:t=e.sent,n=t.default?t.default:t,r=window,i=r.location,this.client=n.connect("ws://".concat(i.host).concat(ibiz.env.baseUrl,"/").concat(this.appId).concat(ibiz.env.mqttUrl),this.options),this.client.on("connect",(function(){o.client.subscribe(o.mqttTopic),o.readyState=1,o.evt.emit("connect"),ibiz.log.debug("collaborate connect")})),this.client.on("error",(function(e){o.readyState=3,o.evt.emit("error",e),ibiz.log.debug("collaborate error")})),this.client.on("message",(function(e,t){var n=JSON.parse(t.toString());n&&n.data&&n.data.data&&n.data.data.data&&o.evt.emit("message",new Uint8Array(Object.values(n.data.data.data))),ibiz.log.debug("collaborate message")})),this.client.on("reconnect",(function(){o.readyState=0,o.evt.emit("reconnect")})),this.client.on("close",(function(){o.readyState=3,o.evt.emit("close"),ibiz.log.debug("collaborate close")}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){var e;null===(e=this.client)||void 0===e||e.end(),this.evt.reset()}}]),e}(),Zs=function(){return new Map},Xs=function(e,t,n){var r=e.get(t);return void 0===r&&e.set(t,r=n()),r},Ks=String.fromCharCode,$s=/^\s*/g,Qs=/([A-Z])/g,el=function(e,t){return function(e){return e.replace($s,"")}(e.replace(Qs,(function(e){return"".concat(t).concat(function(e){return e.toLowerCase()}(e))})))},tl="undefined"!=typeof TextEncoder?new TextEncoder:null,nl=tl?function(e){return tl.encode(e)}:function(e){for(var t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.codePointAt(i);return r},rl="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});rl&&1===rl.decode(new Uint8Array).length&&(rl=null);var il=function(e){return void 0===e?null:e},ol=new(function(){function e(){A(this,e),this.map=new Map}return P(e,[{key:"setItem",value:function(e,t){this.map.set(e,t)}},{key:"getItem",value:function(e){return this.map.get(e)}}]),e}()),al=!0;try{"undefined"!=typeof localStorage&&(ol=localStorage,al=!1)}catch(Kk){}var sl,ll,ul=ol,cl="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name),hl="undefined"!=typeof window&&!cl,fl=function(e){return function(){if(void 0===sl)if(cl){sl=Zs();for(var e=process.argv,t=null,n=0;n<e.length;n++){var r=e[n];"-"===r[0]?(null!==t&&sl.set(t,""),t=r):null!==t&&(sl.set(t,r),t=null)}null!==t&&sl.set(t,"")}else"object"===("undefined"==typeof location?"undefined":v(location))?(sl=Zs(),(location.search||"?").slice(1).split("&").forEach((function(e){if(0!==e.length){var t=m(e.split("="),2),n=t[0],r=t[1];sl.set("--".concat(el(n,"-")),r),sl.set("-".concat(el(n,"-")),r)}}))):sl=Zs();return sl}().has(e)};fl("--"+(ll="production"))||function(e){il(cl?process.env[e.toUpperCase()]:ul.getItem(e))}(ll);var dl=Math.floor,gl=function(e,t){return e<t?e:t},vl=Math.pow,pl=127,yl=Number.MAX_SAFE_INTEGER,ml=P((function e(){A(this,e),this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]})),wl=function(){return new ml},bl=function(e){for(var t=e.cpos,n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},kl=function(e){for(var t=new Uint8Array(bl(e)),n=0,r=0;r<e.bufs.length;r++){var i=e.bufs[r];t.set(i,n),n+=i.length}return t.set(Nl(e.cbuf.buffer,0,e.cpos),n),t},xl=function(e,t){var n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},Cl=function(e,t){for(;t>pl;)xl(e,128|pl&t),t=dl(t/128);xl(e,pl&t)},El=new Uint8Array(3e4),Sl=El.length/3,_l=tl?function(e,t){if(t.length<Sl){var n=tl.encodeInto(t,El).written||0;Cl(e,n);for(var r=0;r<n;r++)xl(e,El[r])}else Al(e,nl(t))}:function(e,t){var n=unescape(encodeURIComponent(t)),r=n.length;Cl(e,r);for(var i=0;i<r;i++)xl(e,n.codePointAt(i))},Al=function(e,t){Cl(e,t.byteLength),function(e,t){var n,r,i=e.cbuf.length,o=e.cpos,a=gl(i-o,t.length),s=t.length-a;e.cbuf.set(t.subarray(0,a),o),e.cpos+=a,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array((n=2*i)>(r=s)?n:r),e.cbuf.set(t.subarray(a)),e.cpos=s)}(e,t)},Ml=P((function e(t){A(this,e),this.arr=t,this.pos=0})),Pl=function(e){return new Ml(e)},Ol=function(e){return function(e,t){var n=Nl(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n}(e,Ll(e))},Tl=function(e){return e.arr[e.pos++]},Ll=function(e){for(var t=0,n=1;;){var r=e.arr[e.pos++];if(t+=(r&pl)*n,n*=128,r<128)return t;if(t>yl)throw new Error("Integer out of range!")}},jl=rl?function(e){return rl.decode(Ol(e))}:function(e){var t=Ll(e);if(0===t)return"";var n=String.fromCodePoint(Tl(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(Tl(e));else for(;t>0;){var r=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,i),t-=r}return decodeURIComponent(escape(n))},Nl=function(e,t,n){return new Uint8Array(e,t,n)},Rl=hl?function(e){for(var t="",n=0;n<e.byteLength;n++)t+=Ks(e[n]);return btoa(t)}:function(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64")},Dl=hl?function(e){for(var t,n=atob(e),r=(t=n.length,new Uint8Array(t)),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}:function(e){var t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},Il=new Map,Bl="undefined"==typeof BroadcastChannel?function(){function e(t){var n,r=this;A(this,e),this.room=t,this.onmessage=null,n=function(e){return e.key===t&&null!==r.onmessage&&r.onmessage({data:Dl(e.newValue||"")})},al||addEventListener("storage",n)}return P(e,[{key:"postMessage",value:function(e){ul.setItem(this.room,Rl(new Uint8Array(e)))}}]),e}():BroadcastChannel,zl=function(e){return Xs(Il,e,(function(){var t=new Set,n=new Bl(e);return n.onmessage=function(e){return t.forEach((function(t){return t(e.data,"broadcastchannel")}))},{bc:n,subs:t}}))},Fl=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=zl(e);r.bc.postMessage(t),r.subs.forEach((function(e){return e(t,n)}))},Vl=Date.now,Hl=function(e,t){Cl(e,0);var n=function(e){return Yr(e,new Br)}(t);Al(e,n)},Ul=function(e,t,n){Cl(e,1),Al(e,function(e,t){return Gr(e,t,new zr)}(t,n))},ql=function(e,t,n){try{!function(e,t,n){qr(e,t,n,Dr)}(t,Ol(e),n)}catch(r){console.error("Caught error while handling a Yjs update",r)}},Gl=ql,Jl=function(e,t,n,r){var i=Ll(e);switch(i){case 0:!function(e,t,n){Ul(t,n,Ol(e))}(e,t,n);break;case 1:ql(e,n,r);break;case 2:Gl(e,n,r);break;default:throw new Error("Unknown message type")}return i},Wl=function(){return new Set},Yl=Array.from,Zl=function(){function e(){A(this,e),this._observers=Zs()}return P(e,[{key:"on",value:function(e,t){Xs(this._observers,e,Wl).add(t)}},{key:"once",value:function(e,t){var n=this;this.on(e,(function r(){n.off(e,r),t.apply(void 0,arguments)}))}},{key:"off",value:function(e,t){var n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}},{key:"emit",value:function(e,t){return Yl((this._observers.get(e)||Zs()).values()).forEach((function(e){return e.apply(void 0,p(t))}))}},{key:"destroy",value:function(){this._observers=Zs()}}]),e}(),Xl=Object.keys,Kl=function(e){return Xl(e).length},$l=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Ql=function e(t,n){if(null==t||null==n)return function(e,t){return e===t}(t,n);if(t.constructor!==n.constructor)return!1;if(t===n)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),n=new Uint8Array(n);case Uint8Array:if(t.byteLength!==n.byteLength)return!1;for(var r=0;r<t.length;r++)if(t[r]!==n[r])return!1;break;case Set:if(t.size!==n.size)return!1;var i,o=k(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!n.has(a))return!1}}catch(f){o.e(f)}finally{o.f()}break;case Map:if(t.size!==n.size)return!1;var s,l=k(t.keys());try{for(l.s();!(s=l.n()).done;){var u=s.value;if(!n.has(u)||!e(t.get(u),n.get(u)))return!1}}catch(f){l.e(f)}finally{l.f()}break;case Object:if(Kl(t)!==Kl(n))return!1;for(var c in t)if(!$l(t,c)||!e(t[c],n[c]))return!1;break;case Array:if(t.length!==n.length)return!1;for(var h=0;h<t.length;h++)if(!e(t[h],n[h]))return!1;break;default:return!1}return!0},eu=3e4,tu=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this)).doc=e,r.clientID=e.clientID,r.states=new Map,r.meta=new Map,r._checkInterval=setInterval((function(){var e=Vl();null!==r.getLocalState()&&15e3<=e-r.meta.get(r.clientID).lastUpdated&&r.setLocalState(r.getLocalState());var t=[];r.meta.forEach((function(n,i){i!==r.clientID&&eu<=e-n.lastUpdated&&r.states.has(i)&&t.push(i)})),t.length>0&&nu(f(r),t,"timeout")}),dl(3e3)),e.on("destroy",(function(){r.destroy()})),r.setLocalState({}),r}return P(n,[{key:"destroy",value:function(){this.emit("destroy",[this]),this.setLocalState(null),s(g(n.prototype),"destroy",this).call(this),clearInterval(this._checkInterval)}},{key:"getLocalState",value:function(){return this.states.get(this.clientID)||null}},{key:"setLocalState",value:function(e){var t=this.clientID,n=this.meta.get(t),r=void 0===n?0:n.clock+1,i=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:r,lastUpdated:Vl()});var o=[],a=[],s=[],l=[];null===e?l.push(t):null==i?null!=e&&o.push(t):(a.push(t),Ql(i,e)||s.push(t)),(o.length>0||s.length>0||l.length>0)&&this.emit("change",[{added:o,updated:s,removed:l},"local"]),this.emit("update",[{added:o,updated:a,removed:l},"local"])}},{key:"setLocalStateField",value:function(e,t){var n=this.getLocalState();null!==n&&this.setLocalState(a(a({},n),{},O({},e,t)))}},{key:"getStates",value:function(){return this.states}}]),n}(Zl),nu=function(e,t,n){for(var r=[],i=0;i<t.length;i++){var o=t[i];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){var a=e.meta.get(o);e.meta.set(o,{clock:a.clock+1,lastUpdated:Vl()})}r.push(o)}}r.length>0&&(e.emit("change",[{added:[],updated:[],removed:r},n]),e.emit("update",[{added:[],updated:[],removed:r},n]))},ru=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.states,r=t.length,i=wl();Cl(i,r);for(var o=0;o<r;o++){var a=t[o],s=n.get(a)||null,l=e.meta.get(a).clock;Cl(i,a),Cl(i,l),_l(i,JSON.stringify(s))}return kl(i)},iu=[];iu[0]=function(e,t,n,r,i){Cl(e,0);var o=Jl(t,e,n.doc,n);r&&1===o&&!n.synced&&(n.synced=!0)},iu[3]=function(e,t,n,r,i){Cl(e,1),Al(e,ru(n.awareness,Array.from(n.awareness.getStates().keys())))},iu[1]=function(e,t,n,r,i){!function(e,t,n){for(var r=Pl(t),i=Vl(),o=[],a=[],s=[],l=[],u=Ll(r),c=0;c<u;c++){var h=Ll(r),f=Ll(r),d=JSON.parse(jl(r)),g=e.meta.get(h),v=e.states.get(h),p=void 0===g?0:g.clock;(p<f||p===f&&null===d&&e.states.has(h))&&(null===d?h===e.clientID&&null!=e.getLocalState()?f++:e.states.delete(h):e.states.set(h,d),e.meta.set(h,{clock:f,lastUpdated:i}),void 0===g&&null!==d?o.push(h):void 0!==g&&null===d?l.push(h):null!==d&&(Ql(d,v)||s.push(h),a.push(h)))}(o.length>0||s.length>0||l.length>0)&&e.emit("change",[{added:o,updated:s,removed:l},n]),(o.length>0||a.length>0||l.length>0)&&e.emit("update",[{added:o,updated:a,removed:l},n])}(n.awareness,Ol(t),n)},iu[2]=function(e,t,n,r,i){!function(e,t,n){0===Ll(e)&&n(t,jl(e))}(t,n.doc,(function(e,t){return ou(n,t)}))};var ou=function(e,t){return console.warn("Permission denied to access ".concat(e.url,".\n").concat(t))},au=function(e,t,n){var r=Pl(t),i=wl(),o=Ll(r),a=e.messageHandlers[o];return a?a(i,r,e,n,o):console.error("Unable to compute message"),i},su=function e(t){if(t.shouldConnect&&null===t.ws){var n=t._WS;t.ws=n,t.wsconnecting=!0,t.wsconnected=!1,t.synced=!1,n.evt.on("message",(function(e){t.wsLastMessageReceived=Vl();var r=au(t,e,!0);bl(r)>1&&n.send(kl(r))})),n.evt.on("error",(function(e){t.emit("connection-error",[e,t])})),n.evt.on("close",(function(n){t.emit("connection-close",[n,t]),t.ws=null,t.wsconnecting=!1,t.wsconnected?(t.wsconnected=!1,t.synced=!1,nu(t.awareness,Array.from(t.awareness.getStates().keys()).filter((function(e){return e!==t.doc.clientID})),t),t.emit("status",[{status:"disconnected"}])):t.wsUnsuccessfulReconnects++,setTimeout(e,gl(100*vl(2,t.wsUnsuccessfulReconnects),t.maxBackoffTime),t)})),n.evt.on("connect",(function(){t.wsLastMessageReceived=Vl(),t.wsconnecting=!1,t.wsconnected=!0,t.wsUnsuccessfulReconnects=0,t.emit("status",[{status:"connected"}]);var e=wl();if(Cl(e,0),Hl(e,t.doc),n.send(kl(e)),null!==t.awareness.getLocalState()){var r=wl();Cl(r,1),Al(r,ru(t.awareness,[t.doc.clientID])),n.send(kl(r))}})),t.emit("status",[{status:"connecting"}])}},lu=function(e,t){var n=e.ws;e.wsconnected&&n&&1===n.readyState&&n.send(t),e.bcconnected&&Fl(e.bcChannel,t,e)},uu=function(e){l(n,e);var t=c(n);function n(e,r,i){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a.connect,l=void 0===s||s,u=a.awareness,c=void 0===u?new tu(i):u,h=a.params,d=void 0===h?{}:h,g=a.protocols,v=void 0===g?[]:g,p=a.WebSocketPolyfill,y=a.resyncInterval,m=void 0===y?-1:y,w=a.maxBackoffTime,b=void 0===w?2500:w,k=a.disableBc,x=void 0!==k&&k;for(A(this,n),o=t.call(this);"/"===e[e.length-1];)e=e.slice(0,e.length-1);return o.serverUrl=e,o.bcChannel=e+"/"+r,o.maxBackoffTime=b,o.params=d,o.protocols=v,o.roomname=r,o.doc=i,o._WS=p,o.awareness=c,o.wsconnected=!1,o.wsconnecting=!1,o.bcconnected=!1,o.disableBc=x,o.wsUnsuccessfulReconnects=0,o.messageHandlers=iu.slice(),o._synced=!1,o.ws=null,o.wsLastMessageReceived=0,o.shouldConnect=l,o._resyncInterval=0,m>0&&(o._resyncInterval=setInterval((function(){if(o.ws&&1===o.ws.readyState){var e=wl();Cl(e,0),Hl(e,i),o.ws.send(kl(e))}}),m)),o._bcSubscriber=function(e,t){if(t!==f(o)){var n=au(f(o),new Uint8Array(e),!1);bl(n)>1&&Fl(o.bcChannel,kl(n),f(o))}},o._updateHandler=function(e,t){if(t!==f(o)){var n=wl();Cl(n,0),function(e,t){Cl(e,2),Al(e,t)}(n,e),lu(f(o),kl(n))}},o.doc.on("update",o._updateHandler),o._awarenessUpdateHandler=function(e,t){var n=e.added,r=e.updated,i=e.removed,a=n.concat(r).concat(i),s=wl();Cl(s,1),Al(s,ru(c,a)),lu(f(o),kl(s))},o._exitHandler=function(){nu(o.awareness,[i.clientID],"app closed")},cl&&"undefined"!=typeof process&&process.on("exit",o._exitHandler),c.on("update",o._awarenessUpdateHandler),o._checkInterval=setInterval((function(){o.wsconnected&&3e4<Vl()-o.wsLastMessageReceived&&o.ws.close()}),3e3),l&&o.connect(),o}return P(n,[{key:"url",get:function(){var e=function(e){return function(e,t){var n=[];for(var r in e)n.push(t(e[r],r));return n}(e,(function(e,t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e))})).join("&")}(this.params);return this.serverUrl+"/"+this.roomname+(0===e.length?"":"?"+e)}},{key:"synced",get:function(){return this._synced},set:function(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}},{key:"destroy",value:function(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),cl&&"undefined"!=typeof process&&process.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),s(g(n.prototype),"destroy",this).call(this)}},{key:"connectBc",value:function(){if(!this.disableBc){var e,t;this.bcconnected||(e=this.bcChannel,t=this._bcSubscriber,zl(e).subs.add(t),this.bcconnected=!0);var n=wl();Cl(n,0),Hl(n,this.doc),Fl(this.bcChannel,kl(n),this);var r=wl();Cl(r,0),Ul(r,this.doc),Fl(this.bcChannel,kl(r),this);var i=wl();Cl(i,3),Fl(this.bcChannel,kl(i),this);var o=wl();Cl(o,1),Al(o,ru(this.awareness,[this.doc.clientID])),Fl(this.bcChannel,kl(o),this)}}},{key:"disconnectBc",value:function(){var e,t,n=wl();Cl(n,1),Al(n,ru(this.awareness,[this.doc.clientID],new Map)),lu(this,kl(n)),this.bcconnected&&(e=this.bcChannel,t=this._bcSubscriber,zl(e).subs.delete(t),this.bcconnected=!1)}},{key:"disconnect",value:function(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}},{key:"connect",value:function(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(su(this),this.connectBc())}}]),n}(Zl),cu=function(){function e(t,n,r,i){A(this,e),O(this,"id",void 0),O(this,"name",void 0),O(this,"doc",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"connectionProvider",void 0),this.context=t,this.params=n,this.id=r,this.doc=i;var o=ibiz.appData.mqtttopic.split("/");this.name="/".concat(o[1],"/collaborate/ROOM/").concat(this.id)}var t,n;return P(e,[{key:"created",value:(n=_(E().mark((function e(){var t,n,r,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ibiz.hub.getApp(this.context.srfappid),n=t.model.appId||ibiz.env.appId,r="ws://".concat(window.location.host).concat(ibiz.env.baseUrl,"/").concat(n).concat(ibiz.env.mqttUrl),i=new Ys(this.id,this.name,_e(),n),e.next=6,i.connect();case 6:this.connectionProvider=new uu(r,this.name,this.doc,{WebSocketPolyfill:i,resyncInterval:5e3});case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"destroy",value:(t=_(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=this.connectionProvider)||void 0===t||t.destroy();case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),hu=function(){function e(){A(this,e),O(this,"collaborateMap",new Map)}var t,n,r;return P(e,[{key:"getAppId",value:function(e){return ibiz.hub.getApp(e.srfappid).model.appId||ibiz.env.appId}},{key:"create",value:(r=_(E().mark((function e(t,n,r,i){var o,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new cu(t,n,r,i),e.next=3,o.created();case 3:return a=this.getAppId(t),this.collaborateMap.has(a)||this.collaborateMap.set(a,new Map),this.collaborateMap.get(a).set(o.id,o),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"get",value:(n=_(E().mark((function e(t,n,r){var i,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getAppId(t),this.collaborateMap.has(i)){e.next=3;break}throw new Error(ibiz.i18n.t("runtime.utils.collaborateManager.invalidCollaborateRoom",{id:r}));case 3:if(!(o=this.collaborateMap.get(i))||!o.has(r)){e.next=6;break}return e.abrupt("return",o.get(r));case 6:throw new Error(ibiz.i18n.t("runtime.utils.collaborateManager.invalidCollaborateRoom",{id:r}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"destroy",value:(t=_(E().mark((function e(t,n,r){var i,o;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.getAppId(t),this.collaborateMap.has(i)&&(o=this.collaborateMap.get(i))&&o.has(r)&&(o.get(r).destroy(),o.delete(r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}]),e}(),fu=function(){function e(t){A(this,e),O(this,"yDoc",new Nr),O(this,"collaborateManager",new hu),O(this,"wsProvider",void 0),O(this,"inited",C(!1)),O(this,"yjsEditor",void 0),O(this,"cursorStates",V({})),O(this,"cursorHandler",null),this.enableRealtime=t,this.inited.value=!t}var t;return P(e,[{key:"initYjs",value:(t=_(E().mark((function e(t){var n,r,i,o,a=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inited.value){e.next=10;break}return r=p(t.editor.children),i=this.yDoc.get("content",Go),e.next=5,this.collaborateManager.create(t.context,t.params,t.roomname,this.yDoc);case 5:o=e.sent,this.wsProvider=o.connectionProvider,this.wsProvider.on("status",(function(e){"connected"!==e.status||a.inited.value||setTimeout((function(){a.inited.value=!0,!i.toJSON()&&r.length>0&&i.applyDelta(Na(r))}),1e3)})),this.yjsEditor=Ls(js(fs(Cs(us(t.editor,i,Is(null===(n=t.htmlRef)||void 0===n?void 0:n.$el),{autoConnect:!0}),this.wsProvider.awareness,{data:(s=t.context.srfusername,{color:Ns.stringToHexColor(s),name:"".concat(s)})})))),this.initCursorHandler();case 10:case"end":return e.stop()}var s}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"initCursorHandler",value:function(){var e=this;if(!this.cursorHandler&&this.yjsEditor){var t=new Set;this.cursorHandler=function(n){n.added.forEach((function(e){return t.add(e)})),n.removed.forEach((function(e){return t.add(e)})),n.updated.forEach((function(e){return t.add(e)})),t.forEach((function(t){var n=ws(e.yjsEditor,t);null===n?delete e.cursorStates[t.toString()]:e.cursorStates[t]=n}))},ys(this.yjsEditor,"change",this.cursorHandler)}}},{key:"destroy",value:function(){var e,t;null===(e=this.yjsEditor)||void 0===e||e.disconnect(),this.wsProvider.disconnect(),this.cursorHandler&&(ms(this.yjsEditor,"change",this.cursorHandler),this.cursorHandler=null),null===(t=this.yjsEditor)||void 0===t||t.destroy()}}]),e}(),du=d({name:"IBizHtmlCollapse",props:ne(),emits:["change","blur","focus","enter","infoTextChange","link"],setup:function(e,t){var n,r=t.emit,i=re("html"),o=e.controller,s=C(),l=C({}),c=null,h=0,f=C(),d=S(),g=C(),v=C(),p=C(),y=C(""),w=C({Authorization:"Bearer ".concat(be(Ee.TOKEN))}),b=C(""),x=C(""),A=C(!0),P=C(!1),I=C(!1),B=C(!1),F=C(!1),V=C(!0),q=C(!1),G=C(""),J=C(!1),W=C([]),Y=new fu(o.enableRealtime),X=o.model;X.editorParams&&(X.editorParams.enableEdit&&(P.value=!0,I.value=!0,A.value=o.toBoolean(X.editorParams.enableEdit)&&!e.readonly&&!e.disabled),X.editorParams.enableFullScreen&&(B.value=o.toBoolean(X.editorParams.enableFullScreen))),e.readonly&&(P.value=!1,I.value=!0),M((function(){return e.data}),(function(e){if(e){var t=ibiz.util.file.calcFileUpDownUrl(o.context,o.params,e,o.editorParams);b.value=t.uploadUrl,x.value=t.downloadUrl}}),{immediate:!0,deep:!0});var K,$=function(e,t){if(t)return!0},Q=function(e){return e},ee=function(){var e=_(E().mark((function e(){var t,n,i,a,s;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.deService){e.next=11;break}return e.next=3,u.import("@ibiz-template-plugin/ai-chat");case 3:return n=e.sent,i=n.chat||n.default.chat,K=i,a=i.create({question:function(){var e=_(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ke(),e.next=3,null===(n=o.deService)||void 0===n?void 0:n.aiChatSse((function(e){if(ibiz.log.info("aiChatSse",e),20===e.actionstate&&e.actionresult)a.addMessage({messageid:r,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:e.actionresult});else if(30===e.actionstate&&e.actionresult){var t=JSON.parse(e.actionresult).choices;t&&t.length>0&&a.replaceMessage({messageid:r,state:e.actionstate,type:"DEFAULT",role:"ASSISTANT",content:t[0].content||""})}else 40===e.actionstate&&a.replaceMessage({messageid:r,state:e.actionstate,type:"ERROR",role:"ASSISTANT",content:e.actionresult})}),o.context,{},{messages:t});case 3:return a.addMessage({messageid:r,state:10,type:"DEFAULT",role:"ASSISTANT",content:""}),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),action:function(e,t){"backfill"===e&&(P.value?y.value=t.content:r("change",t.content),J.value=!0)},closed:function(){d.value&&d.value.focus(!0)}}),e.next=9,null===(t=o.deService)||void 0===t?void 0:t.aiChatHistory(o.context,{});case 9:(s=e.sent).data&&Array.isArray(s.data)&&s.data.forEach((function(e){var t={messageid:ke(),state:30,type:"DEFAULT",role:e.role,content:e.content};a.addMessage(t)}));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te={toolbarKeys:wt};o.chatCompletion&&(te.insertKeys={index:60,keys:["|","aichart"]}),o.insertKeys.length>0&&te.toolbarKeys&&o.insertKeys.forEach((function(e){e.keys&&e.keys.forEach((function(t,n){te.toolbarKeys.includes(t)||te.toolbarKeys.splice(e.index+n,0,t)}))}));var ne={placeholder:o.placeHolder,readOnly:P.value?I.value:e.readonly,MENU_CONF:{uploadImage:{server:b.value,fieldName:"file",maxFileSize:10485760,maxNumberOfFiles:10,allowedFileTypes:[],headers:w.value,withCredentials:!0,onBeforeUpload:function(e){return e},onProgress:function(e){console.log("progress",e)},onSuccess:function(e,t){console.log("".concat(e.name," 上传成功"),t)},onFailed:function(e,t){console.log("".concat(e.name," 上传失败"),t)},onError:function(e,t,n){console.log("".concat(e.name," 上传出错"),t,n)},customInsert:function(e,t){return _(E().mark((function n(){var r,i;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=x.value.replace("%fileId%",e.id),i=e.filename,t(r,i,"");case 3:case"end":return n.stop()}}),n)})))()}},insertLink:{checkLink:$,parseLinkUrl:Q},editLink:{checkLink:$,parseLinkUrl:Q}},hoverbarKeys:{link:{menuKeys:["editLink","unLink","customViewLink"]}}};T((function(){var e=d.value;null!=e&&(o.enableRealtime?Y.destroy():e.destroy())}));var oe=function(){var e=_(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.maxHeight&&(n=t.getEditableContainer(),q.value=n.offsetHeight>o.maxHeight);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=_(E().mark((function e(t){var n,r,i,o,a,s,l;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.src,I.value)he(n);else if(r=ue.nodes(d.value,{match:function(e){return!(!ce.isElement(e)||"image"!==e.type)},universal:!0}),r){i=k(r);try{for(i.s();!(o=i.n()).done;)a=o.value,s=m(a,1),"image"===(l=s[0]).type&&n.endsWith(l.src)&&he(l.src)}catch(u){i.e(u)}finally{i.f()}}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){var e=_(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G.value=t,W.value=[t],e.next=4,j();case 4:v.value&&(n=v.value.$refs.container)&&n.children[0].click();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(e){if(v.value){var t=v.value.$refs.container;if(t){var n=t.querySelector(".el-image-viewer__wrapper");null==n||n[e]("keydown",de)}}},de=function(){var e=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Escape"!==t.key&&27!==t.keyCode){e.next=7;break}return t.stopPropagation(),t.preventDefault(),e.next=5,j();case 5:fe("removeEventListener"),W.value=[];case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=function(){var e=_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:fe("addEventListener");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var t=y.value;if("JSON"===o.renderMode){var n=d.value;t=o.toJson(n.children)}e.value!==t&&r("change",t)},pe=Se(ve,o.saveInterval),ye=function(t){d.value=t,o.onCreated(d.value,e.data,te);var n,r,i=o.parseNode(y.value);t.setHtml(i),n=e.data.srfuf===Z.CREATE,Y.initYjs({roomname:n?"draft":e.data.srfkey,editor:d.value,context:o.context,params:o.params,htmlRef:g.value}),t.on("modalOrPanelShow",(function(e){r=new pt(e,g.value)})),t.on("modalOrPanelHide",(function(){r&&r.destroy()})),t.on("aiClick",(function(){ee()}))},me=function(t){var n=t.getHtml();oe(t),function(e){var t=e.getEditableContainer();t&&t.querySelectorAll("img").forEach((function(t){t.onload=function(){oe(e)},t.onclick=function(e){var t=e.target;t&&ae(t)}}))}(t);var r="<p><br></p>"===n?"":n;r===e.value||""===r&&Ce(e.value)||(!P.value&&t.isFocused()&&("AUTOMATIC"===o.emitMode?pe():ve()),o.evt.emit("onChange",{eventArg:r}))},we=function(e){},xe=function(t){r("focus"),o.evt.emit("onFocus",{eventArg:e.value})},_e=function(t){r("blur"),o.evt.emit("onBlur",{eventArg:e.value})},Me=function(e,t){alert("【自定义提示】".concat(t," - ").concat(e))},Pe=function(e,t,n){n(!0)},Oe=function(){var e=d.value;null!=e&&e.disable()},Te=function(){var e=d.value;null!=e&&e.enable()},Le=function(){if(I.value=!I.value,I.value){if(g.value)g.value.$refs.box.scroll(0,0);Oe()}else Te(),d.value.focus(),function(){if(e.value){var t=e.value.indexOf("</p>");if(t>=0){var n,r,i=null===(n=d.value.selection.anchor)||void 0===n?void 0:n.offset,o=null===(r=d.value.selection.anchor)||void 0===r?void 0:r.path;0===i&&o.length>0&&0===o[0]&&d.value.move(t-3)}}}(),V.value=!0},je=function(){F.value=!F.value,V.value=!F.value,j((function(){I.value?Oe():(Te(),d.value.focus())}))};return L((function(){p.value&&(n=ie(p,_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.value&&d.value.emit("clickOutside");case 1:case"end":return e.stop()}}),e)}))))),Ae(0,(function(){if(s.value&&f.value){var e=s.value.$el.offsetHeight;(c=new ResizeObserver((function(t){var n=t[0].contentRect.height;if(n!==h){var r={height:"".concat(e-t[0].contentRect.height,"px")};l.value=i.cssVarBlock(r),h=n}}))).observe(f.value.selector)}})),M((function(){return e.value}),(function(t,n){t===n||"string"!=typeof e.value&&null!=t||(null==t?y.value="":"JSON"===o.renderMode?y.value=o.jsonToHtml(t):y.value=t,J.value&&(d.value&&j((function(){d.value.focus(!0)})),J.value=!1))}),{immediate:!0}),M((function(){return e.disabled}),(function(e,t){e!==t&&(!0===e?Oe():Te())}),{immediate:!0})})),z((function(){c&&c.disconnect(),n&&n.stop&&n.stop(),K&&K.close()})),{ns:i,editorRef:d,previewRef:v,containerRef:p,htmlRef:g,mode:"default",valueHtml:y,toolbarConfig:te,editorConfig:ne,handleCreated:ye,handleChange:me,handleDestroyed:we,handleFocus:xe,handleBlur:_e,customAlert:Me,customPaste:Pe,insertText:function(e){var t=d.value;null!=t&&t.insertText(e)},printHtml:function(){d.value},disable:Oe,enable:Te,renderHeaserToolbar:function(){return P.value||B.value?N("div",{class:i.b("custom-toolbar")},[P.value&&A.value&&I.value?N("i",{class:"fa fa-edit","aria-hidden":"true",title:"编辑",onClick:function(){return Le()}},null):null,B.value?F.value?N("i",{class:"fa fa-compress","aria-hidden":"true",title:"缩小",onClick:function(){return je()}},null):N("i",{class:"fa fa-expand","aria-hidden":"true",title:"放大",onClick:function(){return je()}},null):null]):null},renderEditorContent:function(){var e=a({},l.value);return V.value&&o.maxHeight&&Object.assign(e,{maxHeight:"".concat(o.maxHeight,"px")}),H(N(Ws,{ref:"htmlContent",style:e,slateYjs:Y,"element-loading-text":"数据同步中...",class:[i.b("content"),i.is("readonly",I.value)]},{default:function(){return[N(le,{ref:"toolbarRef",editor:d.value,"default-config":te,mode:"default",class:i.b("toolbar")},null),N(se,{ref:"htmlRef",class:i.b("editor"),modelValue:y.value,"onUpdate:modelValue":function(e){return y.value=e},"default-config":ne,mode:"default",onOnCreated:ye,onOnChange:me,onOnDestroyed:we,onOnFocus:xe,onOnBlur:_e,oncustomAlert:Me,oncustomPaste:Pe},null)]}}),[[U("loading"),!Y.inited.value]])},renderToggle:function(){return q.value?V.value?N("div",{class:i.e("toggle"),onClick:function(){V.value=!V.value}},[D("展开更多 "),N(R("ion-icon"),{name:"arrow-down-outline"},null)]):N("div",{class:i.e("toggle"),onClick:function(){V.value=!V.value}},[D("收起更多 "),N(R("ion-icon"),{name:"arrow-up-outline"},null)]):null},renderFooter:function(){return P.value&&"AUTOMATIC"!==o.emitMode?N("div",{class:[i.b("footer"),O({},i.b("footer-dialog"),F.value)]},[N("div",{class:i.be("footer","cancel"),onClick:function(){e.value!==y.value?De({title:"确认取消",type:"warning",customClass:i.b("message"),message:N("div",{class:i.be("message","message-content")},[N("p",null,[D("确定要取消编辑吗？")]),N("p",{class:i.bem("message","message-content","message-tip")},[D("取消编辑将无法保存修改的内容，且不能找回。")])]),showCancelButton:!0,cancelButtonClass:i.be("message","message-cancel"),confirmButtonClass:i.be("message","message-comfire")}).then((function(){if(e.value){var t=o.parseNode(e.value);y.value=t}else y.value="";Le()})).catch((function(){d.value.focus()})):Le()}},[D("取消")]),N("div",{class:i.be("footer","save"),onClick:function(){return I.value=!0,d.value.disable(),"JSON"!==o.renderMode&&r("change",y.value),void(F.value&&(F.value=!1))}},[D("保存")])]):null},htmlContent:s,hasEnableEdit:P,cssVars:l,toolbarRef:f,isFullScreen:F,readonlyState:I,collapse:V,changeFullScreenState:je,renderPreview:function(){return N(R("el-image"),{class:i.e("preview"),ref:"previewRef","zoom-rate":1.1,src:G.value,"preview-src-list":W.value,"hide-on-click-modal":!0,onShow:ge,fit:"cover"},null)}}},render:function(){var e=this;return this.isFullScreen?N(R("el-dialog"),{modelValue:this.isFullScreen,"onUpdate:modelValue":function(t){return e.isFullScreen=t},width:"80%",top:"10vh",class:this.ns.b("dialog-full-screen"),onClose:function(){return e.changeFullScreenState()}},{default:function(){return[N("div",{ref:"containerRef",class:[e.ns.b(),e.ns.b("collapse"),O({},e.ns.b("editor-readonly"),e.readonlyState)]},[e.renderHeaserToolbar(),e.renderEditorContent(),e.hasEnableEdit&&!e.readonlyState?e.renderFooter():null])]}}):N("div",{ref:"containerRef",class:[this.ns.b(),this.ns.is("allow-collapse",!0),O({},this.ns.b("editor-readonly"),this.readonlyState)]},[this.renderHeaserToolbar(),this.renderEditorContent(),this.readonlyState?this.renderToggle():null,this.hasEnableEdit&&!this.readonlyState?this.renderFooter():null,this.renderPreview()])}}),gu=d({name:"HtmlComment",props:ne(),emits:oe(),setup:function(e,t){var n=t.emit,r=re("html-comment"),i=e.controller,o=C(),a=C(),s=C(!1),l=function(){s.value=!0};return{ns:r,c:i,comment:o,editorRef:a,onChange:function(e){n("change",e),e&&i.collapsed.value&&(i.collapsed.value=!1)},onFocus:function(){i.collapsed.value=!1,n("focus")},onBlur:function(){if(n("blur"),e.value)return null;i.collapsed.value=!0},renderAvatar:function(){if(i.userAvatar&&!s.value){var t=JSON.parse(i.userAvatar);if(0===t.length)return null;var n=ibiz.util.file.calcFileUpDownUrl(i.context,i.params,e.data,i.editorParams).downloadUrl.replace("%fileId%",t[0].id);return N("div",{class:r.e("avatar-name")},[N("img",{src:n,alt:"",onError:l},null)])}var o=Ns.stringToHexColor(i.context.srfusername),a=Ns.avatarName(i.context.srfusername);return i.context.srfusername?N("div",{class:r.e("avatar-name"),style:"background: ".concat(o,";")},[a]):N(R("el-avatar"),{class:r.e("avatar"),src:"./assets/images/user-avatar.png"},null)}}},render:function(){return"default"===this.c.mode?N(du,{controller:this.c,data:this.data,value:this.value,readonly:this.readonly,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur},null):N("div",{ref:"comment",class:[this.ns.b(),this.ns.is("collapse",this.c.collapsed.value)],style:{height:"".concat(this.c.collapsed.value?this.c.minHeight:this.c.maxHeight,"px")}},[this.renderAvatar(),N(yt,{controller:this.c,data:this.data,value:this.value,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur},null)])}});function vu(e,t,n,r,i){return{sel:e,data:t,children:n,text:r,elm:i,key:void 0===t?void 0:t.key}}var pu=Array.isArray;function yu(e){return"string"==typeof e||"number"==typeof e||e instanceof String||e instanceof Number}function mu(e,t,n){if(e.ns="http://www.w3.org/2000/svg","foreignObject"!==n&&void 0!==t)for(var r=0;r<t.length;++r){var i=t[r];if("string"!=typeof i){var o=i.data;void 0!==o&&mu(o,i.children,i.sel)}}}function wu(e,t,n){var r,i,o,a={};if(void 0!==n?(null!==t&&(a=t),pu(n)?r=n:yu(n)?i=n.toString():n&&n.sel&&(r=[n])):null!=t&&(pu(t)?r=t:yu(t)?i=t.toString():t&&t.sel?r=[t]:a=t),void 0!==r)for(o=0;o<r.length;++o)yu(r[o])&&(r[o]=vu(void 0,void 0,void 0,r[o],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||mu(a,r,e),vu(e,a,r,i,void 0)}var bu={type:"attachments",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,r=e.data,i=void 0===r?{}:r,o=Y.execScriptFn({data:i},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var ku={selector:'span[data-w-e-type="attachments"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"attachments",script:n.script,data:n,children:[{text:""}]}}};var xu={type:"attachments",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,r={name:"".concat(n.name),id:n.id};return wu("mention-elem",{dataset:{value:JSON.stringify(r)},props:{contentEditable:!1}},[])}},Cu=function(){function e(){A(this,e),O(this,"title","本地文件"),O(this,"tag","button"),O(this,"iconSvg",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36px" height="36px" viewBox="0 0 36 36" version="1.1">\n    <title>附件</title>\n    <g id="附件" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="icon">\n            <rect id="矩形" stroke="#EEEEEE" fill="#FFFFFF" x="0.5" y="0.5" width="35" height="35" rx="4"/>\n            <g id="编组-28" transform="translate(2.997929, 8.001508)">\n                <path d="M13.9611058,12.6330155 C13.9611058,14.5460163 12.4108408,16.0968098 10.498492,16.0968098 C8.58614322,16.0968098 7.03587822,14.5460163 7.03590808,12.6393438 L7.03590808,12.6393438 L6.98338468,7.07669061 C6.97992133,6.70644889 7.27712693,6.40347538 7.64724246,6.39998034 C8.017358,6.39648531 8.32022824,6.69379224 8.32372209,7.06403396 L8.32372209,7.06403396 L8.37624485,12.6330155 C8.37624485,13.8054998 9.32640727,14.7559862 10.498492,14.7559862 C11.6705768,14.7559862 12.6207392,13.8054998 12.6207392,12.6330155 L12.6207392,12.6330155 L12.6207392,6.46506253 C12.6207392,4.69957562 11.0562006,3.24725012 9.10227678,3.24725012 C7.148353,3.24725012 5.58381437,4.69957562 5.58381437,6.46506253 L5.58381437,6.46506253 L5.58381437,12.8655397 C5.58381437,15.5621365 7.78332719,17.7497339 10.498492,17.7497339 C13.2136568,17.7497339 15.4131697,15.5621365 15.4131697,12.8655397 L15.4131697,12.8655397 L15.4131697,7.10001026 C15.4131697,6.72975204 15.713221,6.42959845 16.083353,6.42959845 C16.453485,6.42959845 16.7535363,6.72975204 16.7535363,7.10001026 L16.7535363,7.10001026 L16.7535363,12.8655397 C16.7535363,16.3043913 13.9521943,19.0905575 10.498492,19.0905575 C7.04478976,19.0905575 4.24344774,16.3043913 4.24344774,12.8655397 L4.24344774,12.8655397 L4.24344774,6.46506253 C4.24344774,3.93573556 6.42955024,1.90642651 9.10227678,1.90642651 C11.7750033,1.90642651 13.9611058,3.93573556 13.9611058,6.46506253 L13.9611058,6.46506253 Z" id="形状结合" fill="#DDDDDD" transform="translate(10.498492, 10.498492) rotate(-315.000000) translate(-10.498492, -10.498492) "/>\n                <path d="M21.6662931,9.87797441 L24.6096402,9.87797441 C24.9410111,9.87797441 25.2096402,10.1466036 25.2096402,10.4779744 C25.2096402,10.8093453 24.9410111,11.0779744 24.6096402,11.0779744 L21.6662931,11.0779744 C21.3349223,11.0779744 21.0662931,10.8093453 21.0662931,10.4779744 C21.0662931,10.1466036 21.3349223,9.87797441 21.6662931,9.87797441 Z" id="矩形备份-74" fill="#73D897"/>\n                <path d="M21.6662931,4.29120933 L27.4020707,4.29120933 C27.7334415,4.29120933 28.0020707,4.55983848 28.0020707,4.89120933 C28.0020707,5.22258018 27.7334415,5.49120933 27.4020707,5.49120933 L21.6662931,5.49120933 C21.3349223,5.49120933 21.0662931,5.22258018 21.0662931,4.89120933 C21.0662931,4.55983848 21.3349223,4.29120933 21.6662931,4.29120933 Z" id="矩形备份-75" fill="#6698FF"/>\n                <path d="M21.6662931,15.4647395 L27.4020707,15.4647395 C27.7334415,15.4647395 28.0020707,15.7333686 28.0020707,16.0647395 C28.0020707,16.3961103 27.7334415,16.6647395 27.4020707,16.6647395 L21.6662931,16.6647395 C21.3349223,16.6647395 21.0662931,16.3961103 21.0662931,16.0647395 C21.0662931,15.7333686 21.3349223,15.4647395 21.6662931,15.4647395 Z" id="矩形备份-77" fill="#FF7575"/>\n            </g>\n        </g>\n    </g>\n</svg>')}return P(e,[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){throw new Me("暂未支持上传本地文件！")}}]),e}(),Eu={renderElems:[xu],elemsToHtml:[bu],parseElemsHtml:[ku],menus:[{key:"attachments",factory:function(){return new Cu}}]},Su=function(){function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"evt",void 0),O(this,"execting",!1),this.registerNode()}var t;return P(e,[{key:"registerNode",value:function(){window.attachmentsIsRegiter||(me.registerModule(Eu),window.attachmentsIsRegiter=!0)}},{key:"init",value:(t=_(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams;case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"onDestroyed",value:function(){}},{key:"insertNode",value:function(e){}},{key:"parseNode",value:function(e){return e}}]),e}();var _u={type:"codesnippet",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,r=e.data,i=void 0===r?{}:r,o=Y.execScriptFn({data:i},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var Au={selector:'span[data-w-e-type="codesnippet"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"codesnippet",script:n.script,data:n,children:[{text:""}]}}};var Mu={type:"CodeSnippet",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,r={name:"".concat(n.name),id:n.id};return wu("mention-elem",{dataset:{value:JSON.stringify(r)},props:{contentEditable:!1}},[])}},Pu=function(){function e(){A(this,e),O(this,"title","代码段"),O(this,"tag","button"),O(this,"iconSvg",'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36px" height="36px" viewBox="0 0 36 36" version="1.1">\n  <title>代码段</title>\n  <g id="代码段" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n      <g id="icon备份">\n          <rect id="矩形" stroke="#EEEEEE" fill="#FFFFFF" x="0.5" y="0.5" width="35" height="35" rx="4"/>\n          <path d="M24.6642225,18.8794824 L27.6075695,18.8794824 C27.9389404,18.8794824 28.2075695,19.1481115 28.2075695,19.4794824 C28.2075695,19.8108532 27.9389404,20.0794824 27.6075695,20.0794824 L24.6642225,20.0794824 C24.3328516,20.0794824 24.0642225,19.8108532 24.0642225,19.4794824 C24.0642225,19.1481115 24.3328516,18.8794824 24.6642225,18.8794824 Z" id="矩形备份-74" fill="#73D897"/>\n          <path d="M24.6642225,13.2927173 L30.4,13.2927173 C30.7313708,13.2927173 31,13.5613465 31,13.8927173 C31,14.2240882 30.7313708,14.4927173 30.4,14.4927173 L24.6642225,14.4927173 C24.3328516,14.4927173 24.0642225,14.2240882 24.0642225,13.8927173 C24.0642225,13.5613465 24.3328516,13.2927173 24.6642225,13.2927173 Z" id="矩形备份-75" fill="#6698FF"/>\n          <path d="M24.6642225,24.4662475 L30.4,24.4662475 C30.7313708,24.4662475 31,24.7348766 31,25.0662475 C31,25.3976183 30.7313708,25.6662475 30.4,25.6662475 L24.6642225,25.6662475 C24.3328516,25.6662475 24.0642225,25.3976183 24.0642225,25.0662475 C24.0642225,24.7348766 24.3328516,24.4662475 24.6642225,24.4662475 Z" id="矩形备份-77" fill="#FF7575"/>\n          <g id="1.Base基础/1.icon图标/11.editor/header-1" transform="translate(5.000000, 11.000000)" fill="#DDDDDD">\n              <path d="M4.68266589,2.39258039 L1.51032474,7.44797324 L5.01586095,12.7216272 L4.05994646,13.3212428 L0.126424153,7.40475416 L3.68603474,1.72997946 L4.68266589,2.39258039 Z M11.3173341,12.6697762 L14.4896753,7.61438339 L10.984139,2.34072939 L11.9400535,1.7411138 L15.8735758,7.65760247 L12.3139653,13.3323772 L11.3173341,12.6697762 Z M8.86596086,1.31248434 L10.0376294,1.55020137 L7.19605832,13.6243456 L6.0243898,13.3866286 L8.86596086,1.31248434 Z" id="形状结合"/>\n          </g>\n      </g>\n  </g>\n</svg>')}return P(e,[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){throw new Me("暂未支持上传代码段！")}}]),e}(),Ou={renderElems:[Mu],elemsToHtml:[_u],parseElemsHtml:[Au],menus:[{key:"codesnippet",factory:function(){return new Pu}}]},Tu=function(){function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"evt",void 0),O(this,"execting",!1),this.registerNode()}var t;return P(e,[{key:"registerNode",value:function(){window.codesnippetIsRegiter||(me.registerModule(Ou),window.codesnippetIsRegiter=!0)}},{key:"init",value:(t=_(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams;case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"onDestroyed",value:function(){}},{key:"insertNode",value:function(e){}},{key:"parseNode",value:function(e){return e}}]),e}();var Lu={type:"marker",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,r=e.data,i=void 0===r?{}:r,o=Y.execScriptFn({data:i},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var ju={selector:'span[data-w-e-type="marker"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"marker",script:n.script,data:n,children:[{text:""}]}}};var Nu={type:"marker",renderElem:function(e){var t=e.data,n=void 0===t?{}:t;return wu("mention-elem",{dataset:{value:JSON.stringify(n)},props:{contentEditable:!1}},[])}},Ru=function(){function e(){A(this,e),O(this,"title","提及工作项"),O(this,"tag","button"),O(this,"iconSvg",'<svg t="1706259772097" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6854" width="200" height="200"><path d="M929.28 625.664l-234.496 0.512 24.064-229.888 210.432-0.512c20.992 0 38.4-17.408 38.4-38.4s-17.408-38.4-38.4-38.4H727.04l29.184-275.456c2.048-20.992-13.312-39.936-34.304-41.984-20.992-2.048-39.936 13.312-41.984 34.304L650.24 318.976l-232.448 0.512 29.184-275.456c2.048-20.992-13.312-39.936-34.304-41.984-20.992-2.048-39.936 13.312-41.984 34.304l-29.696 283.648-246.272 0.512c-20.992 0-38.4 17.408-38.4 38.4s17.408 38.4 38.4 38.4l238.08-0.512-24.064 229.888-214.016 0.512c-20.992 0-38.4 17.408-38.4 38.4s17.408 38.4 38.4 38.4l205.824-0.512-29.184 276.992c-2.048 20.992 13.312 39.936 34.304 41.984h4.096c19.456 0 35.84-14.848 37.888-34.304l30.208-285.184 232.448-0.512-29.184 277.504c-2.048 20.992 13.312 39.936 34.304 41.984h4.096c19.456 0 35.84-14.848 38.4-34.304l30.208-285.184 242.688-0.512c20.992 0 38.4-17.408 38.4-38.4-1.536-20.992-18.944-37.888-39.936-37.888z m-544.256 0.512l24.064-229.888 232.448-0.512-24.064 229.888-232.448 0.512z" fill="#979797" p-id="6855"></path></svg>')}return P(e,[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.insertText("#")}}]),e}(),Du={renderElems:[Nu],elemsToHtml:[Lu],parseElemsHtml:[ju],menus:[{key:"marker",factory:function(){return new Ru}}]},Iu=d({name:"MenTion",props:{controller:{type:Object,required:!0},modal:{type:Object}},setup:function(e){var t=re("mention"),n=e.controller,r=C(!1),i=C([]),o=Oe,a=C({}),s=C(0),l=C([]),u=function(e){var t=e.eventArg;if(t){!t.includes("@")&&n.overlay&&n.execting&&n.overlay.dismiss();var r=t.match(/(?<=\@)([^\@&^{]*?)(?=\<)/g)||[];n.execting&&(0===r.length&&n.overlay.dismiss(),n.query=r.pop()||"",n.query&&/\s$/.test(n.query)?n.overlay.dismiss():n.query&&f({isInitialLoad:!0}))}else n.overlay&&n.execting&&n.overlay.dismiss()},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.value=!0,n.getUsers(e).then((function(t){var o;(200===t.status&&t.data||(r.value=!1),t.headers["x-total"]&&(s.value=Number(t.headers["x-total"])),!0===e.isLoadMore)?(o=i.value).push.apply(o,p(n.toUIData(t.data))):(i.value=n.toUIData(t.data),i.value.length>0&&(a.value=i.value[0]));r.value=!1})).catch((function(){r.value=!1}))},h=I((function(){return i.value.length>=s.value||r.value||s.value<=n.size})),f=Ve(c,300,{leading:!0});n.evt&&n.evt.on("onChange",u),c({isInitialLoad:!0});var d=function(e){var t=i.value.findIndex((function(e){return e.id===a.value.id}));switch(e){case"up":-1!==--t&&-2!==t||(t=i.value.length-1),a.value=i.value[t];break;case"down":++t===i.value.length&&(t=0),a.value=i.value[t];break;case"enter":g(a.value)}},g=function(t){if(e.modal){var n,r={ok:!0,data:[t]};null===(n=e.modal)||void 0===n||n.dismiss(r)}};return L((function(){o=Pe(window,"keyup",(function(e){40===e.keyCode?d("down"):38===e.keyCode?d("up"):13===e.keyCode&&d("enter")}))})),T((function(){o!==Oe&&o(),n.evt.off("onChange",u)})),{ns:t,items:i,loading:r,isLodeMoreDisabled:h,renderItem:function(e){var r=e.name,i=Ns.stringToHexColor(r),o=Ns.avatarName(r),s="";if(n.operatorMap.has(e.id)){var u=n.operatorMap.get(e.id);u.data.iconurl&&(s=function(e){if(!e)return null;var t=JSON.parse(e);return 0===t.length?null:ibiz.util.file.calcFileUpDownUrl(n.context,n.params,n.editorParams).downloadUrl.replace("%fileId%",t[0].id)}(u.data.iconurl)||"")}return N("div",{class:[t.e("item"),t.is("active",e.id===a.value.id)],onClick:function(){return g(e)}},[N("div",{class:t.e("avatar"),style:"background: ".concat(i,";")},[s&&!l.value.includes(s)?N("img",{src:s,onError:function(){return function(e){l.value.push(e)}(s)}},null):o]),N("div",{class:t.e("name"),title:r},[r])])},loadMore:function(){c({isLoadMore:!0})}}},render:function(){var e=this;return H(N("div",{"infinite-scroll-distance":10,"infinite-scroll-disabled":this.isLodeMoreDisabled,"infinite-scroll-immediate":!1,class:this.ns.b()},[this.items.map((function(t){return e.renderItem(t)})),0===this.items.length&&N(R("iBizNoData"),{text:"暂无用户数据"},null)]),[[U("infinite-scroll"),function(){return e.loadMore()}],[U("loading"),this.loading]])}}),Bu=d({name:"Marker",props:{controller:{type:Object,required:!0},modal:{type:Object}},setup:function(e){var t=re("marker"),n=e.controller,r=C(!1),i=C([]),o=Oe,a=C({}),s=C(0),l=function(e){var t=e.eventArg;if(t){!t.includes("#")&&n.overlay&&n.execting&&n.overlay.dismiss();var r=t.replace(/<svg((.|[\t\r\f\n\s])+?)<\/svg>/g,"").match(/(?<=\#)([^\#&^{]*?)(?=\<)/g)||[];n.execting&&(0===r.length&&n.overlay.dismiss(),n.query=r.pop()||"",n.query&&/\s$/.test(n.query)?n.overlay.dismiss():n.query&&h({isInitialLoad:!0}))}else n.overlay&&n.execting&&n.overlay.dismiss()},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.value=!0,n.load(e).then((function(t){var o;(200===t.status&&t.data||(r.value=!1),t.headers["x-total"]&&(s.value=Number(t.headers["x-total"])),!0===e.isLoadMore)?(o=i.value).push.apply(o,p(n.toUIData(t.data))):(i.value=n.toUIData(t.data),i.value.length>0&&(a.value=i.value[0]));r.value=!1})).catch((function(){r.value=!1}))},c=I((function(){return i.value.length>=s.value||r.value||s.value<=n.size})),h=Ve(u,300,{leading:!0});n.evt&&n.evt.on("onChange",l),u({isInitialLoad:!0});var f=function(e){var t=i.value.findIndex((function(e){return e.id===a.value.id}));switch(e){case"up":-1!==--t&&-2!==t||(t=i.value.length-1),a.value=i.value[t];break;case"down":++t===i.value.length&&(t=0),a.value=i.value[t];break;case"enter":d(a.value)}},d=function(t){if(e.modal){var n,r={ok:!0,data:[t]};null===(n=e.modal)||void 0===n||n.dismiss(r)}},g=function(e,t){if(n.quoteCodelistMap.has(e)){var r=n.quoteCodelistMap.get(e);return N(R("iBizCodeList"),{codeListItems:r.codeListItems,codeList:r.codeList,value:t},null)}return t};return L((function(){o=Pe(window,"keyup",(function(e){40===e.keyCode?f("down"):38===e.keyCode?f("up"):13===e.keyCode&&f("enter")}))})),T((function(){o!==Oe&&o(),n.evt.off("onChange",l)})),{ns:t,items:i,loading:r,isLodeMoreDisabled:c,renderItem:function(e){return N("div",{class:[t.e("item"),t.is("active",e.id===a.value.id)],onClick:function(){return d(e)}},[N("div",{class:t.e("type")},[g("type",e.type)]),N("div",{class:t.e("identifier")},[g("identifier",e.identifier)]),N("div",{class:t.e("name"),title:e.name},[g("name",e.name)])])},loadMore:function(){u({isLoadMore:!0})}}},render:function(){var e=this;return H(N("div",{"infinite-scroll-distance":10,"infinite-scroll-disabled":this.isLodeMoreDisabled,"infinite-scroll-immediate":!1,class:this.ns.b()},[this.items.map((function(t){return e.renderItem(t)})),0===this.items.length&&N(R("iBizNoData"),{text:"暂无用户数据"},null)]),[[U("infinite-scroll"),function(){return e.loadMore()}],[U("loading"),this.loading]])}}),zu=d({name:"IBizHtmlEmoji",props:{modal:{type:Object,required:!0}},setup:function(e){return{ns:re("html-emoji"),onSelect:function(t){var n={ok:!0,data:[{emoji:Te(t.data)}]};e.modal.dismiss(n)}}},render:function(){return N("div",{class:this.ns.b()},[N(R("iBizEmojiSelect"),{dark:!0,continuousList:!0,onSelect:this.onSelect},null)])}}),Fu=function(){function e(t,n,r){A(this,e),O(this,"name",void 0),O(this,"icon",void 0),O(this,"text",void 0),this.name=t,this.icon=n,this.text=r}return P(e,[{key:"label",get:function(){return this.name}}]),e}(),Vu=P((function e(t,n,r){A(this,e),O(this,"data",void 0),O(this,"category",void 0),O(this,"aliases",void 0),this.data=t,this.category=n,this.aliases=r})),Hu=[new Vu("😀","peoples",["grinning"]),new Vu("😃","peoples",["smiley"]),new Vu("😄","peoples",["smile"]),new Vu("😁","peoples",["grin"]),new Vu("😆","peoples",["laughing","satisfied"]),new Vu("😅","peoples",["sweat_smile"]),new Vu("😂","peoples",["joy"]),new Vu("🤣","peoples",["rofl"]),new Vu("😌","peoples",["relaxed"]),new Vu("😊","peoples",["blush"]),new Vu("😇","peoples",["innocent"]),new Vu("🙂","peoples",["slightly_smiling_face"]),new Vu("🙃","peoples",["upside_down_face"]),new Vu("😉","peoples",["wink"]),new Vu("😌","peoples",["relieved"]),new Vu("😍","peoples",["heart_eyes"]),new Vu("😘","peoples",["kissing_heart"]),new Vu("😗","peoples",["kissing"]),new Vu("😙","peoples",["kissing_smiling_eyes"]),new Vu("😚","peoples",["kissing_closed_eyes"]),new Vu("😋","peoples",["yum"]),new Vu("😜","peoples",["stuck_out_tongue_winking_eye"]),new Vu("😝","peoples",["stuck_out_tongue_closed_eyes"]),new Vu("😛","peoples",["stuck_out_tongue"]),new Vu("🤑","peoples",["money_mouth_face"]),new Vu("🤗","peoples",["hugs"]),new Vu("🤓","peoples",["nerd_face"]),new Vu("😎","peoples",["sunglasses"]),new Vu("🤡","peoples",["clown_face"]),new Vu("🤠","peoples",["cowboy_hat_face"]),new Vu("😏","peoples",["smirk"]),new Vu("😒","peoples",["unamused"]),new Vu("😞","peoples",["disappointed"]),new Vu("😔","peoples",["pensive"]),new Vu("😟","peoples",["worried"]),new Vu("😕","peoples",["confused"]),new Vu("🙁","peoples",["slightly_frowning_face"]),new Vu("☹️","peoples",["frowning_face"]),new Vu("😣","peoples",["persevere"]),new Vu("😖","peoples",["confounded"]),new Vu("😫","peoples",["tired_face"]),new Vu("😩","peoples",["weary"]),new Vu("😤","peoples",["triumph"]),new Vu("😠","peoples",["angry"]),new Vu("😡","peoples",["rage","pout"]),new Vu("😶","peoples",["no_mouth"]),new Vu("😐","peoples",["neutral_face"]),new Vu("😑","peoples",["expressionless"]),new Vu("😯","peoples",["hushed"]),new Vu("😦","peoples",["frowning"]),new Vu("😧","peoples",["anguished"]),new Vu("😮","peoples",["open_mouth"]),new Vu("😲","peoples",["astonished"]),new Vu("😵","peoples",["dizzy_face"]),new Vu("😳","peoples",["flushed"]),new Vu("😱","peoples",["scream"]),new Vu("😨","peoples",["fearful"]),new Vu("😰","peoples",["cold_sweat"]),new Vu("😢","peoples",["cry"]),new Vu("😥","peoples",["disappointed_relieved"]),new Vu("🤤","peoples",["drooling_face"]),new Vu("😭","peoples",["sob"]),new Vu("😓","peoples",["sweat"]),new Vu("😪","peoples",["sleepy"]),new Vu("😴","peoples",["sleeping"]),new Vu("🙄","peoples",["roll_eyes"]),new Vu("🤔","peoples",["thinking"]),new Vu("🤥","peoples",["lying_face"]),new Vu("😬","peoples",["grimacing"]),new Vu("🤐","peoples",["zipper_mouth_face"]),new Vu("🤢","peoples",["nauseated_face"]),new Vu("🤧","peoples",["sneezing_face"]),new Vu("😷","peoples",["mask"]),new Vu("🤒","peoples",["face_with_thermometer"]),new Vu("🤕","peoples",["face_with_head_bandage"]),new Vu("😈","peoples",["smiling_imp"]),new Vu("👿","peoples",["imp"]),new Vu("👹","peoples",["japanese_ogre"]),new Vu("👺","peoples",["japanese_goblin"]),new Vu("💩","peoples",["hankey","poop","shit"]),new Vu("👻","peoples",["ghost"]),new Vu("💀","peoples",["skull"]),new Vu("☠️","peoples",["skull_and_crossbones"]),new Vu("👽","peoples",["alien"]),new Vu("👾","peoples",["space_invader"]),new Vu("🤖","peoples",["robot"]),new Vu("🎃","peoples",["jack_o_lantern"]),new Vu("😺","peoples",["smiley_cat"]),new Vu("😸","peoples",["smile_cat"]),new Vu("😹","peoples",["joy_cat"]),new Vu("😻","peoples",["heart_eyes_cat"]),new Vu("😼","peoples",["smirk_cat"]),new Vu("😽","peoples",["kissing_cat"]),new Vu("🙀","peoples",["scream_cat"]),new Vu("😿","peoples",["crying_cat_face"]),new Vu("😾","peoples",["pouting_cat"]),new Vu("👐","peoples",["open_hands"]),new Vu("🙌","peoples",["raised_hands"]),new Vu("👏","peoples",["clap"]),new Vu("🙏","peoples",["pray"]),new Vu("🤝","peoples",["handshake"]),new Vu("👍","peoples",["+1","thumbsup"]),new Vu("👎","peoples",["-1","thumbsdown"]),new Vu("👊","peoples",["fist_oncoming","facepunch","punch"]),new Vu("✊","peoples",["fist_raised","fist"]),new Vu("🤛","peoples",["fist_left"]),new Vu("🤜","peoples",["fist_right"]),new Vu("🤞","peoples",["crossed_fingers"]),new Vu("✌️","peoples",["v"]),new Vu("🤘","peoples",["metal"]),new Vu("👌","peoples",["ok_hand"]),new Vu("👈","peoples",["point_left"]),new Vu("👉","peoples",["point_right"]),new Vu("👆","peoples",["point_up_2"]),new Vu("👇","peoples",["point_down"]),new Vu("☝️","peoples",["point_up"]),new Vu("✋","peoples",["hand","raised_hand"]),new Vu("🤚","peoples",["raised_back_of_hand"]),new Vu("🖐","peoples",["raised_hand_with_fingers_splayed"]),new Vu("🖖","peoples",["vulcan_salute"]),new Vu("👋","peoples",["wave"]),new Vu("🤙","peoples",["call_me_hand"]),new Vu("💪","peoples",["muscle"]),new Vu("🖕","peoples",["middle_finger","fu"]),new Vu("✍️","peoples",["writing_hand"]),new Vu("🤳","peoples",["selfie"]),new Vu("💅","peoples",["nail_care"]),new Vu("💍","peoples",["ring"]),new Vu("💄","peoples",["lipstick"]),new Vu("💋","peoples",["kiss"]),new Vu("👄","peoples",["lips"]),new Vu("👅","peoples",["tongue"]),new Vu("👂","peoples",["ear"]),new Vu("👃","peoples",["nose"]),new Vu("👣","peoples",["footprints"]),new Vu("👁","peoples",["eye"]),new Vu("👀","peoples",["eyes"]),new Vu("🗣","peoples",["speaking_head"]),new Vu("👤","peoples",["bust_in_silhouette"]),new Vu("👥","peoples",["busts_in_silhouette"]),new Vu("👶","peoples",["baby"]),new Vu("👦","peoples",["boy"]),new Vu("👧","peoples",["girl"]),new Vu("👨","peoples",["man"]),new Vu("👩","peoples",["woman"]),new Vu("👱‍♀","peoples",["blonde_woman"]),new Vu("👱","peoples",["blonde_man","person_with_blond_hair"]),new Vu("👴","peoples",["older_man"]),new Vu("👵","peoples",["older_woman"]),new Vu("👲","peoples",["man_with_gua_pi_mao"]),new Vu("👳‍♀","peoples",["woman_with_turban"]),new Vu("👳","peoples",["man_with_turban"]),new Vu("👮‍♀","peoples",["policewoman"]),new Vu("👮","peoples",["policeman","cop"]),new Vu("👷‍♀","peoples",["construction_worker_woman"]),new Vu("👷","peoples",["construction_worker_man","construction_worker"]),new Vu("💂‍♀","peoples",["guardswoman"]),new Vu("💂","peoples",["guardsman"]),new Vu("👩‍⚕","peoples",["woman_health_worker"]),new Vu("👨‍⚕","peoples",["man_health_worker"]),new Vu("👩‍🌾","peoples",["woman_farmer"]),new Vu("👨‍🌾","peoples",["man_farmer"]),new Vu("👩‍🍳","peoples",["woman_cook"]),new Vu("👨‍🍳","peoples",["man_cook"]),new Vu("👩‍🎓","peoples",["woman_student"]),new Vu("👨‍🎓","peoples",["man_student"]),new Vu("👩‍🎤","peoples",["woman_singer"]),new Vu("👨‍🎤","peoples",["man_singer"]),new Vu("👩‍🏫","peoples",["woman_teacher"]),new Vu("👨‍🏫","peoples",["man_teacher"]),new Vu("👩‍🏭","peoples",["woman_factory_worker"]),new Vu("👨‍🏭","peoples",["man_factory_worker"]),new Vu("👩‍💻","peoples",["woman_technologist"]),new Vu("👨‍💻","peoples",["man_technologist"]),new Vu("👩‍💼","peoples",["woman_office_worker"]),new Vu("👨‍💼","peoples",["man_office_worker"]),new Vu("👩‍🔧","peoples",["woman_mechanic"]),new Vu("👨‍🔧","peoples",["man_mechanic"]),new Vu("👩‍🔬","peoples",["woman_scientist"]),new Vu("👨‍🔬","peoples",["man_scientist"]),new Vu("👩‍🎨","peoples",["woman_artist"]),new Vu("👨‍🎨","peoples",["man_artist"]),new Vu("👩‍🚒","peoples",["woman_firefighter"]),new Vu("👨‍🚒","peoples",["man_firefighter"]),new Vu("👩‍🚀","peoples",["woman_astronaut"]),new Vu("👨‍🚀","peoples",["man_astronaut"]),new Vu("🤶","peoples",["mrs_claus"]),new Vu("🎅","peoples",["santa"]),new Vu("👸","peoples",["princess"]),new Vu("🤴","peoples",["prince"]),new Vu("👰","peoples",["bride_with_veil"]),new Vu("🤵","peoples",["man_in_tuxedo"]),new Vu("👼","peoples",["angel"]),new Vu("🤰","peoples",["pregnant_woman"]),new Vu("🙇‍♀","peoples",["bowing_woman"]),new Vu("🙇","peoples",["bowing_man","bow"]),new Vu("💁","peoples",["tipping_hand_woman","information_desk_person","sassy_woman"]),new Vu("💁‍♂","peoples",["tipping_hand_man","sassy_man"]),new Vu("🙅","peoples",["no_good_woman","no_good","ng_woman"]),new Vu("🙅‍♂","peoples",["no_good_man","ng_man"]),new Vu("🙆","peoples",["ok_woman"]),new Vu("🙆‍♂","peoples",["ok_man"]),new Vu("🙋","peoples",["raising_hand_woman","raising_hand"]),new Vu("🙋‍♂","peoples",["raising_hand_man"]),new Vu("🤦‍♀","peoples",["woman_facepalming"]),new Vu("🤦‍♂","peoples",["man_facepalming"]),new Vu("🤷‍♀","peoples",["woman_shrugging"]),new Vu("🤷‍♂","peoples",["man_shrugging"]),new Vu("🙎","peoples",["pouting_woman","person_with_pouting_face"]),new Vu("🙎‍♂","peoples",["pouting_man"]),new Vu("🙍","peoples",["frowning_woman","person_frowning"]),new Vu("🙍‍♂","peoples",["frowning_man"]),new Vu("💇","peoples",["haircut_woman","haircut"]),new Vu("💇‍♂","peoples",["haircut_man"]),new Vu("💆","peoples",["massage_woman","massage"]),new Vu("💆‍♂","peoples",["massage_man"]),new Vu("🕴","peoples",["business_suit_levitating"]),new Vu("💃","peoples",["dancer"]),new Vu("🕺","peoples",["man_dancing"]),new Vu("👯","peoples",["dancing_women","dancers"]),new Vu("👯‍♂","peoples",["dancing_men"]),new Vu("🚶‍♀","peoples",["walking_woman"]),new Vu("🚶","peoples",["walking_man","walking"]),new Vu("🏃‍♀","peoples",["running_woman"]),new Vu("🏃","peoples",["running_man","runner","running"]),new Vu("👫","peoples",["couple"]),new Vu("👭","peoples",["two_women_holding_hands"]),new Vu("👬","peoples",["two_men_holding_hands"]),new Vu("💑","peoples",["couple_with_heart_woman_man","couple_with_heart"]),new Vu("👩‍❤️‍👩","peoples",["couple_with_heart_woman_woman"]),new Vu("👨‍❤️‍👨","peoples",["couple_with_heart_man_man"]),new Vu("💏","peoples",["couplekiss_man_woman"]),new Vu("👩‍❤️‍💋‍👩","peoples",["couplekiss_woman_woman"]),new Vu("👨‍❤️‍💋‍👨","peoples",["couplekiss_man_man"]),new Vu("👪","peoples",["family_man_woman_boy","family"]),new Vu("👨‍👩‍👧","peoples",["family_man_woman_girl"]),new Vu("👨‍👩‍👧‍👦","peoples",["family_man_woman_girl_boy"]),new Vu("👨‍👩‍👦‍👦","peoples",["family_man_woman_boy_boy"]),new Vu("👨‍👩‍👧‍👧","peoples",["family_man_woman_girl_girl"]),new Vu("👩‍👩‍👦","peoples",["family_woman_woman_boy"]),new Vu("👩‍👩‍👧","peoples",["family_woman_woman_girl"]),new Vu("👩‍👩‍👧‍👦","peoples",["family_woman_woman_girl_boy"]),new Vu("👩‍👩‍👦‍👦","peoples",["family_woman_woman_boy_boy"]),new Vu("👩‍👩‍👧‍👧","peoples",["family_woman_woman_girl_girl"]),new Vu("👨‍👨‍👦","peoples",["family_man_man_boy"]),new Vu("👨‍👨‍👧","peoples",["family_man_man_girl"]),new Vu("👨‍👨‍👧‍👦","peoples",["family_man_man_girl_boy"]),new Vu("👨‍👨‍👦‍👦","peoples",["family_man_man_boy_boy"]),new Vu("👨‍👨‍👧‍👧","peoples",["family_man_man_girl_girl"]),new Vu("👩‍👦","peoples",["family_woman_boy"]),new Vu("👩‍👧","peoples",["family_woman_girl"]),new Vu("👩‍👧‍👦","peoples",["family_woman_girl_boy"]),new Vu("👩‍👦‍👦","peoples",["family_woman_boy_boy"]),new Vu("👩‍👧‍👧","peoples",["family_woman_girl_girl"]),new Vu("👨‍👦","peoples",["family_man_boy"]),new Vu("👨‍👧","peoples",["family_man_girl"]),new Vu("👨‍👧‍👦","peoples",["family_man_girl_boy"]),new Vu("👨‍👦‍👦","peoples",["family_man_boy_boy"]),new Vu("👨‍👧‍👧","peoples",["family_man_girl_girl"]),new Vu("👚","peoples",["womans_clothes"]),new Vu("👕","peoples",["shirt","tshirt"]),new Vu("👖","peoples",["jeans"]),new Vu("👔","peoples",["necktie"]),new Vu("👗","peoples",["dress"]),new Vu("👙","peoples",["bikini"]),new Vu("👘","peoples",["kimono"]),new Vu("👠","peoples",["high_heel"]),new Vu("👡","peoples",["sandal"]),new Vu("👢","peoples",["boot"]),new Vu("👞","peoples",["mans_shoe","shoe"]),new Vu("👟","peoples",["athletic_shoe"]),new Vu("👒","peoples",["womans_hat"]),new Vu("🎩","peoples",["tophat"]),new Vu("🎓","peoples",["mortar_board"]),new Vu("👑","peoples",["crown"]),new Vu("⛑","peoples",["rescue_worker_helmet"]),new Vu("🎒","peoples",["school_satchel"]),new Vu("👝","peoples",["pouch"]),new Vu("👛","peoples",["purse"]),new Vu("👜","peoples",["handbag"]),new Vu("💼","peoples",["briefcase"]),new Vu("👓","peoples",["eyeglasses"]),new Vu("🕶","peoples",["dark_sunglasses"]),new Vu("🌂","peoples",["closed_umbrella"]),new Vu("☂️","peoples",["open_umbrella"]),new Vu("🐶","nature",["dog"]),new Vu("🐱","nature",["cat"]),new Vu("🐭","nature",["mouse"]),new Vu("🐹","nature",["hamster"]),new Vu("🐰","nature",["rabbit"]),new Vu("🦊","nature",["fox_face"]),new Vu("🐻","nature",["bear"]),new Vu("🐼","nature",["panda_face"]),new Vu("🐨","nature",["koala"]),new Vu("🐯","nature",["tiger"]),new Vu("🦁","nature",["lion"]),new Vu("🐮","nature",["cow"]),new Vu("🐷","nature",["pig"]),new Vu("🐽","nature",["pig_nose"]),new Vu("🐸","nature",["frog"]),new Vu("🐵","nature",["monkey_face"]),new Vu("🙈","nature",["see_no_evil"]),new Vu("🙉","nature",["hear_no_evil"]),new Vu("🙊","nature",["speak_no_evil"]),new Vu("🐒","nature",["monkey"]),new Vu("🐔","nature",["chicken"]),new Vu("🐧","nature",["penguin"]),new Vu("🐦","nature",["bird"]),new Vu("🐤","nature",["baby_chick"]),new Vu("🐣","nature",["hatching_chick"]),new Vu("🐥","nature",["hatched_chick"]),new Vu("🦆","nature",["duck"]),new Vu("🦅","nature",["eagle"]),new Vu("🦉","nature",["owl"]),new Vu("🦇","nature",["bat"]),new Vu("🐺","nature",["wolf"]),new Vu("🐗","nature",["boar"]),new Vu("🐴","nature",["horse"]),new Vu("🦄","nature",["unicorn"]),new Vu("🐝","nature",["bee","honeybee"]),new Vu("🐛","nature",["bug"]),new Vu("🦋","nature",["butterfly"]),new Vu("🐌","nature",["snail"]),new Vu("🐚","nature",["shell"]),new Vu("🐞","nature",["beetle"]),new Vu("🐜","nature",["ant"]),new Vu("🕷","nature",["spider"]),new Vu("🕸","nature",["spider_web"]),new Vu("🐢","nature",["turtle"]),new Vu("🐍","nature",["snake"]),new Vu("🦎","nature",["lizard"]),new Vu("🦂","nature",["scorpion"]),new Vu("🦀","nature",["crab"]),new Vu("🦑","nature",["squid"]),new Vu("🐙","nature",["octopus"]),new Vu("🦐","nature",["shrimp"]),new Vu("🐠","nature",["tropical_fish"]),new Vu("🐟","nature",["fish"]),new Vu("🐡","nature",["blowfish"]),new Vu("🐬","nature",["dolphin","flipper"]),new Vu("🦈","nature",["shark"]),new Vu("🐳","nature",["whale"]),new Vu("🐋","nature",["whale2"]),new Vu("🐊","nature",["crocodile"]),new Vu("🐆","nature",["leopard"]),new Vu("🐅","nature",["tiger2"]),new Vu("🐃","nature",["water_buffalo"]),new Vu("🐂","nature",["ox"]),new Vu("🐄","nature",["cow2"]),new Vu("🦌","nature",["deer"]),new Vu("🐪","nature",["dromedary_camel"]),new Vu("🐫","nature",["camel"]),new Vu("🐘","nature",["elephant"]),new Vu("🦏","nature",["rhinoceros"]),new Vu("🦍","nature",["gorilla"]),new Vu("🐎","nature",["racehorse"]),new Vu("🐖","nature",["pig2"]),new Vu("🐐","nature",["goat"]),new Vu("🐏","nature",["ram"]),new Vu("🐑","nature",["sheep"]),new Vu("🐕","nature",["dog2"]),new Vu("🐩","nature",["poodle"]),new Vu("🐈","nature",["cat2"]),new Vu("🐓","nature",["rooster"]),new Vu("🦃","nature",["turkey"]),new Vu("🕊","nature",["dove"]),new Vu("🐇","nature",["rabbit2"]),new Vu("🐁","nature",["mouse2"]),new Vu("🐀","nature",["rat"]),new Vu("🐿","nature",["chipmunk"]),new Vu("🐾","nature",["feet","paw_prints"]),new Vu("🐉","nature",["dragon"]),new Vu("🐲","nature",["dragon_face"]),new Vu("🌵","nature",["cactus"]),new Vu("🎄","nature",["christmas_tree"]),new Vu("🌲","nature",["evergreen_tree"]),new Vu("🌳","nature",["deciduous_tree"]),new Vu("🌴","nature",["palm_tree"]),new Vu("🌱","nature",["seedling"]),new Vu("🌿","nature",["herb"]),new Vu("☘️","nature",["shamrock"]),new Vu("🍀","nature",["four_leaf_clover"]),new Vu("🎍","nature",["bamboo"]),new Vu("🎋","nature",["tanabata_tree"]),new Vu("🍃","nature",["leaves"]),new Vu("🍂","nature",["fallen_leaf"]),new Vu("🍁","nature",["maple_leaf"]),new Vu("🍄","nature",["mushroom"]),new Vu("🌾","nature",["ear_of_rice"]),new Vu("💐","nature",["bouquet"]),new Vu("🌷","nature",["tulip"]),new Vu("🌹","nature",["rose"]),new Vu("🥀","nature",["wilted_flower"]),new Vu("🌻","nature",["sunflower"]),new Vu("🌼","nature",["blossom"]),new Vu("🌸","nature",["cherry_blossom"]),new Vu("🌺","nature",["hibiscus"]),new Vu("🌎","nature",["earth_americas"]),new Vu("🌍","nature",["earth_africa"]),new Vu("🌏","nature",["earth_asia"]),new Vu("🌕","nature",["full_moon"]),new Vu("🌖","nature",["waning_gibbous_moon"]),new Vu("🌗","nature",["last_quarter_moon"]),new Vu("🌘","nature",["waning_crescent_moon"]),new Vu("🌑","nature",["new_moon"]),new Vu("🌒","nature",["waxing_crescent_moon"]),new Vu("🌓","nature",["first_quarter_moon"]),new Vu("🌔","nature",["moon","waxing_gibbous_moon"]),new Vu("🌚","nature",["new_moon_with_face"]),new Vu("🌝","nature",["full_moon_with_face"]),new Vu("🌞","nature",["sun_with_face"]),new Vu("🌛","nature",["first_quarter_moon_with_face"]),new Vu("🌜","nature",["last_quarter_moon_with_face"]),new Vu("🌙","nature",["crescent_moon"]),new Vu("💫","nature",["dizzy"]),new Vu("⭐️","nature",["star"]),new Vu("🌟","nature",["star2"]),new Vu("✨","nature",["sparkles"]),new Vu("⚡️","nature",["zap"]),new Vu("🔥","nature",["fire"]),new Vu("💥","nature",["boom","collision"]),new Vu("☄","nature",["comet"]),new Vu("☀️","nature",["sunny"]),new Vu("🌤","nature",["sun_behind_small_cloud"]),new Vu("⛅️","nature",["partly_sunny"]),new Vu("🌥","nature",["sun_behind_large_cloud"]),new Vu("🌦","nature",["sun_behind_rain_cloud"]),new Vu("🌈","nature",["rainbow"]),new Vu("☁️","nature",["cloud"]),new Vu("🌧","nature",["cloud_with_rain"]),new Vu("⛈","nature",["cloud_with_lightning_and_rain"]),new Vu("🌩","nature",["cloud_with_lightning"]),new Vu("🌨","nature",["cloud_with_snow"]),new Vu("☃️","nature",["snowman_with_snow"]),new Vu("⛄️","nature",["snowman"]),new Vu("❄️","nature",["snowflake"]),new Vu("🌬","nature",["wind_face"]),new Vu("💨","nature",["dash"]),new Vu("🌪","nature",["tornado"]),new Vu("🌫","nature",["fog"]),new Vu("🌊","nature",["ocean"]),new Vu("💧","nature",["droplet"]),new Vu("💦","nature",["sweat_drops"]),new Vu("☔️","nature",["umbrella"]),new Vu("🍏","foods",["green_apple"]),new Vu("🍎","foods",["apple"]),new Vu("🍐","foods",["pear"]),new Vu("🍊","foods",["tangerine","orange","mandarin"]),new Vu("🍋","foods",["lemon"]),new Vu("🍌","foods",["banana"]),new Vu("🍉","foods",["watermelon"]),new Vu("🍇","foods",["grapes"]),new Vu("🍓","foods",["strawberry"]),new Vu("🍈","foods",["melon"]),new Vu("🍒","foods",["cherries"]),new Vu("🍑","foods",["peach"]),new Vu("🍍","foods",["pineapple"]),new Vu("🥝","foods",["kiwi_fruit"]),new Vu("🥑","foods",["avocado"]),new Vu("🍅","foods",["tomato"]),new Vu("🍆","foods",["eggplant"]),new Vu("🥒","foods",["cucumber"]),new Vu("🥕","foods",["carrot"]),new Vu("🌽","foods",["corn"]),new Vu("🌶","foods",["hot_pepper"]),new Vu("🥔","foods",["potato"]),new Vu("🍠","foods",["sweet_potato"]),new Vu("🌰","foods",["chestnut"]),new Vu("🥜","foods",["peanuts"]),new Vu("🍯","foods",["honey_pot"]),new Vu("🥐","foods",["croissant"]),new Vu("🍞","foods",["bread"]),new Vu("🥖","foods",["baguette_bread"]),new Vu("🧀","foods",["cheese"]),new Vu("🥚","foods",["egg"]),new Vu("🍳","foods",["fried_egg"]),new Vu("🥓","foods",["bacon"]),new Vu("🥞","foods",["pancakes"]),new Vu("🍤","foods",["fried_shrimp"]),new Vu("🍗","foods",["poultry_leg"]),new Vu("🍖","foods",["meat_on_bone"]),new Vu("🍕","foods",["pizza"]),new Vu("🌭","foods",["hotdog"]),new Vu("🍔","foods",["hamburger"]),new Vu("🍟","foods",["fries"]),new Vu("🥙","foods",["stuffed_flatbread"]),new Vu("🌮","foods",["taco"]),new Vu("🌯","foods",["burrito"]),new Vu("🥗","foods",["green_salad"]),new Vu("🥘","foods",["shallow_pan_of_food"]),new Vu("🍝","foods",["spaghetti"]),new Vu("🍜","foods",["ramen"]),new Vu("🍲","foods",["stew"]),new Vu("🍥","foods",["fish_cake"]),new Vu("🍣","foods",["sushi"]),new Vu("🍱","foods",["bento"]),new Vu("🍛","foods",["curry"]),new Vu("🍚","foods",["rice"]),new Vu("🍙","foods",["rice_ball"]),new Vu("🍘","foods",["rice_cracker"]),new Vu("🍢","foods",["oden"]),new Vu("🍡","foods",["dango"]),new Vu("🍧","foods",["shaved_ice"]),new Vu("🍨","foods",["ice_cream"]),new Vu("🍦","foods",["icecream"]),new Vu("🍰","foods",["cake"]),new Vu("🎂","foods",["birthday"]),new Vu("🍮","foods",["custard"]),new Vu("🍭","foods",["lollipop"]),new Vu("🍬","foods",["candy"]),new Vu("🍫","foods",["chocolate_bar"]),new Vu("🍿","foods",["popcorn"]),new Vu("🍩","foods",["doughnut"]),new Vu("🍪","foods",["cookie"]),new Vu("🥛","foods",["milk_glass"]),new Vu("🍼","foods",["baby_bottle"]),new Vu("☕️","foods",["coffee"]),new Vu("🍵","foods",["tea"]),new Vu("🍶","foods",["sake"]),new Vu("🍺","foods",["beer"]),new Vu("🍻","foods",["beers"]),new Vu("🥂","foods",["clinking_glasses"]),new Vu("🍷","foods",["wine_glass"]),new Vu("🥃","foods",["tumbler_glass"]),new Vu("🍸","foods",["cocktail"]),new Vu("🍹","foods",["tropical_drink"]),new Vu("🍾","foods",["champagne"]),new Vu("🥄","foods",["spoon"]),new Vu("🍴","foods",["fork_and_knife"]),new Vu("🍽","foods",["plate_with_cutlery"]),new Vu("⚽️","activity",["soccer"]),new Vu("🏀","activity",["basketball"]),new Vu("🏈","activity",["football"]),new Vu("⚾️","activity",["baseball"]),new Vu("🎾","activity",["tennis"]),new Vu("🏐","activity",["volleyball"]),new Vu("🏉","activity",["rugby_football"]),new Vu("🎱","activity",["8ball"]),new Vu("🏓","activity",["ping_pong"]),new Vu("🏸","activity",["badminton"]),new Vu("🥅","activity",["goal_net"]),new Vu("🏒","activity",["ice_hockey"]),new Vu("🏑","activity",["field_hockey"]),new Vu("🏏","activity",["cricket"]),new Vu("⛳️","activity",["golf"]),new Vu("🏹","activity",["bow_and_arrow"]),new Vu("🎣","activity",["fishing_pole_and_fish"]),new Vu("🥊","activity",["boxing_glove"]),new Vu("🥋","activity",["martial_arts_uniform"]),new Vu("⛸","activity",["ice_skate"]),new Vu("🎿","activity",["ski"]),new Vu("⛷","activity",["skier"]),new Vu("🏂","activity",["snowboarder"]),new Vu("🏋️‍♀️","activity",["weight_lifting_woman"]),new Vu("🏋","activity",["weight_lifting_man"]),new Vu("🤺","activity",["person_fencing"]),new Vu("🤼‍♀","activity",["women_wrestling"]),new Vu("🤼‍♂","activity",["men_wrestling"]),new Vu("🤸‍♀","activity",["woman_cartwheeling"]),new Vu("🤸‍♂","activity",["man_cartwheeling"]),new Vu("⛹️‍♀️","activity",["basketball_woman"]),new Vu("⛹","activity",["basketball_man"]),new Vu("🤾‍♀","activity",["woman_playing_handball"]),new Vu("🤾‍♂","activity",["man_playing_handball"]),new Vu("🏌️‍♀️","activity",["golfing_woman"]),new Vu("🏌","activity",["golfing_man"]),new Vu("🏄‍♀","activity",["surfing_woman"]),new Vu("🏄","activity",["surfing_man","surfer"]),new Vu("🏊‍♀","activity",["swimming_woman"]),new Vu("🏊","activity",["swimming_man","swimmer"]),new Vu("🤽‍♀","activity",["woman_playing_water_polo"]),new Vu("🤽‍♂","activity",["man_playing_water_polo"]),new Vu("🚣‍♀","activity",["rowing_woman"]),new Vu("🚣","activity",["rowing_man","rowboat"]),new Vu("🏇","activity",["horse_racing"]),new Vu("🚴‍♀","activity",["biking_woman"]),new Vu("🚴","activity",["biking_man","bicyclist"]),new Vu("🚵‍♀","activity",["mountain_biking_woman"]),new Vu("🚵","activity",["mountain_biking_man","mountain_bicyclist"]),new Vu("🎽","activity",["running_shirt_with_sash"]),new Vu("🏅","activity",["medal_sports"]),new Vu("🎖","activity",["medal_military"]),new Vu("🥇","activity",["1st_place_medal"]),new Vu("🥈","activity",["2nd_place_medal"]),new Vu("🥉","activity",["3rd_place_medal"]),new Vu("🏆","activity",["trophy"]),new Vu("🏵","activity",["rosette"]),new Vu("🎗","activity",["reminder_ribbon"]),new Vu("🎫","activity",["ticket"]),new Vu("🎟","activity",["tickets"]),new Vu("🎪","activity",["circus_tent"]),new Vu("🤹‍♀","activity",["woman_juggling"]),new Vu("🤹‍♂","activity",["man_juggling"]),new Vu("🎭","activity",["performing_arts"]),new Vu("🎨","activity",["art"]),new Vu("🎬","activity",["clapper"]),new Vu("🎤","activity",["microphone"]),new Vu("🎧","activity",["headphones"]),new Vu("🎼","activity",["musical_score"]),new Vu("🎹","activity",["musical_keyboard"]),new Vu("🥁","activity",["drum"]),new Vu("🎷","activity",["saxophone"]),new Vu("🎺","activity",["trumpet"]),new Vu("🎸","activity",["guitar"]),new Vu("🎻","activity",["violin"]),new Vu("🎲","activity",["game_die"]),new Vu("🎯","activity",["dart"]),new Vu("🎳","activity",["bowling"]),new Vu("🎮","activity",["video_game"]),new Vu("🎰","activity",["slot_machine"]),new Vu("🚗","places",["car","red_car"]),new Vu("🚕","places",["taxi"]),new Vu("🚙","places",["blue_car"]),new Vu("🚌","places",["bus"]),new Vu("🚎","places",["trolleybus"]),new Vu("🏎","places",["racing_car"]),new Vu("🚓","places",["police_car"]),new Vu("🚑","places",["ambulance"]),new Vu("🚒","places",["fire_engine"]),new Vu("🚐","places",["minibus"]),new Vu("🚚","places",["truck"]),new Vu("🚛","places",["articulated_lorry"]),new Vu("🚜","places",["tractor"]),new Vu("🛴","places",["kick_scooter"]),new Vu("🚲","places",["bike"]),new Vu("🛵","places",["motor_scooter"]),new Vu("🏍","places",["motorcycle"]),new Vu("🚨","places",["rotating_light"]),new Vu("🚔","places",["oncoming_police_car"]),new Vu("🚍","places",["oncoming_bus"]),new Vu("🚘","places",["oncoming_automobile"]),new Vu("🚖","places",["oncoming_taxi"]),new Vu("🚡","places",["aerial_tramway"]),new Vu("🚠","places",["mountain_cableway"]),new Vu("🚟","places",["suspension_railway"]),new Vu("🚃","places",["railway_car"]),new Vu("🚋","places",["train"]),new Vu("🚞","places",["mountain_railway"]),new Vu("🚝","places",["monorail"]),new Vu("🚄","places",["bullettrain_side"]),new Vu("🚅","places",["bullettrain_front"]),new Vu("🚈","places",["light_rail"]),new Vu("🚂","places",["steam_locomotive"]),new Vu("🚆","places",["train2"]),new Vu("🚇","places",["metro"]),new Vu("🚊","places",["tram"]),new Vu("🚉","places",["station"]),new Vu("🚁","places",["helicopter"]),new Vu("🛩","places",["small_airplane"]),new Vu("✈️","places",["airplane"]),new Vu("🛫","places",["flight_departure"]),new Vu("🛬","places",["flight_arrival"]),new Vu("🚀","places",["rocket"]),new Vu("🛰","places",["artificial_satellite"]),new Vu("💺","places",["seat"]),new Vu("🛶","places",["canoe"]),new Vu("⛵️","places",["boat","sailboat"]),new Vu("🛥","places",["motor_boat"]),new Vu("🚤","places",["speedboat"]),new Vu("🛳","places",["passenger_ship"]),new Vu("⛴","places",["ferry"]),new Vu("🚢","places",["ship"]),new Vu("⚓️","places",["anchor"]),new Vu("🚧","places",["construction"]),new Vu("⛽️","places",["fuelpump"]),new Vu("🚏","places",["busstop"]),new Vu("🚦","places",["vertical_traffic_light"]),new Vu("🚥","places",["traffic_light"]),new Vu("🗺","places",["world_map"]),new Vu("🗿","places",["moyai"]),new Vu("🗽","places",["statue_of_liberty"]),new Vu("⛲️","places",["fountain"]),new Vu("🗼","places",["tokyo_tower"]),new Vu("🏰","places",["european_castle"]),new Vu("🏯","places",["japanese_castle"]),new Vu("🏟","places",["stadium"]),new Vu("🎡","places",["ferris_wheel"]),new Vu("🎢","places",["roller_coaster"]),new Vu("🎠","places",["carousel_horse"]),new Vu("⛱","places",["parasol_on_ground"]),new Vu("🏖","places",["beach_umbrella"]),new Vu("🏝","places",["desert_island"]),new Vu("⛰","places",["mountain"]),new Vu("🏔","places",["mountain_snow"]),new Vu("🗻","places",["mount_fuji"]),new Vu("🌋","places",["volcano"]),new Vu("🏜","places",["desert"]),new Vu("🏕","places",["camping"]),new Vu("⛺️","places",["tent"]),new Vu("🛤","places",["railway_track"]),new Vu("🛣","places",["motorway"]),new Vu("🏗","places",["building_construction"]),new Vu("🏭","places",["factory"]),new Vu("🏠","places",["house"]),new Vu("🏡","places",["house_with_garden"]),new Vu("🏘","places",["houses"]),new Vu("🏚","places",["derelict_house"]),new Vu("🏢","places",["office"]),new Vu("🏬","places",["department_store"]),new Vu("🏣","places",["post_office"]),new Vu("🏤","places",["european_post_office"]),new Vu("🏥","places",["hospital"]),new Vu("🏦","places",["bank"]),new Vu("🏨","places",["hotel"]),new Vu("🏪","places",["convenience_store"]),new Vu("🏫","places",["school"]),new Vu("🏩","places",["love_hotel"]),new Vu("💒","places",["wedding"]),new Vu("🏛","places",["classical_building"]),new Vu("⛪️","places",["church"]),new Vu("🕌","places",["mosque"]),new Vu("🕍","places",["synagogue"]),new Vu("🕋","places",["kaaba"]),new Vu("⛩","places",["shinto_shrine"]),new Vu("🗾","places",["japan"]),new Vu("🎑","places",["rice_scene"]),new Vu("🏞","places",["national_park"]),new Vu("🌅","places",["sunrise"]),new Vu("🌄","places",["sunrise_over_mountains"]),new Vu("🌠","places",["stars"]),new Vu("🎇","places",["sparkler"]),new Vu("🎆","places",["fireworks"]),new Vu("🌇","places",["city_sunrise"]),new Vu("🌆","places",["city_sunset"]),new Vu("🏙","places",["cityscape"]),new Vu("🌃","places",["night_with_stars"]),new Vu("🌌","places",["milky_way"]),new Vu("🌉","places",["bridge_at_night"]),new Vu("🌁","places",["foggy"]),new Vu("⌚️","objects",["watch"]),new Vu("📱","objects",["iphone"]),new Vu("📲","objects",["calling"]),new Vu("💻","objects",["computer"]),new Vu("⌨️","objects",["keyboard"]),new Vu("🖥","objects",["desktop_computer"]),new Vu("🖨","objects",["printer"]),new Vu("🖱","objects",["computer_mouse"]),new Vu("🖲","objects",["trackball"]),new Vu("🕹","objects",["joystick"]),new Vu("🗜","objects",["clamp"]),new Vu("💽","objects",["minidisc"]),new Vu("💾","objects",["floppy_disk"]),new Vu("💿","objects",["cd"]),new Vu("📀","objects",["dvd"]),new Vu("📼","objects",["vhs"]),new Vu("📷","objects",["camera"]),new Vu("📸","objects",["camera_flash"]),new Vu("📹","objects",["video_camera"]),new Vu("🎥","objects",["movie_camera"]),new Vu("📽","objects",["film_projector"]),new Vu("🎞","objects",["film_strip"]),new Vu("📞","objects",["telephone_receiver"]),new Vu("☎️","objects",["phone","telephone"]),new Vu("📟","objects",["pager"]),new Vu("📠","objects",["fax"]),new Vu("📺","objects",["tv"]),new Vu("📻","objects",["radio"]),new Vu("🎙","objects",["studio_microphone"]),new Vu("🎚","objects",["level_slider"]),new Vu("🎛","objects",["control_knobs"]),new Vu("⏱","objects",["stopwatch"]),new Vu("⏲","objects",["timer_clock"]),new Vu("⏰","objects",["alarm_clock"]),new Vu("🕰","objects",["mantelpiece_clock"]),new Vu("⌛️","objects",["hourglass"]),new Vu("⏳","objects",["hourglass_flowing_sand"]),new Vu("📡","objects",["satellite"]),new Vu("🔋","objects",["battery"]),new Vu("🔌","objects",["electric_plug"]),new Vu("💡","objects",["bulb"]),new Vu("🔦","objects",["flashlight"]),new Vu("🕯","objects",["candle"]),new Vu("🗑","objects",["wastebasket"]),new Vu("🛢","objects",["oil_drum"]),new Vu("💸","objects",["money_with_wings"]),new Vu("💵","objects",["dollar"]),new Vu("💴","objects",["yen"]),new Vu("💶","objects",["euro"]),new Vu("💷","objects",["pound"]),new Vu("💰","objects",["moneybag"]),new Vu("💳","objects",["credit_card"]),new Vu("💎","objects",["gem"]),new Vu("⚖️","objects",["balance_scale"]),new Vu("🔧","objects",["wrench"]),new Vu("🔨","objects",["hammer"]),new Vu("⚒","objects",["hammer_and_pick"]),new Vu("🛠","objects",["hammer_and_wrench"]),new Vu("⛏","objects",["pick"]),new Vu("🔩","objects",["nut_and_bolt"]),new Vu("⚙️","objects",["gear"]),new Vu("⛓","objects",["chains"]),new Vu("🔫","objects",["gun"]),new Vu("💣","objects",["bomb"]),new Vu("🔪","objects",["hocho","knife"]),new Vu("🗡","objects",["dagger"]),new Vu("⚔️","objects",["crossed_swords"]),new Vu("🛡","objects",["shield"]),new Vu("🚬","objects",["smoking"]),new Vu("⚰️","objects",["coffin"]),new Vu("⚱️","objects",["funeral_urn"]),new Vu("🏺","objects",["amphora"]),new Vu("🔮","objects",["crystal_ball"]),new Vu("📿","objects",["prayer_beads"]),new Vu("💈","objects",["barber"]),new Vu("⚗️","objects",["alembic"]),new Vu("🔭","objects",["telescope"]),new Vu("🔬","objects",["microscope"]),new Vu("🕳","objects",["hole"]),new Vu("💊","objects",["pill"]),new Vu("💉","objects",["syringe"]),new Vu("🌡","objects",["thermometer"]),new Vu("🚽","objects",["toilet"]),new Vu("🚰","objects",["potable_water"]),new Vu("🚿","objects",["shower"]),new Vu("🛁","objects",["bathtub"]),new Vu("🛀","objects",["bath"]),new Vu("🛎","objects",["bellhop_bell"]),new Vu("🔑","objects",["key"]),new Vu("🗝","objects",["old_key"]),new Vu("🚪","objects",["door"]),new Vu("🛋","objects",["couch_and_lamp"]),new Vu("🛏","objects",["bed"]),new Vu("🛌","objects",["sleeping_bed"]),new Vu("🖼","objects",["framed_picture"]),new Vu("🛍","objects",["shopping"]),new Vu("🛒","objects",["shopping_cart"]),new Vu("🎁","objects",["gift"]),new Vu("🎈","objects",["balloon"]),new Vu("🎏","objects",["flags"]),new Vu("🎀","objects",["ribbon"]),new Vu("🎊","objects",["confetti_ball"]),new Vu("🎉","objects",["tada"]),new Vu("🎎","objects",["dolls"]),new Vu("🏮","objects",["izakaya_lantern","lantern"]),new Vu("🎐","objects",["wind_chime"]),new Vu("✉️","objects",["email","envelope"]),new Vu("📩","objects",["envelope_with_arrow"]),new Vu("📨","objects",["incoming_envelope"]),new Vu("📧","objects",["e-mail"]),new Vu("💌","objects",["love_letter"]),new Vu("📥","objects",["inbox_tray"]),new Vu("📤","objects",["outbox_tray"]),new Vu("📦","objects",["package"]),new Vu("🏷","objects",["label"]),new Vu("📪","objects",["mailbox_closed"]),new Vu("📫","objects",["mailbox"]),new Vu("📬","objects",["mailbox_with_mail"]),new Vu("📭","objects",["mailbox_with_no_mail"]),new Vu("📮","objects",["postbox"]),new Vu("📯","objects",["postal_horn"]),new Vu("📜","objects",["scroll"]),new Vu("📃","objects",["page_with_curl"]),new Vu("📄","objects",["page_facing_up"]),new Vu("📑","objects",["bookmark_tabs"]),new Vu("📊","objects",["bar_chart"]),new Vu("📈","objects",["chart_with_upwards_trend"]),new Vu("📉","objects",["chart_with_downwards_trend"]),new Vu("🗒","objects",["spiral_notepad"]),new Vu("🗓","objects",["spiral_calendar"]),new Vu("📆","objects",["calendar"]),new Vu("📅","objects",["date"]),new Vu("📇","objects",["card_index"]),new Vu("🗃","objects",["card_file_box"]),new Vu("🗳","objects",["ballot_box"]),new Vu("🗄","objects",["file_cabinet"]),new Vu("📋","objects",["clipboard"]),new Vu("📁","objects",["file_folder"]),new Vu("📂","objects",["open_file_folder"]),new Vu("🗂","objects",["card_index_dividers"]),new Vu("🗞","objects",["newspaper_roll"]),new Vu("📰","objects",["newspaper"]),new Vu("📓","objects",["notebook"]),new Vu("📔","objects",["notebook_with_decorative_cover"]),new Vu("📒","objects",["ledger"]),new Vu("📕","objects",["closed_book"]),new Vu("📗","objects",["green_book"]),new Vu("📘","objects",["blue_book"]),new Vu("📙","objects",["orange_book"]),new Vu("📚","objects",["books"]),new Vu("📖","objects",["book","open_book"]),new Vu("🔖","objects",["bookmark"]),new Vu("🔗","objects",["link"]),new Vu("📎","objects",["paperclip"]),new Vu("🖇","objects",["paperclips"]),new Vu("📐","objects",["triangular_ruler"]),new Vu("📏","objects",["straight_ruler"]),new Vu("📌","objects",["pushpin"]),new Vu("📍","objects",["round_pushpin"]),new Vu("✂️","objects",["scissors"]),new Vu("🖊","objects",["pen"]),new Vu("🖋","objects",["fountain_pen"]),new Vu("✒️","objects",["black_nib"]),new Vu("🖌","objects",["paintbrush"]),new Vu("🖍","objects",["crayon"]),new Vu("📝","objects",["memo","pencil"]),new Vu("✏️","objects",["pencil2"]),new Vu("🔍","objects",["mag"]),new Vu("🔎","objects",["mag_right"]),new Vu("🔏","objects",["lock_with_ink_pen"]),new Vu("🔐","objects",["closed_lock_with_key"]),new Vu("🔒","objects",["lock"]),new Vu("🔓","objects",["unlock"]),new Vu("❤️","symbols",["heart"]),new Vu("💛","symbols",["yellow_heart"]),new Vu("💚","symbols",["green_heart"]),new Vu("💙","symbols",["blue_heart"]),new Vu("💜","symbols",["purple_heart"]),new Vu("🖤","symbols",["black_heart"]),new Vu("💔","symbols",["broken_heart"]),new Vu("❣️","symbols",["heavy_heart_exclamation"]),new Vu("💕","symbols",["two_hearts"]),new Vu("💞","symbols",["revolving_hearts"]),new Vu("💓","symbols",["heartbeat"]),new Vu("💗","symbols",["heartpulse"]),new Vu("💖","symbols",["sparkling_heart"]),new Vu("💘","symbols",["cupid"]),new Vu("💝","symbols",["gift_heart"]),new Vu("💟","symbols",["heart_decoration"]),new Vu("☮️","symbols",["peace_symbol"]),new Vu("✝️","symbols",["latin_cross"]),new Vu("☪️","symbols",["star_and_crescent"]),new Vu("🕉","symbols",["om"]),new Vu("☸️","symbols",["wheel_of_dharma"]),new Vu("✡️","symbols",["star_of_david"]),new Vu("🔯","symbols",["six_pointed_star"]),new Vu("🕎","symbols",["menorah"]),new Vu("☯️","symbols",["yin_yang"]),new Vu("☦️","symbols",["orthodox_cross"]),new Vu("🛐","symbols",["place_of_worship"]),new Vu("⛎","symbols",["ophiuchus"]),new Vu("♈️","symbols",["aries"]),new Vu("♉️","symbols",["taurus"]),new Vu("♊️","symbols",["gemini"]),new Vu("♋️","symbols",["cancer"]),new Vu("♌️","symbols",["leo"]),new Vu("♍️","symbols",["virgo"]),new Vu("♎️","symbols",["libra"]),new Vu("♏️","symbols",["scorpius"]),new Vu("♐️","symbols",["sagittarius"]),new Vu("♑️","symbols",["capricorn"]),new Vu("♒️","symbols",["aquarius"]),new Vu("♓️","symbols",["pisces"]),new Vu("🆔","symbols",["id"]),new Vu("⚛️","symbols",["atom_symbol"]),new Vu("🉑","symbols",["accept"]),new Vu("☢️","symbols",["radioactive"]),new Vu("☣️","symbols",["biohazard"]),new Vu("📴","symbols",["mobile_phone_off"]),new Vu("📳","symbols",["vibration_mode"]),new Vu("🈶","symbols",["u6709"]),new Vu("🈚️","symbols",["u7121"]),new Vu("🈸","symbols",["u7533"]),new Vu("🈺","symbols",["u55b6"]),new Vu("🈷️","symbols",["u6708"]),new Vu("✴️","symbols",["eight_pointed_black_star"]),new Vu("🆚","symbols",["vs"]),new Vu("💮","symbols",["white_flower"]),new Vu("🉐","symbols",["ideograph_advantage"]),new Vu("㊙️","symbols",["secret"]),new Vu("㊗️","symbols",["congratulations"]),new Vu("🈴","symbols",["u5408"]),new Vu("🈵","symbols",["u6e80"]),new Vu("🈹","symbols",["u5272"]),new Vu("🈲","symbols",["u7981"]),new Vu("🅰️","symbols",["a"]),new Vu("🅱️","symbols",["b"]),new Vu("🆎","symbols",["ab"]),new Vu("🆑","symbols",["cl"]),new Vu("🅾️","symbols",["o2"]),new Vu("🆘","symbols",["sos"]),new Vu("❌","symbols",["x"]),new Vu("⭕️","symbols",["o"]),new Vu("🛑","symbols",["stop_sign"]),new Vu("⛔️","symbols",["no_entry"]),new Vu("📛","symbols",["name_badge"]),new Vu("🚫","symbols",["no_entry_sign"]),new Vu("💯","symbols",["100"]),new Vu("💢","symbols",["anger"]),new Vu("♨️","symbols",["hotsprings"]),new Vu("🚷","symbols",["no_pedestrians"]),new Vu("🚯","symbols",["do_not_litter"]),new Vu("🚳","symbols",["no_bicycles"]),new Vu("🚱","symbols",["non-potable_water"]),new Vu("🔞","symbols",["underage"]),new Vu("📵","symbols",["no_mobile_phones"]),new Vu("🚭","symbols",["no_smoking"]),new Vu("❗️","symbols",["exclamation","heavy_exclamation_mark"]),new Vu("❕","symbols",["grey_exclamation"]),new Vu("❓","symbols",["question"]),new Vu("❔","symbols",["grey_question"]),new Vu("‼️","symbols",["bangbang"]),new Vu("⁉️","symbols",["interrobang"]),new Vu("🔅","symbols",["low_brightness"]),new Vu("🔆","symbols",["high_brightness"]),new Vu("〽️","symbols",["part_alternation_mark"]),new Vu("⚠️","symbols",["warning"]),new Vu("🚸","symbols",["children_crossing"]),new Vu("🔱","symbols",["trident"]),new Vu("⚜️","symbols",["fleur_de_lis"]),new Vu("🔰","symbols",["beginner"]),new Vu("♻️","symbols",["recycle"]),new Vu("✅","symbols",["white_check_mark"]),new Vu("🈯️","symbols",["u6307"]),new Vu("💹","symbols",["chart"]),new Vu("❇️","symbols",["sparkle"]),new Vu("✳️","symbols",["eight_spoked_asterisk"]),new Vu("❎","symbols",["negative_squared_cross_mark"]),new Vu("🌐","symbols",["globe_with_meridians"]),new Vu("💠","symbols",["diamond_shape_with_a_dot_inside"]),new Vu("Ⓜ️","symbols",["m"]),new Vu("🌀","symbols",["cyclone"]),new Vu("💤","symbols",["zzz"]),new Vu("🏧","symbols",["atm"]),new Vu("🚾","symbols",["wc"]),new Vu("♿️","symbols",["wheelchair"]),new Vu("🅿️","symbols",["parking"]),new Vu("🈳","symbols",["u7a7a"]),new Vu("🈂️","symbols",["sa"]),new Vu("🛂","symbols",["passport_control"]),new Vu("🛃","symbols",["customs"]),new Vu("🛄","symbols",["baggage_claim"]),new Vu("🛅","symbols",["left_luggage"]),new Vu("🚹","symbols",["mens"]),new Vu("🚺","symbols",["womens"]),new Vu("🚼","symbols",["baby_symbol"]),new Vu("🚻","symbols",["restroom"]),new Vu("🚮","symbols",["put_litter_in_its_place"]),new Vu("🎦","symbols",["cinema"]),new Vu("📶","symbols",["signal_strength"]),new Vu("🈁","symbols",["koko"]),new Vu("🔣","symbols",["symbols"]),new Vu("ℹ️","symbols",["information_source"]),new Vu("🔤","symbols",["abc"]),new Vu("🔡","symbols",["abcd"]),new Vu("🔠","symbols",["capital_abcd"]),new Vu("🆖","symbols",["ng"]),new Vu("🆗","symbols",["ok"]),new Vu("🆙","symbols",["up"]),new Vu("🆒","symbols",["cool"]),new Vu("🆕","symbols",["new"]),new Vu("🆓","symbols",["free"]),new Vu("0️⃣","symbols",["zero"]),new Vu("1️⃣","symbols",["one"]),new Vu("2️⃣","symbols",["two"]),new Vu("3️⃣","symbols",["three"]),new Vu("4️⃣","symbols",["four"]),new Vu("5️⃣","symbols",["five"]),new Vu("6️⃣","symbols",["six"]),new Vu("7️⃣","symbols",["seven"]),new Vu("8️⃣","symbols",["eight"]),new Vu("9️⃣","symbols",["nine"]),new Vu("🔟","symbols",["keycap_ten"]),new Vu("🔢","symbols",["1234"]),new Vu("#️⃣","symbols",["hash"]),new Vu("*️⃣","symbols",["asterisk"]),new Vu("▶️","symbols",["arrow_forward"]),new Vu("⏸","symbols",["pause_button"]),new Vu("⏯","symbols",["play_or_pause_button"]),new Vu("⏹","symbols",["stop_button"]),new Vu("⏺","symbols",["record_button"]),new Vu("⏭","symbols",["next_track_button"]),new Vu("⏮","symbols",["previous_track_button"]),new Vu("⏩","symbols",["fast_forward"]),new Vu("⏪","symbols",["rewind"]),new Vu("⏫","symbols",["arrow_double_up"]),new Vu("⏬","symbols",["arrow_double_down"]),new Vu("◀️","symbols",["arrow_backward"]),new Vu("🔼","symbols",["arrow_up_small"]),new Vu("🔽","symbols",["arrow_down_small"]),new Vu("➡️","symbols",["arrow_right"]),new Vu("⬅️","symbols",["arrow_left"]),new Vu("⬆️","symbols",["arrow_up"]),new Vu("⬇️","symbols",["arrow_down"]),new Vu("↗️","symbols",["arrow_upper_right"]),new Vu("↘️","symbols",["arrow_lower_right"]),new Vu("↙️","symbols",["arrow_lower_left"]),new Vu("↖️","symbols",["arrow_upper_left"]),new Vu("↕️","symbols",["arrow_up_down"]),new Vu("↔️","symbols",["left_right_arrow"]),new Vu("↪️","symbols",["arrow_right_hook"]),new Vu("↩️","symbols",["leftwards_arrow_with_hook"]),new Vu("⤴️","symbols",["arrow_heading_up"]),new Vu("⤵️","symbols",["arrow_heading_down"]),new Vu("🔀","symbols",["twisted_rightwards_arrows"]),new Vu("🔁","symbols",["repeat"]),new Vu("🔂","symbols",["repeat_one"]),new Vu("🔄","symbols",["arrows_counterclockwise"]),new Vu("🔃","symbols",["arrows_clockwise"]),new Vu("🎵","symbols",["musical_note"]),new Vu("🎶","symbols",["notes"]),new Vu("➕","symbols",["heavy_plus_sign"]),new Vu("➖","symbols",["heavy_minus_sign"]),new Vu("➗","symbols",["heavy_division_sign"]),new Vu("✖️","symbols",["heavy_multiplication_x"]),new Vu("💲","symbols",["heavy_dollar_sign"]),new Vu("💱","symbols",["currency_exchange"]),new Vu("™️","symbols",["tm"]),new Vu("©️","symbols",["copyright"]),new Vu("®️","symbols",["registered"]),new Vu("〰️","symbols",["wavy_dash"]),new Vu("➰","symbols",["curly_loop"]),new Vu("➿","symbols",["loop"]),new Vu("🔚","symbols",["end"]),new Vu("🔙","symbols",["back"]),new Vu("🔛","symbols",["on"]),new Vu("🔝","symbols",["top"]),new Vu("🔜","symbols",["soon"]),new Vu("✔️","symbols",["heavy_check_mark"]),new Vu("☑️","symbols",["ballot_box_with_check"]),new Vu("🔘","symbols",["radio_button"]),new Vu("⚪️","symbols",["white_circle"]),new Vu("⚫️","symbols",["black_circle"]),new Vu("🔴","symbols",["red_circle"]),new Vu("🔵","symbols",["large_blue_circle"]),new Vu("🔺","symbols",["small_red_triangle"]),new Vu("🔻","symbols",["small_red_triangle_down"]),new Vu("🔸","symbols",["small_orange_diamond"]),new Vu("🔹","symbols",["small_blue_diamond"]),new Vu("🔶","symbols",["large_orange_diamond"]),new Vu("🔷","symbols",["large_blue_diamond"]),new Vu("🔳","symbols",["white_square_button"]),new Vu("🔲","symbols",["black_square_button"]),new Vu("▪️","symbols",["black_small_square"]),new Vu("▫️","symbols",["white_small_square"]),new Vu("◾️","symbols",["black_medium_small_square"]),new Vu("◽️","symbols",["white_medium_small_square"]),new Vu("◼️","symbols",["black_medium_square"]),new Vu("◻️","symbols",["white_medium_square"]),new Vu("⬛️","symbols",["black_large_square"]),new Vu("⬜️","symbols",["white_large_square"]),new Vu("🔈","symbols",["speaker"]),new Vu("🔇","symbols",["mute"]),new Vu("🔉","symbols",["sound"]),new Vu("🔊","symbols",["loud_sound"]),new Vu("🔔","symbols",["bell"]),new Vu("🔕","symbols",["no_bell"]),new Vu("📣","symbols",["mega"]),new Vu("📢","symbols",["loudspeaker"]),new Vu("👁‍🗨","symbols",["eye_speech_bubble"]),new Vu("💬","symbols",["speech_balloon"]),new Vu("💭","symbols",["thought_balloon"]),new Vu("🗯","symbols",["right_anger_bubble"]),new Vu("♠️","symbols",["spades"]),new Vu("♣️","symbols",["clubs"]),new Vu("♥️","symbols",["hearts"]),new Vu("♦️","symbols",["diamonds"]),new Vu("🃏","symbols",["black_joker"]),new Vu("🎴","symbols",["flower_playing_cards"]),new Vu("🀄️","symbols",["mahjong"]),new Vu("🕐","symbols",["clock1"]),new Vu("🕑","symbols",["clock2"]),new Vu("🕒","symbols",["clock3"]),new Vu("🕓","symbols",["clock4"]),new Vu("🕔","symbols",["clock5"]),new Vu("🕕","symbols",["clock6"]),new Vu("🕖","symbols",["clock7"]),new Vu("🕗","symbols",["clock8"]),new Vu("🕘","symbols",["clock9"]),new Vu("🕙","symbols",["clock10"]),new Vu("🕚","symbols",["clock11"]),new Vu("🕛","symbols",["clock12"]),new Vu("🕜","symbols",["clock130"]),new Vu("🕝","symbols",["clock230"]),new Vu("🕞","symbols",["clock330"]),new Vu("🕟","symbols",["clock430"]),new Vu("🕠","symbols",["clock530"]),new Vu("🕡","symbols",["clock630"]),new Vu("🕢","symbols",["clock730"]),new Vu("🕣","symbols",["clock830"]),new Vu("🕤","symbols",["clock930"]),new Vu("🕥","symbols",["clock1030"]),new Vu("🕦","symbols",["clock1130"]),new Vu("🕧","symbols",["clock1230"]),new Vu("🏳️","flags",["white_flag"]),new Vu("🏴","flags",["black_flag"]),new Vu("🏁","flags",["checkered_flag"]),new Vu("🚩","flags",["triangular_flag_on_post"]),new Vu("🏳️‍🌈","flags",["rainbow_flag"]),new Vu("🇦🇫","flags",["afghanistan"]),new Vu("🇦🇽","flags",["aland_islands"]),new Vu("🇦🇱","flags",["albania"]),new Vu("🇩🇿","flags",["algeria"]),new Vu("🇦🇸","flags",["american_samoa"]),new Vu("🇦🇩","flags",["andorra"]),new Vu("🇦🇴","flags",["angola"]),new Vu("🇦🇮","flags",["anguilla"]),new Vu("🇦🇶","flags",["antarctica"]),new Vu("🇦🇬","flags",["antigua_barbuda"]),new Vu("🇦🇷","flags",["argentina"]),new Vu("🇦🇲","flags",["armenia"]),new Vu("🇦🇼","flags",["aruba"]),new Vu("🇦🇺","flags",["australia"]),new Vu("🇦🇹","flags",["austria"]),new Vu("🇦🇿","flags",["azerbaijan"]),new Vu("🇧🇸","flags",["bahamas"]),new Vu("🇧🇭","flags",["bahrain"]),new Vu("🇧🇩","flags",["bangladesh"]),new Vu("🇧🇧","flags",["barbados"]),new Vu("🇧🇾","flags",["belarus"]),new Vu("🇧🇪","flags",["belgium"]),new Vu("🇧🇿","flags",["belize"]),new Vu("🇧🇯","flags",["benin"]),new Vu("🇧🇲","flags",["bermuda"]),new Vu("🇧🇹","flags",["bhutan"]),new Vu("🇧🇴","flags",["bolivia"]),new Vu("🇧🇶","flags",["caribbean_netherlands"]),new Vu("🇧🇦","flags",["bosnia_herzegovina"]),new Vu("🇧🇼","flags",["botswana"]),new Vu("🇧🇷","flags",["brazil"]),new Vu("🇮🇴","flags",["british_indian_ocean_territory"]),new Vu("🇻🇬","flags",["british_virgin_islands"]),new Vu("🇧🇳","flags",["brunei"]),new Vu("🇧🇬","flags",["bulgaria"]),new Vu("🇧🇫","flags",["burkina_faso"]),new Vu("🇧🇮","flags",["burundi"]),new Vu("🇨🇻","flags",["cape_verde"]),new Vu("🇰🇭","flags",["cambodia"]),new Vu("🇨🇲","flags",["cameroon"]),new Vu("🇨🇦","flags",["canada"]),new Vu("🇮🇨","flags",["canary_islands"]),new Vu("🇰🇾","flags",["cayman_islands"]),new Vu("🇨🇫","flags",["central_african_republic"]),new Vu("🇹🇩","flags",["chad"]),new Vu("🇨🇱","flags",["chile"]),new Vu("🇨🇳","flags",["cn"]),new Vu("🇨🇽","flags",["christmas_island"]),new Vu("🇨🇨","flags",["cocos_islands"]),new Vu("🇨🇴","flags",["colombia"]),new Vu("🇰🇲","flags",["comoros"]),new Vu("🇨🇬","flags",["congo_brazzaville"]),new Vu("🇨🇩","flags",["congo_kinshasa"]),new Vu("🇨🇰","flags",["cook_islands"]),new Vu("🇨🇷","flags",["costa_rica"]),new Vu("🇨🇮","flags",["cote_divoire"]),new Vu("🇭🇷","flags",["croatia"]),new Vu("🇨🇺","flags",["cuba"]),new Vu("🇨🇼","flags",["curacao"]),new Vu("🇨🇾","flags",["cyprus"]),new Vu("🇨🇿","flags",["czech_republic"]),new Vu("🇩🇰","flags",["denmark"]),new Vu("🇩🇯","flags",["djibouti"]),new Vu("🇩🇲","flags",["dominica"]),new Vu("🇩🇴","flags",["dominican_republic"]),new Vu("🇪🇨","flags",["ecuador"]),new Vu("🇪🇬","flags",["egypt"]),new Vu("🇸🇻","flags",["el_salvador"]),new Vu("🇬🇶","flags",["equatorial_guinea"]),new Vu("🇪🇷","flags",["eritrea"]),new Vu("🇪🇪","flags",["estonia"]),new Vu("🇪🇹","flags",["ethiopia"]),new Vu("🇪🇺","flags",["eu","european_union"]),new Vu("🇫🇰","flags",["falkland_islands"]),new Vu("🇫🇴","flags",["faroe_islands"]),new Vu("🇫🇯","flags",["fiji"]),new Vu("🇫🇮","flags",["finland"]),new Vu("🇫🇷","flags",["fr"]),new Vu("🇬🇫","flags",["french_guiana"]),new Vu("🇵🇫","flags",["french_polynesia"]),new Vu("🇹🇫","flags",["french_southern_territories"]),new Vu("🇬🇦","flags",["gabon"]),new Vu("🇬🇲","flags",["gambia"]),new Vu("🇬🇪","flags",["georgia"]),new Vu("🇩🇪","flags",["de"]),new Vu("🇬🇭","flags",["ghana"]),new Vu("🇬🇮","flags",["gibraltar"]),new Vu("🇬🇷","flags",["greece"]),new Vu("🇬🇱","flags",["greenland"]),new Vu("🇬🇩","flags",["grenada"]),new Vu("🇬🇵","flags",["guadeloupe"]),new Vu("🇬🇺","flags",["guam"]),new Vu("🇬🇹","flags",["guatemala"]),new Vu("🇬🇬","flags",["guernsey"]),new Vu("🇬🇳","flags",["guinea"]),new Vu("🇬🇼","flags",["guinea_bissau"]),new Vu("🇬🇾","flags",["guyana"]),new Vu("🇭🇹","flags",["haiti"]),new Vu("🇭🇳","flags",["honduras"]),new Vu("🇭🇰","flags",["hong_kong"]),new Vu("🇭🇺","flags",["hungary"]),new Vu("🇮🇸","flags",["iceland"]),new Vu("🇮🇳","flags",["india"]),new Vu("🇮🇩","flags",["indonesia"]),new Vu("🇮🇷","flags",["iran"]),new Vu("🇮🇶","flags",["iraq"]),new Vu("🇮🇪","flags",["ireland"]),new Vu("🇮🇲","flags",["isle_of_man"]),new Vu("🇮🇱","flags",["israel"]),new Vu("🇮🇹","flags",["it"]),new Vu("🇯🇲","flags",["jamaica"]),new Vu("🇯🇵","flags",["jp"]),new Vu("🎌","flags",["crossed_flags"]),new Vu("🇯🇪","flags",["jersey"]),new Vu("🇯🇴","flags",["jordan"]),new Vu("🇰🇿","flags",["kazakhstan"]),new Vu("🇰🇪","flags",["kenya"]),new Vu("🇰🇮","flags",["kiribati"]),new Vu("🇽🇰","flags",["kosovo"]),new Vu("🇰🇼","flags",["kuwait"]),new Vu("🇰🇬","flags",["kyrgyzstan"]),new Vu("🇱🇦","flags",["laos"]),new Vu("🇱🇻","flags",["latvia"]),new Vu("🇱🇧","flags",["lebanon"]),new Vu("🇱🇸","flags",["lesotho"]),new Vu("🇱🇷","flags",["liberia"]),new Vu("🇱🇾","flags",["libya"]),new Vu("🇱🇮","flags",["liechtenstein"]),new Vu("🇱🇹","flags",["lithuania"]),new Vu("🇱🇺","flags",["luxembourg"]),new Vu("🇲🇴","flags",["macau"]),new Vu("🇲🇰","flags",["macedonia"]),new Vu("🇲🇬","flags",["madagascar"]),new Vu("🇲🇼","flags",["malawi"]),new Vu("🇲🇾","flags",["malaysia"]),new Vu("🇲🇻","flags",["maldives"]),new Vu("🇲🇱","flags",["mali"]),new Vu("🇲🇹","flags",["malta"]),new Vu("🇲🇭","flags",["marshall_islands"]),new Vu("🇲🇶","flags",["martinique"]),new Vu("🇲🇷","flags",["mauritania"]),new Vu("🇲🇺","flags",["mauritius"]),new Vu("🇾🇹","flags",["mayotte"]),new Vu("🇲🇽","flags",["mexico"]),new Vu("🇫🇲","flags",["micronesia"]),new Vu("🇲🇩","flags",["moldova"]),new Vu("🇲🇨","flags",["monaco"]),new Vu("🇲🇳","flags",["mongolia"]),new Vu("🇲🇪","flags",["montenegro"]),new Vu("🇲🇸","flags",["montserrat"]),new Vu("🇲🇦","flags",["morocco"]),new Vu("🇲🇿","flags",["mozambique"]),new Vu("🇲🇲","flags",["myanmar"]),new Vu("🇳🇦","flags",["namibia"]),new Vu("🇳🇷","flags",["nauru"]),new Vu("🇳🇵","flags",["nepal"]),new Vu("🇳🇱","flags",["netherlands"]),new Vu("🇳🇨","flags",["new_caledonia"]),new Vu("🇳🇿","flags",["new_zealand"]),new Vu("🇳🇮","flags",["nicaragua"]),new Vu("🇳🇪","flags",["niger"]),new Vu("🇳🇬","flags",["nigeria"]),new Vu("🇳🇺","flags",["niue"]),new Vu("🇳🇫","flags",["norfolk_island"]),new Vu("🇲🇵","flags",["northern_mariana_islands"]),new Vu("🇰🇵","flags",["north_korea"]),new Vu("🇳🇴","flags",["norway"]),new Vu("🇴🇲","flags",["oman"]),new Vu("🇵🇰","flags",["pakistan"]),new Vu("🇵🇼","flags",["palau"]),new Vu("🇵🇸","flags",["palestinian_territories"]),new Vu("🇵🇦","flags",["panama"]),new Vu("🇵🇬","flags",["papua_new_guinea"]),new Vu("🇵🇾","flags",["paraguay"]),new Vu("🇵🇪","flags",["peru"]),new Vu("🇵🇭","flags",["philippines"]),new Vu("🇵🇳","flags",["pitcairn_islands"]),new Vu("🇵🇱","flags",["poland"]),new Vu("🇵🇹","flags",["portugal"]),new Vu("🇵🇷","flags",["puerto_rico"]),new Vu("🇶🇦","flags",["qatar"]),new Vu("🇷🇪","flags",["reunion"]),new Vu("🇷🇴","flags",["romania"]),new Vu("🇷🇺","flags",["ru"]),new Vu("🇷🇼","flags",["rwanda"]),new Vu("🇧🇱","flags",["st_barthelemy"]),new Vu("🇸🇭","flags",["st_helena"]),new Vu("🇰🇳","flags",["st_kitts_nevis"]),new Vu("🇱🇨","flags",["st_lucia"]),new Vu("🇵🇲","flags",["st_pierre_miquelon"]),new Vu("🇻🇨","flags",["st_vincent_grenadines"]),new Vu("🇼🇸","flags",["samoa"]),new Vu("🇸🇲","flags",["san_marino"]),new Vu("🇸🇹","flags",["sao_tome_principe"]),new Vu("🇸🇦","flags",["saudi_arabia"]),new Vu("🇸🇳","flags",["senegal"]),new Vu("🇷🇸","flags",["serbia"]),new Vu("🇸🇨","flags",["seychelles"]),new Vu("🇸🇱","flags",["sierra_leone"]),new Vu("🇸🇬","flags",["singapore"]),new Vu("🇸🇽","flags",["sint_maarten"]),new Vu("🇸🇰","flags",["slovakia"]),new Vu("🇸🇮","flags",["slovenia"]),new Vu("🇸🇧","flags",["solomon_islands"]),new Vu("🇸🇴","flags",["somalia"]),new Vu("🇿🇦","flags",["south_africa"]),new Vu("🇬🇸","flags",["south_georgia_south_sandwich_islands"]),new Vu("🇰🇷","flags",["kr"]),new Vu("🇸🇸","flags",["south_sudan"]),new Vu("🇪🇸","flags",["es"]),new Vu("🇱🇰","flags",["sri_lanka"]),new Vu("🇸🇩","flags",["sudan"]),new Vu("🇸🇷","flags",["suriname"]),new Vu("🇸🇿","flags",["swaziland"]),new Vu("🇸🇪","flags",["sweden"]),new Vu("🇨🇭","flags",["switzerland"]),new Vu("🇸🇾","flags",["syria"]),new Vu("🇹🇼","flags",["taiwan"]),new Vu("🇹🇯","flags",["tajikistan"]),new Vu("🇹🇿","flags",["tanzania"]),new Vu("🇹🇭","flags",["thailand"]),new Vu("🇹🇱","flags",["timor_leste"]),new Vu("🇹🇬","flags",["togo"]),new Vu("🇹🇰","flags",["tokelau"]),new Vu("🇹🇴","flags",["tonga"]),new Vu("🇹🇹","flags",["trinidad_tobago"]),new Vu("🇹🇳","flags",["tunisia"]),new Vu("🇹🇷","flags",["tr"]),new Vu("🇹🇲","flags",["turkmenistan"]),new Vu("🇹🇨","flags",["turks_caicos_islands"]),new Vu("🇹🇻","flags",["tuvalu"]),new Vu("🇺🇬","flags",["uganda"]),new Vu("🇺🇦","flags",["ukraine"]),new Vu("🇦🇪","flags",["united_arab_emirates"]),new Vu("🇬🇧","flags",["gb","uk"]),new Vu("🇺🇸","flags",["us"]),new Vu("🇻🇮","flags",["us_virgin_islands"]),new Vu("🇺🇾","flags",["uruguay"]),new Vu("🇺🇿","flags",["uzbekistan"]),new Vu("🇻🇺","flags",["vanuatu"]),new Vu("🇻🇦","flags",["vatican_city"]),new Vu("🇻🇪","flags",["venezuela"]),new Vu("🇻🇳","flags",["vietnam"]),new Vu("🇼🇫","flags",["wallis_futuna"]),new Vu("🇪🇭","flags",["western_sahara"]),new Vu("🇾🇪","flags",["yemen"]),new Vu("🇿🇲","flags",["zambia"]),new Vu("🇿🇼","flags",["zimbabwe"])],Uu='\n    <svg width="1em" height="1em"\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 303.6 303.6">\n      <path d="M291.503 11.6c-10.4-10.4-37.2-11.6-48.4-11.6-50.4 0-122.4 18.4-173.6 69.6-77.2 76.8-78.4 201.6-58.4 222 10.8 10.4 35.6 12 49.2 12 49.6 0 121.2-18.4 173.2-70 76.4-76.4 80.4-199.6 58-222zm-231.2 277.2c-24.4 0-36-4.8-38.8-7.6-5.2-5.2-8.4-24.4-6.8-49.6l57.2 56.8c-4 .4-8 .4-11.6.4zm162.8-66c-38.8 38.8-90.4 57.2-132.4 63.6l-74-73.6c6-42 24-94 63.2-133.2 38-38 88-56.4 130.8-62.8l75.6 75.6c-6 40.8-24.4 91.6-63.2 130.4zm65.2-148.8l-58.8-59.2c4.8-.4 9.2-.4 13.6-.4 24.4 0 35.6 4.8 38 7.2 5.6 5.6 9.2 25.6 7.2 52.4z"/>\n      <path d="M215.103 139.6l-20.8-20.8 13.2-13.2c2.8-2.8 2.8-7.6 0-10.4s-7.6-2.8-10.4 0l-13.2 13.6-20.8-20.8c-2.8-2.8-7.6-2.8-10.4 0-2.8 2.8-2.8 7.6 0 10.4l20.8 20.8-22 22-20.8-20.8c-2.8-2.8-7.6-2.8-10.4 0s-2.8 7.6 0 10.4l20.8 20.8-22 22-20.8-20.8c-2.8-2.8-7.6-2.8-10.4 0s-2.8 7.6 0 10.4l20.8 20.8-13.2 13.2c-2.8 2.8-2.8 7.6 0 10.4 1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2l13.2-13.2 20.8 20.8c1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2c2.8-2.8 2.8-7.6 0-10.4l-20.8-21.2 22-22 20.8 20.8c1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2c2.8-2.8 2.8-7.6 0-10.4l-20.8-20.8 22-22 20.8 20.8c1.6 1.6 3.2 2 5.2 2s3.6-.8 5.2-2c2.8-2.8 2.8-7.6 0-10.4zM169.103 47.6c-1.2-4-5.2-6-9.2-4.8-3.2 1.2-80.8 25.6-110.4 98-1.6 4 0 8.4 4 9.6.8.4 2 .4 2.8.4 2.8 0 5.6-1.6 6.8-4.4 27.2-66 100.4-89.6 101.2-89.6 4-1.2 6-5.2 4.8-9.2z"/>\n    </svg>\n    ',qu='\n    <svg width="1em" height="1em"\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n      <path d="M472.928 34.72c-4.384-2.944-9.984-3.52-14.912-1.568-1.088.448-106.528 42.176-195.168.384C186.752-2.4 102.944 14.4 64 25.76V16c0-8.832-7.168-16-16-16S32 7.168 32 16v480c0 8.832 7.168 16 16 16s16-7.168 16-16V315.296c28.352-9.248 112.384-31.232 185.184 3.168 34.592 16.352 70.784 21.792 103.648 21.792 63.2 0 114.016-20.128 117.184-21.408 6.016-2.464 9.984-8.32 9.984-14.848V48c0-5.312-2.656-10.272-7.072-13.28zM448 292.672c-28.512 9.248-112.512 31.136-185.184-3.168C186.752 253.6 102.944 270.4 64 281.76V59.328c28.352-9.248 112.384-31.232 185.184 3.168 76 35.872 159.872 19.104 198.816 7.712v222.464z"/>\n    </svg>\n    ',Gu='\n    <svg width="1em" height="1em"\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.999 511.999">\n      <path d="M413.949 155.583a10.153 10.153 0 0 0-3.24-2.16c-.61-.25-1.24-.44-1.87-.57-3.25-.66-6.701.41-9.03 2.73a10.093 10.093 0 0 0-2.93 7.07 10.098 10.098 0 0 0 1.69 5.56c.36.54.779 1.05 1.24 1.52 1.86 1.86 4.44 2.93 7.07 2.93.65 0 1.31-.07 1.96-.2.63-.13 1.26-.32 1.87-.57a10.146 10.146 0 0 0 3.24-2.16c.47-.47.88-.98 1.25-1.52a10.098 10.098 0 0 0 1.49-3.6 10.038 10.038 0 0 0-2.74-9.03zM115.289 385.873c-.12-.64-.32-1.27-.57-1.87-.25-.6-.55-1.18-.91-1.73-.37-.54-.79-1.06-1.25-1.52a9.57 9.57 0 0 0-1.52-1.24c-.54-.36-1.12-.67-1.72-.92-.61-.25-1.24-.44-1.88-.57a9.847 9.847 0 0 0-3.9 0c-.64.13-1.27.32-1.87.57-.61.25-1.19.56-1.73.92-.55.36-1.06.78-1.52 1.24-.46.46-.88.98-1.24 1.52-.36.55-.67 1.13-.92 1.73-.25.6-.45 1.23-.57 1.87-.13.651-.2 1.3-.2 1.96 0 .65.07 1.3.2 1.95.12.64.32 1.27.57 1.87.25.6.56 1.18.92 1.73.36.54.78 1.06 1.24 1.52.46.46.97.88 1.52 1.24.54.36 1.12.67 1.73.92.6.25 1.23.44 1.87.57s1.3.2 1.95.2c.65 0 1.31-.07 1.95-.2.64-.13 1.27-.32 1.88-.57.6-.25 1.18-.56 1.72-.92.55-.36 1.059-.78 1.52-1.24.46-.46.88-.98 1.25-1.52.36-.55.66-1.13.91-1.73.25-.6.45-1.23.57-1.87.13-.65.2-1.3.2-1.95 0-.66-.07-1.31-.2-1.96z"/>\n      <path d="M511.999 222.726c0-14.215-9.228-26.315-22.007-30.624-1.628-74.155-62.456-133.978-136.994-133.978H159.002c-74.538 0-135.366 59.823-136.994 133.978C9.228 196.411 0 208.51 0 222.726a32.076 32.076 0 0 0 3.847 15.203 44.931 44.931 0 0 0-.795 8.427v.708c0 14.06 6.519 26.625 16.693 34.833-10.178 8.275-16.693 20.891-16.693 35.001 0 15.114 7.475 28.515 18.921 36.702v26.668c0 40.588 33.021 73.608 73.608 73.608h320.836c40.588 0 73.608-33.021 73.608-73.608V353.6c11.446-8.186 18.921-21.587 18.921-36.702 0-13.852-6.354-26.385-16.361-34.702 9.983-8.212 16.361-20.656 16.361-34.562v-.708c0-2.985-.294-5.944-.877-8.845a32.082 32.082 0 0 0 3.93-15.355zM44.033 173.229h322.441c5.523 0 10-4.477 10-10s-4.477-10-10-10H49.737c16.896-43.883 59.503-75.106 109.265-75.106h193.996c62.942 0 114.438 49.953 116.934 112.295H42.068c.234-5.848.9-11.588 1.965-17.189zM23.052 316.896c0-13.837 11.257-25.094 25.094-25.094h117.298l55.346 50.188H48.146c-13.837 0-25.094-11.256-25.094-25.094zm.976-62.945c.422.111.847.215 1.275.309 7.421 1.634 14.68 8.002 22.365 14.744a576.29 576.29 0 0 0 3.206 2.799h-3.081c-11.253-.001-20.774-7.551-23.765-17.852zm308.727 89.752l57.233-51.899 49.904.57-81.871 74.24-25.266-22.911zm7.861 34.126H295.12l17.467-15.839h10.563l17.466 15.839zm19.599-86.027l-82.499 74.811-82.499-74.811h164.998zm-59.529-20c.849-.842 1.677-1.675 2.49-2.493 9.531-9.587 17.059-17.16 32.89-17.16 15.832 0 23.359 7.573 32.89 17.162.812.817 1.64 1.65 2.489 2.491h-70.759zm-160.13 0a485.82 485.82 0 0 0 2.489-2.492c9.531-9.588 17.059-17.161 32.89-17.161 15.83 0 23.358 7.573 32.888 17.16.813.818 1.641 1.651 2.49 2.493h-70.757zm275.862 162.073H95.582c-29.56 0-53.608-24.049-53.608-53.608v-18.275h200.872l17.467 15.839H145.897c-5.523 0-10 4.477-10 10s4.477 10 10 10H467.07c-7.288 20.958-27.242 36.044-50.652 36.044zm53.608-56.046h-94.6l17.467-15.839h77.133v15.839zm-6.174-35.837h-48.906l54.624-49.533c11.135 2.604 19.376 12.665 19.376 24.439 0 13.836-11.257 25.094-25.094 25.094zm-2.728-70.19l.262-.227.101-.087.342-.298c.848-.738 1.682-1.469 2.501-2.187 4.105-3.601 8.089-7.095 12.04-9.819 3.446-2.375 6.868-4.164 10.326-4.925l.359-.081.04-.01.317-.076.065-.016a22.897 22.897 0 0 0 .42-.107l.196-.052a.374.374 0 0 0 .048-.012c-2.433 9.276-10.129 16.443-19.691 18.102a9.984 9.984 0 0 0-2.016-.205h-5.31zm21.271-37.073a40.746 40.746 0 0 0-4.536 1.281c-10.109 3.489-18.327 10.602-26.283 17.58l-.434.381c-9.178 8.052-17.923 15.723-29.033 17.834h-13.146c-11.249-1.93-17.833-8.552-25.823-16.591-10.213-10.275-22.923-23.062-47.074-23.062-24.15 0-36.86 12.786-47.074 23.06-7.992 8.04-14.576 14.663-25.829 16.593h-14.327c-11.253-1.93-17.837-8.553-25.829-16.593-10.213-10.274-22.923-23.06-47.072-23.06-24.151 0-36.861 12.787-47.074 23.062-7.991 8.039-14.574 14.661-25.824 16.591h-7.065c-14.134 0-24.325-8.939-35.113-18.404-9.248-8.112-18.81-16.501-31.252-19.241a12.237 12.237 0 0 1-7.025-4.453 10.027 10.027 0 0 0-1.153-1.252 12.234 12.234 0 0 1-1.428-5.727c-.001-6.788 5.52-12.309 12.307-12.309h447.384c6.787 0 12.308 5.521 12.308 12.308 0 5.729-4.039 10.776-9.605 12.002z"/>\n    </svg>\n    ',Ju='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 219.15 219.15" width="1em" height="1em">\n      <path d="M109.575 0C49.156 0 .001 49.155.001 109.574c0 60.42 49.154 109.576 109.573 109.576 60.42 0 109.574-49.156 109.574-109.576C219.149 49.155 169.995 0 109.575 0zm0 204.15c-52.148 0-94.573-42.427-94.573-94.576C15.001 57.426 57.427 15 109.575 15c52.148 0 94.574 42.426 94.574 94.574 0 52.15-42.426 94.576-94.574 94.576z"/>\n      <path d="M166.112 108.111h-52.051V51.249a7.5 7.5 0 0 0-15 0v64.362a7.5 7.5 0 0 0 7.5 7.5h59.551a7.5 7.5 0 0 0 0-15z"/>\n    </svg>\n    ',Wu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="1em" height="1em">\n      <path d="M490.815 3.784C480.082 5.7 227.049 51.632 148.477 130.203c-39.153 39.153-64.259 87.884-70.694 137.218-5.881 45.081 4.347 85.929 28.878 116.708L.001 490.789 21.212 512l106.657-106.657c33.094 26.378 75.092 34.302 116.711 28.874 49.334-6.435 98.065-31.541 137.218-70.695C460.368 284.951 506.3 31.918 508.216 21.185L511.999 0l-21.184 3.784zm-43.303 39.493L309.407 181.383l-7.544-98.076c46.386-15.873 97.819-29.415 145.649-40.03zm-174.919 50.64l8.877 115.402-78.119 78.119-11.816-153.606c19.947-13.468 47.183-26.875 81.058-39.915zm-109.281 64.119l12.103 157.338-47.36 47.36c-39.246-52.892-24.821-139.885 35.257-204.698zm57.113 247.849c-26.548-.001-51.267-7.176-71.161-21.938l47.363-47.363 157.32 12.102c-40.432 37.475-89.488 57.201-133.522 57.199zm157.743-85.421l-153.605-11.816 78.118-78.118 115.403 8.877c-13.04 33.876-26.448 61.111-39.916 81.057zm50.526-110.326l-98.076-7.544L468.725 64.485c-10.589 47.717-24.147 99.232-40.031 145.653z"/>\n    </svg>\n    ',Yu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 792 792">\n      <path d="M425.512 741.214H365.58c-14.183 0-25.164 11.439-25.164 25.622S351.397 792 365.58 792h59.932c15.101 0 26.54-10.981 26.54-25.164s-11.44-25.622-26.54-25.622zM472.638 671.209H319.821c-14.183 0-26.081 10.98-26.081 25.163s11.898 25.164 26.081 25.164h152.817c14.183 0 25.164-10.981 25.164-25.164s-10.982-25.163-25.164-25.163zM639.188 138.634c-25.164-42.548-59.181-76.135-102.49-101.113C493.526 12.621 446.566 0 395.771 0 320.28 0 247.19 31.684 197.205 81.445c-49.761 49.527-81.904 121.24-81.904 196.282 0 33.861 7.779 68.629 22.879 103.866 15.1 35.228 38.565 78.614 70.005 130.396 7.448 12.269 15.764 31.205 25.623 56.271 12.104 30.757 22.87 51.713 31.566 63.602 5.027 6.872 11.899 10.063 20.596 10.063h228.766c9.605 0 16.359-4.188 21.504-11.898 6.754-10.132 13.987-27.516 22.42-51.693 8.951-25.691 16.838-43.982 23.329-55.364 30.571-53.587 54.446-99.747 70.464-137.717 16.018-37.979 24.246-74.124 24.246-107.526 0-49.878-12.347-96.545-37.511-139.093zm-35.696 232.437c-15.012 34.348-36.398 76.974-65.427 126.736-9.41 16.125-18.458 37.003-26.989 63.592-3.367 10.474-7.32 20.596-11.439 30.2H300.153c-6.862-11.439-12.26-25.837-18.761-42.089-12.718-31.801-23.338-52.621-30.2-64.061-28.824-48.043-49.868-87.39-64.051-118.957s-20.537-60.859-21.044-88.766c-2.235-121.718 106.13-228.991 229.674-226.941 41.631.693 80.527 10.063 115.765 30.659 35.227 20.586 63.134 48.043 83.729 82.812 20.586 34.768 31.108 72.748 31.108 113.47-.001 27.449-7.692 58.596-22.881 93.345z"/>\n    </svg>\n    ',Zu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 106.059 106.059">\n      <path d="M90.544 90.542c20.687-20.684 20.685-54.341.002-75.024-20.688-20.689-54.347-20.689-75.031-.006-20.688 20.687-20.686 54.346.002 75.034 20.682 20.684 54.341 20.684 75.027-.004zM21.302 21.3c17.494-17.493 45.959-17.495 63.457.002 17.494 17.494 17.492 45.963-.002 63.455-17.494 17.494-45.96 17.496-63.455.003-17.498-17.498-17.496-45.966 0-63.46zM27 69.865s-2.958-11.438 6.705-8.874c0 0 17.144 9.295 38.651 0 9.662-2.563 6.705 8.874 6.705 8.874C73.539 86.824 53.03 85.444 53.03 85.444S32.521 86.824 27 69.865zm6.24-31.194a6.202 6.202 0 1 1 12.399.001 6.202 6.202 0 0 1-12.399-.001zm28.117 0a6.202 6.202 0 1 1 12.403.001 6.202 6.202 0 0 1-12.403-.001z"/>\n    </svg>\n    ',Xu='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 611.999 611.998">\n      <path d="M596.583 15.454C586.226 5.224 573.354.523 558.423.523c-15.597 0-31.901 4.906-49.452 14.599-17.296 9.551-32.851 20.574-46.458 32.524h-.665c-2.655 2.322-10.953 10.287-25.219 24.553-14.272 14.272-26.217 26.223-35.845 36.51L112.401 26.406c-6.896-1.968-12.928.014-17.593 4.645L46.687 78.839c-4.326 4.297-5.805 9.268-4.977 15.597.829 6.287 3.979 10.627 9.629 13.607L280.32 228.839 161.514 347.978l-95.91 3.32c-4.645.164-8.637 1.643-12.276 5.311L5.872 404.397c-4.312 4.34-6.641 9.289-5.643 16.262 1.657 6.967 5.31 11.611 11.618 13.602l117.142 48.787 48.787 117.148c2.421 5.812 6.634 9.621 13.607 11.279h3.313c4.977 0 9.296-1.658 12.942-5.311l47.456-47.457c3.653-3.645 5.494-7.965 5.643-12.275l3.32-95.91 118.807-118.807 121.128 228.99c2.988 5.643 7.32 8.793 13.607 9.621 6.329.836 11.271-1.316 15.597-5.643l47.456-47.457c4.978-4.977 6.945-10.697 4.978-17.586l-82.296-288.389 59.732-59.739c10.287-10.287 21.699-24.149 33.183-45.134 5.777-10.542 10.032-20.886 12.942-31.194 5.722-20.218 3.258-44.07-12.608-59.73zm-59.4 110.176l-67.039 67.372c-5.628 5.657-6.811 11.122-4.977 17.586l81.637 288.388-22.563 22.238L403.438 292.89c-2.98-5.643-7.299-8.963-12.941-9.621-6.301-1.331-11.611.325-16.263 4.977l-141.37 141.37c-2.987 2.986-4.644 6.973-5.643 11.949l-3.32 95.904-22.896 23.236-41.48-98.566c-1.331-4.645-4.553-8.184-9.629-10.287L51.338 411.03l23.229-22.895 95.578-3.654c5.643-.99 9.622-2.654 12.276-5.309l141.37-141.371c4.651-4.645 6.308-9.954 4.984-16.262-.666-5.643-3.986-9.954-9.629-12.942L90.829 87.47l22.231-22.238 288.389 81.637c6.464 1.833 11.951.666 17.587-4.977l28.545-28.539 26.217-25.884 11.278-11.285 1.331-.666c27.873-23.895 55.088-38.16 72.016-38.16 5.969 0 9.954 1.324 11.611 3.979 18.917 18.585-21.099 72.484-32.851 84.293z"/>\n    </svg>\n    ',Ku='\n    <svg\n      xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 511.626 511.626">\n      <path d="M475.366 71.949c-24.175-23.606-57.575-35.404-100.215-35.404-11.8 0-23.843 2.046-36.117 6.136-12.279 4.093-23.702 9.615-34.256 16.562-10.568 6.945-19.65 13.467-27.269 19.556a263.828 263.828 0 0 0-21.696 19.414 264.184 264.184 0 0 0-21.698-19.414c-7.616-6.089-16.702-12.607-27.268-19.556-10.564-6.95-21.985-12.468-34.261-16.562-12.275-4.089-24.316-6.136-36.116-6.136-42.637 0-76.039 11.801-100.211 35.404C12.087 95.55 0 128.286 0 170.16c0 12.753 2.24 25.891 6.711 39.398 4.471 13.514 9.566 25.031 15.275 34.546 5.708 9.514 12.181 18.792 19.414 27.834 7.233 9.041 12.519 15.272 15.846 18.698 3.33 3.426 5.948 5.903 7.851 7.427L243.25 469.938c3.427 3.426 7.614 5.144 12.562 5.144s9.138-1.718 12.563-5.144l177.87-171.31c43.588-43.58 65.38-86.406 65.38-128.472.001-41.877-12.085-74.61-36.259-98.207zm-53.961 199.846L255.813 431.391 89.938 271.507C54.344 235.922 36.55 202.133 36.55 170.156c0-15.415 2.046-29.026 6.136-40.824 4.093-11.8 9.327-21.177 15.703-28.124 6.377-6.949 14.132-12.607 23.268-16.988 9.141-4.377 18.086-7.328 26.84-8.85 8.754-1.52 18.079-2.281 27.978-2.281 9.896 0 20.557 2.424 31.977 7.279 11.418 4.853 21.934 10.944 31.545 18.271 9.613 7.332 17.845 14.183 24.7 20.557 6.851 6.38 12.559 12.229 17.128 17.559 3.424 4.189 8.091 6.283 13.989 6.283 5.9 0 10.562-2.094 13.99-6.283 4.568-5.33 10.28-11.182 17.131-17.559 6.852-6.374 15.085-13.222 24.694-20.557 9.613-7.327 20.129-13.418 31.553-18.271 11.416-4.854 22.08-7.279 31.977-7.279s19.219.761 27.977 2.281c8.757 1.521 17.702 4.473 26.84 8.85 9.137 4.38 16.892 10.042 23.267 16.988 6.376 6.947 11.612 16.324 15.705 28.124 4.086 11.798 6.132 25.409 6.132 40.824-.002 31.977-17.89 65.86-53.675 101.639z"/>\n    </svg>\n    ',$u=d({name:"IBizCategories",props:{categories:{type:Array,required:!0,default:function(){return[]}},current:{type:String,required:!0}},emits:["select"],setup:function(e,t){var n=t.emit;return{ns:re("emoji-categories"),onSelect:function(e){n("select",e)}}},render:function(){var e=this;return N("div",{class:this.ns.b()},[this.categories.map((function(t){return N("div",{class:[e.ns.e("category"),e.ns.is("active",t.name===e.current)],onClick:function(){return e.onSelect(t)}},[N("span",{class:e.ns.em("category","svg"),title:t.label,innerHTML:t.icon},null)])}))])}}),Qu=d({name:"IBizCategoryLabel",props:{name:{type:String,default:""}},emits:["select"],setup:function(){return{ns:re("emoji-category-label")}},render:function(){return N("div",{class:this.ns.b()},[this.name])}}),ec=d({name:"IBizEmojiItem",props:{emoji:{type:Object,required:!0,default:function(){}},size:{type:Number,required:!0},withBorder:{type:Boolean,required:!0}},emits:["click"],setup:function(e,t){var n=t.emit;return{ns:re("emoji-item"),styleSize:I((function(){return{fontSize:"".concat(e.size-5,"px"),lineHeight:"".concat(e.size,"px"),height:"".concat(e.size,"px"),width:"".concat(e.size,"px")}})),onClick:function(){n("click",e.emoji)}}},render:function(){return N("span",{class:[this.ns.b(),this.ns.is("border",this.withBorder)],style:this.styleSize,onClick:this.onClick,innerHTML:this.emoji.data},null)}}),tc=function(e,t){return t.aliases.some((function(t){return function(t){return t.toLowerCase().includes(e)}(t)}))},nc=d({name:"IBizEmojiList",props:{data:{type:Object,required:!0},emojisByRow:{type:Number,required:!0},emojiWithBorder:{type:Boolean},emojiSize:{type:Number},filter:{type:String,default:""},continuousList:{type:Boolean},category:{type:String,default:""},categories:{type:Object,required:!0,default:function(){}},hasSearch:{type:Boolean}},emits:["select","data"],setup:function(e,t){var n=t.emit,r=re("emoji-list"),i=C({}),o=C({}),a=I((function(){var t=e.data[e.category],n=e.filter.trim().toLowerCase();return n&&(t=t.filter((function(e){return tc(n,e)}))),t})),s=I((function(){return Object.keys(e.data)})),l=I((function(){var t=100/e.emojisByRow;return{gridTemplateColumns:"repeat(".concat(e.emojisByRow,", ").concat(t,"%)")}})),u=I((function(){var t={};Object.assign(t,e.data);var n=e.filter.trim().toLowerCase();return n&&s.value.forEach((function(r){t[r]=e.data[r].filter((function(e){return tc(n,e)}))})),t})),c=function(e){n("select",e)};M((function(){return e.data}),(function(){i.value.$el.scrollTop=0})),M((function(){return e.category}),(function(t){if(e.continuousList){var n=o.value[t].$el;i.value.scrollTop=n.offsetTop-(e.hasSearch?88:44)}}));return{ns:r,emojisRef:i,gridDynamic:l,dataFiltered:a,dataFilteredByCategory:u,onSelect:c,setCategoryRef:function(e,t){t&&(o.value[e]=t)},renderGridEmojis:function(e){var t=e.emojis,n=e.style,i=e.size,o=e.withBorder;return t&&t.length>0?N("div",{class:[r.m("grid-emojis")],style:n},[t.map((function(e){return N(ec,{emoji:e,size:i,withBorder:o,onClick:function(){return c(e)}},null)}))]):""}}},render:function(){var e=this;return N("div",{class:[this.ns.b()]},[N("div",{ref:"emojisRef",class:[this.ns.e("container")]},[this.continuousList?Object.keys(this.dataFilteredByCategory).map((function(t){var n=e.dataFilteredByCategory[t],r=e.categories[t],i=r?r.text:t;return N("div",null,[n.length?N(Qu,{name:i,ref:function(n){return e.setCategoryRef(t,n)}},null):"",e.renderGridEmojis({emojis:n,style:e.gridDynamic,size:e.emojiSize,withBorder:e.emojiWithBorder})])})):this.renderGridEmojis({emojis:this.dataFiltered||[],style:this.gridDynamic,size:this.emojiSize,withBorder:this.emojiWithBorder})])])}}),rc=d({name:"IBizInputSearch",emits:["update"],setup:function(e,t){var n=t.emit,r=re("emoji-input-search"),i=C(""),o=function(){n("update",i.value)};return{ns:r,inputSearch:i,onSearch:o,handleKeyUp:function(e){e&&"Enter"===e.code&&o()}}},render:function(){var e=this;return N("div",{class:[this.ns.b()]},[N("div",{class:this.ns.e("container"),onKeyup:this.handleKeyUp},[N("div",{class:this.ns.em("container","search"),onClick:this.onSearch},[N("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em",focusable:"false"},[N("g",{"stroke-width":"1"},[N("path",{d:"M6.751 12.303A5.557 5.557 0 0 1 1.2 6.751C1.2 3.691 3.69 1.2 6.751 1.2a5.558 5.558 0 0 1 5.551 5.551 5.557 5.557 0 0 1-5.551 5.552M6.751 0a6.751 6.751 0 1 0 4.309 11.949l3.855 3.855a.6.6 0 1 0 .849-.849l-3.854-3.853A6.751 6.751 0 0 0 6.751 0"},null)])])]),H(N("input",{class:this.ns.em("container","input"),type:"text","onUpdate:modelValue":function(t){return e.inputSearch=t},placeholder:ibiz.i18n.t("app.search")},null),[[q,this.inputSearch]])])])}}),ic=d({name:"IBizEmojiSelectHtmlComment",props:{customEmojis:{type:Array,required:!0,default:function(){return Hu}},customCategories:{type:Array,required:!0,default:function(){return[]}},limitFrequently:{type:Number,default:15},emojisByRow:{type:Number,default:8},continuousList:{type:Boolean,default:!1},emojiSize:{type:Number,default:27},emojiWithBorder:{type:Boolean,default:!0},showSearch:{type:Boolean,default:!0},showCategories:{type:Boolean,default:!0},dark:{type:Boolean,default:!1},initialCategory:{type:String,default:"peoples"},exceptCategories:{type:Array,default:function(){return[]}},exceptEmojis:{type:Array,default:function(){return[]}}},emits:["select","changeCategory","customEmojis"],setup:function(e,t){var n=t.emit,r=re("emoji-select"),i=C([]),o=C([]),a=C("peoples"),s=C([]),l=C([]),u=C([]),c=C({}),h=C({}),f=C("");f.value=a.value;var d=C(""),g=o.value.map((function(e){return e.name}));g.includes(a.value)||(a.value=g[0]);var v=function(){var e=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.value=t;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=I((function(){return o.value.filter((function(e){return!s.value.includes(e)}))})),m=function(e){Object.assign(h.value,{frequently:[]}),e.filter((function(e){return!l.value.includes(e)})).forEach((function(e){var t=e.category;h.value[t]||Object.assign(h.value,O({},t,[])),h.value[t].push(e)}))},w=function(){var e=_(E().mark((function e(){var t;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=u.value||[],Object.assign(h.value,{frequently:t.map((function(e){return i.value[e]}))});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(e){var t=e.map((function(e){return i.value.indexOf(e)}));u.value=t},k=function(){var t=_(E().mark((function t(n){var r,i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=h.value.frequently,i=p(new Set([n].concat(p(r)))),h.value.frequently=i.slice(0,e.limitFrequently),b(i);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var e=_(E().mark((function e(t){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=h.value[t.name].length,f.value=t.name,r&&n("changeCategory",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t);case 2:n("select",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return M((function(){return e.customEmojis}),(function(t){i.value=e.customEmojis,t&&t.length&&(h.value={},m(t))}),{immediate:!0,deep:!0}),M((function(){return e.customCategories}),(function(e){e&&e.length>0?o.value=e:o.value=[new Fu("frequently",Ju,"常用"),new Fu("peoples",Zu,"情绪"),new Fu("nature",Wu,"自然"),new Fu("foods",Gu,"食物与饮料"),new Fu("activity",Uu,"活动"),new Fu("objects",Yu,"对象"),new Fu("places",Xu,"旅行与地方"),new Fu("symbols",Ku,"符号"),new Fu("flags",qu,"旗帜")],function(e){e.forEach((function(e){Object.assign(c.value,O({},e.name,e))}))}(o.value)}),{immediate:!0,deep:!0}),M((function(){return e.initialCategory}),(function(){a.value=e.initialCategory})),M((function(){return e.exceptCategories}),(function(){s.value=e.exceptCategories})),M((function(){return e.exceptEmojis}),(function(){l.value=e.exceptEmojis})),L((function(){m(i.value),w()})),z((function(){h.value={},u.value=[]})),{ns:r,mapEmojis:h,filterEmoji:d,mapCategories:c,currentCategory:f,categoriesFiltered:y,onSearch:v,onSelectEmoji:S,changeCategory:x}},render:function(){return N("div",{class:[this.ns.b(),this.ns.is("dark",this.dark)]},[this.showCategories&&N($u,{categories:this.categoriesFiltered,current:this.currentCategory,onSelect:this.changeCategory},null),this.showSearch&&N(rc,{onUpdate:this.onSearch},null),N(nc,{data:this.mapEmojis,category:this.currentCategory,filter:this.filterEmoji,categories:this.mapCategories,emojiWithBorder:this.emojiWithBorder,emojiSize:this.emojiSize,emojisByRow:this.emojisByRow,continuousList:this.continuousList,hasSearch:this.showSearch,onSelect:this.onSelectEmoji},null)])}}),oc=function(){function e(t,n,r){A(this,e),O(this,"type",void 0),O(this,"icon",void 0),O(this,"text",void 0),this.type=t,this.icon=n,this.text=r}return P(e,[{key:"label",get:function(){return this.type}}]),e}(),ac=P((function e(t,n,r,i,o,a){A(this,e),O(this,"type",void 0),O(this,"icon",void 0),O(this,"category",void 0),O(this,"text",void 0),O(this,"value",void 0),O(this,"isInline",void 0),this.type=t,this.icon=n,this.category=r,this.text=i,this.value=o,this.isInline=!0===a})),sc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>布局</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(4.666667, 4.666667)"> <path d="M1.6,0 L6.95555556,0 C7.83921116,5.97197047e-17 8.55555556,0.7163444 8.55555556,1.6 L8.55555556,9.28888889 C8.55555556,10.1725445 7.83921116,10.8888889 6.95555556,10.8888889 L1.6,10.8888889 C0.7163444,10.8888889 1.082166e-16,10.1725445 0,9.28888889 L0,1.6 C-1.082166e-16,0.7163444 0.7163444,1.623249e-16 1.6,0 Z M11.6512821,0 L17.0068376,0 C17.8904932,5.97197047e-17 18.6068376,0.7163444 18.6068376,1.6 L18.6068376,9.28888889 C18.6068376,10.1725445 17.8904932,10.8888889 17.0068376,10.8888889 L11.6512821,10.8888889 C10.7676265,10.8888889 10.0512821,10.1725445 10.0512821,9.28888889 L10.0512821,1.6 C10.0512821,0.7163444 10.7676265,1.623249e-16 11.6512821,0 Z" id="形状结合" fill="#6698FF" opacity="0.300000012"></path> <path d="M0.466666667,17.8888889 L18.2,17.8888889 C18.4577329,17.8888889 18.6666667,18.0978227 18.6666667,18.3555556 C18.6666667,18.6132884 18.4577329,18.8222222 18.2,18.8222222 L0.466666667,18.8222222 C0.208933783,18.8222222 3.15631751e-17,18.6132884 0,18.3555556 C-3.15631751e-17,18.0978227 0.208933783,17.8888889 0.466666667,17.8888889 Z M0.466666667,14 L10.3025641,14 C10.560297,14 10.7692308,14.2089338 10.7692308,14.4666667 C10.7692308,14.7243995 10.560297,14.9333333 10.3025641,14.9333333 L0.466666667,14.9333333 C0.208933783,14.9333333 3.15631751e-17,14.7243995 0,14.4666667 C-3.15631751e-17,14.2089338 0.208933783,14 0.466666667,14 Z" id="形状结合" fill="#CACACA"></path> <path d="M4.2,4.82222222 L2.8,4.82222222 C2.54226712,4.82222222 2.33333333,4.61328844 2.33333333,4.35555556 C2.33333333,4.09782267 2.54226712,3.88888889 2.8,3.88888889 L4.2,3.88888889 C4.45773288,3.88888889 4.66666667,4.09782267 4.66666667,4.35555556 C4.66666667,4.61328844 4.45773288,4.82222222 4.2,4.82222222 Z M15.0888889,4.82222222 L12.9111111,4.82222222 C12.6533782,4.82222222 12.4444444,4.61328844 12.4444444,4.35555556 C12.4444444,4.09782267 12.6533782,3.88888889 12.9111111,3.88888889 L15.0888889,3.88888889 C15.3466218,3.88888889 15.5555556,4.09782267 15.5555556,4.35555556 C15.5555556,4.61328844 15.3466218,4.82222222 15.0888889,4.82222222 Z M5.75555556,7.93333333 L2.8,7.93333333 C2.54226712,7.93333333 2.33333333,7.72439955 2.33333333,7.46666667 C2.33333333,7.20893378 2.54226712,7 2.8,7 L5.75555556,7 C6.01328844,7 6.22222222,7.20893378 6.22222222,7.46666667 C6.22222222,7.72439955 6.01328844,7.93333333 5.75555556,7.93333333 Z M15.8666667,7.93333333 L12.9111111,7.93333333 C12.6533782,7.93333333 12.4444444,7.72439955 12.4444444,7.46666667 C12.4444444,7.20893378 12.6533782,7 12.9111111,7 L15.8666667,7 C16.1243995,7 16.3333333,7.20893378 16.3333333,7.46666667 C16.3333333,7.72439955 16.1243995,7.93333333 15.8666667,7.93333333 Z" id="形状结合" fill="#6698FF"></path> </g> </g> </g> </svg>',lc="<svg width='1em' height='1em' viewBox='0 0 28 28' version='1.1' xmlns='http://www.w3.org/2000/svg'> <title>日期</title> <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'> <g> <rect fill='#FFFFFF' x='0' y='0' width='28' height='28' rx='4'></rect> <path d='M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z' fill='#EEEEEE' fill-rule='nonzero' ></path> <g transform='translate(4.666667, 4.666667)'> <path d='M18.2666667,6.62222222 L18.2666667,17.1111111 C18.2666667,17.430209 18.1373267,17.7190979 17.9282123,17.9282123 C17.7190979,18.1373267 17.430209,18.2666667 17.1111111,18.2666667 L1.55555556,18.2666667 C1.2364577,18.2666667 0.947568811,18.1373267 0.738454386,17.9282123 C0.529339961,17.7190979 0.4,17.430209 0.4,17.1111111 L0.4,6.62222222 L18.2666667,6.62222222 Z M18.1333333,6.75555556 L0.509112478,6.75555556 L1.17926226,18.1481019 L18.1333333,17.4960222 L18.1333333,6.75555556 Z M17.0666667,1.95555556 C17.3980375,1.95555556 17.6980375,2.08987013 17.9151948,2.30702742 C18.1323521,2.52418471 18.2666667,2.82418471 18.2666667,3.15555556 L18.2666667,5.80985059 L0.4,5.80985059 L0.4,3.15555556 C0.4,2.82418471 0.534314575,2.52418471 0.751471863,2.30702742 C0.96862915,2.08987013 1.26862915,1.95555556 1.6,1.95555556 Z' stroke='#EEEEEE' stroke-width='0.8' fill='#EEEEEE' ></path> <rect fill='#DDDDDD' x='3.88888889' y='0' width='1.55555556' height='3.88888889' rx='0.777777778' ></rect> <rect fill='#DDDDDD' x='13.2222222' y='0' width='1.55555556' height='3.88888889' rx='0.777777778' ></rect> <path d='M2.8,10.1111111 L4.2,10.1111111 C4.45773288,10.1111111 4.66666667,10.3200449 4.66666667,10.5777778 C4.66666667,10.8355107 4.45773288,11.0444444 4.2,11.0444444 L2.8,11.0444444 C2.54226712,11.0444444 2.33333333,10.8355107 2.33333333,10.5777778 C2.33333333,10.3200449 2.54226712,10.1111111 2.8,10.1111111 Z M2.8,14 L4.2,14 C4.45773288,14 4.66666667,14.2089338 4.66666667,14.4666667 C4.66666667,14.7243995 4.45773288,14.9333333 4.2,14.9333333 L2.8,14.9333333 C2.54226712,14.9333333 2.33333333,14.7243995 2.33333333,14.4666667 C2.33333333,14.2089338 2.54226712,14 2.8,14 Z M6.68888889,10.1111111 L8.08888889,10.1111111 C8.34662177,10.1111111 8.55555556,10.3200449 8.55555556,10.5777778 C8.55555556,10.8355107 8.34662177,11.0444444 8.08888889,11.0444444 L6.68888889,11.0444444 C6.43115601,11.0444444 6.22222222,10.8355107 6.22222222,10.5777778 C6.22222222,10.3200449 6.43115601,10.1111111 6.68888889,10.1111111 Z M14.4666667,14 L15.8666667,14 C16.1243995,14 16.3333333,14.2089338 16.3333333,14.4666667 C16.3333333,14.7243995 16.1243995,14.9333333 15.8666667,14.9333333 L14.4666667,14.9333333 C14.2089338,14.9333333 14,14.7243995 14,14.4666667 C14,14.2089338 14.2089338,14 14.4666667,14 Z' fill='#CACACA' ></path> <path d='M6.68888889,14 L11.9777778,14 C12.2355107,14 12.4444444,14.2089338 12.4444444,14.4666667 C12.4444444,14.7243995 12.2355107,14.9333333 11.9777778,14.9333333 L6.68888889,14.9333333 C6.43115601,14.9333333 6.22222222,14.7243995 6.22222222,14.4666667 C6.22222222,14.2089338 6.43115601,14 6.68888889,14 Z' fill='#FF7575' ></path> <path d='M10.5777778,10.1111111 L15.8666667,10.1111111 C16.1243995,10.1111111 16.3333333,10.3200449 16.3333333,10.5777778 C16.3333333,10.8355107 16.1243995,11.0444444 15.8666667,11.0444444 L10.5777778,11.0444444 C10.3200449,11.0444444 10.1111111,10.8355107 10.1111111,10.5777778 C10.1111111,10.3200449 10.3200449,10.1111111 10.5777778,10.1111111 Z' fill='#6698FF' ></path> </g> </g> </g></svg>",uc="<svg width='1em' height='1em' viewBox='0 0 28 28' version='1.1' xmlns='http://www.w3.org/2000/svg'> <title>标签</title> <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'> <g> <rect fill='#FFFFFF' x='0' y='0' width='28' height='28' rx='4'></rect> <path d='M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z' fill='#EEEEEE' fill-rule='nonzero' ></path> <g transform='translate(3.888889, 6.222222)'> <rect fill='#EEEEEE' x='0' y='0' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#F6C659' opacity='0.300000012' x='0' y='6.22222222' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#D287F8' opacity='0.300000012' x='0' y='12.4444444' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#FF7575' opacity='0.300000012' x='10.8888889' y='0' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#73D897' opacity='0.300000012' x='10.8888889' y='6.22222222' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <rect fill='#56ABFB' opacity='0.300000012' x='10.8888889' y='12.4444444' width='9.33333333' height='3.88888889' rx='1.94444444' ></rect> <path d='M7.77777778,2.02222222 C7.77777778,2.27995511 7.56884399,2.48888889 7.31111111,2.48888889 L2.02222222,2.48888889 C1.76448934,2.48888889 1.55555556,2.27995511 1.55555556,2.02222222 C1.55555556,1.76448934 1.76448934,1.55555556 2.02222222,1.55555556 L7.31111111,1.55555556 C7.56884399,1.55555556 7.77777778,1.76448934 7.77777778,2.02222222 Z' fill='#CACACA' fill-rule='nonzero' ></path> <path d='M7.77777778,8.24444444 C7.77777778,8.50217733 7.56884399,8.71111111 7.31111111,8.71111111 L2.02222222,8.71111111 C1.76448934,8.71111111 1.55555556,8.50217733 1.55555556,8.24444444 C1.55555556,7.98671156 1.76448934,7.77777778 2.02222222,7.77777778 L7.31111111,7.77777778 C7.56884399,7.77777778 7.77777778,7.98671156 7.77777778,8.24444444 Z' fill='#FFCD5D' fill-rule='nonzero' ></path> <path d='M7.77777778,14.4666667 C7.77777778,14.7243995 7.56884399,14.9333333 7.31111111,14.9333333 L2.02222222,14.9333333 C1.76448934,14.9333333 1.55555556,14.7243995 1.55555556,14.4666667 C1.55555556,14.2089338 1.76448934,14 2.02222222,14 L7.31111111,14 C7.56884399,14 7.77777778,14.2089338 7.77777778,14.4666667 Z' fill='#D287F8' fill-rule='nonzero' ></path> <path d='M18.6666667,2.02222222 C18.6666667,2.27995511 18.4577329,2.48888889 18.2,2.48888889 L12.9111111,2.48888889 C12.6533782,2.48888889 12.4444444,2.27995511 12.4444444,2.02222222 C12.4444444,1.76448934 12.6533782,1.55555556 12.9111111,1.55555556 L18.2,1.55555556 C18.4577329,1.55555556 18.6666667,1.76448934 18.6666667,2.02222222 Z' fill='#FF7575' fill-rule='nonzero' ></path> <path d='M18.6666667,8.24444444 C18.6666667,8.50217733 18.4577329,8.71111111 18.2,8.71111111 L12.9111111,8.71111111 C12.6533782,8.71111111 12.4444444,8.50217733 12.4444444,8.24444444 C12.4444444,7.98671156 12.6533782,7.77777778 12.9111111,7.77777778 L18.2,7.77777778 C18.4577329,7.77777778 18.6666667,7.98671156 18.6666667,8.24444444 Z' fill='#73D897' fill-rule='nonzero' ></path> <path d='M18.6666667,14.4666667 C18.6666667,14.7243995 18.4577329,14.9333333 18.2,14.9333333 L12.9111111,14.9333333 C12.6533782,14.9333333 12.4444444,14.7243995 12.4444444,14.4666667 C12.4444444,14.2089338 12.6533782,14 12.9111111,14 L18.2,14 C18.4577329,14 18.6666667,14.2089338 18.6666667,14.4666667 Z' fill='#56ABFB' fill-rule='nonzero' ></path> </g> </g> </g></svg>",cc="<svg width='1em' height='1em' viewBox='0 0 28 28' version='1.1' xmlns='http://www.w3.org/2000/svg'> <title>提示框</title> <defs> <rec x='1' y='1' width='26' height='26' rx='4'></rect> </defs> <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'> <g > <rect fill='#FFFFFF' x='0' y='0' width='28' height='28' rx='3.2' ></rect> <path d='M24.8,0 C26.5673112,0 28,1.4326888 28,3.2 L28,24.8 C28,26.5673112 26.5673112,28 24.8,28 L3.2,28 C1.4326888,28 0,26.5673112 0,24.8 L0,3.2 C0,1.4326888 1.4326888,0 3.2,0 L24.8,0 Z M24.8,1 L3.2,1 C1.98497355,1 1,1.98497355 1,3.2 L1,24.8 C1,26.0150264 1.98497355,27 3.2,27 L24.8,27 C26.0150264,27 27,26.0150264 27,24.8 L27,3.2 C27,1.98497355 26.0150264,1 24.8,1 Z' fill='#EEEEEE' fill-rule='nonzero' ></path> <mask fill='white'> <use xlink:href='#path-1'></use> </mask> <use fill='#FFFFFF' xlink:href='#path-1'></use> <g mask='url(#mask-2)'> <g transform='translate(4.666667, 7.000000)'> <rect fill='#5DCFFF' opacity='0.200000003' x='0' y='0' width='33.4444444' height='14' rx='1.6' ></rect> <path d='M12.9111111,8.55555556 L15.8666667,8.55555556 C16.1243995,8.55555556 16.3333333,8.76448934 16.3333333,9.02222222 C16.3333333,9.27995511 16.1243995,9.48888889 15.8666667,9.48888889 L12.9111111,9.48888889 C12.6533782,9.48888889 12.4444444,9.27995511 12.4444444,9.02222222 C12.4444444,8.76448934 12.6533782,8.55555556 12.9111111,8.55555556 Z M12.9111111,4.66666667 L23.6444444,4.66666667 C23.9021773,4.66666667 24.1111111,4.87560045 24.1111111,5.13333333 C24.1111111,5.39106622 23.9021773,5.6 23.6444444,5.6 L12.9111111,5.6 C12.6533782,5.6 12.4444444,5.39106622 12.4444444,5.13333333 C12.4444444,4.87560045 12.6533782,4.66666667 12.9111111,4.66666667 Z' fill='#5DCFFF' ></path> <g stroke-width='1' fill='none' transform='translate(3.111111, 3.888889)' > <pat  d='M3.11111111,-8.8817842e-16 C4.82222222,-8.8817842e-16 6.22222222,1.4 6.22222222,3.11111111 C6.22222222,4.82222222 4.82222222,6.22222222 3.11111111,6.22222222 C1.4,6.22222222 0,4.82222222 0,3.11111111 C0,1.4 1.4,-8.8817842e-16 3.11111111,-8.8817842e-16 Z M2.85139179,2.72012729 L2.83967627,4.6768138 L3.3841145,4.6794151 L3.39583002,2.72272859 L2.85139179,2.72012729 Z M2.87813929,1.54282507 L2.87038639,2.32474454 L3.50268048,2.33249744 L3.51043338,1.55057797 L2.87813929,1.54282507 Z'  fill='#5DCFFF' ></path> </g> </g> </g> </g> </g></svg>",hc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>思维导图</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" fill="#EEEEEE" fill-rule="nonzero"></path> <g id="编组-26" transform="translate(3.888889, 5.833333)"> <rect id="矩形" fill="#CACACA" x="7" y="7.77777778" width="5.44444444" height="1"></rect> <path d="M12.4444444,14.7777778 L11.3222222,14.7777778 C10.4385666,14.7777778 9.72222222,14.0614334 9.72222222,13.1777778 L9.72222222,3.15555556 C9.72222222,2.27189996 10.4385666,1.55555556 11.3222222,1.55555556 L12.4444444,1.55555556 L12.4444444,1.55555556" stroke="#CACACA" stroke-width="0.96"></path> <path d="M13.2444444,0 L18.6444444,0 C19.0862722,2.00237164e-16 19.4444444,0.3581722 19.4444444,0.8 L19.4444444,2.31111111 C19.4444444,2.75293891 19.0862722,3.11111111 18.6444444,3.11111111 L13.2444444,3.11111111 C12.8026166,3.11111111 12.4444444,2.75293891 12.4444444,2.31111111 L12.4444444,0.8 C12.4444444,0.3581722 12.8026166,-2.98598523e-17 13.2444444,0 Z" id="矩形备份-68" fill="#6698FF" opacity="0.300000012"></path> <rect fill="#73D897" opacity="0.300000012" x="12.4444444" y="6.61111111" width="7" height="3.11111111" rx="0.8"></rect> <path d="M13.2444444,13.2222222 L18.6444444,13.2222222 C19.0862722,13.2222222 19.4444444,13.5803944 19.4444444,14.0222222 L19.4444444,15.5333333 C19.4444444,15.9751611 19.0862722,16.3333333 18.6444444,16.3333333 L13.2444444,16.3333333 C12.8026166,16.3333333 12.4444444,15.9751611 12.4444444,15.5333333 L12.4444444,14.0222222 C12.4444444,13.5803944 12.8026166,13.2222222 13.2444444,13.2222222 Z" fill="#FF7575" opacity="0.300000012"></path> <path d="M17.8888889,1.64666667 C17.8888889,1.91176335 17.6739856,2.12666667 17.4088889,2.12666667 L14.48,2.12666667 C14.2149033,2.12666667 14,1.91176335 14,1.64666667 C14,1.38156999 14.2149033,1.16666667 14.48,1.16666667 L17.4088889,1.16666667 C17.6739856,1.16666667 17.8888889,1.38156999 17.8888889,1.64666667 Z" id="直线-7备份-6" fill="#6698FF" fill-rule="nonzero"></path> <path d="M17.8888889,8.25777778 C17.8888889,8.52287446 17.6739856,8.73777778 17.4088889,8.73777778 L14.48,8.73777778 C14.2149033,8.73777778 14,8.52287446 14,8.25777778 C14,7.9926811 14.2149033,7.77777778 14.48,7.77777778 L17.4088889,7.77777778 C17.6739856,7.77777778 17.8888889,7.9926811 17.8888889,8.25777778 Z" id="直线-7备份-7" fill="#73D897" fill-rule="nonzero"></path> <path d="M17.8888889,14.8688889 C17.8888889,15.1339856 17.6739856,15.3488889 17.4088889,15.3488889 L14.48,15.3488889 C14.2149033,15.3488889 14,15.1339856 14,14.8688889 C14,14.6037922 14.2149033,14.3888889 14.48,14.3888889 L17.4088889,14.3888889 C17.6739856,14.3888889 17.8888889,14.6037922 17.8888889,14.8688889 Z" id="直线-7备份-8" fill="#FF7575" fill-rule="nonzero"></path> <path d="M1.6,5.44444444 L5.4,5.44444444 C6.2836556,5.44444444 7,6.16078884 7,7.04444444 L7,9.28888889 C7,10.1725445 6.2836556,10.8888889 5.4,10.8888889 L1.6,10.8888889 C0.7163444,10.8888889 3.30261205e-16,10.1725445 0,9.28888889 L0,7.04444444 C1.13828005e-16,6.16078884 0.7163444,5.44444444 1.6,5.44444444 Z" fill="#EEEEEE"></path> </g> </g> </g> </svg>',fc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>音频</title> <g id="音频" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(4.666667, 7.000000)"> <ellipse fill="#CACACA" cx="9.33333333" cy="7" rx="2.33333333" ry="3.11111111"></ellipse> <path d="M2.69356086,9.2803178 L0.690789474,9.2803178 C0.309276809,9.2803178 0,8.97105135 0,8.58952833 L0,5.35862792 C0,4.9771049 0.309276809,4.66783845 0.690789474,4.66783845 L2.69356086,4.66783845 C2.69356086,4.66783845 2.69356086,9.2803178 2.69356086,9.2803178 Z" id="路径" fill="#DDDDDD"></path> <path d="M9.24122807,0 L9.24122807,14 C6.82346491,14 2.69356086,9.2803178 2.69356086,9.2803178 L2.69356086,4.66783845 C2.69356086,4.66783845 6.82346491,0 9.24122807,0 Z" id="路径" fill="#F5F5F5"></path> <path d="M14.4666667,6.67859506 L16.7559366,6.67859506 C17.0136695,6.67859506 17.2226033,6.88752885 17.2226033,7.14526173 C17.2226033,7.40299461 17.0136695,7.6119284 16.7559366,7.6119284 L14.4666667,7.6119284 C14.2089338,7.6119284 14,7.40299461 14,7.14526173 C14,6.88752885 14.2089338,6.67859506 14.4666667,6.67859506 Z" id="矩形备份-74" fill="#73D897"></path> <path d="M14.4666667,2.33333333 L18.927827,2.33333333 C19.1855599,2.33333333 19.3944936,2.54226712 19.3944936,2.8 C19.3944936,3.05773288 19.1855599,3.26666667 18.927827,3.26666667 L14.4666667,3.26666667 C14.2089338,3.26666667 14,3.05773288 14,2.8 C14,2.54226712 14.2089338,2.33333333 14.4666667,2.33333333 Z" id="矩形备份-75" fill="#6698FF"></path> <path d="M14.4666667,11.0238568 L18.927827,11.0238568 C19.1855599,11.0238568 19.3944936,11.2327906 19.3944936,11.4905235 C19.3944936,11.7482563 19.1855599,11.9571901 18.927827,11.9571901 L14.4666667,11.9571901 C14.2089338,11.9571901 14,11.7482563 14,11.4905235 C14,11.2327906 14.2089338,11.0238568 14.4666667,11.0238568 Z" id="矩形备份-77" fill="#FF7575"></path> </g> </g> </g> </svg>',dc='<svg width="1em" height="1em" viewBox="0 0 28 28" version="1.1" xmlns="http://www.w3.org/2000/svg" fit="" preserveAspectRatio="xMidYMid meet" focusable="false"> <title>公式</title> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="icon"> <rect fill="#FFFFFF" x="0" y="0" width="28" height="28" rx="4"></rect> <path d="M24,0 C26.209139,0 28,1.790861 28,4 L28,24 C28,26.209139 26.209139,28 24,28 L4,28 C1.790861,28 0,26.209139 0,24 L0,4 C0,1.790861 1.790861,0 4,0 L24,0 Z M24,1 L4,1 C2.34314575,1 1,2.34314575 1,4 L1,24 C1,25.6568542 2.34314575,27 4,27 L24,27 C25.6568542,27 27,25.6568542 27,24 L27,4 C27,2.34314575 25.6568542,1 24,1 Z" id="矩形" fill="#EEEEEE" fill-rule="nonzero"></path> <g transform="translate(6.222222, 6.222222)"> <path d="M0.466666667,16.3333333 L8.08888889,16.3333333 C8.34662177,16.3333333 8.55555556,16.5422671 8.55555556,16.8 C8.55555556,17.0577329 8.34662177,17.2666667 8.08888889,17.2666667 L0.466666667,17.2666667 C0.208933783,17.2666667 3.15631751e-17,17.0577329 0,16.8 C-3.15631751e-17,16.5422671 0.208933783,16.3333333 0.466666667,16.3333333 Z M0.466666667,13.2222222 L15.0888889,13.2222222 C15.3466218,13.2222222 15.5555556,13.431156 15.5555556,13.6888889 C15.5555556,13.9466218 15.3466218,14.1555556 15.0888889,14.1555556 L0.466666667,14.1555556 C0.208933783,14.1555556 3.15631751e-17,13.9466218 0,13.6888889 C-3.15631751e-17,13.431156 0.208933783,13.2222222 0.466666667,13.2222222 Z" id="形状结合" fill="#CACACA"></path> <path d="M7.29125451,0 C7.38377228,0 7.47325862,0.03098981 7.54722121,0.0875155065 L7.59958726,0.13461254 L8.32633451,0.900605806 C8.49662199,1.08008919 8.49662199,1.37108926 8.32633451,1.55057265 C8.17496787,1.71011343 7.94000374,1.72784019 7.77005987,1.60375291 L7.70966902,1.55057265 L7.11011022,0.919191919 L2.20294226,0.919191919 L5.86172644,4.73057214 C6.01309309,4.89011292 6.0299116,5.13776566 5.91218199,5.31688688 L5.86172644,5.38053898 L1.48925255,9.19191919 L7.21088891,9.19191919 L7.81117445,8.56053847 C7.9625411,8.40099768 8.19750523,8.38327092 8.3674491,8.5073582 L8.42783995,8.56053847 C8.57920659,8.72007925 8.59602511,8.96773199 8.4782955,9.14685321 L8.42783995,9.21050531 L7.70109269,9.97649857 C7.63567275,10.0454513 7.55160597,10.0902317 7.46138469,10.1053857 L7.39275995,10.1111111 L0.436922523,10.1111111 C0.0727247798,10.1111111 -0.121029049,9.67600851 0.0825161905,9.38305589 L0.128589776,9.32653173 L4.93638527,5.05555556 L0.841552739,0.784579379 C0.584026044,0.513145656 0.738922096,0.0610784438 1.07938574,0.00563033025 L1.14988549,0 L7.29125451,0 Z M13.4123521,6.36326594 C13.4835613,6.26668286 13.5653385,6.17894359 13.6560525,6.10179832 C13.7739326,6.14537625 13.9131899,6.18895419 14.0738245,6.23253213 C14.2338105,6.27601914 14.3985524,6.29798932 14.5639737,6.29789904 C14.8254058,6.30337896 15.0782142,6.20113169 15.2666735,6.0136951 C15.4633399,5.81548898 15.5681255,5.53943359 15.5543498,5.25581792 C15.5625234,5.03769835 15.4836884,4.82568311 15.3363022,4.66941046 C15.1932921,4.51889384 14.9960721,4.43684042 14.7920992,4.44299465 C14.5276073,4.44184652 14.2723055,4.54325127 14.076573,4.72719859 C13.79695,5.00734436 13.5561581,5.32614942 13.3610468,5.67454506 C13.305466,5.76927971 13.2388913,5.87854033 13.1613225,6.00232694 L12.7001548,6.55130253 C12.6378555,6.27846675 12.57464,5.99994689 12.5059275,5.71290091 C12.085407,3.96315198 10.6900851,4.30787901 10.2805586,4.48219077 C9.8389663,4.67166006 9.9571518,5.09512393 10.194439,4.98333705 C10.4166026,4.85295335 10.6857788,4.84072112 10.9181474,4.95044941 C11.1505161,5.0601777 11.3178523,5.27853825 11.3680485,5.53753473 C11.5668567,6.24899193 11.7134433,6.89792426 11.8508683,7.46822683 C11.7478048,7.62153899 11.403818,8.05305748 11.2859293,8.19448666 C11.2112337,8.28582736 11.1304112,8.37161645 11.0440613,8.45121756 C10.9090794,8.40069241 10.7652412,8.35427244 10.6125468,8.31195763 C10.4564339,8.269741 10.2956695,8.2487227 10.1343078,8.24943276 C9.87263241,8.24411775 9.61959814,8.34632312 9.43069178,8.5336367 C9.23123516,8.73520831 9.1254105,9.01585021 9.14026694,9.30382938 C9.13218953,9.51704512 9.20928522,9.72430908 9.35345807,9.87697219 C9.49763092,10.0296353 9.69618572,10.1142547 9.90251761,10.1109686 C10.1692308,10.1154591 10.427396,10.0136988 10.6235408,9.82676463 C10.8971525,9.54472709 11.1359499,9.22875305 11.3344861,8.88604959 C11.4206058,8.747737 11.4862644,8.64037107 11.531462,8.56395179 C11.5736056,8.49195346 11.876521,8.09631754 11.9690538,7.95232088 C12.0491926,8.58451479 12.347946,9.16533971 12.8100948,9.58744088 C13.5199368,9.89948674 14.0990436,10.1179285 14.7536202,9.69603082 C15.044045,9.52456111 14.9478475,9.16078006 14.7536202,9.22804166 C14.4839818,9.40974328 13.8958539,9.57918911 13.646555,9.36871093 C13.1802062,8.68324372 12.8921623,7.88528807 12.8100948,7.05150147 C12.9469091,6.85319028 13.3048553,6.49778914 13.4123521,6.36326594 Z" id="形状结合" fill="#666666" fill-rule="nonzero"></path> </g> </g> </g> </svg>',gc=function(){return[new ac("layout",sc,"base","布局","",!1),new ac("date",lc,"base","日期",gt().format("YYYY-MM-DD"),!0),new ac("label",uc,"base","标签","",!0),new ac("prompt-box",cc,"base","提示框","",!1),new ac("formula",dc,"base","LaTex 公式","",!0),new ac("mind-map",hc,"graph","思维导图","",!1),new ac("audio",fc,"file","本地音频","",!1)]},vc=d({name:"IBizInsertItemList",props:{data:{type:Object,required:!0},filter:{type:String,default:""},categories:{type:Object,required:!0,default:function(){}},hasSearch:{type:Boolean}},emits:["select","data"],setup:function(e,t){var n=t.emit,r=re("insert-item-list"),i=C({}),o=I((function(){return Object.keys(e.data)})),a=I((function(){var t={};Object.assign(t,e.data);var n=e.filter.trim().toLowerCase();return n&&o.value.forEach((function(r){t[r]=e.data[r].filter((function(e){return t=n,e.text.toLowerCase().includes(t);var t}))})),t})),s=function(e){n("select",e)};return{ns:r,InsertItemsRef:i,dataFilteredByCategory:a,onSelect:s,renderListInsertItems:function(e){var t=e.insertSelect,n=e.style;return t&&t.length>0?N("div",{class:[r.e("list-insert-items")],style:n},[t.map((function(e){return function(e){var t=e.icon,n=e.text;return N("div",{class:[r.e("insert-item")],onClick:function(){return s(e)}},[t?N("div",{class:r.em("insert-item","icon"),innerHTML:t},null):"",N("div",{class:r.em("insert-item","text")},[n])])}(e)}))]):""}}},render:function(){var e=this;return N("div",{class:[this.ns.b()]},[N("div",{ref:"InsertItemsRef",class:[this.ns.e("container")]},[Object.keys(this.dataFilteredByCategory).map((function(t){var n=e.dataFilteredByCategory[t],r=e.categories[t],i=r?r.text:t;return N("div",null,[n.length?N("div",{class:e.ns.e("label")},[i]):"",e.renderListInsertItems({insertSelect:n})])}))])])}});var pc=d({name:"UploadCustom",props:{modal:{type:Object,required:!0},context:{type:Object,default:function(){}},viewParams:{type:Object,default:function(){}},actionParams:{type:Object,default:function(){}}},setup:function(e){var t=re("upload-custom"),n=function(e){var t=C([]),n=C({Authorization:"Bearer ".concat(be(Ee.TOKEN))}),r=C(""),i=C(""),o={count:0,cacheFiles:[]},a=I((function(){return o.count}));if(e.context&&e.actionParams){var s=ibiz.util.file.calcFileUpDownUrl(e.context,e.viewParams,{},e.actionParams);r.value=s.uploadUrl,i.value=s.downloadUrl}var l=function(){var t=o.cacheFiles,n=t.length>0?t:null;o.cacheFiles=[],e.modal.dismiss({ok:!0,data:n})},u=I((function(){return e.multiple?9999:1}));return{uploadUrl:r,headers:n,files:t,limit:u,filesCount:a,onError:function(){var e=arguments.length<=0?void 0:arguments[0];throw o.count-=1,new Le({response:{data:JSON.parse(e.message),status:e.status}})},onRemove:function(n){if(!e.disabled){if(0===o.count){var r=o.cacheFiles.findIndex((function(e){return n.response&&e.id===n.response.id}));-1!==r&&o.cacheFiles.splice(r,1)}var i=t.value.findIndex((function(e){return e.id===n.id}));-1!==i&&t.value.splice(i,1)}},onSuccess:function(e){e&&(o.cacheFiles.push({id:e.fileid,name:e.filename,ext:e.ext,folder:e.folder,size:e.size,url:e.rul||i.value.replace("%fileId%",e.fileid)}),o.count-=1)},beforeUpload:function(t){var n=t.size/1024/1024;return e.size&&n>e.size?(ibiz.message.error("".concat(ibiz.i18n.t("editor.upload.fileSizeErr")," ").concat(e.size,"MB!")),!1):(o.count+=1,!0)},onConfirm:function(){l()},onCancel:function(){o.cacheFiles=[],l()}}}(a(a({},e),{},{multiple:!0})),r=n.uploadUrl,i=n.headers;return{ns:t,files:n.files,limit:n.limit,uploadUrl:r,headers:i,onError:n.onError,onRemove:n.onRemove,onSuccess:n.onSuccess,beforeUpload:n.beforeUpload,onConfirm:n.onConfirm,onCancel:n.onCancel}},render:function(){var e=this;return N("div",{class:[this.ns.b()]},[N("div",{class:[this.ns.e("center")]},[N(R("el-upload"),{class:[this.ns.em("center","upload")],modelValue:this.files,"onUpdate:modelValue":function(t){return e.files=t},action:this.uploadUrl,headers:this.headers,limit:this.limit,multiple:!0,accept:"audio/*",drag:!0,"auto-upload":!0,"before-upload":this.beforeUpload,onSuccess:this.onSuccess,onError:this.onError,onRemove:this.onRemove},{default:function(){return N("i",{class:"el-icon"},[N("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[N("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"},null)])])}})]),N("div",{class:[this.ns.e("bottom")]},[N(R("el-button"),{onClick:this.onCancel},{default:function(){return[D("取消")]}}),N(R("el-button"),{onClick:this.onConfirm},{default:function(){return[D("确认")]}})])])}}),yc=d({name:"IBizHtmlInsertSelect",props:{modal:{type:Object,required:!0},context:{type:Object,default:function(){}},viewParams:{type:Object,default:function(){}},actionParams:{type:Object,default:function(){}}},emits:["select"],setup:function(e){var t=re("html-insert-select"),n=C(""),r=C([]),i=C({}),o=C([]),a=C({}),s=function(){var t=_(E().mark((function t(n){var r,i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={ok:!0,data:[]},t.next=3,ibiz.overlay.modal((function(t){return G(pc,{modal:t,context:e.context,viewParams:e.viewParams,actionParams:e.actionParams})}),void 0,{width:"auto",height:"auto"});case 3:(i=t.sent).ok&&i.data&&i.data.length>0&&i.data.forEach((function(e){var t;null===(t=r.data)||void 0===t||t.push({type:n.type,value:e,params:{isAdd:!0}})})),e.modal.dismiss(r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(t){var n={ok:!0,data:[{type:t.type,value:t.value,params:{isAdd:!0}}]};e.modal.dismiss(n)},u=function(){var e=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="audio"===e.t0?3:6;break;case 3:return e.next=5,s(t);case 5:return e.abrupt("break",8);case 6:return l(t),e.abrupt("break",8);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return L((function(){var e;i.value={},e=gc(),Object.assign(i.value,{frequently:[]}),e.filter((function(e){return!o.value.includes(e)})).forEach((function(e){var t=e.category;i.value[t]||Object.assign(i.value,O({},t,[])),i.value[t].push(e)})),r.value=[new oc("base","","基础"),new oc("graph","","图形"),new oc("file","","文件")],function(e){e.forEach((function(e){Object.assign(a.value,O({},e.type,e))}))}(r.value)})),{ns:t,mapInsertItems:i,mapCategories:a,searchVal:n,onSelectItem:u}},render:function(){var e=this,t=N("div",{class:[this.ns.b("search")]},[N("div",{class:this.ns.be("search","container")},[N("div",{class:this.ns.bem("search","container","search")},[N("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em",focusable:"false"},[N("g",{"stroke-width":"1"},[N("path",{d:"M6.751 12.303A5.557 5.557 0 0 1 1.2 6.751C1.2 3.691 3.69 1.2 6.751 1.2a5.558 5.558 0 0 1 5.551 5.551 5.557 5.557 0 0 1-5.551 5.552M6.751 0a6.751 6.751 0 1 0 4.309 11.949l3.855 3.855a.6.6 0 1 0 .849-.849l-3.854-3.853A6.751 6.751 0 0 0 6.751 0"},null)])])]),H(N("input",{class:this.ns.bem("search","container","input"),type:"text","onUpdate:modelValue":function(t){return e.searchVal=t},placeholder:ibiz.i18n.t("app.search")},null),[[q,this.searchVal]])])]);return N("div",{class:this.ns.b()},[t,N(vc,{data:this.mapInsertItems,filter:this.searchVal,categories:this.mapCategories,onSelect:this.onSelectItem},null)])}}),mc={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"}}},wc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ibiz.overlay.createPopover((function(t){return G(e,a({modal:t},n))}),void 0,a({width:"auto",height:"auto",noArrow:!0,autoClose:!0,placement:"bottom-start"},t))};function bc(){return{data:{type:Object,required:!0},change:{type:Function,required:!0},nodeKey:{type:String,default:""},isFocus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}}}var kc=function(e){(document.getElementsByClassName(e)||[]).forEach((function(e){e.remove()}))},xc=d({name:"IBizDateSelect",props:bc(),emits:["change"],setup:function(e){var t=re("date-select"),n=C(),r=C("");e.data&&(r.value=gt(e.data).format("YYYY-MM-DD")),e.isFocus&&M(n,(function(e){e&&e.focus&&e.focus()}));return{ns:t,dateVal:r,dateRef:n,handleChange:function(t){var n=gt(t).format("YYYY-MM-DD");r.value=n;var i=setTimeout((function(){e.change(n),clearTimeout(i),i=null}),200)}}},render:function(){var e=this;return N("div",{class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""]},[N(R("el-date-picker"),{ref:"dateRef","popper-class":[this.ns.e("popover"),"".concat(this.nodeKey)],modelValue:this.dateVal,"onUpdate:modelValue":function(t){return e.dateVal=t},onChange:this.handleChange},null)])}}),Cc=d({name:"IBizLabelSelect",props:bc(),setup:function(e){var t=re("label-select"),n=function(e){return e.replace(")",",0.196)")},r=["rgba(207, 207, 207)","rgb(255, 117, 117)","rgb(246, 198, 89)","rgb(115, 216, 151)","rgb(210, 135, 248)","rgb(86, 171, 251)"],i=C(),o=C(),a=C(),s=V({color:r[0],bgColor:n(r[0]),labelName:""}),l=C("");null!=e&&e.data&&(Object.assign(s,null==e?void 0:e.data),l.value=null==e?void 0:e.data.labelName),e.isFocus&&M(a,(function(e){e&&e.click&&e.click()}));var u=function(){var t=_(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=void 0,l.value&&(n={color:s.color,bgColor:s.bgColor,labelName:l.value}),e.change(n,{isDelete:!l.value});case 1:case"end":return t.stop()}var n}),t)})));return function(){return t.apply(this,arguments)}}();return{ns:t,curData:s,inputVal:l,inputRef:i,popoverRef:o,labelConfig:r,referenceRef:a,onInput:function(){s.labelName=l.value},handleColorItemClick:function(e){s.color=e,s.bgColor=n(e)},handleAfterEnter:function(){e.isFocus&&i.value&&i.value.focus()},handleAfterLeave:u,calcAlpha:n}},render:function(){var e=this,t=N("div",{ref:"referenceRef",class:this.ns.e("reference"),style:{backgroundColor:"".concat(this.curData.bgColor),color:this.curData.color===this.labelConfig[0]?"":this.curData.color}},[this.curData.labelName||"设置标签"]),n=N(R("el-popover"),{trigger:"click",ref:"popoverRef",width:"200px","hide-after":0,"popper-class":[this.ns.e("popover"),"".concat(this.nodeKey)],onAfterEnter:this.handleAfterEnter,onAfterLeave:this.handleAfterLeave},{default:function(){return N("div",{class:e.ns.em("popover","content")},[H(N("input",{ref:"inputRef",class:e.ns.em("popover","input"),type:"text","onUpdate:modelValue":function(t){return e.inputVal=t},onInput:function(){return e.onInput()},placeholder:"输入标签名称"},null),[[q,e.inputVal]]),N("div",{class:e.ns.em("popover","color-box")},[e.labelConfig.map((function(t,n){return N("div",{class:e.ns.em("popover","color-item"),style:"background-color: ".concat(0===n?e.calcAlpha(t):t),onClick:function(){return e.handleColorItemClick(t)}},[t===e.curData.color?N("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",height:"1em",width:"1em"},[N("g",{"stroke-width":"1","fill-rule":"evenodd"},[N("path",{d:"M13.993 3l1.364 1.364-9.311 9.31-.01-.01-.008.01L0 7.645l1.362-1.363 4.674 4.673L13.993 3z"},null)])]):""])}))])])},reference:function(){return t}});return N("div",{class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""]},[this.readonly?t:n])}}),Ec=["rgb(0, 0, 0)","rgb(38, 38, 38)","rgb(89, 89, 89)","rgb(140, 140, 140)","rgb(191, 191, 191)","rgb(217, 217, 217)","rgb(233, 233, 233)","rgb(245, 245, 245)","rgb(250, 250, 250)","rgb(255, 255, 255)","rgb(225, 60, 57)","rgb(231, 95, 51)","rgb(235, 144, 58)","rgb(245, 219, 77)","rgb(114, 192, 64)","rgb(89, 191, 192)","rgb(66, 144, 247)","rgb(54, 88, 226)","rgb(106, 57, 201)","rgb(216, 68, 147)","rgb(251, 233, 230)","rgb(252, 237, 225)","rgb(252, 239, 212)","rgb(252, 251, 207)","rgb(231, 246, 213)","rgb(218, 244, 240)","rgb(217, 237, 250)","rgb(224, 232, 250)","rgb(237, 225, 248)","rgb(246, 226, 234)","rgb(255, 163, 158)","rgb(255, 187, 150)","rgb(255, 213, 145)","rgb(255, 251, 143)","rgb(183, 235, 143)","rgb(135, 232, 222)","rgb(145, 213, 255)","rgb(173, 198, 255)","rgb(211, 173, 247)","rgb(255, 173, 210)","rgb(255, 77, 79)","rgb(255, 122, 69)","rgb(255, 169, 64)","rgb(255, 236, 61)","rgb(115, 209, 61)","rgb(54, 207, 201)","rgb(64, 169, 255)","rgb(89, 126, 247)","rgb(146, 84, 222)","rgb(247, 89, 171)","rgb(207, 19, 34)","rgb(212, 56, 13)","rgb(212, 107, 8)","rgb(212, 177, 6)","rgb(56, 158, 13)","rgb(8, 151, 156)","rgb(9, 109, 217)","rgb(29, 57, 196)","rgb(83, 29, 171)","rgb(196, 29, 127)","rgb(130, 0, 20)","rgb(135, 20, 0)","rgb(135, 56, 0)","rgb(97, 71, 0)","rgb(19, 82, 0)","rgb(0, 71, 79)","rgb(0, 58, 140)","rgb(6, 17, 120)","rgb(34, 7, 94)","rgb(120, 6, 80)"],Sc=[{type:"success",text:"成功",color:"rgb(103,194,58,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(103,194,58)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M0 8c0-4.4 3.6-8 8-8s8 3.6 8 8-3.6 8-8 8-8-3.6-8-8zm7.097.758L5.199 6.905l-.978 1.001 2.9 2.833 4.563-4.685-1.003-.977-3.584 3.68z'></path> </g></svg>"},{type:"danger",text:"危险",color:"rgb(245,108,108,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(245,108,108)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M0 8c0-4.4 3.6-8 8-8s8 3.6 8 8-3.6 8-8 8-8-3.6-8-8zm9.005.021l1.777-1.793-.994-.986-1.769 1.784L6.28 5.27l-.995.985 1.75 1.767-1.766 1.782.995.985 1.756-1.772 1.702 1.718.995-.985L9.005 8.02z'></path> </g></svg>"},{type:"warning",text:"警告",color:"rgb(230,162,60,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(230,162,60)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M9.718 2.496l5.588 9.387a2 2 0 0 1-1.718 3.023H2.412a2 2 0 0 1-1.718-3.023L6.28 2.496a2 2 0 0 1 3.437 0zm-2.447 9.496v1.457h1.457v-1.457H7.271zm-.363-5.84l.363 4.384h1.457l.376-4.385H6.908z'></path> </g></svg>"},{type:"prompt",text:"提示",color:"rgb(64,158,255,0.2)",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' style='fill:rgb(64,158,255)'> <g stroke-width='1' fill-rule='evenodd'> <path d='M0 8c0-4.4 3.6-8 8-8s8 3.6 8 8-3.6 8-8 8-8-3.6-8-8zm7.332-1.005l-.03 5.031 1.4.007L8.732 7l-1.4-.006zm0-3.052l-.03 1.732 1.4.006.03-1.731-1.4-.007z'></path> </g></svg>"},{type:"add-emoji",text:"添加表情",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M14.727 7h1.211A8 8 0 1 1 11.206.668L10.795 1.8A6.8 6.8 0 1 0 14.727 7zm-.226-1h1.247-1.247zM5 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm6.97 1.5a4 4 0 0 1-7.94 0h1.215a2.8 2.8 0 0 0 5.51 0h1.214zM11 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm2.264-5.177V1.459h1.2v1.364h1.364v1.2h-1.364v1.363h-1.2V4.023H11.9v-1.2h1.364z'></path> </g></svg>"},{type:"delete-emoji",text:"删除表情",icon:"<svg viewBox='0 0 16 16' version='1.1' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M1.90326777,1.07326956 L14.9701984,14.1861127 C15.2041017,14.4208379 15.2034355,14.8007363 14.9687103,15.0346396 C14.7339852,15.2685429 14.3540868,15.2678766 14.1201835,15.0331515 L1.05325285,1.9203083 C0.819349557,1.68558316 0.8200158,1.30568475 1.05474094,1.07178147 C1.28946608,0.837878178 1.66936449,0.838544422 1.90326777,1.07326956 Z M1.78392959,4.77808157 L2.68262793,5.6799605 C2.37220548,6.39042724 2.2,7.17510325 2.2,8 C2.2,11.2032515 4.79674845,13.8 8,13.8 C8.81790048,13.8 9.59625958,13.6307032 10.3019463,13.3252407 L11.199833,14.2274912 C10.2408005,14.7212594 9.15295194,15 8,15 C4.13400675,15 1,11.8659932 1,8 C1,6.83818849 1.28304083,5.7424847 1.78392959,4.77808157 Z M8,1 C11.8659932,1 15,4.13400675 15,8 C15,9.18355772 14.7062644,10.2985098 14.1877157,11.2759337 L13.2919736,10.3773191 C13.6183874,9.65183814 13.8,8.84712801 13.8,8 C13.8,4.79674845 11.2032515,2.2 8,2.2 C7.15989239,2.2 6.36150251,2.37861488 5.640734,2.69994102 L4.7450393,1.80120321 C5.71742699,1.28955298 6.82489914,1 8,1 Z'></path> </g></svg>"},{type:"separator",text:"|"},{type:"background-color",text:"背景色",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M3.58 8.165l2.092 1.209L3.86 12.51l4.9.01.592-1.021 1.39.803 4.138-7.165L7.717 1 3.58 8.165zm1.639-.44L8.156 2.64l5.085 2.936-2.935 5.087-5.087-2.937z'></path> <path d='M1 15.064h11.997v-1.201H1z'></path> </g></svg>"},{type:"separator",text:"|"},{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}];function _c(){return Sc}var Ac=d({name:"IBizPromptBoxSelect",props:bc(),emits:["change"],setup:function(e){var t=re("prompt-box-select"),n=C(""),r=C(""),i=C(""),o=C(null),a=C(null),s=C(null),l=C(),u=C(),c=C([]),h=C([]);if(c.value=Ec,h.value=_c(),n.value=h.value[0].color,r.value=h.value[0].icon,e.data){var f=e.data,d=f.color,g=f.icon,v=f.text;n.value=d,r.value=je(g),i.value=v}var p=new ResizeObserver((function(){var e;u.value&&0!==u.value.offsetWidth&&(null===(e=u.value)||void 0===e||e.click(),p=null)}));e.isFocus&&(M(u,(function(e){e&&e.click&&p.observe(e)})),M(l,(function(e){e&&e.focus&&e.focus()})));var y=function(e){var t,n={ok:!0,data:[{emoji:Te(e.data)}]};null===(t=a.value)||void 0===t||t.dismiss(n)},m=function(e){var t;null===(t=s.value)||void 0===t||t.dismiss({ok:!0,data:[e]})},w=function(){var e=_(E().mark((function e(t){var n,i,o,s;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.value||(a.value=wc(ic,{},{dark:!0,continuousList:!0,onSelect:y})),e.next=3,a.value.present(t.target);case 3:return e.next=5,a.value.onWillDismiss();case 5:o=e.sent,s=null===(n=o.data)||void 0===n?void 0:n[0],o.ok&&s&&(r.value="".concat(je(s.emoji))),a.value=null,null===(i=l.value)||void 0===i||i.focus();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=_(E().mark((function e(r){var i,o,a,u;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.value||(s.value=wc((h=c.value,N("div",{class:t.be("background-popover","content")},[N("ul",{class:t.be("background-popover","list")},[N("li",{class:t.be("background-popover","list-item-clear"),onClick:function(){return m("")}},[N("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em"},[N("path",{d:"M236.8 128L896 787.2V128H236.8z m614.4 704L192 172.8V832h659.2zM192 64h704c38.4 0 64 25.6 64 64v704c0 38.4-25.6 64-64 64H192c-38.4 0-64-25.6-64-64V128c0-38.4 25.6-64 64-64z"},null)]),D("清除背景色")]),h.map((function(e){return N("li",{class:t.be("background-popover","list-item"),onClick:function(){return m(e)}},[N("div",{class:t.bem("background-popover","list-item","color-block"),style:{backgroundColor:e}},null)])}))])])))),e.next=3,s.value.present(r.target);case 3:return e.next=5,s.value.onWillDismiss();case 5:a=e.sent,u=null===(i=a.data)||void 0===i?void 0:i[0],a.ok&&(n.value="".concat(u)),s.value=null,null===(o=l.value)||void 0===o||o.focus();case 10:case"end":return e.stop()}var h}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var t=_(E().mark((function t(){var n,r,i;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(n=o.value)||void 0===n?void 0:n.dismiss();case 2:return t.next=4,null===(r=a.value)||void 0===r?void 0:r.dismiss();case 4:return t.next=6,null===(i=s.value)||void 0===i?void 0:i.dismiss();case 6:e.change("",{isDelete:!0});case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),x=function(e,t){var i;if("separator"!==e.type)switch(null===(i=l.value)||void 0===i||i.focus(),e.type){case"add-emoji":w(t);break;case"background-color":b(t);break;case"delete":k();break;case"delete-emoji":r.value="";break;default:!function(e){var t;e.color&&(n.value=e.color,r.value=e.icon),null===(t=l.value)||void 0===t||t.focus()}(e)}},S=function(){var a=_(E().mark((function a(){var s;return E().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return null===(s=l.value)||void 0===s||s.focus(),o.value=wc(N("div",{class:t.be("popover","content")},[h.value.map((function(e){return N("div",{class:[t.be("popover","tool-item"),t.be("popover","tool-item-".concat(e.type)),t.is("activated",r.value===e.icon)],title:e.text,onClick:function(t){return x(e,t)}},[N("div",{class:t.bem("popover","tool-item","content"),innerHTML:e.icon||e.text},null)])}))]),{placement:"top-start"}),a.next=4,o.value.present(u.value);case 4:return a.next=6,o.value.onWillDismiss();case 6:c=void 0,c={color:n.value,icon:Te(r.value),text:i.value},e.change(c),o.value=null;case 8:case"end":return a.stop()}var c}),a)})));return function(){return a.apply(this,arguments)}}();return{ns:t,curColor:n,curIcon:r,curText:i,inputRef:l,referenceRef:u,toolBars:h,handleToolItemClick:x,onOpenTopPopover:S}},render:function(){var e=this;return N("div",{class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""]},[N("div",{ref:"referenceRef",class:this.ns.e("reference"),style:{backgroundColor:this.curColor},onClick:this.onOpenTopPopover},[this.curIcon?N("div",{class:[this.ns.em("reference","icon")],innerHTML:this.curIcon},null):"",N(R("el-input"),{ref:"inputRef",modelValue:this.curText,"onUpdate:modelValue":function(t){return e.curText=t},type:"text",autofocus:!0},null)])])}}),Mc=new X(u.meta.url),Pc=function(){function e(){A(this,e)}return P(e,null,[{key:"getMathJax",value:function(){return window.MathJax}},{key:"loadScript",value:function(e){return new Promise((function(t,n){var r=document.createElement("script");r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)}))}},{key:"initMathJax",value:function(e){window.MathJax={tex:{inlineMath:[["$","$"]],processEnvironments:!0,processRefs:!0},options:{skipHtmlTags:["noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore"},startup:{pageReady:function(){return e&&e()}},svg:{fontCache:"global"}}}},{key:"renderFormula",value:function(e){return window.MathJax&&window.MathJax.typesetPromise?(e&&!Array.isArray(e)&&(e=[e]),window.MathJax.typesetPromise(e)):Promise.reject()}},{key:"loadMathJax",value:function(){var e=this;return new Promise((function(t,n){if(e.getMathJax())t();else{e.initMathJax();var r=[e.loadScript(Mc.dir("assets/mathjax/plugins/js/tex-svg.js"))];Promise.all(r).then((function(){t()})).catch((function(){ibiz.message.error("加载mathJax静态资源失败,请确认静态资源是否存在！"),n()}))}}))}}]),e}();function Oc(){}var Tc='<p data-we-empty-p=""><br></p>',Lc="#ee7959",jc=["Control","Escape","Tab","CapsLock","Shift","Meta","Alt","ArrowLeft","ArrowUp","ArrowDown","ArrowRight","Enter","Backspace","Delete","Insert","c","v","z"],Nc=[" ","{","}"];function Rc(e){return Array.prototype.slice.call(e)}function Dc(e){return e=e.replace(/[A-Za-z0-9]+/g,(function(e){return'<span style="color: '.concat(Lc,'">').concat(e,"</span>")})),"<span>".concat(e,"</span>&nbsp;")}function Ic(e){return'<div class="me-menu-item"><span class="icon">$'.concat(e,"$</span></div>")}var Bc=new(function(){function e(){A(this,e),O(this,"_ua",void 0),O(this,"isOldEdge",void 0),O(this,"isFirefox",void 0),this._ua=navigator.userAgent;var t=this._ua.match(/(Edge?)\/(\d+)/);this.isOldEdge=!!(t&&"Edge"===t[1]&&parseInt(t[2])<19),this.isFirefox=!(!/Firefox\/\d+/.test(this._ua)||/Seamonkey\/\d+/.test(this._ua))}return P(e,[{key:"isIE",value:function(){return"ActiveXObject"in window}},{key:"isWebkit",value:function(){return/webkit/i.test(this._ua)}}]),e}()),zc=[];function Fc(e){var t=[];return(Array.isArray(e)?e:e.split(";")).forEach((function(e){var n=e.split(":").map((function(e){return e.trim()}));2===n.length&&t.push("".concat(n[0],":").concat(n[1]))})),t}var Vc=function(){function e(t){if(A(this,e),O(this,"selector",void 0),O(this,"length",void 0),O(this,"elems",void 0),O(this,"dataSource",void 0),O(this,"prior",void 0),this.elems=[],this.length=this.elems.length,this.dataSource=new Map,t){if(t instanceof e)return t;var n=[],r=t instanceof Node?t.nodeType:-1;if(this.selector=t,1===r||9===r)n=[t];else if(function(e){return!!e&&(e instanceof HTMLCollection||e instanceof NodeList)}(t))n=Rc(t);else if(t instanceof Array)n=t;else if("string"==typeof t){var i=t.replace("/\n/mg","").trim();n=0===i.indexOf("<")?function(e){var t=document.createElement("div");return t.innerHTML=e,Rc(t.children)}(i):function(e){return Rc(document.querySelectorAll(e))}(i)}var o=n.length;if(!o)return this;for(var a=0;a<o;a++)this.elems.push(n[a]);this.length=o}}return P(e,[{key:"id",get:function(){return this.elems[0].id}},{key:"forEach",value:function(e){for(var t=0;t<this.length;t++){var n=this.elems[t];if(!1===e.call(n,n,t))break}return this}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];return this.elems.forEach((function(n){t.push(n.cloneNode(!!e))})),Hc(t)}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.length;return e>=t&&(e%=t),Hc(this.elems[e])}},{key:"first",value:function(){return this.get(0)}},{key:"last",value:function(){var e=this.length;return this.get(e-1)}},{key:"on",value:function(e,t,n){return e?("function"==typeof t&&(n=t,t=""),this.forEach((function(r){if(t){var i=function(e){var r=e.target;r.matches(t)&&n.call(r,e)};r.addEventListener(e,i),zc.push({elem:r,selector:t,fn:n,agentFn:i})}else r.addEventListener(e,n)}))):this}},{key:"off",value:function(e,t,n){return e?("function"==typeof t&&(n=t,t=""),this.forEach((function(r){if(t){for(var i=-1,o=0;o<zc.length;o++){var a=zc[o];if(a.selector===t&&a.fn===n&&a.elem===r){i=o;break}}if(-1!==i){var s=zc.splice(i,1)[0].agentFn;r.removeEventListener(e,s)}}else r.removeEventListener(e,n)}))):this}},{key:"attr",value:function(e,t){return void 0===t?this.elems[0].getAttribute(e)||"":this.forEach((function(n){n.setAttribute(e,t)}))}},{key:"removeAttr",value:function(e){this.forEach((function(t){t.removeAttribute(e)}))}},{key:"addClass",value:function(e){return e?this.forEach((function(t){if(t.className){var n=t.className.split(/\s/);(n=n.filter((function(e){return!!e.trim()}))).indexOf(e)<0&&n.push(e),t.className=n.join(" ")}else t.className=e})):this}},{key:"removeClass",value:function(e){return e?this.forEach((function(t){if(t.className){var n=t.className.split(/\s/);n=n.filter((function(t){return!(!(t=t.trim())||t===e)})),t.className=n.join(" ")}})):this}},{key:"hasClass",value:function(e){if(!e)return!1;var t=this.elems[0];return!!t.className&&t.className.split(/\s/).includes(e)}},{key:"css",value:function(e,t){var n;return n=""===t?"":"".concat(e,":").concat(t,";"),this.forEach((function(t){var r=(t.getAttribute("style")||"").trim();if(r){var i=Fc(r);i=i.map((function(t){return 0===t.indexOf(e)?n:t})),""!==n&&i.indexOf(n)<0&&i.push(n),""===n&&(i=Fc(i)),t.setAttribute("style",i.join("; "))}else t.setAttribute("style",n)}))}},{key:"getBoundingClientRect",value:function(){return this.elems[0].getBoundingClientRect()}},{key:"show",value:function(){return this.css("display","block")}},{key:"hide",value:function(){return this.css("display","none")}},{key:"children",value:function(){var e=this.elems[0];return e?Hc(e.children):null}},{key:"childNodes",value:function(){var e=this.elems[0];return e?Hc(e.childNodes):null}},{key:"replaceChildAll",value:function(e){for(var t=this.getNode(),n=this.elems[0];n.hasChildNodes();)t.firstChild&&n.removeChild(t.firstChild);this.append(e)}},{key:"append",value:function(e){return this.forEach((function(t){e.forEach((function(e){t.appendChild(e)}))}))}},{key:"remove",value:function(){return this.forEach((function(e){if(e.remove)e.remove();else{var t=e.parentElement;t&&t.removeChild(e)}}))}},{key:"isContain",value:function(e){var t=this.elems[0],n=e.elems[0];return t.contains(n)}},{key:"getNodeName",value:function(){return this.elems[0].nodeName}},{key:"getNode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.elems[e]}},{key:"find",value:function(e){return Hc(this.elems[0].querySelectorAll(e))}},{key:"text",value:function(e){return void 0===e?this.elems[0].innerHTML.replace(/<[^>]+>/g,(function(){return""})):this.forEach((function(t){t.innerHTML=e}))}},{key:"html",value:function(e){var t=this.elems[0];return void 0===e?t.innerHTML:(t.innerHTML=e,this)}},{key:"val",value:function(){return this.elems[0].value.trim()}},{key:"focus",value:function(){return this.forEach((function(e){e.focus()}))}},{key:"prev",value:function(){return Hc(this.elems[0].previousElementSibling)}},{key:"next",value:function(){return Hc(this.elems[0].nextElementSibling)}},{key:"getNextSibling",value:function(){return Hc(this.elems[0].nextSibling)}},{key:"parent",value:function(){return Hc(this.elems[0].parentElement)}},{key:"parentUntil",value:function(e,t){var n=t||this.elems[0];if("BODY"===n.nodeName)return null;var r=n.parentElement;return r?r.matches(e)?Hc(r):this.parentUntil(e,r):null}},{key:"equal",value:function(t){return t instanceof e?this.elems[0]===t.elems[0]:t instanceof HTMLElement&&this.elems[0]===t}},{key:"insertBefore",value:function(e){var t=Hc(e).elems[0];return t?this.forEach((function(e){var n=t.parentNode;null==n||n.insertBefore(e,t)})):this}},{key:"insertAfter",value:function(e){var t=Hc(e).elems[0],n=t&&t.nextSibling;return t?this.forEach((function(e){var r=t.parentNode;n?r.insertBefore(e,n):r.appendChild(e)})):this}},{key:"data",value:function(e,t){if(void 0===t)return this.dataSource.get(e);this.dataSource.set(e,t)}},{key:"getNodeTop",value:function(e){if(this.length<1)return this;var t=this.parent();return e.$textLatexElem.equal(this)||e.$textLatexElem.equal(t)?this:(t.prior=this,t.getNodeTop(e))}},{key:"getOffsetData",value:function(){var e=this.elems[0];return{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight,parent:e.offsetParent}}},{key:"scrollTop",value:function(e){this.elems[0].scrollTo({top:e})}},{key:"renderFormula",value:function(){return Pc.renderFormula(this.elems)}}]),e}();function Hc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(Vc,t)}var Uc={width:620,height:272,menuHeight:38,mathJaxUrl:"https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/mathjax/3.2.0/es5/tex-svg.min.js"},qc={menus:["presets","operators","greekLetters","inequation","AdvancedMath","LinearAlgebra","arrows","Trigonometric"],presets:function(e){return[{label:e("fe.pt"),value:"a^2+b^2=c^2"},{label:e("fe.h"),value:"\\frac{x^2}{a^2}-\\frac{y^2}{b^2}=1"},{label:e("fe.tfr"),value:"\\sin^2\\theta +\\cos^2\\theta = 1"},{label:e("fe.d"),value:"\\left( e^x \\right) ' = e^x"},{label:e("fe.nl"),value:"\\int_a^b f(x) dx = F(b) - F(a)"}]},operators:["+","-","\\pm","\\mp","\\times","\\div","\\ast","\\cdot","\\cap","\\cup","\\aleph","\\Re","\\top","\\bot","\\infty","\\partial","\\forall","\\exists","\\neg","\\because","\\therefore","\\varnothing","\\frac{b}{a}","\\circ","\\bullet","\\prime","\\triangle","\\angle","\\surd","\\barwedge","\\veebar","\\odot","\\oplus","\\otimes","\\oslash","\\circledcirc","\\boxdot","\\bigtriangledown","\\dagger","\\diamond","\\star","\\triangleleft","\\triangleright"],greekLetters:["\\alpha","\\beta","\\gamma","\\delta","\\epsilon","\\zeta","\\eta","\\theta","\\iota","\\kappa","\\lambda","\\mu","\\nu","\\xi","\\omicron","\\pi","\\rho","\\sigma","\\tau","\\upsilon","\\phi","\\chi","\\psi","\\omega","\\varepsilon","\\vartheta","\\varpi","\\varrho","\\varsigma","\\varphi","\\Gamma","\\Delta","\\Theta","\\Lambda","\\Xi","\\Pi","\\Sigma","\\Upsilon","\\Phi","\\Psi","\\Omega"],inequation:["=","\\leq","\\geq","\\prec","\\succ","\\preceq","\\succeq","\\ll","\\gg","\\equiv","\\sim","\\simeq","\\asymp","\\approx","\\ne","\\subset","\\supset","\\subseteq","\\supseteq","\\nsubseteq","\\nsupseteq","\\in","\\ni","\\notin"],AdvancedMath:["x_{a}","x^{b}","x_{a}^{b}","\\sqrt{x}","\\sqrt[n]{x}","\\bigcap_{a}^{b}","\\bigcup_{a}^{b}","\\prod_{a}^{b}","\\coprod_{a}^{b}","\\int_{a}^{b}","\\oint_{a}^{b}","\\sum_{a}^{b}{x}","\\lim_{a  \\rightarrow b}{x}","\\frac{dy}{dx}|_{t=0}","\\vec{a}","\\bar{a}","\\tilde{a}","\\dot{a}","\\ddot{a}","\\hat{a}","\\overleftarrow{ab}","\\overline{ab}","\\overrightarrow{ab}","\\underline{ab}","\\overbrace{ab}","\\underbrace{ab}"],LinearAlgebra:["A^{*}","A^{T}","A^{-1}","\\left( x  \\right)","\\left[ x  \\right]","\\left \\{ x  \\right \\}","\\left| x  \\right|","\\begin{pmatrix}a&b\\\\c&d\\\\ \\end{pmatrix}","\\begin{bmatrix}a&b\\\\c&d\\\\ \\end{bmatrix}","\\begin{Bmatrix}a&b\\\\c&d\\\\ \\end{Bmatrix}","\\begin{vmatrix}a&b\\\\c&d\\\\ \\end{vmatrix}"],arrows:["\\leftarrow","\\rightarrow","\\leftrightarrow","\\Leftarrow","\\Rightarrow","\\Leftrightarrow","\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow"],trigonometric:["\\sin \\theta","\\cos \\theta","\\tan \\theta","\\csc \\theta","\\sec \\theta","\\cot \\theta","\\arcsin \\theta","\\arccos \\theta"]};function Gc(e){var t=e.$editorRootElem,n=e.$toolbarElem,r=e.$textLatexElem,i=e.config;t.append(n);var o=Hc("<div></div>");o.addClass("clearfix").css("width","100%").css("height","".concat(i.height-i.menuHeight,"px")).css("overflow","hidden"),r.attr("contenteditable","true").css("outline","none"),o.append(r),t.css("width","".concat(i.width,"px")).css("height","".concat(i.height,"px")),t.append(o)}var Jc=function(){function e(t){A(this,e),O(this,"editor",void 0),this.editor=t}return P(e,[{key:"do",value:function(e){var t=this.editor.selection;t.getRange()&&(t.restoreSelection(),this.insertHtml(e),this.renderFormula(),t.saveRange(),t.restoreSelection())}},{key:"insert",value:function(e,t){if(t){var n=this.editor.selection.getRange();if(n){var r=n.startContainer;n.setStart(r,n.endOffset),n.setEnd(r,n.endOffset),n.deleteContents()}this.insertHtml(" "===e?"&nbsp;":e)}else{var i,o=(i=e,'<span style="color: '.concat(Lc,'">').concat(" "!==i?i:"&nbsp;","</span>"));this.do(o)}}},{key:"renderFormula",value:function(){var e=this.editor,t=e.latex.text();e.change(t)}},{key:"insertHtml",value:function(e){var t=this.editor,n=t.selection.getRange();if(n)if(this.queryCommandSupported("insertHTML"))this.execCommand("insertHTML",e);else if(n.insertNode){if(n.deleteContents(),Hc(e).elems.length>0)n.insertNode(Hc(e).elems[0]);else{var r=document.createElement("p");r.appendChild(document.createTextNode(e)),n.insertNode(r)}t.selection.collapseRange()}}},{key:"execCommand",value:function(e,t){document.execCommand(e,!1,t)}},{key:"queryCommandSupported",value:function(e){return document.queryCommandSupported(e)}}]),e}(),Wc=function(){function e(t){A(this,e),O(this,"editor",void 0),O(this,"_currentRange",null),this.editor=t}return P(e,[{key:"getRange",value:function(){return this._currentRange}},{key:"saveRange",value:function(e){if(e)this._currentRange=e;else{var t=window.getSelection();if(0!==t.rangeCount){var n=t.getRangeAt(0),r=this.getSelectionContainerElem(n);if(null!=r&&r.length){var i=this.editor,o=i.$textLatexElem;if(o.isContain(r)){if(o.elems[0]===r.elems[0]&&o.html().trim()===Tc){var a=o.children(),s=null==a?void 0:a.last();i.selection.createRangeByElem(s,!0,!0),i.selection.restoreSelection()}this._currentRange=n}}}}}},{key:"collapseRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._currentRange;t&&t.collapse(e)}},{key:"getSelectionText",value:function(){var e=this._currentRange;return e?e.toString():""}},{key:"getSelectionContainerElem",value:function(e){var t=e||this._currentRange;if(t){var n=t.commonAncestorContainer;return Hc(1===n.nodeType?n:n.parentNode)}}},{key:"getSelectionStartElem",value:function(e){var t=e||this._currentRange;if(t){var n=t.startContainer;return Hc(1===n.nodeType?n:n.parentNode)}}},{key:"getSelectionEndElem",value:function(e){var t=e||this._currentRange;if(t){var n=t.endContainer;return Hc(1===n.nodeType?n:n.parentNode)}}},{key:"isSelectionEmpty",value:function(){var e=this._currentRange;return!(!e||!e.startContainer||e.startContainer!==e.endContainer||e.startOffset!==e.endOffset)}},{key:"restoreSelection",value:function(){var e=window.getSelection(),t=this._currentRange;e&&t&&(e.removeAllRanges(),e.addRange(t))}},{key:"createRangeByElems",value:function(e,t){var n=window.getSelection?window.getSelection():document.getSelection();null==n||n.removeAllRanges();var r=document.createRange();r.setStart(e,0),r.setEnd(t,t.childNodes.length||1),this.saveRange(r),this.restoreSelection()}},{key:"createRangeByElem",value:function(e,t,n){if(e.length){var r=e.elems[0],i=document.createRange();n?i.selectNodeContents(r):i.selectNode(r),null!=t&&(i.collapse(t),t||(this.saveRange(i),this.editor.selection.moveCursor(r))),this.saveRange(i)}}},{key:"getSelectionRangeTopNodes",value:function(){var e,t,n=null===(e=this.getSelectionStartElem())||void 0===e?void 0:e.getNodeTop(this.editor),r=null===(t=this.getSelectionEndElem())||void 0===t?void 0:t.getNodeTop(this.editor);return this.recordSelectionNodes(Hc(n),Hc(r))}},{key:"moveCursor",value:function(e,t){var n,r=this.getRange(),i=3===e.nodeType?null===(n=e.nodeValue)||void 0===n?void 0:n.length:e.childNodes.length;(Bc.isFirefox||Bc.isIE())&&0!==i&&(3!==e.nodeType&&"BR"!==e.childNodes[i-1].nodeName||(i-=1));var o=null!=t?t:i;r&&e&&(r.setStart(e,o),r.setEnd(e,o),this.restoreSelection())}},{key:"getCursorPos",value:function(){var e=window.getSelection();return null==e?void 0:e.anchorOffset}},{key:"clearWindowSelectionRange",value:function(){var e=window.getSelection();e&&e.removeAllRanges()}},{key:"recordSelectionNodes",value:function(e,t){var n=[],r=!0;try{for(var i=e,o=this.editor.$textLatexElem;r;){var a,s=null===(a=i)||void 0===a?void 0:a.getNodeTop(this.editor);"BODY"===s.getNodeName()&&(r=!1),s.length>0&&(n.push(Hc(i)),null!=t&&t.equal(s)||o.equal(s)?r=!1:i=s.getNextSibling())}}catch(Kk){r=!1}return n}},{key:"setRangeToElem",value:function(e){var t=this.getRange();null==t||t.setStart(e,0),null==t||t.setEnd(e,0)}}]),e}();function Yc(e,t){var n=e.$textLatexElem,r=n.children();if(!r||!r.length)return n.append(Hc(Tc)),void Yc(e);var i=r.last();if(t){var o=i.html().toLowerCase(),a=i.getNodeName();if("<br>"!==o&&"<br/>"!==o||"P"!==a)return n.append(Hc(Tc)),void Yc(e)}e.selection.createRangeByElem(i,!1,!0),e.selection.restoreSelection()}var Zc=function(){function e(t,n){var r=this;A(this,e),O(this,"key",void 0),O(this,"$elem",void 0),O(this,"editor",void 0),O(this,"_active",void 0),this.$elem=t,this.editor=n,this._active=!1,t.on("click",(function(e){e.stopPropagation(),n.selection.getRange()&&(t.addClass("active"),r.clickHandler())}))}return P(e,[{key:"clickHandler",value:function(){}},{key:"active",value:function(){this._active=!0,this.$elem.addClass("me-active")}},{key:"unActive",value:function(){this._active=!1,this.$elem.removeClass("me-active")}},{key:"isActive",get:function(){return this._active}}]),e}(),Xc=function(){function e(t,n){var r=this;A(this,e),O(this,"menu",void 0),O(this,"conf",void 0),O(this,"$container",void 0),O(this,"rendered",void 0),O(this,"_show",void 0),O(this,"hideTimeoutId",void 0),this.hideTimeoutId=0,this.menu=t,this.conf=n;var i=this.menu.editor.config,o=i.height,a=i.menuHeight,s=i.zIndex,l=void 0===s?0:s,u=Hc("<p>".concat(n.title,"</p>")).addClass("me-dp-title"),c=Hc('<div class="me-droplist"></div>').append(u).css("z-index",l+1),h=n.list||[],f=n.type||"block",d=n.clickHandler||Oc,g=Hc('<ul class="'.concat("list"===f?"me-list":"me-block",'"></ul>')).css("max-height","".concat(o-a-38,"px")).css("overflow-y","auto");h.forEach((function(e){var t=e.$elem,n=e.value,i=Hc('<li class="me-item"></li>');t&&(i.append(t),g.append(i),i.on("click",(function(e){d(n),e.stopPropagation(),r.hideTimeoutId=window.setTimeout((function(){r.hide()}))})))})),c.append(g),c.on("mouseleave",(function(){r.hideTimeoutId=window.setTimeout((function(){r.hide()}))})),this.$container=c,this.rendered=!1,this._show=!1}return P(e,[{key:"show",value:function(){this.hideTimeoutId&&clearTimeout(this.hideTimeoutId);var e=this.menu.$elem,t=this.$container;if(!this._show){if(this.rendered)t.show();else{var n=this.conf.width||232;t.css("width","".concat(n,"px")),e.append(t),this.rendered=!0,e.renderFormula()}this._show=!0}}},{key:"hide",value:function(){var e=this.$container;this._show&&(e.hide(),this._show=!1)}},{key:"isShow",get:function(){return this._show}}]),e}(),Kc=function(e){l(n,e);var t=c(n);function n(e,r,i){var o;A(this,n),O(f(o=t.call(this,e,r)),"dropList",void 0);var a=new Xc(f(o),i);return o.dropList=a,e.on("mouseover",(function(){r.selection.getRange()&&(e.addClass("active"),a.show())})).on("mouseleave",(function(){e.removeClass("active"),a.hideTimeoutId=window.setTimeout((function(){a.hide()}))})),o}return P(n,[{key:"command",value:function(e){var t,n=this.editor,r=n.selection.isSelectionEmpty();if(null===(t=n.selection.getSelectionContainerElem())||void 0===t?void 0:t.elems[0]){var i=Dc(e);n.cmd.do(i),r&&(n.selection.collapseRange(),n.selection.restoreSelection())}}}]),n}(Zc),$c=function(){function e(t){A(this,e),O(this,"itemList",void 0),this.itemList=t.map((function(e){var t=e.label,n=e.value;return{$elem:Hc('<p class="title">'.concat(t,"：</p><p>$ ").concat(n," $</p>")),value:n}}))}return P(e,[{key:"getItemList",value:function(){return this.itemList}}]),e}(),Qc=function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("f_{(x)}")),o=new $c(e.menusConfig.presets(e.t)),a={width:252,title:e.t("fe.p"),type:"list",list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),eh=function(){function e(t){A(this,e),O(this,"itemList",void 0),this.itemList=t.map((function(e){return{$elem:Hc("<span>$".concat(e,"$</span>")),value:e}}))}return P(e,[{key:"getItemList",value:function(){return this.itemList}}]),e}(),th={presets:Qc,operators:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("+")),o=new eh(e.menusConfig.operators),a={title:e.t("fe.o"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),greekLetters:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("\\alpha")),o=new eh(e.menusConfig.greekLetters),a={title:e.t("fe.gl"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),inequation:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("\\approx")),o=new eh(e.menusConfig.inequation),a={title:e.t("fe.i"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),AdvancedMath:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("\\Sigma")),o=new eh(e.menusConfig.AdvancedMath),a={width:244,title:e.t("fe.am"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),LinearAlgebra:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("\\left|x\\right|")),o=new eh(e.menusConfig.LinearAlgebra),a={width:244,title:e.t("fe.lg"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),arrows:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("\\rightarrow")),o=new eh(e.menusConfig.arrows),a={title:e.t("fe.a"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc),Trigonometric:function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n);var i=Hc(Ic("\\theta")),o=new eh(e.menusConfig.trigonometric),a={title:e.t("fe.t"),list:o.getItemList(),clickHandler:function(e){r.command(e)}};return r=t.call(this,i,e,a)}return P(n)}(Kc)},nh=function(){function e(t){A(this,e),O(this,"editor",void 0),O(this,"menuList",void 0),O(this,"constructorList",void 0),this.editor=t,this.menuList=[],this.constructorList=th}return P(e,[{key:"extend",value:function(e,t){t&&"function"==typeof t&&(this.constructorList[e]=t)}},{key:"init",value:function(){var e=this;this.editor.menusConfig.menus.forEach((function(t){var n=e.constructorList[t];e._initMenuList(t,n)})),this._addToToolbar()}},{key:"_initMenuList",value:function(e,t){if("function"==typeof t)if(this.menuList.some((function(t){return t.key===e})))console.warn("Duplicate menu name:".concat(e));else{var n=new t(this.editor);n.key=e,this.menuList.push(n)}}},{key:"_addToToolbar",value:function(){var e=this.editor.$toolbarElem;e.addClass("clearfix"),this.menuList.forEach((function(t){var n=t.$elem;n&&e.append(n)}))}},{key:"menuFind",value:function(e){for(var t=this.menuList,n=0,r=t.length;n<r;n++)if(t[n].key===e)return t[n];return t[0]}}]),e}(),rh=function(){function e(t){A(this,e),O(this,"editor",void 0),this.editor=t}return P(e,[{key:"init",value:function(){this._saveRange()}},{key:"clear",value:function(){this.editor.$textLatexElem.replaceChildAll(Hc(Tc))}},{key:"text",value:function(){return this.editor.$textLatexElem.text().replace(/&nbsp;/g," ")}},{key:"_saveRange",value:function(){var e=this.editor,t=e.$textLatexElem,n=Hc(document);function r(){e.selection.saveRange()}function i(){r(),n.off("mouseup",i)}function o(){n.on("mouseup",i),t.off("mouseleave",o)}t.on("keyup",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0;return function(){for(var r=this,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];n&&window.clearTimeout(n),n=window.setTimeout((function(){n=0,e.call.apply(e,[r].concat(o))}),t)}}((function(){r(),e.cmd.renderFormula()}))),t.on("keydown",(function(t){var n=t.key,i=t.ctrlKey&&!jc.includes(n),o=Nc.includes(n);(i||o)&&(t.preventDefault(),r(),e.cmd.insert(n,o))})),t.on("click",(function e(){r(),t.off("click",e)})),t.on("mousedown",(function(){t.on("mouseleave",o)})),t.on("mouseup",(function(){t.off("mouseleave",o),setTimeout((function(){e.selection.getRange()&&r()}),0)}))}}]),e}(),ih={"fe.a":"箭头符号","fe.am":"高数","fe.lg":"线代","fe.gl":"希腊字母","fe.i":"不等式","fe.o":"运算符","fe.p":"预设公式","fe.t":"三角函数","fe.l":"资源加载中...","fe.pt":"勾股定理","fe.h":"双曲线","fe.tfr":"三角函数关系","fe.d":"导数","fe.nl":"牛莱公式"};function oh(e){return ih[e]||e}var ah=function(){function e(){A(this,e),O(this,"config",void 0),O(this,"menusConfig",void 0),O(this,"$editorRootElem",void 0),O(this,"$toolbarElem",void 0),O(this,"$textLatexElem",void 0),O(this,"$textSvgElem",void 0),O(this,"cmd",void 0),O(this,"selection",void 0),O(this,"menus",void 0),O(this,"latex",void 0),O(this,"t",void 0),this.config=Uc,this.menusConfig=qc,this.$editorRootElem=Hc('<div class="math-editor"></div>'),this.$toolbarElem=Hc('<div class="me-menu"></div>'),this.$textLatexElem=Hc('<div class="me-latex is-no-data"></div>'),this.$textSvgElem=Hc('<div class="me-svg"></div>'),this.cmd=new Jc(this),this.selection=new Wc(this),this.menus=new nh(this),this.latex=new rh(this),this.t=oh}var t;return P(e,[{key:"create",value:(t=_(E().mark((function e(t,n){var r,i,o=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.menus.init(),this.latex.init(),Gc(this),(r=Hc(t)).text(this.t("fe.l")),i=function(){r.text("").append(o.$editorRootElem),o.initSelection(),o.$toolbarElem.renderFormula(),n&&n()},Pc.loadMathJax().then((function(){return i()}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"append",value:function(e){var t=Dc(e);this.cmd.do(t)}},{key:"change",value:function(e){e?this.$textLatexElem.removeClass("is-no-data"):this.$textLatexElem.addClass("is-no-data")}},{key:"initSelection",value:function(){Yc(this)}},{key:"destroyDom",value:function(){this.$editorRootElem.remove()}}]),e}();O(ah,"$",Hc);try{document}catch($k){throw new Error("Please run in the browser environment!")}Pc.loadMathJax();var sh=d({name:"IBizFormula",props:bc(),setup:function(e){var t=re("formula-elem"),n=C(),r=C(null),i=C(null),o=C(""),a=C(),s=C("");e.data&&(s.value=e.data);var l=function(){var e=_(E().mark((function e(){var t,o,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=r.value)||void 0===t?void 0:t.dismiss();case 2:return e.next=4,null===(o=i.value)||void 0===o?void 0:o.dismiss();case 4:return e.next=6,null===(a=n.value)||void 0===a?void 0:a.destroyDom();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){if(s.value){var e=s.value.replace(/&nbsp;/g," ").trim(),t="$ ".concat(e," $");a.value.innerHTML=t,Pc.renderFormula(a.value)}else a.value.innerHTML="输入 LaTeX 公式"},c=function(){var e;s.value&&(null===(e=n.value)||void 0===e||e.append(s.value))},h=function(){u(),n.value=new ah,n.value.config={width:570,height:184,menuHeight:40},n.value.change=function(e){e?n.value.$textLatexElem.removeClass("is-no-data"):n.value.$textLatexElem.addClass("is-no-data"),s.value=e,u()}},f=C([{type:"edit",text:"编辑",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="ajbaction/edit" stroke-width="1" fill-rule="evenodd"><path d="M2 8.34L10.71 0 15 4.17 6.538 13H2V8.34zm1.2.512V11.8h2.826l7.283-7.6-2.606-2.533L3.2 8.852zM0 16v-1.2h16V16H0z"></path></g></svg>'},{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}]),d=function(){var t=_(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:e.change("",{isDelete:!0});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=function(){var e;null===(e=i.value)||void 0===e||e.dismiss()},v=function(){var l=_(E().mark((function l(){return E().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return o.value=ke(),i.value||(i.value=wc(N("div",{class:t.b("edit-popover")},[N("div",{id:o.value,class:t.be("edit-popover","editor")},null),N("div",{class:t.be("edit-popover","confirm"),onClick:g},[N("button",{class:["el-button el-button--default"]},[D("确定")])])]),{placement:"top-start"})),l.next=4,i.value.present(a.value);case 4:return n.value.create(document.getElementById(o.value),c),l.next=7,i.value.onWillDismiss();case 7:e.change(s.value),n.value.destroyDom(),n.value=null,r.value=null;case 11:case"end":return l.stop()}}),l)})));return function(){return l.apply(this,arguments)}}(),p=function(){var e=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("separator"!==t.type){e.next=2;break}return e.abrupt("return");case 2:e.t0=t.type,e.next="edit"===e.t0?5:"delete"===e.t0?9:11;break;case 5:return e.next=7,r.value.dismiss();case 7:return v(),e.abrupt("break",11);case 9:return d(),e.abrupt("break",11);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.value=wc(N("div",{class:t.b("tool-popover")},[f.value.map((function(e){return N("div",{class:[t.be("tool-popover","item"),t.is(e.type,!0)],title:e.text,onClick:function(){return p(e)}},[N("div",{class:t.bem("popover","item","content"),innerHTML:e.icon||e.text},null)])}))]),{placement:"top-start"}),e.next=3,r.value.present(a.value);case 3:return e.next=5,r.value.onWillDismiss();case 5:r.value=null;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=this,w=new ResizeObserver((function(){a.value&&0!==a.value.offsetWidth&&(h.bind(m)(),e.isFocus&&v(),w.disconnect(),w=null)}));return M(a,(function(e){e&&e.click&&w.observe(a.value)})),z((function(){l()})),{ns:t,nodeRef:a,openNodeOverlay:y}},render:function(){return N("div",{ref:"nodeRef",class:[this.ns.b(),this.readonly?this.ns.m("readonly"):""],onClick:this.openNodeOverlay},null)}});"object"===("undefined"==typeof window?"undefined":v(window))&&window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"undefined"!=typeof window&&[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){for(var e=document.createDocumentFragment(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n=t instanceof Node;e.appendChild(n?t:document.createTextNode(String(t)))})),this.appendChild(e)}})}));var lh=function(){function e(){A(this,e)}return P(e,[{key:"disposed",get:function(){return!0===this._disposed}},{key:"dispose",value:function(){this._disposed=!0}}]),e}();!function(e){e.dispose=function(){return function(e,t,n){var r=n.value,i=e.__proto__;n.value=function(){if(!this.disposed){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.call.apply(r,[this].concat(t)),i.dispose.call(this)}}}}}(lh||(lh={}));var uh=function(){function e(){A(this,e),this.isDisposed=!1,this.items=new Set}return P(e,[{key:"disposed",get:function(){return this.isDisposed}},{key:"dispose",value:function(){this.isDisposed||(this.isDisposed=!0,this.items.forEach((function(e){e.dispose()})),this.items.clear())}},{key:"contains",value:function(e){return this.items.has(e)}},{key:"add",value:function(e){this.items.add(e)}},{key:"remove",value:function(e){this.items.delete(e)}},{key:"clear",value:function(){this.items.clear()}}]),e}();function ch(e,t,n){if(n)switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2]);case 4:return e.call(t,n[0],n[1],n[2],n[3]);case 5:return e.call(t,n[0],n[1],n[2],n[3],n[4]);case 6:return e.call(t,n[0],n[1],n[2],n[3],n[4],n[5]);default:return e.apply(t,n)}return e.call(t)}function hh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return ch(e,t,r)}function fh(e){return null!=e&&(e instanceof Promise||function(e){return"object"===v(e)&&e.then&&"function"==typeof e.then}(e))}function dh(){for(var e=[],t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.forEach((function(t){Array.isArray(t)?e.push.apply(e,p(t)):e.push(t)})),e.some((function(e){return fh(e)}))){var i=e.map((function(e){return fh(e)?e:Promise.resolve(!1!==e)}));return Promise.all(i).then((function(e){return e.reduce((function(e,t){return!1!==t&&e}),!0)}))}return e.every((function(e){return!1!==e}))}function gh(e,t){for(var n=[],r=0;r<e.length;r+=2){var i=ch(e[r],e[r+1],Array.isArray(t)?t:[t]);n.push(i)}return dh(n)}!function(e){e.from=function(t){var n=new e;return t.forEach((function(e){n.add(e)})),n}}(uh||(uh={}));var vh=function(){function e(){A(this,e),this.listeners={}}return P(e,[{key:"on",value:function(e,t,n){return null==t||(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t,n)),this}},{key:"once",value:function(e,t,n){var r=this;return this.on(e,(function i(){r.off(e,i);for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return gh([t,n],a)}),this)}},{key:"off",value:function(e,t,n){if(!(e||t||n))return this.listeners={},this;var r=this.listeners;return(e?[e]:Object.keys(r)).forEach((function(e){var i=r[e];if(i)if(t||n)for(var o=i.length-2;o>=0;o-=2)t&&i[o]!==t||n&&i[o+1]!==n||i.splice(o,2);else delete r[e]})),this}},{key:"trigger",value:function(e){for(var t=!0,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if("*"!==e){var o=this.listeners[e];null!=o&&(t=gh(p(o),r))}var a=this.listeners["*"];return null!=a?dh([t,gh(p(a),[e].concat(r))]):t}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.trigger.apply(this,[e].concat(n))}}]),e}();var ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};var yh=/^\s*class\s+/.test("".concat(P((function e(){A(this,e)}))))||/^\s*class\s*\{/.test("".concat(function(){return P((function e(){A(this,e)}))}()));function mh(e,t){var n;return yh?n=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n)}(t):(n=function(){return t.apply(this,arguments)},function(e,t){function n(){this.constructor=e}ph(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,t)),Object.defineProperty(n,"name",{value:e}),n}function wh(e){return"__proto__"===e}function bh(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",i=Array.isArray(t)?t:t.split(r);if(i.length)for(n=e;i.length;){var o=i.shift();if(Object(n)!==n||!o||!(o in n))return;n=n[o]}return n}function kh(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",i=Array.isArray(t)?t:t.split(r),o=i.pop();if(o&&!wh(o)){var a=e;i.forEach((function(e){wh(e)||(null==a[e]&&(a[e]={}),a=a[e])})),a[o]=n}return e}function xh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",r=Array.isArray(t)?t.slice():t.split(n),i=r.pop();if(i)if(r.length>0){var o=bh(e,r);o&&delete o[i]}else delete e[i];return e}var Ch=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Eh=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"dispose",value:function(){this.off()}}]),n}(vh);Ch([lh.dispose()],Eh.prototype,"dispose",null),function(e){e.dispose=lh.dispose}(Eh||(Eh={})),function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(n){"constructor"!==n&&Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n))}))}))}(Eh,lh);var Sh=function(e){var t=Object.create(null);return function(n){return t[n]||(t[n]=e(n))}},_h=Sh((function(e){return e.replace(/\B([A-Z])/g,"-$1").toLowerCase()})),Ah=Sh((function(e){return He(Ue(e)).replace(/ /g,"")}));function Mh(e){for(var t=2166136261,n=!1,r=e,i=0,o=r.length;i<o;i+=1){var a=r.charCodeAt(i);a>127&&!n&&(a=(r=unescape(encodeURIComponent(r))).charCodeAt(i),n=!0),t^=a,t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24)}return t>>>0}function Ph(){for(var e="",t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n=0;n<36;n+=1){var r=t[n],i=16*Math.random()|0;e+=("x"===r?i:"y"===r?3&i|8:r).toString(16)}return e}function Oh(e,t,n){for(var r=new Array(t.length+1),i=new Array(t.length+1),o=n+1,a=0;a<=t.length;a+=1)r[a]=a;for(var s=1;s<=e.length;s+=1){var l=e.charCodeAt(s-1),u=s>n?s-n:1,c=t.length>n+s?n+s:t.length;i[0]=s;for(var h=s,f=1;f<u;f+=1)i[f]=o;for(var d=u;d<=c;d+=1){var g=l===t.charCodeAt(d-1)?r[d-1]:Math.min(r[d]+1,i[d-1]+1,r[d-1]+2);i[d]=g,h=Math.min(h,g)}for(var v=c+1;v<=t.length;v+=1)i[v]=o;if(h>n)return;var p=r;r=i,i=p}var y=r[t.length];return y>n?void 0:y}function Th(e){return"string"==typeof e&&"%"===e.slice(-1)}function Lh(e,t){if(null==e)return 0;var n;if("string"==typeof e){if(n=parseFloat(e),Th(e)&&(n/=100,Number.isFinite(n)))return n*t}else n=e;return Number.isFinite(n)?n>0&&n<1?n*t:n:0}function jh(e){if("object"===v(e)){var t=0,n=0,r=0,i=0;return null!=e.vertical&&Number.isFinite(e.vertical)&&(n=i=e.vertical),null!=e.horizontal&&Number.isFinite(e.horizontal)&&(r=t=e.horizontal),null!=e.left&&Number.isFinite(e.left)&&(t=e.left),null!=e.top&&Number.isFinite(e.top)&&(n=e.top),null!=e.right&&Number.isFinite(e.right)&&(r=e.right),null!=e.bottom&&Number.isFinite(e.bottom)&&(i=e.bottom),{top:n,right:r,bottom:i,left:t}}var o=0;return null!=e&&Number.isFinite(e)&&(o=e),{top:o,right:o,bottom:o,left:o}}var Nh,Rh=!1,Dh=!1,Ih=!1,Bh=!1,zh=!1,Fh=!1,Vh=!1,Hh=!1,Uh=!1,qh=!1,Gh=!1,Jh=!1,Wh=!1,Yh=!1,Zh=!1,Xh=!1;if("object"===("undefined"==typeof navigator?"undefined":v(navigator))){var Kh=navigator.userAgent;Rh=Kh.indexOf("Macintosh")>=0,Dh=!!Kh.match(/(iPad|iPhone|iPod)/g),Ih=Kh.indexOf("Windows")>=0,Bh=Kh.indexOf("MSIE")>=0,zh=!!Kh.match(/Trident\/7\./),Fh=!!Kh.match(/Edge\//),Vh=Kh.indexOf("Mozilla/")>=0&&Kh.indexOf("MSIE")<0&&Kh.indexOf("Edge/")<0,Uh=Kh.indexOf("Chrome/")>=0&&Kh.indexOf("Edge/")<0,qh=Kh.indexOf("Opera/")>=0||Kh.indexOf("OPR/")>=0,Gh=Kh.indexOf("Firefox/")>=0,Jh=Kh.indexOf("AppleWebKit/")>=0&&Kh.indexOf("Chrome/")<0&&Kh.indexOf("Edge/")<0,"object"===("undefined"==typeof document?"undefined":v(document))&&(Xh=!document.createElementNS||"[object SVGForeignObjectElement]"!=="".concat(document.createElementNS("http://www.w3.org/2000/svg","foreignObject"))||Kh.indexOf("Opera/")>=0)}if("object"===("undefined"==typeof window?"undefined":v(window))&&(Hh=null!=window.chrome&&null!=window.chrome.app&&null!=window.chrome.app.runtime,Yh=null!=window.PointerEvent&&!Rh),"object"===("undefined"==typeof document?"undefined":v(document))){Wh="ontouchstart"in document.documentElement;try{var $h=Object.defineProperty({},"passive",{get:function(){Zh=!0}}),Qh=document.createElement("div");Qh.addEventListener&&Qh.addEventListener("click",(function(){}),$h)}catch(Qk){}}!function(e){e.IS_MAC=Rh,e.IS_IOS=Dh,e.IS_WINDOWS=Ih,e.IS_IE=Bh,e.IS_IE11=zh,e.IS_EDGE=Fh,e.IS_NETSCAPE=Vh,e.IS_CHROME_APP=Hh,e.IS_CHROME=Uh,e.IS_OPERA=qh,e.IS_FIREFOX=Gh,e.IS_SAFARI=Jh,e.SUPPORT_TOUCH=Wh,e.SUPPORT_POINTER=Yh,e.SUPPORT_PASSIVE=Zh,e.NO_FOREIGNOBJECT=Xh,e.SUPPORT_FOREIGNOBJECT=!e.NO_FOREIGNOBJECT}(Nh||(Nh={})),function(e){function t(){var e=window.module;return null!=e&&null!=e.hot&&null!=e.hot.status?e.hot.status():"unkonwn"}e.getHMRStatus=t,e.isApplyingHMR=function(){return"apply"===t()};var n={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};e.isEventSupported=function(e){var t=document.createElement(n[e]||"div"),r="on".concat(e),i=r in t;return i||(t.setAttribute(r,"return;"),i="function"==typeof t[r]),i}}(Nh||(Nh={}));var ef=/[\t\r\n\f]/g,tf=/\S+/g,nf=function(e){return" ".concat(e," ")};function rf(e){return e&&e.getAttribute&&e.getAttribute("class")||""}function of(e,t){if(null==e||null==t)return!1;var n=nf(rf(e)),r=nf(t);return 1===e.nodeType&&n.replace(ef," ").includes(r)}function af(e,t){if(null!=e&&null!=t){if("function"==typeof t)return af(e,t(rf(e)));if("string"==typeof t&&1===e.nodeType){var n=t.match(tf)||[],r=nf(rf(e)).replace(ef," "),i=n.reduce((function(e,t){return e.indexOf(nf(t))<0?"".concat(e).concat(t," "):e}),r);r!==(i=i.trim())&&e.setAttribute("class",i)}}}function sf(e,t){if(null!=e){if("function"==typeof t)return sf(e,t(rf(e)));if((!t||"string"==typeof t)&&1===e.nodeType){var n=(t||"").match(tf)||[],r=nf(rf(e)).replace(ef," "),i=n.reduce((function(e,t){var n=nf(t);return e.indexOf(n)>-1?e.replace(n," "):e}),r);r!==(i=t?i.trim():"")&&e.setAttribute("class",i)}}}function lf(e,t,n){if(null!=e&&null!=t)if(null==n||"string"!=typeof t){if("function"==typeof t)return lf(e,t(rf(e),n),n);if("string"==typeof t)(t.match(tf)||[]).forEach((function(t){of(e,t)?sf(e,t):af(e,t)}))}else n?af(e,t):sf(e,t)}var uf=0;function cf(e){return null!=e.id&&""!==e.id||(e.id="v".concat(uf+=1)),e.id}function hf(e){return null!=e&&("function"==typeof e.getScreenCTM&&e instanceof SVGElement)}var ff={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};function df(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).createElement(e)}function gf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ff.xhtml;return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).createElementNS(t,e)}function vf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return gf(e,ff.svg,t)}function pf(e){if(e){var t=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var r=new DOMParser;if(null!=n.async)r.async=n.async;t=r.parseFromString(e,n.mimeType||"text/xml")}catch(i){t=void 0}if(!t||t.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: ".concat(e));return t}('<svg xmlns="'.concat(ff.svg,'" xmlns:xlink="').concat(ff.xlink,'" version="').concat("1.1",'">').concat(e,"</svg>"),{async:!1});return t.documentElement}var n=document.createElementNS(ff.svg,"svg");return n.setAttributeNS(ff.xmlns,"xmlns:xlink",ff.xlink),n.setAttribute("version","1.1"),n}function yf(e){for(var t=0,n=e.previousSibling;n;)1===n.nodeType&&(t+=1),n=n.previousSibling;return t}function mf(e,t,n){for(var r=e.ownerSVGElement,i=e.parentNode;i&&i!==n&&i!==r;){if(of(i,t))return i;i=i.parentNode}return null}function wf(e,t){var n=t&&t.parentNode;return e===n||!!(n&&1===n.nodeType&&16&e.compareDocumentPosition(n))}function bf(e){e&&(Array.isArray(e)?e:[e]).forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}function kf(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function xf(e,t){(Array.isArray(t)?t:[t]).forEach((function(t){null!=t&&e.appendChild(t)}))}function Cf(e,t){var n=e.parentNode;n&&(Array.isArray(t)?t:[t]).forEach((function(t){null!=t&&n.insertBefore(t,e)}))}function Ef(e){try{return e instanceof HTMLElement}catch(Kk){return"object"===v(e)&&1===e.nodeType&&"object"===v(e.style)&&"object"===v(e.ownerDocument)}}var Sf,_f,Af=["viewBox","attributeName","attributeType","repeatCount","textLength","lengthAdjust","gradientUnits"];function Mf(e,t){var n=Lf(t);n.ns?e.hasAttributeNS(n.ns,n.local)&&e.removeAttributeNS(n.ns,n.local):e.hasAttribute(t)&&e.removeAttribute(t)}function Pf(e,t,n){if(null==n)return Mf(e,t);var r=Lf(t);r.ns&&"string"==typeof n?e.setAttributeNS(r.ns,t,n):"id"===t?e.id="".concat(n):e.setAttribute(t,"".concat(n))}function Of(e,t){Object.keys(t).forEach((function(n){Pf(e,n,t[n])}))}function Tf(e,t,n){if(null==t){for(var r=e.attributes,i={},o=0;o<r.length;o+=1)i[r[o].name]=r[o].value;return i}if("string"==typeof t&&void 0===n)return e.getAttribute(t);"object"===v(t)?Of(e,t):Pf(e,t,n)}function Lf(e){if(-1!==e.indexOf(":")){var t=e.split(":");return{ns:ff[t[0]],local:t[1]}}return{ns:null,local:e}}function jf(e){var t={};return Object.keys(e).forEach((function(n){var r=Af.includes(n)?n:_h(n);t[r]=e[n]})),t}function Nf(e){var t={};return e.split(";").forEach((function(e){var n=e.trim();if(n){var r=n.split("=");r.length&&(t[r[0].trim()]=r[1]?r[1].trim():"")}})),t}function Rf(e,t){return Object.keys(t).forEach((function(n){if("class"===n)e[n]=e[n]?"".concat(e[n]," ").concat(t[n]):t[n];else if("style"===n){var r,i,o="object"===v(e[n]),a="object"===v(t[n]);o&&a?(r=e[n],i=t[n]):o?(r=e[n],i=Nf(t[n])):a?(r=Nf(e[n]),i=t[n]):(r=Nf(e[n]),i=Nf(t[n])),e[n]=Rf(r,i)}else e[n]=t[n]})),e}function Df(e,t){for(var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.offset||0,a=[],s=[],l=null,u=0;u<e.length;u+=1){n=s[u]=e[u];for(var c=0,h=t.length;c<h;c+=1){var f=t[c],d=f.start+o,g=f.end+o;u>=d&&u<g&&("string"==typeof n?n=s[u]={t:e[u],attrs:f.attrs}:n.attrs=Rf(Rf({},n.attrs),f.attrs),i.includeAnnotationIndices&&(null==n.annotations&&(n.annotations=[]),n.annotations.push(c)))}(r=s[u-1])?qe(n)&&qe(r)?JSON.stringify(n.attrs)===JSON.stringify(r.attrs)?l.t+=n.t:(a.push(l),l=n):qe(n)||qe(r)?(a.push(l),l=n):l=(l||"")+n:l=n}return null!=l&&a.push(l),a}!function(e){function t(e){var t="data:";return e.substr(0,5)===t}function n(e){var t,n=e.replace(/\s/g,""),r=(n=decodeURIComponent(n)).indexOf(","),i=n.slice(0,r),o=i.split(":")[1].split(";")[0],a=n.slice(r+1);t=i.indexOf("base64")>=0?atob(a):unescape(encodeURIComponent(a));for(var s=new Uint8Array(t.length),l=0;l<t.length;l+=1)s[l]=t.charCodeAt(l);return new Blob([s],{type:o})}function r(e,t){var n=window.navigator.msSaveBlob;if(n)n(e,t);else{var r=window.URL.createObjectURL(e),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)}}function i(e){var t=parseFloat(e);return Number.isNaN(t)?null:t}e.isDataUrl=t,e.imageToDataUri=function(e,n){if(e&&!t(e)){var r=function(){n(new Error("Failed to load image: ".concat(e)))},i=window.FileReader?function(e){if(200===e.status){var t=new FileReader;t.onload=function(e){var t=e.target.result;n(null,t)},t.onerror=r,t.readAsDataURL(e.response)}else r()}:function(t){if(200===t.status){var i=e.split(".").pop()||"png";"svg"===i&&(i="svg+xml");var o="data:image/".concat(i,";base64,"),a=new Uint8Array(t.response),s=o+btoa(function(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));return t.join("")}(a));n(null,s)}else r()},o=new XMLHttpRequest;o.responseType=window.FileReader?"blob":"arraybuffer",o.open("GET",e,!0),o.addEventListener("error",r),o.addEventListener("load",(function(){return i(o)})),o.send()}else setTimeout((function(){return n(null,e)}))},e.dataUriToBlob=n,e.downloadBlob=r,e.downloadDataUri=function(e,t){r(n(e),t)},e.svgToDataUrl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=function(t){return null==n&&(n=function(e){var t=e.match(/<svg[^>]*viewBox\s*=\s*(["']?)(.+?)\1[^>]*>/i);return t&&t[2]?t[2].replace(/\s+/," ").split(" "):null}(e)),null!=n?i(n[t]):null},o=function(t){var n=e.match(t);return n&&n[2]?i(n[2]):null},a=t.width;if(null==a&&(a=o(/<svg[^>]*width\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==a&&(a=r(2)),null==a)throw new Error("Can not parse width from svg string");var s=t.height;if(null==s&&(s=o(/<svg[^>]*height\s*=\s*(["']?)(.+?)\1[^>]*>/i)),null==s&&(s=r(3)),null==s)throw new Error("Can not parse height from svg string");var l=encodeURIComponent(e).replace(/'/g,"%27").replace(/"/g,"%22");return"".concat("data:image/svg+xml",",").concat(l)}}(Sf||(Sf={}));var If,Bf={px:function(e){return e},mm:function(e){return _f*e},cm:function(e){return _f*e*10},in:function(e){return _f*e*25.4},pt:function(e){return _f*(25.4*e/72)},pc:function(e){return _f*(25.4*e/6)}};!function(e){function t(e,t,n){var r=document.createElement("div"),i=r.style;i.display="inline-block",i.position="absolute",i.left="-15000px",i.top="-15000px",i.width=e+(n||"px"),i.height=t+(n||"px"),document.body.appendChild(r);var o=r.getBoundingClientRect(),a={width:o.width||0,height:o.height||0};return document.body.removeChild(r),a}e.measure=t,e.toPx=function(e,n){null==_f&&(_f=t("1","1","mm").width);var r=n?Bf[n]:null;return r?r(e):e}}(If||(If={}));var zf=/-(.)/g;var Ff={},Vf=["webkit","ms","moz","o"],Hf="undefined"!=typeof document?document.createElement("div").style:{};function Uf(e){var t=e.replace(zf,(function(e,t){return t.toUpperCase()}));if(null==Ff[t]){var n=t.charAt(0).toUpperCase()+t.slice(1);Ff[t]=t in Hf?t:function(e){for(var t=0;t<Vf.length;t+=1){var n=Vf[t]+e;if(n in Hf)return n}return null}(n)}return Ff[t]}function qf(e,t){var n=e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null);return n&&t?n.getPropertyValue(t)||n[t]:n}var Gf={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function Jf(e,t,n){if("string"!=typeof t)for(var r in t)Jf(e,r,t[r]);else{var i=function(e){return/^--/.test(e)}(t);if(i||(t=Uf(t)),void 0===n)return function(e,t,n){var r=window.getComputedStyle(e,null);return n?r.getPropertyValue(t)||void 0:r[t]||e.style[t]}(e,t,i);i||(n=function(e,t){return Gf[e]||"number"!=typeof t?t:"".concat(t,"px")}(t,n));var o=e.style;i?o.setProperty(t,n):o[t]=n}}var Wf=new WeakMap;function Yf(e,t){var n=Ue(t),r=Wf.get(e);if(r)return r[n]}function Zf(e,t,n){if(!t){var r={};return Object.keys(Wf).forEach((function(t){r[t]=Yf(e,t)})),r}if("string"==typeof t)return void 0===n?Yf(e,t):void function(e,t,n){var r=Ue(t),i=Wf.get(e);i?i[r]=n:Wf.set(e,O({},r,n))}(e,t,n);for(var i in t)Zf(e,i,t[i])}var Xf=function(e){function t(e,n,r){if(A(this,t),!e)throw new TypeError("Invalid element to create vector");var i;if(t.isVector(e))i=e.node;else if("string"==typeof e)if("svg"===e.toLowerCase())i=pf();else if("<"===e[0]){var o=pf(e);i=document.importNode(o.firstChild,!0)}else i=document.createElementNS(ff.svg,e);else i=e;this.node=i,n&&this.setAttributes(n),r&&this.append(r)}return P(t,[{key:Symbol.toStringTag,get:function(){return t.toStringTag}},{key:"type",get:function(){return this.node.nodeName}},{key:"id",get:function(){return this.node.id}},{key:"id",set:function(e){this.node.id=e}},{key:"transform",value:function(e,t){return null==e?xd(this.node):(xd(this.node,e,t),this)}},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return null==e?Cd(this.node):(Cd(this.node,e,t,n),this)}},{key:"rotate",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null==e?Ed(this.node):(Ed(this.node,e,t,n,r),this)}},{key:"scale",value:function(e,t){return null==e?Sd(this.node):(Sd(this.node,e,t),this)}},{key:"getTransformToElement",value:function(e){var n=t.toNode(e);return _d(this.node,n)}},{key:"removeAttribute",value:function(e){return Mf(this.node,e),this}},{key:"getAttribute",value:function(e){return function(e,t){return e.getAttribute(t)}(this.node,e)}},{key:"setAttribute",value:function(e,t){return Pf(this.node,e,t),this}},{key:"setAttributes",value:function(e){return Of(this.node,e),this}},{key:"attr",value:function(e,t){return null==e?Tf(this.node):"string"==typeof e&&void 0===t?Tf(this.node,e):("object"===v(e)?Tf(this.node,e):Tf(this.node,e,t),this)}},{key:"svg",value:function(){return this.node instanceof SVGSVGElement?this:t.create(this.node.ownerSVGElement)}},{key:"defs",value:function(){var e=this.svg()||this,n=e.node.getElementsByTagName("defs")[0];return n?t.create(n):t.create("defs").appendTo(e)}},{key:"text",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ed(this.node,e,t),this}},{key:"tagName",value:function(){return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.nodeName;return t?n.toLowerCase():n.toUpperCase()}(this.node)}},{key:"clone",value:function(){return t.create(this.node.cloneNode(!0))}},{key:"remove",value:function(){return bf(this.node),this}},{key:"empty",value:function(){return kf(this.node),this}},{key:"append",value:function(e){return xf(this.node,t.toNodes(e)),this}},{key:"appendTo",value:function(e){return function(e,t){null!=t&&t.appendChild(e)}(this.node,t.isVector(e)?e.node:e),this}},{key:"prepend",value:function(e){return function(e,t){var n=e.firstChild;n?Cf(n,t):xf(e,t)}(this.node,t.toNodes(e)),this}},{key:"before",value:function(e){return Cf(this.node,t.toNodes(e)),this}},{key:"replace",value:function(e){return this.node.parentNode&&this.node.parentNode.replaceChild(t.toNode(e),this.node),t.create(e)}},{key:"first",value:function(){return this.node.firstChild?t.create(this.node.firstChild):null}},{key:"last",value:function(){return this.node.lastChild?t.create(this.node.lastChild):null}},{key:"get",value:function(e){var n=this.node.childNodes[e];return n?t.create(n):null}},{key:"indexOf",value:function(e){return Array.prototype.slice.call(this.node.childNodes).indexOf(t.toNode(e))}},{key:"find",value:function(e){var n=[],r=function(e,t){return e.querySelectorAll(t)}(this.node,e);if(r)for(var i=0,o=r.length;i<o;i+=1)n.push(t.create(r[i]));return n}},{key:"findOne",value:function(e){var n=function(e,t){return e.querySelector(t)}(this.node,e);return n?t.create(n):null}},{key:"findParentByClass",value:function(e,n){var r=mf(this.node,e,n);return r?t.create(r):null}},{key:"matches",value:function(e){var t=this.node;this.node.matches;var n=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return n&&n.call(t,e)}},{key:"contains",value:function(e){return wf(this.node,t.isVector(e)?e.node:e)}},{key:"wrap",value:function(e){var n=t.create(e),r=this.node.parentNode;return null!=r&&r.insertBefore(n.node,this.node),n.append(this)}},{key:"parent",value:function(e){var n=this;if(null==n.node.parentNode)return null;if(n=t.create(n.node.parentNode),null==e)return n;do{if("string"==typeof e?n.matches(e):n instanceof e)return n}while(n=t.create(n.node.parentNode));return n}},{key:"children",value:function(){for(var e=this.node.childNodes,n=[],r=0;r<e.length;r+=1){1===e[r].nodeType&&n.push(t.create(e[r]))}return n}},{key:"eachChild",value:function(e,t){for(var n=this.children(),r=0,i=n.length;r<i;r+=1)e.call(n[r],n[r],r,n),t&&n[r].eachChild(e,t);return this}},{key:"index",value:function(){return yf(this.node)}},{key:"hasClass",value:function(e){return of(this.node,e)}},{key:"addClass",value:function(e){return af(this.node,e),this}},{key:"removeClass",value:function(e){return sf(this.node,e),this}},{key:"toggleClass",value:function(e,t){return lf(this.node,e,t),this}},{key:"toLocalPoint",value:function(e,t){return function(e,t,n){var r=e instanceof SVGSVGElement?e:e.ownerSVGElement,i=r.createSVGPoint();i.x=t,i.y=n;try{var o=r.getScreenCTM(),a=i.matrixTransform(o.inverse()),s=_d(e,r).inverse();return a.matrixTransform(s)}catch(Kk){return i}}(this.node,e,t)}},{key:"sample",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.node instanceof SVGPathElement?function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.getTotalLength(),i=[],o=0;for(;o<r;)t=e.getPointAtLength(o),i.push({distance:o,x:t.x,y:t.y}),o+=n;return i}(this.node,e):[]}},{key:"toPath",value:function(){return t.create(function(e){var t=vf("path");Tf(t,Tf(e));var n=ud(e);n&&t.setAttribute("d",n);return t}(this.node))}},{key:"toPathData",value:function(){return ud(this.node)}}]),t}();function Kf(e,t,n){for(var r,i=n.eol,o=n.baseSize,a=n.lineHeight,s=0,l={},u=t.length-1,c=0;c<=u;c+=1){var h=t[c],f=null;if("object"===v(h)){var d=h.attrs,g=Xf.create("tspan",d);r=g.node;var p=h.t;i&&c===u&&(p+=i),r.textContent=p;var y=d.class;y&&g.addClass(y),n.includeAnnotationIndices&&g.attr("annotations",h.annotations.join(",")),void 0===(f=parseFloat(d["font-size"]))&&(f=o),f&&f>s&&(s=f)}else i&&c===u&&(h+=i),r=document.createTextNode(h||" "),o&&o>s&&(s=o);e.appendChild(r)}return s&&(l.maxFontSize=s),a?l.lineHeight=a:s&&(l.lineHeight=1.2*s),l}!function(e){function t(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&r.node instanceof SVGElement&&"function"==typeof r.sample&&"function"==typeof r.toPath}function n(t,n,r){return new e(t,n,r)}function r(e){return t(e)?e.node:e}e.toStringTag="X6.".concat(e.name),e.isVector=t,e.create=n,e.createVectors=function(e){if("<"===e[0]){for(var t=pf(e),r=[],i=0,o=t.childNodes.length;i<o;i+=1){var a=t.childNodes[i];r.push(n(document.importNode(a,!0)))}return r}return[n(e)]},e.toNode=r,e.toNodes=function(e){return Array.isArray(e)?e.map((function(e){return r(e)})):[r(e)]}}(Xf||(Xf={}));var $f=/em$/;function Qf(e,t){var n=parseFloat(e);return $f.test(e)?n*t:n}function ed(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=function(e){return e.replace(/ /g," ")}(t);var r=n.eol,i=n.textPath,o=n.textVerticalAnchor,a="middle"===o||"bottom"===o||"top"===o,s=n.x;void 0===s&&(s=e.getAttribute("x")||0);var l=n.includeAnnotationIndices,u=n.annotations;u&&!Array.isArray(u)&&(u=[u]);var c=n.lineHeight,h="auto"===c,f=h?"1.5em":c||"1em",d=!0,g=e.childNodes;if(1===g.length){var p=g[0];p&&"TITLE"===p.tagName.toUpperCase()&&(d=!1)}d&&kf(e),Tf(e,{"xml:space":"preserve",display:t||n.displayEmpty?null:"none"});var y,m,w=Tf(e,"font-size"),b=parseFloat(w);b||(b=16,!a&&!u||w||Tf(e,"font-size","".concat(b))),i?("string"==typeof i&&(i={d:i}),y=function(e,t){var n=Xf.create(t),r=Xf.create("textPath"),i=e.d;if(i&&void 0===e["xlink:href"]){var o=Xf.create("path").attr("d",i).appendTo(n.defs());r.attr("xlink:href","#".concat(o.id))}return"object"===v(e)&&r.attr(e),r.node}(i,e)):y=document.createDocumentFragment();for(var k,x=0,C=t.split("\n"),E=[],S=C.length-1,_=0;_<=S;_+=1){m=f;var A="v-line",M=vf("tspan"),P=void 0,O=C[_];if(O)if(u){var T=(P=Kf(M,Df(O,u,{offset:-x,includeAnnotationIndices:l}),{eol:_!==S&&r,baseSize:b,lineHeight:h?null:f,includeAnnotationIndices:l})).lineHeight;T&&h&&0!==_&&(m=T),0===_&&(k=.8*P.maxFontSize)}else r&&_!==S&&(O+=r),M.textContent=O;else{M.textContent="-",A+=" v-empty-line";var L=M.style;L.fillOpacity=0,L.strokeOpacity=0,u&&(P={})}P&&E.push(P),_>0&&M.setAttribute("dy",m),(_>0||i)&&M.setAttribute("x",s),M.className.baseVal=A,y.appendChild(M),x+=O.length+1}if(a)if(u)m=function(e,t,n,r){if(!Array.isArray(t))return 0;var i=t.length;if(!i)return 0;for(var o=t[0],a=Qf(o.maxFontSize,n)||n,s=0,l=Qf(r,n),u=1;u<i;u+=1)s+=Qf((o=t[u]).lineHeight,n)||l;var c,h=Qf(o.maxFontSize,n)||n;switch(e){case"middle":c=a/2-.15*h-s/2;break;case"bottom":c=-.25*h-s;break;default:c=.8*a}return c}(o,E,b,f);else if("top"===o)m="0.8em";else{var j;switch(S>0?(j=parseFloat(f)||1,j*=S,$f.test(f)||(j/=b)):j=0,o){case"middle":m="".concat(.3-j/2,"em");break;case"bottom":m="".concat(-j-.3,"em")}}else 0===o?m="0em":o?m=o:(m=0,null==e.getAttribute("y")&&e.setAttribute("y","".concat(k||"0.8em")));y.firstChild.setAttribute("dy",m),e.appendChild(y)}function td(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=document.createElement("canvas").getContext("2d");if(!e)return{width:0};var r=[],i=t["font-size"]?"".concat(parseFloat(t["font-size"]),"px"):"14px";return r.push(t["font-style"]||"normal"),r.push(t["font-variant"]||"normal"),r.push(t["font-weight"]||400),r.push(i),r.push(t["font-family"]||"sans-serif"),n.font=r.join(" "),n.measureText(e)}function nd(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t>=n)return[e,""];var i=e.length,o={},a=Math.round(t/n*i-1);for(a<0&&(a=0);a>=0&&a<i;){var s=e.slice(0,a),l=o[s]||td(s,r).width,u=e.slice(0,a+1),c=o[u]||td(u,r).width;if(o[s]=l,o[u]=c,l>t)a-=1;else{if(!(c<=t))break;a+=1}}return[e.slice(0,a),e.slice(a)]}function rd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t.width,o=t.height,a=r.eol||"\n",s=n.fontSize||14,l=n.lineHeight?parseFloat(n.lineHeight):Math.ceil(1.4*s),u=Math.floor(o/l);if(e.indexOf(a)>-1){var c=Ph(),h=[];return e.split(a).map((function(e){var i=rd(e,Object.assign(Object.assign({},t),{height:Number.MAX_SAFE_INTEGER}),n,Object.assign(Object.assign({},r),{eol:c}));i&&h.push.apply(h,p(i.split(c)))})),h.slice(0,u).join(a)}var f=td(e,n).width;if(f<i)return e;var d=[],g=e,v=f,y=r.ellipsis,w=0;y&&("string"!=typeof y&&(y="…"),w=td(y,n).width);for(var b=0;b<u;b+=1){if(!(v>i)){d.push(g);break}if(b===u-1){var k=m(nd(g,i-w,v,n),1)[0];d.push(y?"".concat(k).concat(y):k)}else{var x=m(nd(g,i,v,n),2),C=x[0],E=x[1];d.push(C),v=td(g=E,n).width}}return d.join(a)}var id=.551784;function od(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:NaN,r=e.getAttribute(t);if(null==r)return n;var i=parseFloat(r);return Number.isNaN(i)?n:i}function ad(e){var t=e.map((function(e){return"".concat(e.x," ").concat(e.y)}));return"M ".concat(t.join(" L"))}function sd(e){var t=[],n=e.points;if(n)for(var r=0,i=n.numberOfItems;r<i;r+=1)t.push(n.getItem(r));return t}function ld(e){var t=e.x,n=e.y,r=e.width,i=e.height,o=Math.min(e.rx||e["top-rx"]||0,r/2),a=Math.min(e.rx||e["bottom-rx"]||0,r/2),s=Math.min(e.ry||e["top-ry"]||0,i/2),l=Math.min(e.ry||e["bottom-ry"]||0,i/2);return(o||a||s||l?["M",t,n+s,"v",i-s-l,"a",a,l,0,0,0,a,l,"h",r-2*a,"a",a,l,0,0,0,a,-l,"v",-(i-l-s),"a",o,s,0,0,0,-o,-s,"h",-(r-2*o),"a",o,s,0,0,0,-o,s,"Z"]:["M",t,n,"H",t+r,"V",n+i,"H",t,"V",n,"Z"]).join(" ")}function ud(e){var t,n=e.tagName.toLowerCase();switch(n){case"path":return e.getAttribute("d");case"line":return function(e){return["M",od(e,"x1"),od(e,"y1"),"L",od(e,"x2"),od(e,"y2")].join(" ")}(e);case"polygon":return 0===(t=sd(e)).length?null:"".concat(ad(t)," Z");case"polyline":return function(e){var t=sd(e);return 0===t.length?null:ad(t)}(e);case"ellipse":return function(e){var t=od(e,"cx",0),n=od(e,"cy",0),r=od(e,"rx"),i=od(e,"ry")||r,o=r*id,a=i*id;return["M",t,n-i,"C",t+o,n-i,t+r,n-a,t+r,n,"C",t+r,n+a,t+o,n+i,t,n+i,"C",t-o,n+i,t-r,n+a,t-r,n,"C",t-r,n-a,t-o,n-i,t,n-i,"Z"].join(" ")}(e);case"circle":return function(e){var t=od(e,"cx",0),n=od(e,"cy",0),r=od(e,"r"),i=r*id;return["M",t,n-r,"C",t+i,n-r,t+r,n-i,t+r,n,"C",t+r,n+i,t+i,n+r,t,n+r,"C",t-i,n+r,t-r,n+i,t-r,n,"C",t-r,n-i,t-i,n-r,t,n-r,"Z"].join(" ")}(e);case"rect":return function(e){return ld({x:od(e,"x",0),y:od(e,"y",0),width:od(e,"width",0),height:od(e,"height",0),rx:od(e,"rx",0),ry:od(e,"ry",0)})}(e)}throw new Error('"'.concat(n,'" cannot be converted to svg path element.'))}var cd,hd,fd,dd=/(\w+)\(([^,)]+),?([^)]+)?\)/gi,gd=/[ ,]+/,vd=/^(\w+)\((.*)\)/;function pd(e){var t=vf("svg").createSVGMatrix();if(null!=e){var n=e,r=t;for(var i in n)r[i]=n[i]}return t}function yd(e){var t=vf("svg");return null!=e?(e instanceof DOMMatrix||(e=pd(e)),t.createSVGTransformFromMatrix(e)):t.createSVGTransform()}function md(e){var t=pd(),n=null!=e&&e.match(dd);if(!n)return t;for(var r=0,i=n.length;r<i;r+=1){var o=n[r].match(vd);if(o){var a=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=pd(),f=o[2].split(gd);switch(o[1].toLowerCase()){case"scale":a=parseFloat(f[0]),s=void 0===f[1]?a:parseFloat(f[1]),h=h.scaleNonUniform(a,s);break;case"translate":l=parseFloat(f[0]),u=parseFloat(f[1]),h=h.translate(l,u);break;case"rotate":c=parseFloat(f[0]),l=parseFloat(f[1])||0,u=parseFloat(f[2])||0,h=0!==l||0!==u?h.translate(l,u).rotate(c).translate(-l,-u):h.rotate(c);break;case"skewx":c=parseFloat(f[0]),h=h.skewX(c);break;case"skewy":c=parseFloat(f[0]),h=h.skewY(c);break;case"matrix":h.a=parseFloat(f[0]),h.b=parseFloat(f[1]),h.c=parseFloat(f[2]),h.d=parseFloat(f[3]),h.e=parseFloat(f[4]),h.f=parseFloat(f[5]);break;default:continue}t=t.multiply(h)}}return t}function wd(e){var t=e||{},n=null!=t.a?t.a:1,r=null!=t.b?t.b:0,i=null!=t.c?t.c:0,o=null!=t.d?t.d:1,a=null!=t.e?t.e:0,s=null!=t.f?t.f:0;return"matrix(".concat(n,",").concat(r,",").concat(i,",").concat(o,",").concat(a,",").concat(s,")")}function bd(e){var t,n,r;if(e){var i=gd;if(e.trim().indexOf("matrix")>=0){var o=function(e){var t=kd(e,{x:0,y:1}),n=kd(e,{x:1,y:0}),r=180/Math.PI*Math.atan2(t.y,t.x)-90,i=180/Math.PI*Math.atan2(n.y,n.x);return{skewX:r,skewY:i,translateX:e.e,translateY:e.f,scaleX:Math.sqrt(e.a*e.a+e.b*e.b),scaleY:Math.sqrt(e.c*e.c+e.d*e.d),rotation:r}}(md(e));t=[o.translateX,o.translateY],n=[o.rotation],r=[o.scaleX,o.scaleY];var a=[];0===t[0]&&0===t[1]||a.push("translate(".concat(t.join(","),")")),1===r[0]&&1===r[1]||a.push("scale(".concat(r.join(","),")")),0!==n[0]&&a.push("rotate(".concat(n[0],")")),e=a.join(" ")}else{var s=e.match(/translate\((.*?)\)/);s&&(t=s[1].split(i));var l=e.match(/rotate\((.*?)\)/);l&&(n=l[1].split(i));var u=e.match(/scale\((.*?)\)/);u&&(r=u[1].split(i))}}var c=r&&r[0]?parseFloat(r[0]):1;return{raw:e||"",translation:{tx:t&&t[0]?parseInt(t[0],10):0,ty:t&&t[1]?parseInt(t[1],10):0},rotation:{angle:n&&n[0]?parseInt(n[0],10):0,cx:n&&n[1]?parseInt(n[1],10):void 0,cy:n&&n[2]?parseInt(n[2],10):void 0},scale:{sx:c,sy:r&&r[1]?parseFloat(r[1]):c}}}function kd(e,t){return{x:t.x*e.a+t.y*e.c+0,y:t.x*e.b+t.y*e.d+0}}function xd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)return md(Tf(e,"transform"));if(n.absolute)e.setAttribute("transform",wd(t));else{var r=e.transform,i=yd(t);r.baseVal.appendItem(i)}}function Cd(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Tf(e,"transform"),o=bd(i);if(null==t)return o.translation;i=(i=o.raw).replace(/translate\([^)]*\)/g,"").trim();var a=r.absolute?t:o.translation.tx+t,s=r.absolute?n:o.translation.ty+n,l="translate(".concat(a,",").concat(s,")");e.setAttribute("transform","".concat(l," ").concat(i).trim())}function Ed(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=Tf(e,"transform"),a=bd(o);if(null==t)return a.rotation;o=(o=a.raw).replace(/rotate\([^)]*\)/g,"").trim(),t%=360;var s=i.absolute?t:a.rotation.angle+t,l=null!=n&&null!=r?",".concat(n,",").concat(r):"",u="rotate(".concat(s).concat(l,")");e.setAttribute("transform","".concat(o," ").concat(u).trim())}function Sd(e,t,n){var r=Tf(e,"transform"),i=bd(r);if(null==t)return i.scale;n=null==n?t:n,r=(r=i.raw).replace(/scale\([^)]*\)/g,"").trim();var o="scale(".concat(t,",").concat(n,")");e.setAttribute("transform","".concat(r," ").concat(o).trim())}function _d(e,t){if(hf(t)&&hf(e)){var n=t.getScreenCTM(),r=e.getScreenCTM();if(n&&r)return n.inverse().multiply(r)}return pd()}!function(e){var t={};e.get=function(e){return t[e]||{}},e.register=function(e,n){t[e]=n},e.unregister=function(e){delete t[e]}}(cd||(cd={})),function(e){var t=new WeakMap;e.ensure=function(e){return t.has(e)||t.set(e,{events:Object.create(null)}),t.get(e)},e.get=function(e){return t.get(e)},e.remove=function(e){return t.delete(e)}}(hd||(hd={})),function(e){e.returnTrue=function(){return!0},e.returnFalse=function(){return!1},e.stopPropagationCallback=function(e){e.stopPropagation()},e.addEventListener=function(e,t,n){null!=e.addEventListener&&e.addEventListener(t,n)},e.removeEventListener=function(e,t,n){null!=e.removeEventListener&&e.removeEventListener(t,n)}}(fd||(fd={})),function(e){var t=/[^\x20\t\r\n\f]+/g,n=/^([^.]*)(?:\.(.+)|)/;e.splitType=function(e){return(e||"").match(t)||[""]},e.normalizeType=function(e){var t=n.exec(e)||[];return{originType:t[1]?t[1].trim():t[1],namespaces:t[2]?t[2].split(".").map((function(e){return e.trim()})).sort():[]}},e.isValidTarget=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},e.isValidSelector=function(e,t){if(t){var n=e;return null!=n.querySelector&&null!=n.querySelector(t)}return!0}}(fd||(fd={})),function(e){var t=0,n=new WeakMap;e.ensureHandlerId=function(e){return n.has(e)||(n.set(e,t),t+=1),n.get(e)},e.getHandlerId=function(e){return n.get(e)},e.removeHandlerId=function(e){return n.delete(e)},e.setHandlerId=function(e,t){return n.set(e,t)}}(fd||(fd={})),function(e){e.getHandlerQueue=function(e,t){var n=[],r=hd.get(e),i=r&&r.events&&r.events[t.type],o=i&&i.handlers||[],a=i?i.delegateCount:0;if(a>0&&!("click"===t.type&&"number"==typeof t.button&&t.button>=1))for(var s=t.target;s!==e;s=s.parentNode||e)if(1===s.nodeType&&("click"!==t.type||!0!==s.disabled)){for(var l=[],u={},c=function(){var t=o[h],n=t.selector;if(null!=n&&null==u[n]){var r=[];e.querySelectorAll(n).forEach((function(e){r.push(e)})),u[n]=r.includes(s)}u[n]&&l.push(t)},h=0;h<a;h+=1)c();l.length&&n.push({elem:s,handlers:l})}return a<o.length&&n.push({elem:e,handlers:o.slice(a)}),n}}(fd||(fd={})),function(e){e.isWindow=function(e){return null!=e&&e===e.window}}(fd||(fd={})),function(e){e.contains=function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}}(fd||(fd={}));var Ad=P((function e(t,n){var r=this;A(this,e),this.isDefaultPrevented=fd.returnFalse,this.isPropagationStopped=fd.returnFalse,this.isImmediatePropagationStopped=fd.returnFalse,this.isSimulated=!1,this.preventDefault=function(){var e=r.originalEvent;r.isDefaultPrevented=fd.returnTrue,e&&!r.isSimulated&&e.preventDefault()},this.stopPropagation=function(){var e=r.originalEvent;r.isPropagationStopped=fd.returnTrue,e&&!r.isSimulated&&e.stopPropagation()},this.stopImmediatePropagation=function(){var e=r.originalEvent;r.isImmediatePropagationStopped=fd.returnTrue,e&&!r.isSimulated&&e.stopImmediatePropagation(),r.stopPropagation()},"string"==typeof t?this.type=t:t.type&&(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?fd.returnTrue:fd.returnFalse,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.timeStamp=t.timeStamp),n&&Object.assign(this,n),this.timeStamp||(this.timeStamp=Date.now())}));!function(e){e.create=function(t){return t instanceof e?t:new e(t)}}(Ad||(Ad={})),function(e){e.addProperty=function(t,n){Object.defineProperty(e.prototype,t,{enumerable:!0,configurable:!0,get:"function"==typeof n?function(){if(this.originalEvent)return n(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})}}(Ad||(Ad={})),function(e){var t={bubbles:!0,cancelable:!0,eventPhase:!0,detail:!0,view:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pageX:!0,pageY:!0,screenX:!0,screenY:!0,toElement:!0,pointerId:!0,pointerType:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,touches:!0,changedTouches:!0,targetTouches:!0,which:!0,altKey:!0,ctrlKey:!0,metaKey:!0,shiftKey:!0};Object.keys(t).forEach((function(n){return e.addProperty(n,t[n])}))}(Ad||(Ad={})),cd.register("load",{noBubble:!0}),cd.register("beforeunload",{postDispatch:function(e,t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}),cd.register("mouseenter",{delegateType:"mouseover",bindType:"mouseover",handle:function(e,t){var n,r=t.relatedTarget,i=t.handleObj;return r&&(r===e||fd.contains(e,r))||(t.type=i.originType,n=i.handler.call(e,t),t.type="mouseover"),n}}),cd.register("mouseleave",{delegateType:"mouseout",bindType:"mouseout",handle:function(e,t){var n,r=t.relatedTarget,i=t.handleObj;return r&&(r===e||fd.contains(e,r))||(t.type=i.originType,n=i.handler.call(e,t),t.type="mouseout"),n}});var Md,Pd,Od,Td=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){var t;function n(e,t){var n=Ad.create(t);n.delegateTarget=e;var r=cd.get(n.type);if(!r.preDispatch||!1!==r.preDispatch(e,n)){for(var i=fd.getHandlerQueue(e,n),o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];for(var l=0,u=i.length;l<u&&!n.isPropagationStopped();l+=1){var c=i[l];n.currentTarget=c.elem;for(var h=0,f=c.handlers.length;h<f&&!n.isImmediatePropagationStopped();h+=1){var d=c.handlers[h];if(null==n.rnamespace||d.namespace&&n.rnamespace.test(d.namespace)){var g;n.handleObj=d,n.data=d.data;var v=cd.get(d.originType).handle,p=v?v.apply(void 0,[c.elem,n].concat(a)):(g=d.handler).call.apply(g,[c.elem,n].concat(a));void 0!==p&&(n.result=p,!1===p&&(n.preventDefault(),n.stopPropagation()))}}}return r.postDispatch&&r.postDispatch(e,n),n.result}}e.on=function(e,r,i,o,a){if(fd.isValidTarget(e)){var s;if("function"!=typeof i){var l=i,u=l.handler,c=l.selector,h=Td(i,["handler","selector"]);i=u,a=c,s=h}var f=hd.ensure(e),d=f.handler;null==d&&(d=f.handler=function(r){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return t!==r.type?n.apply(void 0,[e,r].concat(o)):void 0});var g=fd.ensureHandlerId(i);fd.splitType(r).forEach((function(t){var n=fd.normalizeType(t),r=n.originType,l=n.namespaces;if(r){var u=r,c=cd.get(u);u=(a?c.delegateType:c.bindType)||u,c=cd.get(u);var h=Object.assign({type:u,originType:r,data:o,selector:a,guid:g,handler:i,namespace:l.join(".")},s),v=f.events,p=v[u];p||(p=v[u]={handlers:[],delegateCount:0},c.setup&&!1!==c.setup(e,o,l,d)||fd.addEventListener(e,u,d)),c.add&&(fd.removeHandlerId(h.handler),c.add(e,h),fd.setHandlerId(h.handler,g)),a?(p.handlers.splice(p.delegateCount,0,h),p.delegateCount+=1):p.handlers.push(h)}}))}},e.off=function e(t,n,r,i,o){var a=hd.get(t);if(a){var s=a.events;s&&(fd.splitType(n).forEach((function(n){var l=fd.normalizeType(n),u=l.originType,c=l.namespaces;if(u){var h=u,f=cd.get(h);h=(i?f.delegateType:f.bindType)||h;var d=s[h];if(d){for(var g=c.length>0?new RegExp("(^|\\.)".concat(c.join("\\.(?:.*\\.|)"),"(\\.|$)")):null,v=d.handlers.length,p=d.handlers.length-1;p>=0;p-=1){var y=d.handlers[p];!o&&u!==y.originType||r&&fd.getHandlerId(r)!==y.guid||!(null==g||y.namespace&&g.test(y.namespace))||!(null==i||i===y.selector||"**"===i&&y.selector)||(d.handlers.splice(p,1),y.selector&&(d.delegateCount-=1),f.remove&&f.remove(t,y))}v&&0===d.handlers.length&&(f.teardown&&!1!==f.teardown(t,c,a.handler)||fd.removeEventListener(t,h,a.handler),delete s[h])}}else Object.keys(s).forEach((function(o){e(t,o+n,r,i,!0)}))})),0===Object.keys(s).length&&hd.remove(t))}},e.dispatch=n,e.trigger=function(e,n,r,i){var o=e,a="string"==typeof e?e:e.type,s="string"==typeof e||null==o.namespace?[]:o.namespace.split("."),l=r;if(3!==l.nodeType&&8!==l.nodeType){a.indexOf(".")>-1&&(s=a.split("."),a=s.shift(),s.sort());var u=a.indexOf(":")<0&&"on".concat(a);(o=e instanceof Ad?e:new Ad(a,"object"===v(e)?e:null)).namespace=s.join("."),o.rnamespace=o.namespace?new RegExp("(^|\\.)".concat(s.join("\\.(?:.*\\.|)"),"(\\.|$)")):null,o.result=void 0,o.target||(o.target=l);var c=[o];Array.isArray(n)?c.push.apply(c,p(n)):c.push(n);var h=cd.get(a);if(i||!h.trigger||!1!==h.trigger(l,o,n)){var f,d=[l];if(!i&&!h.noBubble&&!fd.isWindow(l)){f=h.delegateType||a;for(var g=l,y=l.parentNode;null!=y;)d.push(y),g=y,y=y.parentNode;if(g===(l.ownerDocument||document)){var m=g.defaultView||g.parentWindow||window;d.push(m)}}for(var w=l,b=0,k=d.length;b<k&&!o.isPropagationStopped();b+=1){var x=d[b];w=x,o.type=b>1?f:h.bindType||a;var C,E=hd.get(x);if(E)if(E.events[o.type]&&E.handler)(C=E.handler).call.apply(C,[x].concat(c));var S=u&&x[u]||null;S&&fd.isValidTarget(x)&&(o.result=S.call.apply(S,[x].concat(c)),!1===o.result&&o.preventDefault())}if(o.type=a,!i&&!o.isDefaultPrevented()){var _=h.preventDefault;if((null==_||!1===_(d.pop(),o,n))&&fd.isValidTarget(l)&&u&&"function"==typeof l[a]&&!fd.isWindow(l)){var A=l[u];A&&(l[u]=null),t=a,o.isPropagationStopped()&&w.addEventListener(a,fd.stopPropagationCallback),l[a](),o.isPropagationStopped()&&w.removeEventListener(a,fd.stopPropagationCallback),t=void 0,A&&(l[u]=A)}}return o.result}}}}(Md||(Md={})),function(e){e.on=function(e,t,n,r,i){return Od.on(e,t,n,r,i),e},e.once=function(e,t,n,r,i){return Od.on(e,t,n,r,i,!0),e},e.off=function(e,t,n,r){return Od.off(e,t,n,r),e},e.trigger=function(e,t,n,r){return Md.trigger(t,n,e,r),e}}(Pd||(Pd={})),function(e){e.on=function t(n,r,i,o,a,s){if("object"===v(r))return"string"!=typeof i&&(o=o||i,i=void 0),void Object.keys(r).forEach((function(e){return t(n,e,i,o,r[e],s)}));if(null==o&&null==a?(a=i,o=i=void 0):null==a&&("string"==typeof i?(a=o,o=void 0):(a=o,o=i,i=void 0)),!1===a)a=fd.returnFalse;else if(!a)return;if(s){var l=a;a=function(t){e.off(n,t);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return l.call.apply(l,[this,t].concat(i))},fd.setHandlerId(a,fd.ensureHandlerId(l))}Md.on(n,r,a,o,i)},e.off=function e(t,n,r,i){var o=n;if(o&&null!=o.preventDefault&&null!=o.handleObj){var a=o.handleObj;e(o.delegateTarget,a.namespace?"".concat(a.originType,".").concat(a.namespace):a.originType,a.selector,a.handler)}else if("object"!==v(n))!1!==r&&"function"!=typeof r||(i=r,r=void 0),!1===i&&(i=fd.returnFalse),Md.off(t,n,i,r);else{var s=n;Object.keys(s).forEach((function(n){return e(t,n,r,s[n])}))}}}(Od||(Od={}));var Ld=function(){function e(t,n,r){A(this,e),this.animationFrameId=0,this.deltaX=0,this.deltaY=0,this.eventName=Nh.isEventSupported("wheel")?"wheel":"mousewheel",this.target=t,this.onWheelCallback=n,this.onWheelGuard=r,this.onWheel=this.onWheel.bind(this),this.didWheel=this.didWheel.bind(this)}return P(e,[{key:"enable",value:function(){this.target.addEventListener(this.eventName,this.onWheel,{passive:!1})}},{key:"disable",value:function(){this.target.removeEventListener(this.eventName,this.onWheel)}},{key:"onWheel",value:function(e){var t,n=this;(null==this.onWheelGuard||this.onWheelGuard(e))&&(this.deltaX+=e.deltaX,this.deltaY+=e.deltaY,e.preventDefault(),0===this.deltaX&&0===this.deltaY||(e.stopPropagation(),t=!0),!0===t&&0===this.animationFrameId&&(this.animationFrameId=requestAnimationFrame((function(){n.didWheel(e)}))))}},{key:"didWheel",value:function(e){this.animationFrameId=0,this.onWheelCallback(e,this.deltaX,this.deltaY),this.deltaX=0,this.deltaY=0}}]),e}();function jd(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,r=null;return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];r&&clearTimeout(r),r=window.setTimeout((function(){e.apply(t,o)}),n)}}var Nd,Rd="undefined"!=typeof ResizeObserver?function(e){var t=null,n=[],r=jd((function(){n.forEach((function(t){t(e)}))})),i=function(){t&&(t.disconnect(),n=[],t=null)};return{element:e,bind:function(i){var o;t||((o=new ResizeObserver(r)).observe(e),r(),t=o),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:function(e){var r=n.indexOf(e);-1!==r&&n.splice(r,1),0===n.length&&t&&i()}}}:function(e){var t=null,n=[],r=jd((function(){n.forEach((function(t){return t(e)}))})),i=function(){t&&t.parentNode&&(t.contentDocument&&t.contentDocument.defaultView.removeEventListener("resize",r),t.parentNode.removeChild(t),t=null,n=[])};return{element:e,bind:function(i){t||(t=function(){"static"===getComputedStyle(e).position&&(e.style.position="relative");var t=document.createElement("object");return t.onload=function(){t.contentDocument.defaultView.addEventListener("resize",r),r()},t.style.display="block",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none",t.style.zIndex="-1",t.style.opacity="0",t.setAttribute("tabindex","-1"),t.type="text/html",e.appendChild(t),t.data="about:blank",t}()),-1===n.indexOf(i)&&n.push(i)},destroy:i,unbind:function(e){var r=n.indexOf(e);-1!==r&&n.splice(r,1),0===n.length&&t&&i()}}};!function(e){var t=new WeakMap;function n(e){var n=t.get(e);return n||(n=Rd(e),t.set(e,n),n)}e.bind=function(e,t){var r=n(e);return r.bind(t),function(){return r.unbind(t)}},e.clear=function(e){!function(e){e.destroy(),t.delete(e.element)}(n(e))}}(Nd||(Nd={}));var Dd,Id=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A(this,e),this.comparator=t.comparator||e.defaultComparator,this.index={},this.data=t.data||[],this.heapify()}return P(e,[{key:"isEmpty",value:function(){return 0===this.data.length}},{key:"insert",value:function(e,t,n){var r={priority:e,value:t},i=this.data.length;return n&&(r.id=n,this.index[n]=i),this.data.push(r),this.bubbleUp(i),this}},{key:"peek",value:function(){return this.data[0]?this.data[0].value:null}},{key:"peekPriority",value:function(){return this.data[0]?this.data[0].priority:null}},{key:"updatePriority",value:function(e,t){var n=this.index[e];if(void 0===n)throw new Error("Node with id '".concat(e,"' was not found in the heap."));var r=this.data,i=r[n].priority,o=this.comparator(t,i);o<0?(r[n].priority=t,this.bubbleUp(n)):o>0&&(r[n].priority=t,this.bubbleDown(n))}},{key:"remove",value:function(){var e=this.data,t=e[0],n=e.pop();return t.id&&delete this.index[t.id],e.length>0&&(e[0]=n,n.id&&(this.index[n.id]=0),this.bubbleDown(0)),t?t.value:null}},{key:"heapify",value:function(){for(var e=0;e<this.data.length;e+=1)this.bubbleUp(e)}},{key:"bubbleUp",value:function(e){for(var t,n,r=this.data,i=e;i>0&&(n=i-1>>>1,this.comparator(r[i].priority,r[n].priority)<0);){t=r[n],r[n]=r[i];var o=r[i].id;null!=o&&(this.index[o]=n),r[i]=t,null!=(o=r[i].id)&&(this.index[o]=i),i=n}}},{key:"bubbleDown",value:function(e){for(var t=this.data,n=t.length-1,r=e;;){var i=1+(r<<1),o=i+1,a=r;if(i<=n&&this.comparator(t[i].priority,t[a].priority)<0&&(a=i),o<=n&&this.comparator(t[o].priority,t[a].priority)<0&&(a=o),a===r)break;var s=t[a];t[a]=t[r];var l=t[r].id;null!=l&&(this.index[l]=a),t[r]=s,null!=(l=t[r].id)&&(this.index[l]=r),r=a}}}]),e}();!function(e){e.defaultComparator=function(e,t){return e-t}}(Id||(Id={})),function(e){e.run=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return 1},r={},i={},o={},a=new Id;for(r[t]=0,Object.keys(e).forEach((function(e){e!==t&&(r[e]=1/0),a.insert(r[e],e,e)}));!a.isEmpty();){var s=a.remove();o[s]=!0;for(var l=e[s]||[],u=0;u<l.length;u+=1){var c=l[u];if(!o[c]){var h=r[s]+n(s,c);h<r[c]&&(r[c]=h,i[c]=s,a.updatePriority(c,h))}}}return i}}(Dd||(Dd={}));var Bd=function(){function e(t,n,r,i){return A(this,e),null==t?this.set(255,255,255,1):"number"==typeof t?this.set(t,n,r,i):"string"==typeof t?e.fromString(t)||this:Array.isArray(t)?this.set(t):void this.set(t.r,t.g,t.b,null==t.a?1:t.a)}return P(e,[{key:"blend",value:function(e,t,n){this.set(e.r+(t.r-e.r)*n,e.g+(t.g-e.g)*n,e.b+(t.b-e.b)*n,e.a+(t.a-e.a)*n)}},{key:"lighten",value:function(t){var n=e.lighten(this.toArray(),t);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}},{key:"darken",value:function(e){this.lighten(-e)}},{key:"set",value:function(e,t,n,r){var i=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,s=Array.isArray(e)?e[3]:r;return this.r=Math.round(Ge(i,0,255)),this.g=Math.round(Ge(o,0,255)),this.b=Math.round(Ge(a,0,255)),this.a=null==s?1:Ge(s,0,1),this}},{key:"toHex",value:function(){var e=this,t=["r","g","b"].map((function(t){var n=e[t].toString(16);return n.length<2?"0".concat(n):n}));return"#".concat(t.join(""))}},{key:"toRGBA",value:function(){return this.toArray()}},{key:"toHSLA",value:function(){return e.rgba2hsla(this.r,this.g,this.b,this.a)}},{key:"toCSS",value:function(e){var t="".concat(this.r,",").concat(this.g,",").concat(this.b,",");return e?"rgb(".concat(t,")"):"rgba(".concat(t,",").concat(this.a,")")}},{key:"toGrey",value:function(){return e.makeGrey(Math.round((this.r+this.g+this.b)/3),this.a)}},{key:"toArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toString",value:function(){return this.toCSS()}}]),e}();!function(e){function t(t){return new e([].concat(p(s(t)),[1]))}function n(t){var n=t.toLowerCase().match(/^rgba?\(([\s.,0-9]+)\)/);if(n){var r=n[1].split(/\s*,\s*/).map((function(e){return parseInt(e,10)}));return new e(r)}return null}function r(e,t,n){n<0&&++n,n>1&&--n;var r=6*n;return r<1?e+(t-e)*r:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function i(t){var n=t.toLowerCase().match(/^hsla?\(([\s.,0-9]+)\)/);if(n){var r=n[2].split(/\s*,\s*/),i=(parseFloat(r[0])%360+360)%360/360,a=parseFloat(r[1])/100,s=parseFloat(r[2])/100,l=null==r[3]?1:parseInt(r[3],10);return new e(o(i,a,s,l))}return null}function o(e,t,n,i){var o=Array.isArray(e)?e[0]:e,a=Array.isArray(e)?e[1]:t,s=Array.isArray(e)?e[2]:n,l=Array.isArray(e)?e[3]:i,u=s<=.5?s*(a+1):s+a-s*a,c=2*s-u;return[256*r(c,u,o+1/3),256*r(c,u,o),256*r(c,u,o-1/3),null==l?1:l]}function a(t){return new e(Math.round(256*Math.random()),Math.round(256*Math.random()),Math.round(256*Math.random()),t?void 0:parseFloat(Math.random().toFixed(2)))}function s(e){var t=0===e.indexOf("#")?e:"#".concat(e),n=Number("0x".concat(t.substr(1)));if(4!==t.length&&7!==t.length||Number.isNaN(n))throw new Error("Invalid hex color.");var r=4===t.length?4:8,i=(1<<r)-1,o=["b","g","r"].map((function(){var e=n&i;return n>>=r,4===r?17*e:e}));return[o[2],o[1],o[0]]}function l(e,t,n){var r=function(e){return e.length<2?"0".concat(e):e};return"".concat(r(e.toString(16))).concat(r(t.toString(16))).concat(r(n.toString(16)))}function u(e,t){if("string"==typeof e){var n="#"===e[0],r=parseInt(n?e.substr(1):e,16),i=Ge((r>>16)+t,0,255),o=Ge((r>>8&255)+t,0,255),a=Ge((255&r)+t,0,255);return"".concat(n?"#":"").concat((a|o<<8|i<<16).toString(16))}var c=s(u(l(e[0],e[1],e[2]),t));return[c[0],c[1],c[2],e[3]]}e.fromArray=function(t){return new e(t)},e.fromHex=t,e.fromRGBA=n,e.fromHSLA=i,e.fromString=function(r){if(r.startsWith("#"))return t(r);if(r.startsWith("rgb"))return n(r);var o=e.named[r];return o?t(o):i(r)},e.makeGrey=function(t,n){return e.fromArray([t,t,t,n])},e.rgba2hsla=function(e,t,n,r){var i=Array.isArray(e)?e[0]:e,o=Array.isArray(e)?e[1]:t,a=Array.isArray(e)?e[2]:n,s=Array.isArray(e)?e[3]:r,l=Math.max(i,o,a),u=Math.min(i,o,a),c=(l+u)/2,h=0,f=0;if(u!==l){var d=l-u;switch(f=c>.5?d/(2-l-u):d/(l+u),l){case i:h=(o-a)/d+(o<a?6:0);break;case o:h=(a-i)/d+2;break;case a:h=(i-o)/d+4}h/=6}return[h,f,c,null==s?1:s]},e.hsla2rgba=o,e.random=a,e.randomHex=function(){for(var e="#",t=0;t<6;t+=1)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},e.randomRGBA=function(e){return a(e).toString()},e.invert=function(e,t){if("string"==typeof e){var n="#"===e[0],r=m(s(e),3),i=r[0],o=r[1],a=r[2];return t?.299*i+.587*o+.114*a>186?"#000000":"#ffffff":"".concat(n?"#":"").concat(l(255-i,255-o,255-a))}var u=e[0],c=e[1],h=e[2],f=e[3];return t?.299*u+.587*c+.114*h>186?[0,0,0,f]:[255,255,255,f]:[255-u,255-c,255-h,f]},e.lighten=function(e,t){return u(e,t)},e.darken=function(e,t){return u(e,-t)}}(Bd||(Bd={})),function(e){e.named={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",burntsienna:"#ea7e5d",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(Bd||(Bd={}));var zd,Fd,Vd,Hd=function(){function e(){A(this,e),this.clear()}return P(e,[{key:"clear",value:function(){this.map=new WeakMap,this.arr=[]}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e){return this.map.get(e)}},{key:"set",value:function(e,t){this.map.set(e,t),this.arr.push(e)}},{key:"delete",value:function(e){var t=this.arr.indexOf(e);t>=0&&this.arr.splice(t,1);var n=this.map.get(e);return this.map.delete(e),n}},{key:"each",value:function(e){var t=this;this.arr.forEach((function(n){var r=t.map.get(n);e(r,n)}))}},{key:"dispose",value:function(){this.clear()}}]),e}();!function(e){function t(e){var t=[],n=[];return Array.isArray(e)?t.push.apply(t,p(e)):e.split("|").forEach((function(e){-1===e.indexOf("&")?t.push(e):n.push.apply(n,p(e.split("&")))})),{or:t,and:n}}e.parse=t,e.equals=function(e,n){if(null!=e&&null!=n){var r=t(e),i=t(n),o=r.or.sort(),a=i.or.sort(),s=r.and.sort(),l=i.and.sort(),u=function(e,t){return e.length===t.length&&(0===e.length||e.every((function(e,n){return e===t[n]})))};return u(o,a)&&u(s,l)}return null==e&&null==n},e.isMatch=function(e,n,r){if(null==n||Array.isArray(n)&&0===n.length)return!r||!0!==e.altKey&&!0!==e.ctrlKey&&!0!==e.metaKey&&!0!==e.shiftKey;var i=t(n),o=i.or,a=i.and,s=function(t){var n="".concat(t.toLowerCase(),"Key");return!0===e[n]};return o.some((function(e){return s(e)}))&&a.every((function(e){return s(e)}))}}(zd||(zd={})),function(e){e.linear=function(e){return e},e.quad=function(e){return e*e},e.cubic=function(e){return e*e*e},e.inout=function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)},e.exponential=function(e){return Math.pow(2,10*(e-1))},e.bounce=function(e){for(var t=0,n=1;;t+=n,n/=2)if(e>=(7-4*t)/11){var r=(11-6*t-11*e)/4;return-r*r+n*n}}}(Fd||(Fd={})),function(e){e.decorators={reverse:function(e){return function(t){return 1-e(1-t)}},reflect:function(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}},clamp:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return function(r){var i=e(r);return i<t?t:i>n?n:i}},back:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.70158;return function(t){return t*t*((e+1)*t-e)}},elastic:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1.5;return function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)}}}}(Fd||(Fd={})),function(e){function t(e){var t=e/1;if(t<1/2.75)return 7.5625*t*t;if(t<2/2.75){var n=t-1.5/2.75;return 7.5625*n*n+.75}if(t<2.5/2.75){var r=t-2.25/2.75;return 7.5625*r*r+.9375}var i=t-2.625/2.75;return 7.5625*i*i+.984375}function n(e){return 1-t(1-e)}e.easeInSine=function(e){return-1*Math.cos(e*(Math.PI/2))+1},e.easeOutSine=function(e){return Math.sin(e*(Math.PI/2))},e.easeInOutSine=function(e){return-.5*(Math.cos(Math.PI*e)-1)},e.easeInQuad=function(e){return e*e},e.easeOutQuad=function(e){return e*(2-e)},e.easeInOutQuad=function(e){return e<.5?2*e*e:(4-2*e)*e-1},e.easeInCubic=function(e){return e*e*e},e.easeOutCubic=function(e){var t=e-1;return t*t*t+1},e.easeInOutCubic=function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},e.easeInQuart=function(e){return e*e*e*e},e.easeOutQuart=function(e){var t=e-1;return 1-t*t*t*t},e.easeInOutQuart=function(e){var t=e-1;return e<.5?8*e*e*e*e:1-8*t*t*t*t},e.easeInQuint=function(e){return e*e*e*e*e},e.easeOutQuint=function(e){var t=e-1;return 1+t*t*t*t*t},e.easeInOutQuint=function(e){var t=e-1;return e<.5?16*e*e*e*e*e:1+16*t*t*t*t*t},e.easeInExpo=function(e){return 0===e?0:Math.pow(2,10*(e-1))},e.easeOutExpo=function(e){return 1===e?1:1-Math.pow(2,-10*e)},e.easeInOutExpo=function(e){if(0===e||1===e)return e;var t=2*e,n=t-1;return t<1?.5*Math.pow(2,10*n):.5*(2-Math.pow(2,-10*n))},e.easeInCirc=function(e){var t=e/1;return-1*(Math.sqrt(1-t*e)-1)},e.easeOutCirc=function(e){var t=e-1;return Math.sqrt(1-t*t)},e.easeInOutCirc=function(e){var t=2*e,n=t-2;return t<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-n*n)+1)},e.easeInBack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158;return e*e*((t+1)*e-t)},e.easeOutBack=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158,n=e/1-1;return n*n*((t+1)*n+t)+1},e.easeInOutBack=function(e){var t=2*e,n=t-2,r=1.525*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.70158);return t<1?.5*t*t*((r+1)*t-r):.5*(n*n*((r+1)*n+r)+2)},e.easeInElastic=function(e){if(0===e||1===e)return e;var t=e/1-1,n=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7),r=n/(2*Math.PI)*Math.asin(1);return-Math.pow(2,10*t)*Math.sin((t-r)*(2*Math.PI)/n)},e.easeOutElastic=function(e){var t=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7),n=2*e;if(0===e||1===e)return e;var r=t/(2*Math.PI)*Math.asin(1);return Math.pow(2,-10*n)*Math.sin((n-r)*(2*Math.PI)/t)+1},e.easeInOutElastic=function(e){var t=1-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.65);if(0===e||1===e)return e;var n=2*e,r=n-1,i=t/(2*Math.PI)*Math.asin(1);return n<1?Math.pow(2,10*r)*Math.sin((r-i)*(2*Math.PI)/t)*-.5:Math.pow(2,-10*r)*Math.sin((r-i)*(2*Math.PI)/t)*.5+1},e.easeOutBounce=t,e.easeInBounce=n,e.easeInOutBounce=function(e){return e<.5?.5*n(2*e):.5*t(2*e-1)+.5}}(Fd||(Fd={})),function(e){e.number=function(e,t){var n=t-e;return function(t){return e+n*t}},e.object=function(e,t){var n=Object.keys(e);return function(r){for(var i={},o=n.length-1;-1!==o;o-=1){var a=n[o];i[a]=e[a]+(t[a]-e[a])*r}return i}},e.unit=function(e,t){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,r=n.exec(e),i=n.exec(t),o=i?i[1]:"",a=r?+r[1]:0,s=i?+i[1]:0,l=o.indexOf("."),u=l>0?o[1].length-l-1:0,c=s-a,h=r?r[2]:"";return function(e){return(a+c*e).toFixed(u)+h}},e.color=function(e,t){var n=parseInt(e.slice(1),16),r=parseInt(t.slice(1),16),i=255&n,o=(255&r)-i,a=65280&n,s=(65280&r)-a,l=16711680&n,u=(16711680&r)-l;return function(e){return"#".concat((1<<24|i+o*e&255|a+s*e&65280|l+u*e&16711680).toString(16).slice(1))}}}(Vd||(Vd={}));var Ud,qd,Gd=[];!function(e){e.toDeg=function(e){return 180*e/Math.PI%360},e.toRad=function(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:e%360)*Math.PI/180},e.normalize=function(e){return e%360+(e<0?360:0)}}(Ud||(Ud={})),function(e){e.round=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number.isInteger(e)?e:+e.toFixed(t)},e.random=function(e,t){var n,r;if(null==t?(r=null==e?1:e,n=0):(r=t,n=null==e?0:e),r<n){var i=n;n=r,r=i}return Math.floor(Math.random()*(r-n+1)+n)},e.clamp=function(e,t,n){return Number.isNaN(e)?NaN:Number.isNaN(t)||Number.isNaN(n)?0:t<n?e<t?t:e>n?n:e:e<n?n:e>t?t:e},e.snapToGrid=function(e,t){return t*Math.round(e/t)},e.containsPoint=function(e,t){return null!=t&&null!=e&&t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},e.squaredLength=function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}}(qd||(qd={}));var Jd=function(){function e(){A(this,e)}return P(e,[{key:"valueOf",value:function(){return this.toJSON()}},{key:"toString",value:function(){return JSON.stringify(this.toJSON())}}]),e}(),Wd=function(e){l(n,e);var t=c(n);function n(e,r){var i;return A(this,n),(i=t.call(this)).x=null==e?0:e,i.y=null==r?0:r,i}return P(n,[{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x=qd.round(this.x,e),this.y=qd.round(this.y,e),this}},{key:"add",value:function(e,t){var r=n.create(e,t);return this.x+=r.x,this.y+=r.y,this}},{key:"update",value:function(e,t){var r=n.create(e,t);return this.x=r.x,this.y=r.y,this}},{key:"translate",value:function(e,t){var r=n.create(e,t);return this.x+=r.x,this.y+=r.y,this}},{key:"rotate",value:function(e,t){var r=n.rotate(this,e,t);return this.x=r.x,this.y=r.y,this}},{key:"scale",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new n,i=n.create(r);return this.x=i.x+e*(this.x-i.x),this.y=i.y+t*(this.y-i.y),this}},{key:"closest",value:function(e){var t=this;if(1===e.length)return n.create(e[0]);var r=null,i=1/0;return e.forEach((function(e){var n=t.squaredDistance(e);n<i&&(r=e,i=n)})),r?n.create(r):null}},{key:"distance",value:function(e){return Math.sqrt(this.squaredDistance(e))}},{key:"squaredDistance",value:function(e){var t=n.create(e),r=this.x-t.x,i=this.y-t.y;return r*r+i*i}},{key:"manhattanDistance",value:function(e){var t=n.create(e);return Math.abs(t.x-this.x)+Math.abs(t.y-this.y)}},{key:"magnitude",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)||.01}},{key:"theta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n,t=n.create(e),r=-(t.y-this.y),i=t.x-this.x,o=Math.atan2(r,i);return o<0&&(o=2*Math.PI+o),180*o/Math.PI}},{key:"angleBetween",value:function(e,t){if(this.equals(e)||this.equals(t))return NaN;var n=this.theta(t)-this.theta(e);return n<0&&(n+=360),n}},{key:"vectorAngle",value:function(e){return new n(0,0).angleBetween(this,e)}},{key:"toPolar",value:function(e){return this.update(n.toPolar(this,e)),this}},{key:"changeInAngle",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new n;return this.clone().translate(-e,-t).theta(r)-this.theta(r)}},{key:"adhereToRect",value:function(e){return qd.containsPoint(e,this)||(this.x=Math.min(Math.max(this.x,e.x),e.x+e.width),this.y=Math.min(Math.max(this.y,e.y),e.y+e.height)),this}},{key:"bearing",value:function(e){var t=n.create(e),r=Ud.toRad(this.y),i=Ud.toRad(t.y),o=this.x,a=t.x,s=Ud.toRad(a-o),l=Math.sin(s)*Math.cos(i),u=Math.cos(r)*Math.sin(i)-Math.sin(r)*Math.cos(i)*Math.cos(s),c=Ud.toDeg(Math.atan2(l,u))-22.5;return c<0&&(c+=360),["NE","E","SE","S","SW","W","NW","N"][c=parseInt(c/45,10)]}},{key:"cross",value:function(e,t){if(null!=e&&null!=t){var r=n.create(e),i=n.create(t);return(i.x-this.x)*(r.y-this.y)-(i.y-this.y)*(r.x-this.x)}return NaN}},{key:"dot",value:function(e){var t=n.create(e);return this.x*t.x+this.y*t.y}},{key:"diff",value:function(e,t){if("number"==typeof e)return new n(this.x-e,this.y-t);var r=n.create(e);return new n(this.x-r.x,this.y-r.y)}},{key:"lerp",value:function(e,t){var r=n.create(e);return new n((1-t)*this.x+t*r.x,(1-t)*this.y+t*r.y)}},{key:"normalize",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1)/this.magnitude();return this.scale(e,e)}},{key:"move",value:function(e,t){var r=n.create(e),i=Ud.toRad(r.theta(this));return this.translate(Math.cos(i)*t,-Math.sin(i)*t)}},{key:"reflection",value:function(e){return n.create(e).move(this,this.distance(e))}},{key:"snapToGrid",value:function(e,t){return this.x=qd.snapToGrid(this.x,e),this.y=qd.snapToGrid(this.y,null==t?e:t),this}},{key:"equals",value:function(e){var t=n.create(e);return null!=t&&t.x===this.x&&t.y===this.y}},{key:"clone",value:function(){return n.clone(this)}},{key:"toJSON",value:function(){return n.toJSON(this)}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y)}}]),n}(Jd);!function(e){e.isPoint=function(t){return null!=t&&t instanceof e}}(Wd||(Wd={})),function(e){e.isPointLike=function(e){return null!=e&&"object"===v(e)&&"number"==typeof e.x&&"number"==typeof e.y},e.isPointData=function(e){return null!=e&&Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}}(Wd||(Wd={})),function(e){function t(t){return e.isPoint(t)?new e(t.x,t.y):Array.isArray(t)?new e(t[0],t[1]):new e(t.x,t.y)}function n(e,t){return e===t||null!=e&&null!=t&&(e.x===t.x&&e.y===t.y)}function r(n,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new e,a=t(n),s=t(o),l=a.x-s.x,u=a.y-s.y,c=u*r+l*i;return new e(l*r-u*i+s.x,c+s.y)}e.create=function(n,r){return null==n||"number"==typeof n?new e(n,r):t(n)},e.clone=t,e.toJSON=function(t){return e.isPoint(t)?{x:t.x,y:t.y}:Array.isArray(t)?{x:t[0],y:t[1]}:{x:t.x,y:t.y}},e.fromPolar=function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,o=Math.abs(n*Math.cos(r)),a=Math.abs(n*Math.sin(r)),s=t(i),l=Ud.normalize(Ud.toDeg(r));return l<90?a=-a:l<180?(o=-o,a=-a):l<270&&(o=-o),new e(s.x+o,s.y+a)},e.toPolar=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e,i=t(n),o=t(r),a=i.x-o.x,s=i.y-o.y;return new e(Math.sqrt(a*a+s*s),Ud.toRad(o.theta(i)))},e.equals=n,e.equalPoints=function(e,t){if(null==e&&null!=t||null!=e&&null==t||null!=e&&null!=t&&e.length!==t.length)return!1;if(null!=e&&null!=t)for(var r=0,i=e.length;r<i;r+=1)if(!n(e[r],t[r]))return!1;return!0},e.random=function(t,n,r,i){return new e(qd.random(t,n),qd.random(r,i))},e.rotate=function(e,t,n){var i=Ud.toRad(Ud.normalize(-t)),o=Math.sin(i);return r(e,Math.cos(i),o,n)},e.rotateEx=r}(Wd||(Wd={}));var Yd=function(e){l(n,e);var t=c(n);function n(e,r,i,o){var a;return A(this,n),(a=t.call(this)).x=null==e?0:e,a.y=null==r?0:r,a.width=null==i?0:i,a.height=null==o?0:o,a}return P(n,[{key:"left",get:function(){return this.x}},{key:"top",get:function(){return this.y}},{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"origin",get:function(){return new Wd(this.x,this.y)}},{key:"topLeft",get:function(){return new Wd(this.x,this.y)}},{key:"topCenter",get:function(){return new Wd(this.x+this.width/2,this.y)}},{key:"topRight",get:function(){return new Wd(this.x+this.width,this.y)}},{key:"center",get:function(){return new Wd(this.x+this.width/2,this.y+this.height/2)}},{key:"bottomLeft",get:function(){return new Wd(this.x,this.y+this.height)}},{key:"bottomCenter",get:function(){return new Wd(this.x+this.width/2,this.y+this.height)}},{key:"bottomRight",get:function(){return new Wd(this.x+this.width,this.y+this.height)}},{key:"corner",get:function(){return new Wd(this.x+this.width,this.y+this.height)}},{key:"rightMiddle",get:function(){return new Wd(this.x+this.width,this.y+this.height/2)}},{key:"leftMiddle",get:function(){return new Wd(this.x,this.y+this.height/2)}},{key:"topLine",get:function(){return new Zd(this.topLeft,this.topRight)}},{key:"rightLine",get:function(){return new Zd(this.topRight,this.bottomRight)}},{key:"bottomLine",get:function(){return new Zd(this.bottomLeft,this.bottomRight)}},{key:"leftLine",get:function(){return new Zd(this.topLeft,this.bottomLeft)}},{key:"getOrigin",value:function(){return this.origin}},{key:"getTopLeft",value:function(){return this.topLeft}},{key:"getTopCenter",value:function(){return this.topCenter}},{key:"getTopRight",value:function(){return this.topRight}},{key:"getCenter",value:function(){return this.center}},{key:"getCenterX",value:function(){return this.x+this.width/2}},{key:"getCenterY",value:function(){return this.y+this.height/2}},{key:"getBottomLeft",value:function(){return this.bottomLeft}},{key:"getBottomCenter",value:function(){return this.bottomCenter}},{key:"getBottomRight",value:function(){return this.bottomRight}},{key:"getCorner",value:function(){return this.corner}},{key:"getRightMiddle",value:function(){return this.rightMiddle}},{key:"getLeftMiddle",value:function(){return this.leftMiddle}},{key:"getTopLine",value:function(){return this.topLine}},{key:"getRightLine",value:function(){return this.rightLine}},{key:"getBottomLine",value:function(){return this.bottomLine}},{key:"getLeftLine",value:function(){return this.leftLine}},{key:"bbox",value:function(e){if(!e)return this.clone();var t=Ud.toRad(e),r=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t)),o=this.width*i+this.height*r,a=this.width*r+this.height*i;return new n(this.x+(this.width-o)/2,this.y+(this.height-a)/2,o,a)}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.x=qd.round(this.x,e),this.y=qd.round(this.y,e),this.width=qd.round(this.width,e),this.height=qd.round(this.height,e),this}},{key:"add",value:function(e,t,r,i){var o=n.create(e,t,r,i),a=Math.min(this.x,o.x),s=Math.min(this.y,o.y),l=Math.max(this.x+this.width,o.x+o.width),u=Math.max(this.y+this.height,o.y+o.height);return this.x=a,this.y=s,this.width=l-a,this.height=u-s,this}},{key:"update",value:function(e,t,r,i){var o=n.create(e,t,r,i);return this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height,this}},{key:"inflate",value:function(e,t){var n=e,r=null!=t?t:e;return this.x-=n,this.y-=r,this.width+=2*n,this.height+=2*r,this}},{key:"snapToGrid",value:function(e,t){var n=this.origin.snapToGrid(e,t),r=this.corner.snapToGrid(e,t);return this.x=n.x,this.y=n.y,this.width=r.x-n.x,this.height=r.y-n.y,this}},{key:"translate",value:function(e,t){var n=Wd.create(e,t);return this.x+=n.x,this.y+=n.y,this}},{key:"scale",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Wd,r=this.origin.scale(e,t,n);return this.x=r.x,this.y=r.y,this.width*=e,this.height*=t,this}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCenter();if(0!==e){var r=Ud.toRad(e),i=Math.cos(r),o=Math.sin(r),a=this.getOrigin(),s=this.getTopRight(),l=this.getBottomRight(),u=this.getBottomLeft();a=Wd.rotateEx(a,i,o,t),s=Wd.rotateEx(s,i,o,t),l=Wd.rotateEx(l,i,o,t),u=Wd.rotateEx(u,i,o,t);var c=new n(a.x,a.y,0,0);c.add(s.x,s.y,0,0),c.add(l.x,l.y,0,0),c.add(u.x,u.y,0,0),this.update(c)}return this}},{key:"rotate90",value:function(){var e=(this.width-this.height)/2;this.x+=e,this.y-=e;var t=this.width;return this.width=this.height,this.height=t,this}},{key:"moveAndExpand",value:function(e){var t=n.clone(e);return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this}},{key:"getMaxScaleToFit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center,r=n.clone(e),i=t.x,o=t.y,a=1/0,s=1/0,l=1/0,u=1/0,c=1/0,h=1/0,f=1/0,d=1/0,g=r.topLeft;g.x<i&&(a=(this.x-i)/(g.x-i)),g.y<o&&(c=(this.y-o)/(g.y-o));var v=r.bottomRight;v.x>i&&(s=(this.x+this.width-i)/(v.x-i)),v.y>o&&(h=(this.y+this.height-o)/(v.y-o));var p=r.topRight;p.x>i&&(l=(this.x+this.width-i)/(p.x-i)),p.y<o&&(f=(this.y-o)/(p.y-o));var y=r.bottomLeft;return y.x<i&&(u=(this.x-i)/(y.x-i)),y.y>o&&(d=(this.y+this.height-o)/(y.y-o)),{sx:Math.min(a,s,l,u),sy:Math.min(c,h,f,d)}}},{key:"getMaxUniformScaleToFit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center,n=this.getMaxScaleToFit(e,t);return Math.min(n.sx,n.sy)}},{key:"containsPoint",value:function(e,t){return qd.containsPoint(this,Wd.create(e,t))}},{key:"containsRect",value:function(e,t,r,i){var o=n.create(e,t,r,i),a=this.x,s=this.y,l=this.width,u=this.height,c=o.x,h=o.y,f=o.width,d=o.height;return 0!==l&&0!==u&&0!==f&&0!==d&&(c>=a&&h>=s&&c+f<=a+l&&h+d<=s+u)}},{key:"intersectsWithLine",value:function(e){var t=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],n=[],r=[];return t.forEach((function(t){var i=e.intersectsWithLine(t);null!==i&&r.indexOf(i.toString())<0&&(n.push(i),r.push(i.toString()))})),n.length>0?n:null}},{key:"intersectsWithLineFromCenterToPoint",value:function(e,t){var n=Wd.clone(e),r=this.center,i=null;null!=t&&0!==t&&n.rotate(t,r);for(var o=[this.topLine,this.rightLine,this.bottomLine,this.leftLine],a=new Zd(r,n),s=o.length-1;s>=0;s-=1){var l=o[s].intersectsWithLine(a);if(null!==l){i=l;break}}return i&&null!=t&&0!==t&&i.rotate(-t,r),i}},{key:"intersectsWithRect",value:function(e,t,r,i){var o=n.create(e,t,r,i);if(!this.isIntersectWithRect(o))return null;var a=this.origin,s=this.corner,l=o.origin,u=o.corner,c=Math.max(a.x,l.x),h=Math.max(a.y,l.y);return new n(c,h,Math.min(s.x,u.x)-c,Math.min(s.y,u.y)-h)}},{key:"isIntersectWithRect",value:function(e,t,r,i){var o=n.create(e,t,r,i),a=this.origin,s=this.corner,l=o.origin,u=o.corner;return!(u.x<=a.x||u.y<=a.y||l.x>=s.x||l.y>=s.y)}},{key:"normalize",value:function(){var e=this.x,t=this.y,n=this.width,r=this.height;return this.width<0&&(e=this.x+this.width,n=-this.width),this.height<0&&(t=this.y+this.height,r=-this.height),this.x=e,this.y=t,this.width=n,this.height=r,this}},{key:"union",value:function(e){var t=n.clone(e),r=this.origin,i=this.corner,o=t.origin,a=t.corner,s=Math.min(r.x,o.x),l=Math.min(r.y,o.y);return new n(s,l,Math.max(i.x,a.x)-s,Math.max(i.y,a.y)-l)}},{key:"getNearestSideToPoint",value:function(e){var t=Wd.clone(e),n=t.x-this.x,r=this.x+this.width-t.x,i=t.y-this.y,o=n,a="left";return r<o&&(o=r,a="right"),i<o&&(o=i,a="top"),this.y+this.height-t.y<o&&(a="bottom"),a}},{key:"getNearestPointToPoint",value:function(e){var t=Wd.clone(e);if(this.containsPoint(t)){var n=this.getNearestSideToPoint(t);if("left"===n)return new Wd(this.x,t.y);if("top"===n)return new Wd(t.x,this.y);if("right"===n)return new Wd(this.x+this.width,t.y);if("bottom"===n)return new Wd(t.x,this.y+this.height)}return t.adhereToRect(this)}},{key:"equals",value:function(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}},{key:"clone",value:function(){return new n(this.x,this.y,this.width,this.height)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.width," ").concat(this.height)}}]),n}(Jd);!function(e){e.isRectangle=function(t){return null!=t&&t instanceof e}}(Yd||(Yd={})),function(e){e.isRectangleLike=function(e){return null!=e&&"object"===v(e)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.width&&"number"==typeof e.height}}(Yd||(Yd={})),function(e){function t(t){return e.isRectangle(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.width,t.height)}e.create=function(n,r,i,o){return null==n||"number"==typeof n?new e(n,r,i,o):t(n)},e.clone=t,e.fromEllipse=function(t){return new e(t.x-t.a,t.y-t.b,2*t.a,2*t.b)},e.fromSize=function(t){return new e(0,0,t.width,t.height)},e.fromPositionAndSize=function(t,n){return new e(t.x,t.y,n.width,n.height)}}(Yd||(Yd={}));var Zd=function(e){l(n,e);var t=c(n);function n(e,r,i,o){var a;return A(this,n),a=t.call(this),"number"==typeof e&&"number"==typeof r?(a.start=new Wd(e,r),a.end=new Wd(i,o)):(a.start=Wd.create(e),a.end=Wd.create(r)),a}return P(n,[{key:"center",get:function(){return new Wd((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)}},{key:"getCenter",value:function(){return this.center}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.start.round(e),this.end.round(e),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.start.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.end.translate(e)),this}},{key:"rotate",value:function(e,t){return this.start.rotate(e,t),this.end.rotate(e,t),this}},{key:"scale",value:function(e,t,n){return this.start.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"length",value:function(){return Math.sqrt(this.squaredLength())}},{key:"squaredLength",value:function(){var e=this.start.x-this.end.x,t=this.start.y-this.end.y;return e*e+t*t}},{key:"setLength",value:function(e){var t=this.length();if(!t)return this;var n=e/t;return this.scale(n,n,this.start)}},{key:"parallel",value:function(e){var t=this.clone();if(!t.isDifferentiable())return t;var n=t.start,r=t.end,i=n.clone().rotate(270,r),o=r.clone().rotate(90,n);return n.move(o,e),r.move(i,e),t}},{key:"vector",value:function(){return new Wd(this.end.x-this.start.x,this.end.y-this.start.y)}},{key:"angle",value:function(){var e=new Wd(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,e)}},{key:"bbox",value:function(){var e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),n=Math.max(this.start.x,this.end.x),r=Math.max(this.start.y,this.end.y);return new Yd(e,t,n-e,r-t)}},{key:"bearing",value:function(){return this.start.bearing(this.end)}},{key:"closestPoint",value:function(e){return this.pointAt(this.closestPointNormalizedLength(e))}},{key:"closestPointLength",value:function(e){return this.closestPointNormalizedLength(e)*this.length()}},{key:"closestPointTangent",value:function(e){return this.tangentAt(this.closestPointNormalizedLength(e))}},{key:"closestPointNormalizedLength",value:function(e){var t=this.vector().dot(new n(this.start,e).vector()),r=Math.min(1,Math.max(0,t/this.squaredLength()));return Number.isNaN(r)?0:r}},{key:"pointAt",value:function(e){var t=this.start,n=this.end;return e<=0?t.clone():e>=1?n.clone():t.lerp(n,e)}},{key:"pointAtLength",value:function(e){var t=this.start,n=this.end,r=!0;e<0&&(r=!1,e=-e);var i=this.length();if(e>=i)return r?n.clone():t.clone();var o=(r?e:i-e)/i;return this.pointAt(o)}},{key:"divideAt",value:function(e){var t=this.pointAt(e);return[new n(this.start,t),new n(t,this.end)]}},{key:"divideAtLength",value:function(e){var t=this.pointAtLength(e);return[new n(this.start,t),new n(t,this.end)]}},{key:"containsPoint",value:function(e){var t=this.start,r=this.end;if(0!==t.cross(e,r))return!1;var i=this.length();return!(new n(t,e).length()>i)&&!(new n(e,r).length()>i)}},{key:"intersect",value:function(e,t){var n=e.intersectsWithLine(this,t);return n?Array.isArray(n)?n:[n]:null}},{key:"intersectsWithLine",value:function(e){var t=new Wd(this.end.x-this.start.x,this.end.y-this.start.y),n=new Wd(e.end.x-e.start.x,e.end.y-e.start.y),r=t.x*n.y-t.y*n.x,i=new Wd(e.start.x-this.start.x,e.start.y-this.start.y),o=i.x*n.y-i.y*n.x,a=i.x*t.y-i.y*t.x;if(0===r||o*r<0||a*r<0)return null;if(r>0){if(o>r||a>r)return null}else if(o<r||a<r)return null;return new Wd(this.start.x+o*t.x/r,this.start.y+o*t.y/r)}},{key:"isDifferentiable",value:function(){return!this.start.equals(this.end)}},{key:"pointOffset",value:function(e){var t=Wd.clone(e),n=this.start,r=this.end;return((r.x-n.x)*(t.y-n.y)-(r.y-n.y)*(t.x-n.x))/this.length()}},{key:"pointSquaredDistance",value:function(e,t){var n=Wd.create(e,t);return this.closestPoint(n).squaredDistance(n)}},{key:"pointDistance",value:function(e,t){var n=Wd.create(e,t);return this.closestPoint(n).distance(n)}},{key:"tangentAt",value:function(e){if(!this.isDifferentiable())return null;var t=this.start,r=this.end,i=this.pointAt(e),o=new n(t,r);return o.translate(i.x-t.x,i.y-t.y),o}},{key:"tangentAtLength",value:function(e){if(!this.isDifferentiable())return null;var t=this.start,r=this.end,i=this.pointAtLength(e),o=new n(t,r);return o.translate(i.x-t.x,i.y-t.y),o}},{key:"relativeCcw",value:function(e,t){var n=Wd.create(e,t),r=n.x-this.start.x,i=n.y-this.start.y,o=this.end.x-this.start.x,a=this.end.y-this.start.y,s=r*a-i*o;return 0===s&&(s=r*o+i*a)>0&&(s=(r-=o)*o+(i-=a)*a)<0&&(s=0),s<0?-1:s>0?1:0}},{key:"equals",value:function(e){return null!=e&&this.start.x===e.start.x&&this.start.y===e.start.y&&this.end.x===e.end.x&&this.end.y===e.end.y}},{key:"clone",value:function(){return new n(this.start,this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return[this.start.serialize(),this.end.serialize()].join(" ")}}]),n}(Jd);!function(e){e.isLine=function(t){return null!=t&&t instanceof e}}(Zd||(Zd={}));var Xd=function(e){l(n,e);var t=c(n);function n(e,r,i,o){var a;return A(this,n),(a=t.call(this)).x=null==e?0:e,a.y=null==r?0:r,a.a=null==i?0:i,a.b=null==o?0:o,a}return P(n,[{key:"center",get:function(){return new Wd(this.x,this.y)}},{key:"bbox",value:function(){return Yd.fromEllipse(this)}},{key:"getCenter",value:function(){return this.center}},{key:"inflate",value:function(e,t){var n=e,r=null!=t?t:e;return this.a+=2*n,this.b+=2*r,this}},{key:"normalizedDistance",value:function(e,t){var n=Wd.create(e,t),r=n.x-this.x,i=n.y-this.y,o=this.a,a=this.b;return r*r/(o*o)+i*i/(a*a)}},{key:"containsPoint",value:function(e,t){return this.normalizedDistance(e,t)<=1}},{key:"intersectsWithLine",value:function(e){var t=[],n=this.a,r=this.b,i=e.start,o=e.end,a=e.vector(),s=i.diff(new Wd(this.x,this.y)),l=new Wd(a.x/(n*n),a.y/(r*r)),u=new Wd(s.x/(n*n),s.y/(r*r)),c=a.dot(l),h=a.dot(u),f=h*h-c*(s.dot(u)-1);if(f<0)return null;if(f>0){var d=Math.sqrt(f),g=(-h-d)/c,v=(-h+d)/c;if((g<0||g>1)&&(v<0||v>1))return null;g>=0&&g<=1&&t.push(i.lerp(o,g)),v>=0&&v<=1&&t.push(i.lerp(o,v))}else{var p=-h/c;if(!(p>=0&&p<=1))return null;t.push(i.lerp(o,p))}return t}},{key:"intersectsWithLineFromCenterToPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Wd.clone(e);t&&n.rotate(t,this.getCenter());var r,i=n.x-this.x,o=n.y-this.y;if(0===i)return r=this.bbox().getNearestPointToPoint(n),t?r.rotate(-t,this.getCenter()):r;var a=o/i,s=a*a,l=this.a*this.a,u=this.b*this.b,c=Math.sqrt(1/(1/l+s/u)),h=a*(c=i<0?-c:c);return r=new Wd(this.x+c,this.y+h),t?r.rotate(-t,this.getCenter()):r}},{key:"tangentTheta",value:function(e){var t,n,r=Wd.clone(e),i=r.x,o=r.y,a=this.a,s=this.b,l=this.bbox().center,u=l.x,c=l.y,h=i>l.x+a/2,f=i<l.x-a/2;return h||f?t=a*a/(i-u)-a*a*(o-c)*((n=i>l.x?o-30:o+30)-c)/(s*s*(i-u))+u:n=s*s/(o-c)-s*s*(i-u)*((t=o>l.y?i+30:i-30)-u)/(a*a*(o-c))+c,new Wd(t,n).theta(r)}},{key:"scale",value:function(e,t){return this.a*=e,this.b*=t,this}},{key:"rotate",value:function(e,t){var r=Yd.fromEllipse(this);r.rotate(e,t);var i=n.fromRect(r);return this.a=i.a,this.b=i.b,this.x=i.x,this.y=i.y,this}},{key:"translate",value:function(e,t){var n=Wd.create(e,t);return this.x+=n.x,this.y+=n.y,this}},{key:"equals",value:function(e){return null!=e&&e.x===this.x&&e.y===this.y&&e.a===this.a&&e.b===this.b}},{key:"clone",value:function(){return new n(this.x,this.y,this.a,this.b)}},{key:"toJSON",value:function(){return{x:this.x,y:this.y,a:this.a,b:this.b}}},{key:"serialize",value:function(){return"".concat(this.x," ").concat(this.y," ").concat(this.a," ").concat(this.b)}}]),n}(Jd);!function(e){e.isEllipse=function(t){return null!=t&&t instanceof e}}(Xd||(Xd={})),function(e){function t(t){return e.isEllipse(t)?t.clone():Array.isArray(t)?new e(t[0],t[1],t[2],t[3]):new e(t.x,t.y,t.a,t.b)}e.create=function(n,r,i,o){return null==n||"number"==typeof n?new e(n,r,i,o):t(n)},e.parse=t,e.fromRect=function(t){var n=t.center;return new e(n.x,n.y,t.width/2,t.height/2)}}(Xd||(Xd={}));var Kd=new RegExp("^[\\s\\dLMCZz,.]*$");function $d(e){return"string"==typeof e&&Kd.test(e)}function Qd(e,t){return(e%t+t)%t}function eg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e&&e.length&&e.forEach((function(e){Array.isArray(e)?n.push({x:e[0],y:e[1]}):n.push({x:e.x,y:e.y})})),function(e,t,n,r,i){var o=[],a=e[e.length-1],s=null!=t&&t>0,l=t||0;if(r&&s){var u=(e=e.slice())[0],c=new Wd(a.x+(u.x-a.x)/2,a.y+(u.y-a.y)/2);e.splice(0,0,c)}var h=e[0],f=1;for(n?o.push("M",h.x,h.y):o.push("L",h.x,h.y);f<(r?e.length:e.length-1);){var d=e[Qd(f,e.length)],g=h.x-d.x,v=h.y-d.y;if(s&&(0!==g||0!==v)&&(null==i||i.indexOf(f-1)<0)){var p=Math.sqrt(g*g+v*v),y=g*Math.min(l,p/2)/p,m=v*Math.min(l,p/2)/p,w=d.x+y,b=d.y+m;o.push("L",w,b);for(var k=e[Qd(f+1,e.length)];f<e.length-2&&0===Math.round(k.x-d.x)&&0===Math.round(k.y-d.y);)k=e[Qd(f+2,e.length)],f+=1;g=k.x-d.x,v=k.y-d.y,p=Math.max(1,Math.sqrt(g*g+v*v));var x=g*Math.min(l,p/2)/p,C=v*Math.min(l,p/2)/p,E=d.x+x,S=d.y+C;o.push("Q",d.x,d.y,E,S),d=new Wd(E,S)}else o.push("L",d.x,d.y);h=d,f+=1}return r?o.push("Z"):o.push("L",a.x,a.y),o.map((function(e){return"string"==typeof e?e:+e.toFixed(3)})).join(" ")}(n,t.round,null==t.initialMove||t.initialMove,t.close,t.exclude)}function tg(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;if(0===n||0===r)return[];s-=e,l-=t,n=Math.abs(n),r=Math.abs(r);var u,c=-s/2,h=-l/2,f=Math.cos(i*Math.PI/180),d=Math.sin(i*Math.PI/180),g=f*c+d*h,v=-1*d*c+f*h,p=g*g,y=v*v,m=n*n,w=r*r,b=p/m+y/w;if(b>1)n=Math.sqrt(b)*n,r=Math.sqrt(b)*r,u=0;else{var k=1;o===a&&(k=-1),u=k*Math.sqrt((m*w-m*y-w*p)/(m*y+w*p))}var x=u*n*v/r,C=-1*u*r*g/n,E=f*x-d*C+s/2,S=d*x+f*C+l/2,_=Math.atan2((v-C)/r,(g-x)/n)-Math.atan2(0,1),A=_>=0?_:2*Math.PI+_,M=(_=Math.atan2((-v-C)/r,(-g-x)/n)-Math.atan2((v-C)/r,(g-x)/n))>=0?_:2*Math.PI+_;0===a&&M>0?M-=2*Math.PI:0!==a&&M<0&&(M+=2*Math.PI);for(var P=2*M/Math.PI,O=Math.ceil(P<0?-1*P:P),T=M/O,L=8/3*Math.sin(T/4)*Math.sin(T/4)/Math.sin(T/2),j=f*n,N=f*r,R=d*n,D=d*r,I=Math.cos(A),B=Math.sin(A),z=-L*(j*B+D*I),F=-L*(R*B-N*I),V=0,H=0,U=[],q=0;q<O;q+=1){A+=T,V=j*(I=Math.cos(A))-D*(B=Math.sin(A))+E,H=R*I+N*B+S;var G=-L*(j*B+D*I),J=-L*(R*B-N*I),W=6*q;U[W]=Number(z+e),U[W+1]=Number(F+t),U[W+2]=Number(V-G+e),U[W+3]=Number(H-J+t),U[W+4]=Number(V+e),U[W+5]=Number(H+t),z=V+G,F=H+J}return U.map((function(e){return+e.toFixed(2)}))}function ng(e,t,n,r){var i=[],o=tg(e,t,n,r,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0);if(null!=o)for(var a=0,s=o.length;a<s;a+=6)i.push("C",o[a],o[a+1],o[a+2],o[a+3],o[a+4],o[a+5]);return i.join(" ")}var rg=function(e){l(n,e);var t=c(n);function n(e){var r;if(A(this,n),r=t.call(this),null!=e){if("string"==typeof e)return h(r,n.parse(e));r.points=e.map((function(e){return Wd.create(e)}))}else r.points=[];return r}return P(n,[{key:"start",get:function(){return this.points[0]||null}},{key:"end",get:function(){return this.points[this.points.length-1]||null}},{key:"scale",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Wd;return this.points.forEach((function(r){return r.scale(e,t,n)})),this}},{key:"rotate",value:function(e,t){return this.points.forEach((function(n){return n.rotate(e,t)})),this}},{key:"translate",value:function(e,t){var n=Wd.create(e,t);return this.points.forEach((function(e){return e.translate(n.x,n.y)})),this}},{key:"round",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.points.forEach((function(t){return t.round(e)})),this}},{key:"bbox",value:function(){if(0===this.points.length)return new Yd;for(var e=1/0,t=-1/0,n=1/0,r=-1/0,i=this.points,o=0,a=i.length;o<a;o+=1){var s=i[o],l=s.x,u=s.y;l<e&&(e=l),l>t&&(t=l),u<n&&(n=u),u>r&&(r=u)}return new Yd(e,n,t-e,r-n)}},{key:"closestPoint",value:function(e){var t=this.closestPointLength(e);return this.pointAtLength(t)}},{key:"closestPointLength",value:function(e){var t=this.points,n=t.length;if(0===n||1===n)return 0;for(var r=0,i=0,o=1/0,a=0,s=n-1;a<s;a+=1){var l=new Zd(t[a],t[a+1]),u=l.length(),c=l.closestPointNormalizedLength(e),h=l.pointAt(c).squaredDistance(e);h<o&&(o=h,i=r+c*u),r+=u}return i}},{key:"closestPointNormalizedLength",value:function(e){var t=this.length();return 0===t?0:this.closestPointLength(e)/t}},{key:"closestPointTangent",value:function(e){var t=this.closestPointLength(e);return this.tangentAtLength(t)}},{key:"containsPoint",value:function(e){if(0===this.points.length)return!1;for(var t=Wd.clone(e),n=t.x,r=t.y,i=this.points,o=i.length,a=o-1,s=0,l=0;l<o;l+=1){var u=i[a],c=i[l];if(t.equals(u))return!0;var h=new Zd(u,c);if(h.containsPoint(e))return!0;if(r<=u.y&&r>c.y||r>u.y&&r<=c.y){var f=u.x-n>c.x-n?u.x-n:c.x-n;if(f>=0){var d=new Wd(n+f,r),g=new Zd(e,d);h.intersectsWithLine(g)&&(s+=1)}}a=l}return s%2==1}},{key:"intersectsWithLine",value:function(e){for(var t=[],n=0,r=this.points.length-1;n<r;n+=1){var i=this.points[n],o=this.points[n+1],a=e.intersectsWithLine(new Zd(i,o));a&&t.push(a)}return t.length>0?t:null}},{key:"isDifferentiable",value:function(){for(var e=0,t=this.points.length-1;e<t;e+=1){var n=this.points[e],r=this.points[e+1];if(new Zd(n,r).isDifferentiable())return!0}return!1}},{key:"length",value:function(){for(var e=0,t=0,n=this.points.length-1;t<n;t+=1){var r=this.points[t],i=this.points[t+1];e+=r.distance(i)}return e}},{key:"pointAt",value:function(e){var t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();if(e<=0)return t[0].clone();if(e>=1)return t[n-1].clone();var r=this.length()*e;return this.pointAtLength(r)}},{key:"pointAtLength",value:function(e){var t=this.points,n=t.length;if(0===n)return null;if(1===n)return t[0].clone();var r=!0;e<0&&(r=!1,e=-e);for(var i=0,o=0,a=n-1;o<a;o+=1){var s=r?o:a-1-o,l=t[s],u=t[s+1],c=new Zd(l,u),h=l.distance(u);if(e<=i+h)return c.pointAtLength((r?1:-1)*(e-i));i+=h}return(r?t[n-1]:t[0]).clone()}},{key:"tangentAt",value:function(e){var t=this.points.length;if(0===t||1===t)return null;e<0&&(e=0),e>1&&(e=1);var n=this.length()*e;return this.tangentAtLength(n)}},{key:"tangentAtLength",value:function(e){var t=this.points,n=t.length;if(0===n||1===n)return null;var r,i=!0;e<0&&(i=!1,e=-e);for(var o=0,a=0,s=n-1;a<s;a+=1){var l=i?a:s-1-a,u=t[l],c=t[l+1],h=new Zd(u,c),f=u.distance(c);if(h.isDifferentiable()){if(e<=o+f)return h.tangentAtLength((i?1:-1)*(e-o));r=h}o+=f}if(r){var d=i?1:0;return r.tangentAt(d)}return null}},{key:"simplify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.points;if(t.length<3)return this;for(var n=e.threshold||0,r=0;t[r+2];){var i=r+1,o=r+2,a=t[r],s=t[i],l=t[o];new Zd(a,l).closestPoint(s).distance(s)<=n?t.splice(i,1):r+=1}return this}},{key:"toHull",value:function(){var e=this.points,t=e.length;if(0===t)return new n;for(var r=e[0],i=1;i<t;i+=1)(e[i].y<r.y||e[i].y===r.y&&e[i].x>r.x)&&(r=e[i]);for(var o=[],a=0;a<t;a+=1){var s=r.theta(e[a]);0===s&&(s=360),o.push([e[a],a,s])}if(o.sort((function(e,t){var n=e[2]-t[2];return 0===n&&(n=t[1]-e[1]),n})),o.length>2){var l=o[o.length-1];o.unshift(l)}for(var u,c={},h=[],f=function(e){return"".concat(e[0].toString(),"@").concat(e[1])};0!==o.length;){var d=o.pop(),g=d[0];if(!c[f(d)])for(var v=!1;!v;)if(h.length<2)h.push(d),v=!0;else{var p=h.pop(),y=p[0],m=h.pop(),w=m[0],b=w.cross(y,g);if(b<0)h.push(m),h.push(p),h.push(d),v=!0;else if(0===b){var k=y.angleBetween(w,g);Math.abs(k-180)<1e-10||y.equals(g)||w.equals(y)?(c[f(p)]=y,h.push(m)):Math.abs((k+1)%360-1)<1e-10&&(h.push(m),o.push(p))}else c[f(p)]=y,h.push(m)}}h.length>2&&h.pop();for(var x=-1,C=0,E=h.length;C<E;C+=1){var S=h[C][1];(void 0===u||S<u)&&(u=S,x=C)}var _=[];if(x>0){var A=h.slice(x),M=h.slice(0,x);_=A.concat(M)}else _=h;for(var P=[],O=0,T=_.length;O<T;O+=1)P.push(_[O][0]);return new n(P)}},{key:"equals",value:function(e){var t=this;return null!=e&&(e.points.length===this.points.length&&e.points.every((function(e,n){return e.equals(t.points[n])})))}},{key:"clone",value:function(){return new n(this.points.map((function(e){return e.clone()})))}},{key:"toJSON",value:function(){return this.points.map((function(e){return e.toJSON()}))}},{key:"serialize",value:function(){return this.points.map((function(e){return"".concat(e.serialize())})).join(" ")}}]),n}(Jd);!function(e){e.isPolyline=function(t){return null!=t&&t instanceof e}}(rg||(rg={})),function(e){e.parse=function(t){var n=t.trim();if(""===n)return new e;for(var r=[],i=n.split(/\s*,\s*|\s+/),o=0,a=i.length;o<a;o+=2)r.push({x:+i[o],y:+i[o+1]});return new e(r)}}(rg||(rg={}));var ig=function(e){l(n,e);var t=c(n);function n(e,r,i,o){var a;return A(this,n),(a=t.call(this)).PRECISION=3,a.start=Wd.create(e),a.controlPoint1=Wd.create(r),a.controlPoint2=Wd.create(i),a.end=Wd.create(o),a}return P(n,[{key:"bbox",value:function(){for(var e,t,n,r,i,o,a,s,l,u,c,h=this.start,f=this.controlPoint1,d=this.controlPoint2,g=this.end,v=h.x,p=h.y,y=f.x,m=f.y,w=d.x,b=d.y,k=g.x,x=g.y,C=[],E=[[],[]],S=0;S<2;S+=1)if(0===S?(t=6*v-12*y+6*w,e=-3*v+9*y-9*w+3*k,n=3*y-3*v):(t=6*p-12*m+6*b,e=-3*p+9*m-9*b+3*x,n=3*m-3*p),Math.abs(e)<1e-12){if(Math.abs(t)<1e-12)continue;(r=-n/t)>0&&r<1&&C.push(r)}else a=t*t-4*n*e,s=Math.sqrt(a),a<0||((i=(-t+s)/(2*e))>0&&i<1&&C.push(i),(o=(-t-s)/(2*e))>0&&o<1&&C.push(o));for(var _=C.length,A=_;_;)l=(c=1-(r=C[_-=1]))*c*c*v+3*c*c*r*y+3*c*r*r*w+r*r*r*k,E[0][_]=l,u=c*c*c*p+3*c*c*r*m+3*c*r*r*b+r*r*r*x,E[1][_]=u;C[A]=0,C[A+1]=1,E[0][A]=v,E[1][A]=p,E[0][A+1]=k,E[1][A+1]=x,C.length=A+2,E[0].length=A+2,E[1].length=A+2;var M=Math.min.apply(null,E[0]),P=Math.min.apply(null,E[1]),O=Math.max.apply(null,E[0]),T=Math.max.apply(null,E[1]);return new Yd(M,P,O-M,T-P)}},{key:"closestPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.pointAtT(this.closestPointT(e,t))}},{key:"closestPointLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t);return this.lengthAtT(this.closestPointT(e,n),n)}},{key:"closestPointNormalizedLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),r=this.closestPointLength(e,n);if(!r)return 0;var i=this.length(n);return 0===i?0:r/i}},{key:"closestPointT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPrecision(t),r=this.getDivisions(t),i=Math.pow(10,-n),o=null,a=0,s=0,l=0,u=0,c=0,h=null,f=r.length,d=f>0?1/f:0;for(r.forEach((function(t,n){var r=t.start.distance(e),i=t.end.distance(e),f=r+i;(null==h||f<h)&&(o=t,a=n*d,s=(n+1)*d,l=r,u=i,h=f,c=t.endpointDistance())}));;){var g=l?Math.abs(l-u)/l:0,v=null!=u?Math.abs(l-u)/u:0;if(g<i||v<i||(!l||l<c*i||(!u||u<c*i)))return l<=u?a:s;var p=o.divide(.5);d/=2;var y=p[0].start.distance(e),m=p[0].end.distance(e),w=y+m,b=p[1].start.distance(e),k=p[1].end.distance(e);w<=b+k?(o=p[0],s-=d,l=y,u=m):(o=p[1],a+=d,l=b,u=k)}}},{key:"closestPointTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.tangentAtT(this.closestPointT(e,t))}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toPolyline(t).containsPoint(e)}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return this.divideAtT(0);if(e>=1)return this.divideAtT(1);var n=this.tAt(e,t);return this.divideAtT(n)}},{key:"divideAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.tAtLength(e,t);return this.divideAtT(n)}},{key:"divide",value:function(e){return this.divideAtT(e)}},{key:"divideAtT",value:function(e){var t=this.start,r=this.controlPoint1,i=this.controlPoint2,o=this.end;if(e<=0)return[new n(t,t,t,t),new n(t,r,i,o)];if(e>=1)return[new n(t,r,i,o),new n(o,o,o,o)];var a=this.getSkeletonPoints(e),s=a.startControlPoint1,l=a.startControlPoint2,u=a.divider,c=a.dividerControlPoint1,h=a.dividerControlPoint2;return[new n(t,s,l,u),new n(u,c,h,o)]}},{key:"endpointDistance",value:function(){return this.start.distance(this.end)}},{key:"getSkeletonPoints",value:function(e){var t=this.start,n=this.controlPoint1,r=this.controlPoint2,i=this.end;if(e<=0)return{startControlPoint1:t.clone(),startControlPoint2:t.clone(),divider:t.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:r.clone()};if(e>=1)return{startControlPoint1:n.clone(),startControlPoint2:r.clone(),divider:i.clone(),dividerControlPoint1:i.clone(),dividerControlPoint2:i.clone()};var o=new Zd(t,n).pointAt(e),a=new Zd(n,r).pointAt(e),s=new Zd(r,i).pointAt(e),l=new Zd(o,a).pointAt(e),u=new Zd(a,s).pointAt(e);return{startControlPoint1:o,startControlPoint2:l,divider:new Zd(l,u).pointAt(e),dividerControlPoint1:u,dividerControlPoint2:s}}},{key:"getSubdivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPrecision(e),r=[new n(this.start,this.controlPoint1,this.controlPoint2,this.end)];if(0===t)return r;for(var i,o=this.endpointDistance(),a=Math.pow(10,-t),s=0,l=function(){s+=1;var e=[];r.forEach((function(t){var n=t.divide(.5);e.push(n[0],n[1])}));var t=e.reduce((function(e,t){return e+t.endpointDistance()}),0);if(s>1&&(0!==t?(t-o)/t:0)<a)return{v:e};r=e,o=t};;)if(i=l())return i.v}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.getDivisions(e).reduce((function(e,t){return e+t.endpointDistance()}),0)}},{key:"lengthAtT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return 0;var n=void 0===t.precision?this.PRECISION:t.precision;return this.divide(e)[0].length({precision:n})}},{key:"pointAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();var n=this.tAt(e,t);return this.pointAtT(n)}},{key:"pointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.tAtLength(e,t);return this.pointAtT(n)}},{key:"pointAtT",value:function(e){return e<=0?this.start.clone():e>=1?this.end.clone():this.getSkeletonPoints(e).divider}},{key:"isDifferentiable",value:function(){var e=this.start,t=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(r))}},{key:"tangentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isDifferentiable())return null;e<0?e=0:e>1&&(e=1);var n=this.tAt(e,t);return this.tangentAtT(n)}},{key:"tangentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isDifferentiable())return null;var n=this.tAtLength(e,t);return this.tangentAtT(n)}},{key:"tangentAtT",value:function(e){if(!this.isDifferentiable())return null;e<0&&(e=0),e>1&&(e=1);var t=this.getSkeletonPoints(e),n=t.startControlPoint2,r=t.dividerControlPoint1,i=t.divider,o=new Zd(n,r);return o.translate(i.x-n.x,i.y-n.y),o}},{key:"getPrecision",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==e.precision?this.PRECISION:e.precision}},{key:"getDivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=e.subdivisions)return e.subdivisions;var t=this.getPrecision(e);return this.getSubdivisions({precision:t})}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{precision:this.getPrecision(e),subdivisions:this.getDivisions(e)}}},{key:"tAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e<=0)return 0;if(e>=1)return 1;var n=this.getOptions(t),r=this.length(n)*e;return this.tAtLength(r,n)}},{key:"tAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!0;e<0&&(n=!1,e=-e);for(var r,i,o=this.getPrecision(t),a=this.getDivisions(t),s={precision:o,subdivisions:a},l=null,u=0,c=0,h=0,f=a.length,d=f>0?1/f:0,g=0;g<f;g+=1){var v=n?g:f-1-g,p=a[g],y=p.endpointDistance();if(e<=h+y){l=p,r=v*d,i=(v+1)*d,u=n?e-h:y+h-e,c=n?y+h-e:e-h;break}h+=y}if(null==l)return n?1:0;for(var m=this.length(s),w=Math.pow(10,-o);;){if((0!==m?u/m:0)<w)return r;if((0!==m?c/m:0)<w)return i;var b=void 0,k=void 0,x=l.divide(.5);d/=2;var C=x[0].endpointDistance(),E=x[1].endpointDistance();u<=C?(l=x[0],i-=d,k=C-(b=u)):(l=x[1],r+=d,k=E-(b=u-C)),u=b,c=k}}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getDivisions(e),n=[t[0].start.clone()];return t.forEach((function(e){return n.push(e.end.clone())})),n}},{key:"toPolyline",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new rg(this.toPoints(e))}},{key:"scale",value:function(e,t,n){return this.start.scale(e,t,n),this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.start.rotate(e,t),this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.start.translate(e,t),this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.start.translate(e),this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}},{key:"equals",value:function(e){return null!=e&&this.start.equals(e.start)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)&&this.end.equals(e.end)}},{key:"clone",value:function(){return new n(this.start,this.controlPoint1,this.controlPoint2,this.end)}},{key:"toJSON",value:function(){return{start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return[this.start.serialize(),this.controlPoint1.serialize(),this.controlPoint2.serialize(),this.end.serialize()].join(" ")}}]),n}(Jd);!function(e){e.isCurve=function(t){return null!=t&&t instanceof e}}(ig||(ig={})),function(e){function t(e){var t=e.length,n=[],r=[],i=2;n[0]=e[0]/i;for(var o=1;o<t;o+=1)r[o]=1/i,i=(o<t-1?4:3.5)-r[o],n[o]=(e[o]-n[o-1])/i;for(var a=1;a<t;a+=1)n[t-a-1]-=r[t-a]*n[t-a];return n}e.throughPoints=function(n){if(null==n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var r=function(e){var n=e.map((function(e){return Wd.clone(e)})),r=[],i=[],o=n.length-1;if(1===o)return r[0]=new Wd((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),i[0]=new Wd(2*r[0].x-n[0].x,2*r[0].y-n[0].y),[r,i];for(var a=[],s=1;s<o-1;s+=1)a[s]=4*n[s].x+2*n[s+1].x;a[0]=n[0].x+2*n[1].x,a[o-1]=(8*n[o-1].x+n[o].x)/2;for(var l=t(a),u=1;u<o-1;u+=1)a[u]=4*n[u].y+2*n[u+1].y;a[0]=n[0].y+2*n[1].y,a[o-1]=(8*n[o-1].y+n[o].y)/2;for(var c=t(a),h=0;h<o;h+=1)r.push(new Wd(l[h],c[h])),h<o-1?i.push(new Wd(2*n[h+1].x-l[h+1],2*n[h+1].y-c[h+1])):i.push(new Wd((n[o].x+l[o-1])/2,(n[o].y+c[o-1])/2));return[r,i]}(n),i=[],o=0,a=r[0].length;o<a;o+=1){var s=new Wd(r[0][o].x,r[0][o].y),l=new Wd(r[1][o].x,r[1][o].y);i.push(new e(n[o],s,l,n[o+1]))}return i}}(ig||(ig={}));var og=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).isVisible=!0,e.isSegment=!0,e.isSubpathStart=!1,e}return P(n,[{key:"end",get:function(){return this.endPoint}},{key:"start",get:function(){if(null==this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path, or segment has not yet been added to a path.)");return this.previousSegment.end}},{key:"closestPointT",value:function(e,t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(e);throw new Error("Neither `closestPointT` nor `closestPointNormalizedLength` method is implemented.")}},{key:"lengthAtT",value:function(e,t){if(e<=0)return 0;var n=this.length();return e>=1?n:n*e}},{key:"divideAtT",value:function(e){if(this.divideAt)return this.divideAt(e);throw new Error("Neither `divideAtT` nor `divideAt` method is implemented.")}},{key:"pointAtT",value:function(e){if(this.pointAt)return this.pointAt(e);throw new Error("Neither `pointAtT` nor `pointAt` method is implemented.")}},{key:"tangentAtT",value:function(e){if(this.tangentAt)return this.tangentAt(e);throw new Error("Neither `tangentAtT` nor `tangentAt` method is implemented.")}}]),n}(Jd),ag=function(e){l(n,e);var t=c(n);function n(e,r){var i;return A(this,n),i=t.call(this),Zd.isLine(e)?i.endPoint=e.end.clone().round(2):i.endPoint=Wd.create(e,r).round(2),i}return P(n,[{key:"type",get:function(){return"L"}},{key:"line",get:function(){return new Zd(this.start,this.end)}},{key:"bbox",value:function(){return this.line.bbox()}},{key:"closestPoint",value:function(e){return this.line.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.line.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.line.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.line.closestPointTangent(e)}},{key:"length",value:function(){return this.line.length()}},{key:"divideAt",value:function(e){var t=this.line.divideAt(e);return[new n(t[0]),new n(t[1])]}},{key:"divideAtLength",value:function(e){var t=this.line.divideAtLength(e);return[new n(t[0]),new n(t[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.line.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.line.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.line.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.line.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){return null!=this.previousSegment&&!this.start.equals(this.end)}},{key:"clone",value:function(){return new n(this.end)}},{key:"scale",value:function(e,t,n){return this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}},{key:"equals",value:function(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.end;return"".concat(this.type," ").concat(e.x," ").concat(e.y)}}]),n}(og);!function(e){e.create=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.length,o=n[0];if(Zd.isLine(o))return new e(o);if(Wd.isPointLike(o))return 1===i?new e(o):n.map((function(t){return new e(t)}));if(2===i)return new e(+n[0],+n[1]);for(var a=[],s=0;s<i;s+=2){var l=+n[s],u=+n[s+1];a.push(new e(l,u))}return a}}(ag||(ag={}));var sg=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"end",get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. MoveTo), or segment has not yet been added to a path.)");return this.subpathStartSegment.end}},{key:"type",get:function(){return"Z"}},{key:"line",get:function(){return new Zd(this.start,this.end)}},{key:"bbox",value:function(){return this.line.bbox()}},{key:"closestPoint",value:function(e){return this.line.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.line.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.line.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.line.closestPointTangent(e)}},{key:"length",value:function(){return this.line.length()}},{key:"divideAt",value:function(e){var t=this.line.divideAt(e);return[t[1].isDifferentiable()?new ag(t[0]):this.clone(),new ag(t[1])]}},{key:"divideAtLength",value:function(e){var t=this.line.divideAtLength(e);return[t[1].isDifferentiable()?new ag(t[0]):this.clone(),new ag(t[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.line.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.line.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.line.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.line.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){return!(!this.previousSegment||!this.subpathStartSegment)&&!this.start.equals(this.end)}},{key:"scale",value:function(){return this}},{key:"rotate",value:function(){return this}},{key:"translate",value:function(){return this}},{key:"equals",value:function(e){return this.type===e.type&&this.start.equals(e.start)&&this.end.equals(e.end)}},{key:"clone",value:function(){return new n}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){return this.type}}]),n}(og);!function(e){e.create=function(){return new e}}(sg||(sg={}));var lg=function(e){l(n,e);var t=c(n);function n(e,r){var i;return A(this,n),(i=t.call(this)).isVisible=!1,i.isSubpathStart=!0,Zd.isLine(e)||ig.isCurve(e)?i.endPoint=e.end.clone().round(2):i.endPoint=Wd.create(e,r).round(2),i}return P(n,[{key:"start",get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}},{key:"type",get:function(){return"M"}},{key:"bbox",value:function(){return null}},{key:"closestPoint",value:function(){return this.end.clone()}},{key:"closestPointLength",value:function(){return 0}},{key:"closestPointNormalizedLength",value:function(){return 0}},{key:"closestPointT",value:function(){return 1}},{key:"closestPointTangent",value:function(){return null}},{key:"length",value:function(){return 0}},{key:"lengthAtT",value:function(){return 0}},{key:"divideAt",value:function(){return[this.clone(),this.clone()]}},{key:"divideAtLength",value:function(){return[this.clone(),this.clone()]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(){return this.end.clone()}},{key:"pointAtLength",value:function(){return this.end.clone()}},{key:"pointAtT",value:function(){return this.end.clone()}},{key:"tangentAt",value:function(){return null}},{key:"tangentAtLength",value:function(){return null}},{key:"tangentAtT",value:function(){return null}},{key:"isDifferentiable",value:function(){return!1}},{key:"scale",value:function(e,t,n){return this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.end.translate(e,t):this.end.translate(e),this}},{key:"clone",value:function(){return new n(this.end)}},{key:"equals",value:function(e){return this.type===e.type&&this.end.equals(e.end)}},{key:"toJSON",value:function(){return{type:this.type,end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.end;return"".concat(this.type," ").concat(e.x," ").concat(e.y)}}]),n}(og);!function(e){e.create=function(){var t=arguments.length,n=arguments.length<=0?void 0:arguments[0];if(Zd.isLine(n))return new e(n);if(ig.isCurve(n))return new e(n);if(Wd.isPointLike(n)){if(1===t)return new e(n);for(var r=[],i=0;i<t;i+=1)0===i?r.push(new e(i<0||arguments.length<=i?void 0:arguments[i])):r.push(new ag(i<0||arguments.length<=i?void 0:arguments[i]));return r}if(2===t)return new e(+(arguments.length<=0?void 0:arguments[0]),+(arguments.length<=1?void 0:arguments[1]));for(var o=[],a=0;a<t;a+=2){var s=+(a<0||arguments.length<=a?void 0:arguments[a]),l=+(a+1<0||arguments.length<=a+1?void 0:arguments[a+1]);0===a?o.push(new e(s,l)):o.push(new ag(s,l))}return o}}(lg||(lg={}));var ug=function(e){l(n,e);var t=c(n);function n(e,r,i,o,a,s){var l;return A(this,n),l=t.call(this),ig.isCurve(e)?(l.controlPoint1=e.controlPoint1.clone().round(2),l.controlPoint2=e.controlPoint2.clone().round(2),l.endPoint=e.end.clone().round(2)):"number"==typeof e?(l.controlPoint1=new Wd(e,r).round(2),l.controlPoint2=new Wd(i,o).round(2),l.endPoint=new Wd(a,s).round(2)):(l.controlPoint1=Wd.create(e).round(2),l.controlPoint2=Wd.create(r).round(2),l.endPoint=Wd.create(i).round(2)),l}return P(n,[{key:"type",get:function(){return"C"}},{key:"curve",get:function(){return new ig(this.start,this.controlPoint1,this.controlPoint2,this.end)}},{key:"bbox",value:function(){return this.curve.bbox()}},{key:"closestPoint",value:function(e){return this.curve.closestPoint(e)}},{key:"closestPointLength",value:function(e){return this.curve.closestPointLength(e)}},{key:"closestPointNormalizedLength",value:function(e){return this.curve.closestPointNormalizedLength(e)}},{key:"closestPointTangent",value:function(e){return this.curve.closestPointTangent(e)}},{key:"length",value:function(){return this.curve.length()}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.curve.divideAt(e,t);return[new n(r[0]),new n(r[1])]}},{key:"divideAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.curve.divideAtLength(e,t);return[new n(r[0]),new n(r[1])]}},{key:"divideAtT",value:function(e){var t=this.curve.divideAtT(e);return[new n(t[0]),new n(t[1])]}},{key:"getSubdivisions",value:function(){return[]}},{key:"pointAt",value:function(e){return this.curve.pointAt(e)}},{key:"pointAtLength",value:function(e){return this.curve.pointAtLength(e)}},{key:"tangentAt",value:function(e){return this.curve.tangentAt(e)}},{key:"tangentAtLength",value:function(e){return this.curve.tangentAtLength(e)}},{key:"isDifferentiable",value:function(){if(!this.previousSegment)return!1;var e=this.start,t=this.controlPoint1,n=this.controlPoint2,r=this.end;return!(e.equals(t)&&t.equals(n)&&n.equals(r))}},{key:"scale",value:function(e,t,n){return this.controlPoint1.scale(e,t,n),this.controlPoint2.scale(e,t,n),this.end.scale(e,t,n),this}},{key:"rotate",value:function(e,t){return this.controlPoint1.rotate(e,t),this.controlPoint2.rotate(e,t),this.end.rotate(e,t),this}},{key:"translate",value:function(e,t){return"number"==typeof e?(this.controlPoint1.translate(e,t),this.controlPoint2.translate(e,t),this.end.translate(e,t)):(this.controlPoint1.translate(e),this.controlPoint2.translate(e),this.end.translate(e)),this}},{key:"equals",value:function(e){return this.start.equals(e.start)&&this.end.equals(e.end)&&this.controlPoint1.equals(e.controlPoint1)&&this.controlPoint2.equals(e.controlPoint2)}},{key:"clone",value:function(){return new n(this.controlPoint1,this.controlPoint2,this.end)}},{key:"toJSON",value:function(){return{type:this.type,start:this.start.toJSON(),controlPoint1:this.controlPoint1.toJSON(),controlPoint2:this.controlPoint2.toJSON(),end:this.end.toJSON()}}},{key:"serialize",value:function(){var e=this.controlPoint1,t=this.controlPoint2,n=this.end;return[this.type,e.x,e.y,t.x,t.y,n.x,n.y].join(" ")}}]),n}(og);function cg(e,t,n){return{x:e*Math.cos(n)-t*Math.sin(n),y:e*Math.sin(n)+t*Math.cos(n)}}function hg(e,t,n,r,i,o){var a=1/3,s=2/3;return[a*e+s*n,a*t+s*r,a*i+s*n,a*o+s*r,i,o]}function fg(e,t,n,r,i,o,a,s,l,u){var c,h,f,d,g,v=120*Math.PI/180,p=Math.PI/180*(+i||0),y=[];if(u)h=u[0],f=u[1],d=u[2],g=u[3];else{e=(c=cg(e,t,-p)).x,t=c.y;var m=(e-(s=(c=cg(s,l,-p)).x))/2,w=(t-(l=c.y))/2,b=m*m/(n*n)+w*w/(r*r);b>1&&(n*=b=Math.sqrt(b),r*=b);var k=n*n,x=r*r,C=(o===a?-1:1)*Math.sqrt(Math.abs((k*x-k*w*w-x*m*m)/(k*w*w+x*m*m)));d=C*n*w/r+(e+s)/2,g=C*-r*m/n+(t+l)/2,h=Math.asin((t-g)/r),f=Math.asin((l-g)/r),h=e<d?Math.PI-h:h,f=s<d?Math.PI-f:f,h<0&&(h=2*Math.PI+h),f<0&&(f=2*Math.PI+f),a&&h>f&&(h-=2*Math.PI),!a&&f>h&&(f-=2*Math.PI)}var E=f-h;if(Math.abs(E)>v){var S=f,_=s,A=l;f=h+v*(a&&f>h?1:-1),y=fg(s=d+n*Math.cos(f),l=g+r*Math.sin(f),n,r,i,0,a,_,A,[f,S,d,g])}E=f-h;var M=Math.cos(h),P=Math.sin(h),O=Math.cos(f),T=Math.sin(f),L=Math.tan(E/4),j=4/3*(n*L),N=4/3*(r*L),R=[e,t],D=[e+j*P,t-N*M],I=[s+j*T,l-N*O],B=[s,l];if(D[0]=2*R[0]-D[0],D[1]=2*R[1]-D[1],u)return[D,I,B].concat(y);for(var z=[],F=(y=[D,I,B].concat(y).join().split(",")).length,V=0;V<F;V+=1)z[V]=V%2?cg(+y[V-1],+y[V],p).y:cg(+y[V],+y[V+1],p).x;return z}function dg(e){var t=function(e){if(!e)return null;var t="\t\n\v\f\r   ᠎             　\u2028\u2029",n=new RegExp("([a-z])[".concat(t,",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?[").concat(t,"]*,?[").concat(t,"]*)+)"),"ig"),r=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)[".concat(t,"]*,?[").concat(t,"]*"),"ig"),i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},o=[];return e.replace(n,(function(e,t,n){var a=[],s=t.toLowerCase();n.replace(r,(function(e,t){return t&&a.push(+t),e})),"m"===s&&a.length>2&&(o.push([t].concat(p(a.splice(0,2)))),s="l",t="m"===t?"l":"L");for(var l=i[s];a.length>=l&&(o.push([t].concat(p(a.splice(0,l)))),l););return e})),o}(e);if(!t||!t.length)return[["M",0,0]];for(var n=0,r=0,i=0,o=0,a=[],s=0,l=t.length;s<l;s+=1){var u=[];a.push(u);var c=t[s],h=c[0];if(h!==h.toUpperCase())switch(u[0]=h.toUpperCase(),u[0]){case"A":u[1]=c[1],u[2]=c[2],u[3]=c[3],u[4]=c[4],u[5]=c[5],u[6]=+c[6]+n,u[7]=+c[7]+r;break;case"V":u[1]=+c[1]+r;break;case"H":u[1]=+c[1]+n;break;case"M":i=+c[1]+n,o=+c[2]+r;for(var f=1,d=c.length;f<d;f+=1)u[f]=+c[f]+(f%2?n:r);break;default:for(var g=1,v=c.length;g<v;g+=1)u[g]=+c[g]+(g%2?n:r)}else for(var y=0,m=c.length;y<m;y+=1)u[y]=c[y];switch(u[0]){case"Z":n=+i,r=+o;break;case"H":n=u[1];break;case"V":r=u[1];break;case"M":i=u[u.length-2],o=u[u.length-1],n=u[u.length-2],r=u[u.length-1];break;default:n=u[u.length-2],r=u[u.length-1]}}return a}function gg(e){var t=dg(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function r(e,t,n){var r,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=null,t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":return 0===parseFloat(e[1])||0===parseFloat(e[2])?["L",e[6],e[7]]:["C"].concat(fg.apply(0,[t.x,t.y].concat(e.slice(1))));case"S":return"C"===n||"S"===n?(r=2*t.x-t.bx,i=2*t.y-t.by):(r=t.x,i=t.y),["C",r,i].concat(e.slice(1));case"T":return"Q"===n||"T"===n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),["C"].concat(hg(t.x,t.y,t.qx,t.qy,e[1],e[2]));case"Q":return t.qx=e[1],t.qy=e[2],["C"].concat(hg(t.x,t.y,e[1],e[2],e[3],e[4]));case"H":return["L"].concat(e[1],t.y);case"V":return["L"].concat(t.x,e[1])}return e}function i(e,n){if(e[n].length>7){e[n].shift();for(var r=e[n];r.length;)o[n]="A",n+=1,e.splice(n,0,["C"].concat(r.splice(0,6)));e.splice(n,1),s=t.length}}for(var o=[],a="",s=t.length,l=0;l<s;l+=1){var u="";t[l]&&(u=t[l][0]),"C"!==u&&(o[l]=u,l>0&&(a=o[l-1])),t[l]=r(t[l],n,a),"A"!==o[l]&&"C"===u&&(o[l]="C"),i(t,l);var c=t[l],h=c.length;n.x=c[h-2],n.y=c[h-1],n.bx=parseFloat(c[h-4])||n.x,n.by=parseFloat(c[h-3])||n.y}return t[0][0]&&"M"===t[0][0]||t.unshift(["M",0,0]),t}function vg(e){return gg(e).map((function(e){return e.map((function(e){return"string"==typeof e?e:qd.round(e,2)}))})).join(",").split(",").join(" ")}!function(e){e.create=function(){var t=arguments.length,n=arguments.length<=0?void 0:arguments[0];if(ig.isCurve(n))return new e(n);if(Wd.isPointLike(n)){if(3===t)return new e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]);for(var r=[],i=0;i<t;i+=3)r.push(new e(i<0||arguments.length<=i?void 0:arguments[i],i+1<0||arguments.length<=i+1?void 0:arguments[i+1],i+2<0||arguments.length<=i+2?void 0:arguments[i+2]));return r}if(6===t)return new e(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]);for(var o=[],a=0;a<t;a+=6)o.push(new e(a<0||arguments.length<=a?void 0:arguments[a],a+1<0||arguments.length<=a+1?void 0:arguments[a+1],a+2<0||arguments.length<=a+2?void 0:arguments[a+2],a+3<0||arguments.length<=a+3?void 0:arguments[a+3],a+4<0||arguments.length<=a+4?void 0:arguments[a+4],a+5<0||arguments.length<=a+5?void 0:arguments[a+5]));return o}}(ug||(ug={}));var pg=function(e){l(n,e);var t=c(n);function n(e){var r;if(A(this,n),(r=t.call(this)).PRECISION=3,r.segments=[],Array.isArray(e))if(Zd.isLine(e[0])||ig.isCurve(e[0])){var i=null;e.forEach((function(e,t){0===t&&r.appendSegment(n.createSegment("M",e.start)),null==i||i.end.equals(e.start)||r.appendSegment(n.createSegment("M",e.start)),Zd.isLine(e)?r.appendSegment(n.createSegment("L",e.end)):ig.isCurve(e)&&r.appendSegment(n.createSegment("C",e.controlPoint1,e.controlPoint2,e.end)),i=e}))}else{e.forEach((function(e){e.isSegment&&r.appendSegment(e)}))}else null!=e&&(Zd.isLine(e)?(r.appendSegment(n.createSegment("M",e.start)),r.appendSegment(n.createSegment("L",e.end))):ig.isCurve(e)?(r.appendSegment(n.createSegment("M",e.start)),r.appendSegment(n.createSegment("C",e.controlPoint1,e.controlPoint2,e.end))):rg.isPolyline(e)?e.points&&e.points.length&&e.points.forEach((function(e,t){var i=0===t?n.createSegment("M",e):n.createSegment("L",e);r.appendSegment(i)})):e.isSegment&&r.appendSegment(e));return r}return P(n,[{key:"start",get:function(){var e=this.segments,t=e.length;if(0===t)return null;for(var n=0;n<t;n+=1){var r=e[n];if(r.isVisible)return r.start}return e[t-1].end}},{key:"end",get:function(){var e=this.segments,t=e.length;if(0===t)return null;for(var n=t-1;n>=0;n-=1){var r=e[n];if(r.isVisible)return r.end}return e[t-1].end}},{key:"moveTo",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.appendSegment((e=lg.create).call.apply(e,[null].concat(n)))}},{key:"lineTo",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.appendSegment((e=ag.create).call.apply(e,[null].concat(n)))}},{key:"curveTo",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return this.appendSegment((e=ug.create).call.apply(e,[null].concat(n)))}},{key:"arcTo",value:function(e,t,n,r,i,o,a){var s=this.end||new Wd,l="number"==typeof o?tg(s.x,s.y,e,t,n,r,i,o,a):tg(s.x,s.y,e,t,n,r,i,o.x,o.y);if(null!=l)for(var u=0,c=l.length;u<c;u+=6)this.curveTo(l[u],l[u+1],l[u+2],l[u+3],l[u+4],l[u+5]);return this}},{key:"quadTo",value:function(e,t,r,i){var o=this.end||new Wd,a=["M",o.x,o.y];if("number"==typeof e)a.push("Q",e,t,r,i);else{var s=t;a.push("Q",e.x,e.y,s.x,s.y)}var l=n.parse(a.join(" "));return this.appendSegment(l.segments.slice(1)),this}},{key:"close",value:function(){return this.appendSegment(sg.create())}},{key:"drawPoints",value:function(e){var t=eg(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),r=n.parse(t);r&&r.segments&&this.appendSegment(r.segments)}},{key:"bbox",value:function(){var e,t=this.segments,n=t.length;if(0===n)return null;for(var r=0;r<n;r+=1){var i=t[r];if(i.isVisible){var o=i.bbox();null!=o&&(e=e?e.union(o):o)}}if(null!=e)return e;var a=t[n-1];return new Yd(a.end.x,a.end.y,0,0)}},{key:"appendSegment",value:function(e){var t,n=this.segments.length,r=0!==n?this.segments[n-1]:null;if(Array.isArray(e))for(var i=0,o=e.length;i<o;i+=1){var a=e[i];t=this.prepareSegment(a,r,null),this.segments.push(t),r=t}else null!=e&&e.isSegment&&(t=this.prepareSegment(e,r,null),this.segments.push(t));return this}},{key:"insertSegment",value:function(e,t){var n,r=this.segments.length;if(e<0&&(e=r+e+1),e>r||e<0)throw new Error("Index out of range.");var i=null,o=null;if(0!==r&&(e>=1?o=(i=this.segments[e-1]).nextSegment:(i=null,o=this.segments[0])),Array.isArray(t))for(var a=0,s=t.length;a<s;a+=1){var l=t[a];n=this.prepareSegment(l,i,o),this.segments.splice(e+a,0,n),i=n}else n=this.prepareSegment(t,i,o),this.segments.splice(e,0,n);return this}},{key:"removeSegment",value:function(e){var t=this.fixIndex(e),n=this.segments.splice(t,1)[0],r=n.previousSegment,i=n.nextSegment;return r&&(r.nextSegment=i),i&&(i.previousSegment=r),n.isSubpathStart&&i&&this.updateSubpathStartSegment(i),n}},{key:"replaceSegment",value:function(e,t){var n,r=this.fixIndex(e),i=this.segments[r],o=i.previousSegment,a=i.nextSegment,s=i.isSubpathStart;if(Array.isArray(t)){this.segments.splice(e,1);for(var l=0,u=t.length;l<u;l+=1){var c=t[l];n=this.prepareSegment(c,o,a),this.segments.splice(e+l,0,n),o=n,s&&n.isSubpathStart&&(s=!1)}}else n=this.prepareSegment(t,o,a),this.segments.splice(r,1,n),s&&n.isSubpathStart&&(s=!1);s&&a&&this.updateSubpathStartSegment(a)}},{key:"getSegment",value:function(e){var t=this.fixIndex(e);return this.segments[t]}},{key:"fixIndex",value:function(e){var t=this.segments.length;if(0===t)throw new Error("Path has no segments.");for(var n=e;n<0;)n=t+n;if(n>=t||n<0)throw new Error("Index out of range.");return n}},{key:"segmentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segmentIndexAt(e,t);return n?this.getSegment(n):null}},{key:"segmentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segmentIndexAtLength(e,t);return n?this.getSegment(n):null}},{key:"segmentIndexAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=qd.clamp(e,0,1),r=this.getOptions(t),i=this.length(r)*n;return this.segmentIndexAtLength(i,r)}},{key:"segmentIndexAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segments.length;if(0===n)return null;var r=!0;e<0&&(r=!1,e=-e);for(var i=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=null,l=0;l<n;l+=1){var u=r?l:n-1-l,c=this.segments[u],h=o[u],f=c.length({precision:i,subdivisions:h});if(c.isVisible){if(e<=a+f)return u;s=u}a+=f}return s}},{key:"getSegmentSubdivisions",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPrecision(e),n=[],r=0,i=this.segments.length;r<i;r+=1){var o=this.segments[r].getSubdivisions({precision:t});n.push(o)}return n}},{key:"updateSubpathStartSegment",value:function(e){for(var t=e.previousSegment,n=e;n&&!n.isSubpathStart;)n.subpathStartSegment=null!=t?t.subpathStartSegment:null,t=n,n=n.nextSegment}},{key:"prepareSegment",value:function(e,t,n){e.previousSegment=t,e.nextSegment=n,null!=t&&(t.nextSegment=e),null!=n&&(n.previousSegment=e);var r=e;return e.isSubpathStart&&(e.subpathStartSegment=e,r=n),null!=r&&this.updateSubpathStartSegment(r),e}},{key:"closestPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.closestPointT(e,t);return n?this.pointAtT(n):null}},{key:"closestPointLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),r=this.closestPointT(e,n);return r?this.lengthAtT(r,n):0}},{key:"closestPointNormalizedLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getOptions(t),r=this.closestPointLength(e,n);if(0===r)return 0;var i=this.length(n);return 0===i?0:r/i}},{key:"closestPointT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;for(var n,r=this.getPrecision(t),i=this.getSubdivisions(t),o=1/0,a=0,s=this.segments.length;a<s;a+=1){var l=this.segments[a],u=i[a];if(l.isVisible){var c=l.closestPointT(e,{precision:r,subdivisions:u}),h=l.pointAtT(c),f=qd.squaredLength(h,e);f<o&&(n={segmentIndex:a,value:c},o=f)}}return n||{segmentIndex:this.segments.length-1,value:1}}},{key:"closestPointTangent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;for(var n,r=this.getPrecision(t),i=this.getSubdivisions(t),o=1/0,a=0,s=this.segments.length;a<s;a+=1){var l=this.segments[a],u=i[a];if(l.isDifferentiable()){var c=l.closestPointT(e,{precision:r,subdivisions:u}),h=l.pointAtT(c),f=qd.squaredLength(h,e);f<o&&(n=l.tangentAtT(c),o=f)}}return n||null}},{key:"containsPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.toPolylines(t);if(!n)return!1;for(var r=0,i=0,o=n.length;i<o;i+=1){n[i].containsPoint(e)&&(r+=1)}return r%2==1}},{key:"pointAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;if(e<=0)return this.start.clone();if(e>=1)return this.end.clone();var n=this.getOptions(t),r=this.length(n)*e;return this.pointAtLength(r,n)}},{key:"pointAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;if(0===e)return this.start.clone();var n=!0;e<0&&(n=!1,e=-e);for(var r,i=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=0,l=this.segments.length;s<l;s+=1){var u=n?s:l-1-s,c=this.segments[u],h=o[u],f=c.length({precision:i,subdivisions:h});if(c.isVisible){if(e<=a+f)return c.pointAtLength((n?1:-1)*(e-a),{precision:i,subdivisions:h});r=c}a+=f}return r?n?r.end:r.start:this.segments[this.segments.length-1].end.clone()}},{key:"pointAtT",value:function(e){var t=this.segments,n=t.length;if(0===n)return null;var r=e.segmentIndex;if(r<0)return t[0].pointAtT(0);if(r>=n)return t[n-1].pointAtT(1);var i=qd.clamp(e.value,0,1);return t[r].pointAtT(i)}},{key:"divideAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=qd.clamp(e,0,1),r=this.getOptions(t),i=this.length(r)*n;return this.divideAtLength(i,r)}},{key:"divideAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var r=!0;e<0&&(r=!1,e=-e);for(var i,o,a,s,l,u=this.getPrecision(t),c=this.getSubdivisions(t),h=0,f=0,d=this.segments.length;f<d;f+=1){var g=r?f:d-1-f,v=this.getSegment(g),p={precision:u,subdivisions:c[g]},y=v.length(p);if(v.isDifferentiable()&&(a=v,s=g,e<=h+y)){o=g,i=v.divideAtLength((r?1:-1)*(e-h),p);break}h+=y}if(!a)return null;i||(o=s,l=r?1:0,i=a.divideAtT(l));var m=this.clone(),w=o;m.replaceSegment(w,i);var b=w,k=w+1,x=w+2;i[0].isDifferentiable()||(m.removeSegment(b),k-=1,x-=1);var C=m.getSegment(k).start;m.insertSegment(k,n.createSegment("M",C)),x+=1,i[1].isDifferentiable()||(m.removeSegment(x-1),x-=1);for(var E=x-b-1,S=x,_=m.segments.length;S<_;S+=1){var A=this.getSegment(S-E),M=m.getSegment(S);if("Z"===M.type&&!A.subpathStartSegment.end.equals(M.subpathStartSegment.end)){var P=n.createSegment("L",A.end);m.replaceSegment(S,P)}}return[new n(m.segments.slice(0,k)),new n(m.segments.slice(k))]}},{key:"intersectsWithLine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.toPolylines(t);if(null==n)return null;for(var r=null,i=0,o=n.length;i<o;i+=1){var a,s=n[i],l=e.intersect(s);if(l)if(null==r&&(r=[]),Array.isArray(l))(a=r).push.apply(a,p(l));else r.push(l)}return r}},{key:"isDifferentiable",value:function(){for(var e=0,t=this.segments.length;e<t;e+=1){if(this.segments[e].isDifferentiable())return!0}return!1}},{key:"isValid",value:function(){var e=this.segments,t=0===e.length||"M"===e[0].type;return t}},{key:"length",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===this.segments.length)return 0;for(var t=this.getSubdivisions(e),n=0,r=0,i=this.segments.length;r<i;r+=1){var o=this.segments[r],a=t[r];n+=o.length({subdivisions:a})}return n}},{key:"lengthAtT",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.segments.length;if(0===n)return 0;var r=e.segmentIndex;if(r<0)return 0;var i=qd.clamp(e.value,0,1);r>=n&&(r=n-1,i=1);for(var o=this.getPrecision(t),a=this.getSubdivisions(t),s=0,l=0;l<r;l+=1){var u=this.segments[l],c=a[l];s+=u.length({precision:o,subdivisions:c})}var h=this.segments[r],f=a[r];return s+=h.lengthAtT(i,{precision:o,subdivisions:f})}},{key:"tangentAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=qd.clamp(e,0,1),r=this.getOptions(t),i=this.length(r)*n;return this.tangentAtLength(i,r)}},{key:"tangentAtLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.segments.length)return null;var n=!0;e<0&&(n=!1,e=-e);for(var r,i=this.getPrecision(t),o=this.getSubdivisions(t),a=0,s=0,l=this.segments.length;s<l;s+=1){var u=n?s:l-1-s,c=this.segments[u],h=o[u],f=c.length({precision:i,subdivisions:h});if(c.isDifferentiable()){if(e<=a+f)return c.tangentAtLength((n?1:-1)*(e-a),{precision:i,subdivisions:h});r=c}a+=f}if(r){var d=n?1:0;return r.tangentAtT(d)}return null}},{key:"tangentAtT",value:function(e){var t=this.segments.length;if(0===t)return null;var n=e.segmentIndex;if(n<0)return this.segments[0].tangentAtT(0);if(n>=t)return this.segments[t-1].tangentAtT(1);var r=qd.clamp(e.value,0,1);return this.segments[n].tangentAtT(r)}},{key:"getPrecision",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null==e.precision?this.PRECISION:e.precision}},{key:"getSubdivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==e.segmentSubdivisions){var t=this.getPrecision(e);return this.getSegmentSubdivisions({precision:t})}return e.segmentSubdivisions}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{precision:this.getPrecision(e),segmentSubdivisions:this.getSubdivisions(e)}}},{key:"toPoints",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.segments,n=t.length;if(0===n)return null;for(var r=this.getSubdivisions(e),i=[],o=[],a=0;a<n;a+=1){var s=t[a];if(s.isVisible){var l=r[a];l.length>0?l.forEach((function(e){return o.push(e.start)})):o.push(s.start)}else o.length>0&&(o.push(t[a-1].end),i.push(o),o=[])}return o.length>0&&(o.push(this.end),i.push(o)),i}},{key:"toPolylines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.toPoints(e);return t?t.map((function(e){return new rg(e)})):null}},{key:"scale",value:function(e,t,n){return this.segments.forEach((function(r){return r.scale(e,t,n)})),this}},{key:"rotate",value:function(e,t){return this.segments.forEach((function(n){return n.rotate(e,t)})),this}},{key:"translate",value:function(e,t){return"number"==typeof e?this.segments.forEach((function(n){return n.translate(e,t)})):this.segments.forEach((function(t){return t.translate(e)})),this}},{key:"clone",value:function(){var e=new n;return this.segments.forEach((function(t){return e.appendSegment(t.clone())})),e}},{key:"equals",value:function(e){if(null==e)return!1;var t=this.segments,n=e.segments,r=t.length;if(n.length!==r)return!1;for(var i=0;i<r;i+=1){var o=t[i],a=n[i];if(o.type!==a.type||!o.equals(a))return!1}return!0}},{key:"toJSON",value:function(){return this.segments.map((function(e){return e.toJSON()}))}},{key:"serialize",value:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.segments.map((function(e){return e.serialize()})).join(" ")}},{key:"toString",value:function(){return this.serialize()}}]),n}(Jd);!function(e){e.isPath=function(t){return null!=t&&t instanceof e}}(pg||(pg={})),function(e){function t(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o,a;if("M"===e)return(i=lg.create).call.apply(i,[null].concat(n));if("L"===e)return(o=ag.create).call.apply(o,[null].concat(n));if("C"===e)return(a=ug.create).call.apply(a,[null].concat(n));if("z"===e||"Z"===e)return sg.create();throw new Error('Invalid path segment type "'.concat(e,'"'))}e.parse=function(n){if(!n)return new e;var r=new e,i=e.normalize(n).match(/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g);if(null!=i)for(var o=0,a=i.length;o<a;o+=1){var s=i[o].match(/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g);if(null!=s){var l=s[0],u=s.slice(1).map((function(e){return+e})),c=t.call.apply(t,[null,l].concat(p(u)));r.appendSegment(c)}}return r},e.createSegment=t}(pg||(pg={})),function(e){e.normalize=vg,e.isValid=$d,e.drawArc=ng,e.drawPoints=eg,e.arcToCurves=tg}(pg||(pg={}));var yg=function(){function e(t){A(this,e),this.options=Object.assign({},t),this.data=this.options.data||{},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this)}return P(e,[{key:"names",get:function(){return Object.keys(this.data)}},{key:"register",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("object"!==v(e)){!this.exist(e)||r||Nh.isApplyingHMR()||this.onDuplicated(e);var i=this.options.process,o=i?hh(i,this,e,t):t;return this.data[e]=o,o}Object.entries(e).forEach((function(e){var r=m(e,2),i=r[0],o=r[1];n.register(i,o,t)}))}},{key:"unregister",value:function(e){var t=e?this.data[e]:null;return delete this.data[e],t}},{key:"get",value:function(e){return e?this.data[e]:null}},{key:"exist",value:function(e){return!!e&&null!=this.data[e]}},{key:"onDuplicated",value:function(e){try{throw this.options.onConflict&&hh(this.options.onConflict,this,e),new Error("".concat(Je(this.options.type)," with name '").concat(e,"' already registered."))}catch(Qk){throw Qk}}},{key:"onNotFound",value:function(e,t){throw new Error(this.getSpellingSuggestion(e,t))}},{key:"getSpellingSuggestion",value:function(e,t){var n=this.getSpellingSuggestionForName(e),r=t?"".concat(t," ").concat(We(this.options.type)):this.options.type;return"".concat(Je(r)," with name '").concat(e,"' does not exist.").concat(n?" Did you mean '".concat(n,"'?"):"")}},{key:"getSpellingSuggestionForName",value:function(e){return function(e,t,n){var r,i,o=Math.min(2,Math.floor(.34*e.length)),a=Math.floor(.4*e.length)+1,s=!1,l=e.toLowerCase(),u=k(t);try{for(u.s();!(i=u.n()).done;){var c=i.value,h=n(c);if(void 0!==h&&Math.abs(h.length-l.length)<=o){var f=h.toLowerCase();if(f===l){if(h===e)continue;return c}if(s)continue;if(h.length<3)continue;var d=Oh(l,f,a-1);if(void 0===d)continue;d<3?(s=!0,r=c):(a=d,r=c)}}}catch(Qk){u.e(Qk)}finally{u.f()}return r}(e,Object.keys(this.data),(function(e){return e}))}}]),e}();!function(e){e.create=function(t){return new e(t)}}(yg||(yg={}));var mg={color:"#aaaaaa",thickness:1,markup:"rect",update:function(e,t){var n=t.thickness*t.sx,r=t.thickness*t.sy;Tf(e,{width:n,height:r,rx:n,ry:r,fill:t.color})}},wg={color:"#aaaaaa",thickness:1,markup:"rect",update:function(e,t){var n=t.sx<=1?t.thickness*t.sx:t.thickness;Tf(e,{width:n,height:n,rx:n,ry:n,fill:t.color})}},bg={color:"rgba(224,224,224,1)",thickness:1,markup:"path",update:function(e,t){var n=t.width,r=t.height,i=t.thickness;Tf(e,{d:n-i>=0&&r-i>=0?["M",n,0,"H0 M0 0 V0",r].join(" "):"M 0 0 0 0",stroke:t.color,"stroke-width":t.thickness})}},kg=[{color:"rgba(224,224,224,1)",thickness:1,markup:"path",update:function(e,t){var n=t.width,r=t.height,i=t.thickness;Tf(e,{d:n-i>=0&&r-i>=0?["M",n,0,"H0 M0 0 V0",r].join(" "):"M 0 0 0 0",stroke:t.color,"stroke-width":t.thickness})}},{color:"rgba(224,224,224,0.2)",thickness:3,factor:4,markup:"path",update:function(e,t){var n,r=t.factor||1,i=t.width*r,o=t.height*r,a=t.thickness;n=i-a>=0&&o-a>=0?["M",i,0,"H0 M0 0 V0",o].join(" "):"M 0 0 0 0",t.width=i,t.height=o,Tf(e,{d:n,stroke:t.color,"stroke-width":t.thickness})}}],xg=Object.freeze(Object.defineProperty({__proto__:null,dot:mg,doubleMesh:kg,fixedDot:wg,mesh:bg},Symbol.toStringTag,{value:"Module"})),Cg=function(){function e(){A(this,e),this.patterns={},this.root=Xf.create(pf(),{width:"100%",height:"100%"},[vf("defs")]).node}return P(e,[{key:"add",value:function(e,t){var n=this.root.childNodes[0];n&&n.appendChild(t),this.patterns[e]=t,Xf.create("rect",{width:"100%",height:"100%",fill:"url(#".concat(e,")")}).appendTo(this.root)}},{key:"get",value:function(e){return this.patterns[e]}},{key:"has",value:function(e){return null!=this.patterns[e]}}]),e}();!function(e){e.presets=xg,e.registry=yg.create({type:"grid"}),e.registry.register(e.presets,!0)}(Cg||(Cg={}));var Eg,Sg=function(e){var t=document.createElement("canvas"),n=e.width,r=e.height;t.width=2*n,t.height=r;var i=t.getContext("2d");return i.drawImage(e,0,0,n,r),i.translate(2*n,0),i.scale(-1,1),i.drawImage(e,0,0,n,r),t},_g=function(e){var t=document.createElement("canvas"),n=e.width,r=e.height;t.width=n,t.height=2*r;var i=t.getContext("2d");return i.drawImage(e,0,0,n,r),i.translate(0,2*r),i.scale(1,-1),i.drawImage(e,0,0,n,r),t},Ag=function(e){var t=document.createElement("canvas"),n=e.width,r=e.height;t.width=2*n,t.height=2*r;var i=t.getContext("2d");return i.drawImage(e,0,0,n,r),i.setTransform(-1,0,0,-1,t.width,t.height),i.drawImage(e,0,0,n,r),i.setTransform(-1,0,0,1,t.width,0),i.drawImage(e,0,0,n,r),i.setTransform(1,0,0,-1,0,t.height),i.drawImage(e,0,0,n,r),t},Mg=Object.freeze(Object.defineProperty({__proto__:null,flipX:Sg,flipXY:Ag,flipY:_g,watermark:function(e,t){var n=e.width,r=e.height,i=document.createElement("canvas");i.width=3*n,i.height=3*r;for(var o=i.getContext("2d"),a=null!=t.angle?-t.angle:-20,s=Ud.toRad(a),l=i.width/4,u=i.height/4,c=0;c<4;c+=1)for(var h=0;h<4;h+=1)(c+h)%2>0&&(o.setTransform(1,0,0,1,(2*c-1)*l,(2*h-1)*u),o.rotate(s),o.drawImage(e,-n/2,-r/2,n,r));return i}},Symbol.toStringTag,{value:"Module"}));function Pg(e,t){return null!=e?e:t}function Og(e,t){return null!=e&&Number.isFinite(e)?e:t}!function(e){e.presets=Object.assign({},Mg),e.presets["flip-x"]=Sg,e.presets["flip-y"]=_g,e.presets["flip-xy"]=Ag,e.registry=yg.create({type:"background pattern"}),e.registry.register(e.presets,!0)}(Eg||(Eg={}));var Tg,Lg=Object.freeze(Object.defineProperty({__proto__:null,blur:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Og(e.x,2),n=null!=e.y&&Number.isFinite(e.y)?[t,e.y]:t;return'\n    <filter>\n      <feGaussianBlur stdDeviation="'.concat(n,'"/>\n    </filter>\n  ').trim()},brightness:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1);return'\n    <filter>\n      <feComponentTransfer>\n        <feFuncR type="linear" slope="'.concat(e,'"/>\n        <feFuncG type="linear" slope="').concat(e,'"/>\n        <feFuncB type="linear" slope="').concat(e,'"/>\n      </feComponentTransfer>\n    </filter>\n  ').trim()},contrast:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.5-e/2;return'\n    <filter>\n     <feComponentTransfer>\n        <feFuncR type="linear" slope="'.concat(e,'" intercept="').concat(t,'"/>\n        <feFuncG type="linear" slope="').concat(e,'" intercept="').concat(t,'"/>\n        <feFuncB type="linear" slope="').concat(e,'" intercept="').concat(t,'"/>\n      </feComponentTransfer>\n    </filter>\n  ').trim()},dropShadow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Og(e.dx,0),n=Og(e.dy,0),r=Pg(e.color,"black"),i=Og(e.blur,4),o=Og(e.opacity,1);return"SVGFEDropShadowElement"in window?'<filter>\n         <feDropShadow stdDeviation="'.concat(i,'" dx="').concat(t,'" dy="').concat(n,'" flood-color="').concat(r,'" flood-opacity="').concat(o,'" />\n       </filter>').trim():'<filter>\n         <feGaussianBlur in="SourceAlpha" stdDeviation="'.concat(i,'" />\n         <feOffset dx="').concat(t,'" dy="').concat(n,'" result="offsetblur" />\n         <feFlood flood-color="').concat(r,'" />\n         <feComposite in2="offsetblur" operator="in" />\n         <feComponentTransfer>\n           <feFuncA type="linear" slope="').concat(o,'" />\n         </feComponentTransfer>\n         <feMerge>\n           <feMergeNode/>\n           <feMergeNode in="SourceGraphic"/>\n         </feMerge>\n       </filter>').trim()},grayScale:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.7152-.7152*(1-e),n=.0722-.0722*(1-e),r=.2126-.2126*(1-e),i=.7152+.2848*(1-e),o=.0722-.0722*(1-e),a=.2126-.2126*(1-e),s=.0722+.9278*(1-e);return'\n    <filter>\n      <feColorMatrix type="matrix" values="'.concat(.2126+.7874*(1-e)," ").concat(t," ").concat(n," 0 0 ").concat(r," ").concat(i," ").concat(o," 0 0 ").concat(a," ").concat(t," ").concat(s,' 0 0 0 0 0 1 0"/>\n    </filter>\n  ').trim()},highlight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Pg(e.color,"red"),n=Og(e.blur,0),r=Og(e.width,1),i=Og(e.opacity,1);return'\n      <filter>\n        <feFlood flood-color="'.concat(t,'" flood-opacity="').concat(i,'" result="colored"/>\n        <feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="').concat(r,'"/>\n        <feComposite result="composed" in="colored" in2="morphed" operator="in"/>\n        <feGaussianBlur result="blured" in="composed" stdDeviation="').concat(n,'"/>\n        <feBlend in="SourceGraphic" in2="blured" mode="normal"/>\n      </filter>\n    ').trim()},hueRotate:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).angle,0);return'\n      <filter>\n        <feColorMatrix type="hueRotate" values="'.concat(e,'"/>\n      </filter>\n    ').trim()},invert:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=1-e;return'\n      <filter>\n        <feComponentTransfer>\n          <feFuncR type="table" tableValues="'.concat(e," ").concat(t,'"/>\n          <feFuncG type="table" tableValues="').concat(e," ").concat(t,'"/>\n          <feFuncB type="table" tableValues="').concat(e," ").concat(t,'"/>\n        </feComponentTransfer>\n      </filter>\n    ').trim()},outline:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Pg(e.color,"blue"),n=Og(e.width,1),r=Og(e.margin,2),i=Og(e.opacity,1),o=r,a=r+n;return'\n    <filter>\n      <feFlood flood-color="'.concat(t,'" flood-opacity="').concat(i,'" result="colored"/>\n      <feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="').concat(a,'" />\n      <feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="').concat(o,'" />\n      <feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/>\n      <feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/>\n      <feMerge>\n        <feMergeNode in="outline"/>\n        <feMergeNode in="SourceGraphic"/>\n      </feMerge>\n    </filter>\n  ').trim()},saturate:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1);return'\n      <filter>\n        <feColorMatrix type="saturate" values="'.concat(1-e,'"/>\n      </filter>\n    ').trim()},sepia:function(){var e=Og((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).amount,1),t=.769-.769*(1-e),n=.189-.189*(1-e),r=.349-.349*(1-e),i=.686+.314*(1-e),o=.168-.168*(1-e),a=.272-.272*(1-e),s=.534-.534*(1-e),l=.131+.869*(1-e);return'\n      <filter>\n        <feColorMatrix type="matrix" values="'.concat(.393+.607*(1-e)," ").concat(t," ").concat(n," 0 0 ").concat(r," ").concat(i," ").concat(o," 0 0 ").concat(a," ").concat(s," ").concat(l,' 0 0 0 0 0 1 0"/>\n      </filter>\n    ').trim()}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Lg,e.registry=yg.create({type:"filter"}),e.registry.register(e.presets,!0)}(Tg||(Tg={}));var jg,Ng,Rg={xlinkHref:"xlink:href",xlinkShow:"xlink:show",xlinkRole:"xlink:role",xlinkType:"xlink:type",xlinkArcrole:"xlink:arcrole",xlinkTitle:"xlink:title",xlinkActuate:"xlink:actuate",xmlSpace:"xml:space",xmlBase:"xml:base",xmlLang:"xml:lang",preserveAspectRatio:"preserveAspectRatio",requiredExtension:"requiredExtension",requiredFeatures:"requiredFeatures",systemLanguage:"systemLanguage",externalResourcesRequired:"externalResourceRequired"},Dg={position:ov("x","width","origin")},Ig={position:ov("y","height","origin")},Bg={position:ov("x","width","corner")},zg={position:ov("y","height","corner")},Fg={set:av("width","width")},Vg={set:av("height","height")},Hg={set:av("rx","width")},Ug={set:av("ry","height")},qg={set:(jg=av("r","width"),Ng=av("r","height"),function(e,t){var n=t.refBBox;return hh(n.height>n.width?jg:Ng,this,e,t)})},Gg={set:function(e,t){var n=t.refBBox,r=parseFloat(e),i=Th(e);i&&(r/=100);var o,a=Math.sqrt(n.height*n.height+n.width*n.width);return Number.isFinite(r)&&(o=i||r>=0&&r<=1?r*a:Math.max(r+a,0)),{r:o}}},Jg={set:av("cx","width")},Wg={set:av("cy","height")},Yg={set:lv({resetOffset:!0})},Zg={set:lv({resetOffset:!1})},Xg={set:uv({resetOffset:!0})},Kg={set:uv({resetOffset:!1})},$g=qg,Qg=Yg,ev=Xg,tv=Dg,nv=Ig,rv=Fg,iv=Vg;function ov(e,t,n){return function(r,i){var o=i.refBBox;if(null==r)return null;var a,s=parseFloat(r),l=Th(r);if(l&&(s/=100),Number.isFinite(s)){var u=o[n];a=l||s>0&&s<1?u[e]+o[t]*s:u[e]+s}var c=new Wd;return c[e]=a||0,c}}function av(e,t){return function(n,r){var i=r.refBBox,o=parseFloat(n),a=Th(n);a&&(o/=100);var s={};if(Number.isFinite(o)){var l=a||o>=0&&o<=1?o*i[t]:Math.max(o+i[t],0);s[e]=l}return s}}function sv(e,t){var n="x6-shape",r=t&&t.resetOffset;return function(t,i){var o=i.elem,a=i.refBBox,s=Zf(o,n);if(!s||s.value!==t){var l=e(t);s={value:t,shape:l,shapeBBox:l.bbox()},Zf(o,n,s)}var u=s.shape.clone(),c=s.shapeBBox.clone(),h=c.getOrigin(),f=a.getOrigin();c.x=f.x,c.y=f.y;var d=a.getMaxScaleToFit(c,f),g=0===c.width||0===a.width?1:d.sx,v=0===c.height||0===a.height?1:d.sy;return u.scale(g,v,h),r&&u.translate(-h.x,-h.y),u}}function lv(e){var t=sv((function(e){return pg.parse(e)}),e);return function(e,n){return{d:t(e,n).serialize()}}}function uv(e){var t=sv((function(e){return new rg(e)}),e);return function(e,n){return{points:t(e,n).serialize()}}}var cv={qualify:Ye,set:function(e,t){var n=t.view;return"url(#".concat(n.graph.defineGradient(e),")")}},hv={qualify:Ye,set:function(e,t){var n=t.view,r=n.cell,i=Object.assign({},e);if(r.isEdge()&&"linearGradient"===i.type){var o=n,a=o.sourcePoint,s=o.targetPoint;i.id="gradient-".concat(i.type,"-").concat(r.id),i.attrs=Object.assign(Object.assign({},i.attrs),{x1:a.x,y1:a.y,x2:s.x,y2:s.y,gradientUnits:"userSpaceOnUse"}),n.graph.defs.remove(i.id)}return"url(#".concat(n.graph.defineGradient(i),")")}},fv={qualify:function(e,t){var n=t.attrs;return null==n.textWrap||!Ye(n.textWrap)},set:function(e,t){var n=t.view,r=t.elem,i=t.attrs,o="x6-text",a=Zf(r,o),s=function(e){try{return JSON.parse(e)}catch(t){return e}},l={x:i.x,eol:i.eol,annotations:s(i.annotations),textPath:s(i["text-path"]||i.textPath),textVerticalAnchor:i["text-vertical-anchor"]||i.textVerticalAnchor,displayEmpty:"true"===(i["display-empty"]||i.displayEmpty),lineHeight:i["line-height"]||i.lineHeight},u=i["font-size"]||i.fontSize,c=JSON.stringify([e,l]);if(u&&r.setAttribute("font-size",u),null==a||a!==c){var h=l.textPath;if(null!=h&&"object"===v(h)){var f=h.selector;if("string"==typeof f){var d=n.find(f)[0];d instanceof SVGPathElement&&(cf(d),l.textPath=Object.assign({"xlink:href":"#".concat(d.id)},h))}}ed(r,"".concat(e),l),Zf(r,o,c)}}},dv={qualify:Ye,set:function(e,t){var n=t.view,r=t.elem,i=t.attrs,o=t.refBBox,a=e,s=a.width||0;Th(s)?o.width*=parseFloat(s)/100:s<=0?o.width+=s:o.width=s;var l,u=a.height||0;Th(u)?o.height*=parseFloat(u)/100:u<=0?o.height+=u:o.height=u;var c=a.text;null==c&&(c=i.text||(null==r?void 0:r.textContent)),l=null!=c?rd("".concat(c),o,{"font-weight":i["font-weight"]||i.fontWeight,"font-size":i["font-size"]||i.fontSize,"font-family":i["font-family"]||i.fontFamily,lineHeight:i.lineHeight},{ellipsis:a.ellipsis}):"",hh(fv.set,this,l,{view:n,elem:r,attrs:i,refBBox:o,cell:n.cell})}},gv=function(e,t){return void 0!==t.attrs.text},vv={qualify:gv},pv={qualify:gv},yv={qualify:gv},mv={qualify:gv},wv={qualify:gv},bv={qualify:gv},kv={qualify:function(e,t){return t.elem instanceof SVGElement},set:function(e,t){var n=t.elem,r="x6-title",i="".concat(e),o=Zf(n,r);if(null==o||o!==i){Zf(n,r,i);var a=n.firstChild;if(a&&"TITLE"===a.tagName.toUpperCase()){a.textContent=i}else{var s=document.createElementNS(n.namespaceURI,"title");s.textContent=i,n.insertBefore(s,a)}}}},xv={offset:Ev("x","width","right")},Cv={offset:Ev("y","height","bottom")};function Ev(e,t,n){return function(r,i){var o,a=i.refBBox,s=new Wd;return o="middle"===r?a[t]/2:r===n?a[t]:"number"==typeof r&&Number.isFinite(r)?r>-1&&r<1?-a[t]*r:-r:Th(r)?a[t]*parseFloat(r)/100:0,s[e]=-(a[e]+o),s}}var Sv={qualify:Ye,set:function(e,t){Jf(t.elem,e)}},_v={qualify:Ye,set:function(e,t){var n=t.view;return"url(#".concat(n.graph.defineFilter(e),")")}},Av={set:function(e){return null!=e&&"object"===v(e)&&e.id?e.id:e}};function Mv(e,t,n){var r,i;"object"===v(t)?(r=t.x,i=t.y):(r=t,i=n);var o=pg.parse(e),a=o.bbox();if(a){var s=-a.height/2-a.y,l=-a.width/2-a.x;"number"==typeof r&&(l-=r),"number"==typeof i&&(s-=i),o.translate(l,s)}return o.serialize()}var Pv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Ov(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3/4,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=e.size||10,a=e.width||o,s=e.height||o,l=new pg,u={};if(t)l.moveTo(a,0).lineTo(0,s/2).lineTo(a,s),u.fill="none";else{if(l.moveTo(0,s/2),l.lineTo(a,0),!n){var c=Ge(r,0,1);l.lineTo(a*c,s/2)}l.lineTo(a,s),l.close()}return Object.assign(Object.assign(Object.assign({},u),i),{tagName:"path",d:Mv(l.serialize(),{x:null!=e.offset?e.offset:-a/2})})}var Tv,Lv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},jv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Nv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Rv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Dv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Iv=function(e){var t=e.r,n=Dv(e,["r"]),r=t||5;return Object.assign(Object.assign({cx:r},n),{tagName:"circle",r:r})},Bv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},zv=Object.freeze(Object.defineProperty({__proto__:null,async:function(e){var t=e.width,n=e.height,r=e.offset,i=e.open,o=e.flip,a=Rv(e,["width","height","offset","open","flip"]),s=n||6,l=t||10,u=!0===i,c=!0===o,h=Object.assign(Object.assign({},a),{tagName:"path"});c&&(s=-s);var f=new pg;return f.moveTo(0,s).lineTo(l,0),u?h.fill="none":(f.lineTo(l,s),f.close()),h.d=Mv(f.serialize(),{x:r||-l/2,y:s/2}),h},block:function(e){return Ov({size:e.size,width:e.width,height:e.height,offset:e.offset},!0===e.open,!0,void 0,Pv(e,["size","width","height","offset","open"]))},circle:Iv,circlePlus:function(e){var t=e.r,n=Dv(e,["r"]),r=t||5,i=new pg;return i.moveTo(r,0).lineTo(r,2*r),i.moveTo(0,r).lineTo(2*r,r),{children:[Object.assign(Object.assign({},Iv({r:r})),{fill:"none"}),Object.assign(Object.assign({},n),{tagName:"path",d:Mv(i.serialize(),-r)})]}},classic:function(e){return Ov({size:e.size,width:e.width,height:e.height,offset:e.offset},!1,!1,e.factor,Pv(e,["size","width","height","offset","factor"]))},cross:function(e){var t=e.size,n=e.width,r=e.height,i=e.offset,o=Nv(e,["size","width","height","offset"]),a=t||10,s=n||a,l=r||a,u=new pg;return u.moveTo(0,0).lineTo(s,l).moveTo(0,l).lineTo(s,0),Object.assign(Object.assign({},o),{tagName:"path",fill:"none",d:Mv(u.serialize(),i||-s/2)})},diamond:function(e){var t=e.size,n=e.width,r=e.height,i=e.offset,o=Lv(e,["size","width","height","offset"]),a=t||10,s=n||a,l=r||a,u=new pg;return u.moveTo(0,l/2).lineTo(s/2,0).lineTo(s,l/2).lineTo(s/2,l).close(),Object.assign(Object.assign({},o),{tagName:"path",d:Mv(u.serialize(),null==i?-s/2:i)})},ellipse:function(e){var t=e.rx,n=e.ry,r=Bv(e,["rx","ry"]),i=t||5,o=n||5;return Object.assign(Object.assign({cx:i},r),{tagName:"ellipse",rx:i,ry:o})},path:function(e){var t=e.d,n=e.offsetX,r=e.offsetY,i=jv(e,["d","offsetX","offsetY"]);return Object.assign(Object.assign({},i),{tagName:"path",d:Mv(t,n,r)})}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=zv,e.registry=yg.create({type:"marker"}),e.registry.register(e.presets,!0)}(Tv||(Tv={})),function(e){e.normalize=Mv}(Tv||(Tv={}));var Fv=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Vv(e){return"string"==typeof e||Ye(e)}var Hv={qualify:Vv,set:function(e,t){return Gv("marker-start",e,t.view,t.attrs)}},Uv={qualify:Vv,set:function(e,t){return Gv("marker-end",e,t.view,t.attrs,{transform:"rotate(180)"})}},qv={qualify:Vv,set:function(e,t){return Gv("marker-mid",e,t.view,t.attrs)}};function Gv(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o="string"==typeof t?{name:t}:t,a=o.name,s=o.args,l=Fv(o,["name","args"]),u=l;if(a&&"string"==typeof a){var c=Tv.registry.get(a);if(!c)return Tv.registry.onNotFound(a);u=c(Object.assign(Object.assign({},l),s))}var h=Object.assign(Object.assign(Object.assign({},function(e,t){var n={},r=e.stroke;"string"==typeof r&&(n.stroke=r,n.fill=r);var i=e.strokeOpacity;null==i&&(i=e["stroke-opacity"]);null==i&&(i=e.opacity);null!=i&&(n["stroke-opacity"]=i,n["fill-opacity"]=i);if("marker-mid"!==t){var o=parseFloat(e.strokeWidth||e["stroke-width"]);if(Number.isFinite(o)&&o>1){var a=Math.ceil(o/2);n.refX="marker-start"===t?a:-a}}return n}(r,e)),i),u);return O({},e,"url(#".concat(n.graph.defineMarker(h),")"))}var Jv=function(e,t){return t.view.cell.isEdge()},Wv={qualify:Jv,set:function(e,t){var n,r,i,o,a,s=t.view,l=e.reverse||!1,u=e.stubs||0;if(Number.isFinite(u)&&0!==u)if(l){var c,h,f=s.getConnectionLength()||0;u<0?(c=(f+u)/2,h=-u):(c=u,h=f-2*u);var d=s.getConnection();a=null===(o=null===(i=null===(r=null===(n=null==d?void 0:d.divideAtLength(c))||void 0===n?void 0:n[1])||void 0===r?void 0:r.divideAtLength(h))||void 0===i?void 0:i[0])||void 0===o?void 0:o.serialize()}else{var g;if(u<0)g=((s.getConnectionLength()||0)+u)/2;else g=u;var v=s.getConnection();if(v){var p=v.divideAtLength(g),y=v.divideAtLength(-g);p&&y&&(a="".concat(p[0].serialize()," ").concat(y[1].serialize()))}}return{d:a||s.getConnectionPathData()}}},Yv={qualify:Jv,set:ep("getTangentAtLength",{rotate:!0})},Zv={qualify:Jv,set:ep("getTangentAtLength",{rotate:!1})},Xv={qualify:Jv,set:ep("getTangentAtRatio",{rotate:!0})},Kv={qualify:Jv,set:ep("getTangentAtRatio",{rotate:!1})},$v=Yv,Qv=Xv;function ep(e,t){var n={x:1,y:0};return function(r,i){var o,a,s=i.view,l=s[e](Number(r));return l?(a=t.rotate?l.vector().vectorAngle(n):0,o=l.start):(o=s.path.start,a=0),0===a?{transform:"translate(".concat(o.x,",").concat(o.y,"')")}:{transform:"translate(".concat(o.x,",").concat(o.y,"') rotate(").concat(a,")")}}}var tp,np=Object.freeze(Object.defineProperty({__proto__:null,annotations:mv,atConnectionLength:$v,atConnectionLengthIgnoreGradient:Zv,atConnectionLengthKeepGradient:Yv,atConnectionRatio:Qv,atConnectionRatioIgnoreGradient:Kv,atConnectionRatioKeepGradient:Xv,connection:Wv,displayEmpty:bv,eol:wv,fill:cv,filter:_v,html:{set:function(e,t){t.elem.innerHTML="".concat(e)}},lineHeight:vv,port:Av,ref:{},refCx:Jg,refCy:Wg,refD:Qg,refDKeepOffset:Zg,refDResetOffset:Yg,refDx:Bg,refDy:zg,refHeight:Vg,refHeight2:iv,refPoints:ev,refPointsKeepOffset:Kg,refPointsResetOffset:Xg,refR:$g,refRCircumscribed:Gg,refRInscribed:qg,refRx:Hg,refRy:Ug,refWidth:Fg,refWidth2:rv,refX:Dg,refX2:tv,refY:Ig,refY2:nv,resetOffset:{offset:function(e,t){var n=t.refBBox;return e?{x:-n.x,y:-n.y}:{x:0,y:0}}},sourceMarker:Hv,stroke:hv,style:Sv,targetMarker:Uv,text:fv,textPath:yv,textVerticalAnchor:pv,textWrap:dv,title:kv,vertexMarker:qv,xAlign:xv,yAlign:Cv},Symbol.toStringTag,{value:"Module"}));!function(e){e.isValidDefinition=function(e,t,n){if(null!=e){if("string"==typeof e)return!0;if("function"!=typeof e.qualify||hh(e.qualify,this,t,n))return!0}return!1}}(tp||(tp={})),function(e){e.presets=Object.assign(Object.assign({},Rg),np),e.registry=yg.create({type:"attribute definition"}),e.registry.register(e.presets,!0)}(tp||(tp={}));var rp,ip={prefixCls:"x6",autoInsertCSS:!0,useCSSSelector:!0,prefix:function(e){return"".concat(ip.prefixCls,"-").concat(e)}},op=ip.prefix("highlighted"),ap={highlight:function(e,t,n){af(t,n&&n.className||op)},unhighlight:function(e,t,n){sf(t,n&&n.className||op)}},sp=ip.prefix("highlight-opacity"),lp={highlight:function(e,t){af(t,sp)},unhighlight:function(e,t){sf(t,sp)}};!function(e){function t(e,t){var n,r,i,o=(n=e.x,r=e.y,i=vf("svg").createSVGPoint(),i.x=n,i.y=r,i).matrixTransform(t);return new Wd(o.x,o.y)}function n(e,t){var n=vf("svg").createSVGPoint();n.x=e.x,n.y=e.y;var r=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y;var i=n.matrixTransform(t);n.x=e.x+e.width,n.y=e.y+e.height;var o=n.matrixTransform(t);n.x=e.x,n.y=e.y+e.height;var a=n.matrixTransform(t),s=Math.min(r.x,i.x,o.x,a.x),l=Math.max(r.x,i.x,o.x,a.x),u=Math.min(r.y,i.y,o.y,a.y),c=Math.max(r.y,i.y,o.y,a.y);return new Yd(s,u,l-s,c-u)}function r(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.ownerSVGElement||!hf(e)){if(Ef(e)){var a=i(e),s=a.left,l=a.top,u=a.width,c=a.height;return new Yd(s,l,u,c)}return new Yd(0,0,0,0)}var h=o.target;if(!o.recursive){try{t=e.getBBox()}catch(Kk){t={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}return h?n(t,_d(e,h)):Yd.create(t)}var f=e.childNodes,d=f.length;if(0===d)return r(e,{target:h});h||(h=e);for(var g=0;g<d;g+=1){var v=f[g],p=void 0;p=0===v.childNodes.length?r(v,{target:h}):r(v,{target:h,recursive:!0}),t=t?t.union(p):p}return t}function i(e){var t=0,n=0,r=0,i=0;if(e){for(var o=e;o;)t+=o.offsetLeft,n+=o.offsetTop,(o=o.offsetParent)&&(t+=parseInt(qf(o,"borderLeft"),10),n+=parseInt(qf(o,"borderTop"),10));r=e.offsetWidth,i=e.offsetHeight}return{left:t,top:n,width:r,height:i}}function o(e){var t=function(t){var n=e.getAttribute(t),r=n?parseFloat(n):0;return Number.isNaN(r)?0:r};switch(e instanceof SVGElement&&e.nodeName.toLowerCase()){case"rect":return new Yd(t("x"),t("y"),t("width"),t("height"));case"circle":return new Xd(t("cx"),t("cy"),t("r"),t("r"));case"ellipse":return new Xd(t("cx"),t("cy"),t("rx"),t("ry"));case"polyline":var n=sd(e);return new rg(n);case"polygon":var i=sd(e);return i.length>1&&i.push(i[0]),new rg(i);case"path":var o=e.getAttribute("d");return pg.isValid(o)||(o=pg.normalize(o)),pg.parse(o);case"line":return new Zd(t("x1"),t("y1"),t("x2"),t("y2"))}return r(e)}function a(e){if(null==e)return null;var t=e;do{var n=t.tagName;if("string"!=typeof n)return null;if(n=n.toUpperCase(),of(t,"x6-port"))t=t.nextElementSibling;else if("G"===n)t=t.firstElementChild;else{if("TITLE"!==n)break;t=t.nextElementSibling}}while(t);return t}e.normalizeMarker=Mv,e.transformPoint=t,e.transformLine=function(e,n){return new Zd(t(e.start,n),t(e.end,n))},e.transformPolyline=function(e,n){var r=e instanceof rg?e.points:e;return Array.isArray(r)||(r=[]),new rg(r.map((function(e){return t(e,n)})))},e.transformRectangle=n,e.bbox=function(e,t,r){var i,o=e.ownerSVGElement;if(!o)return new Yd(0,0,0,0);try{i=e.getBBox()}catch(Kk){i={x:e.clientLeft,y:e.clientTop,width:e.clientWidth,height:e.clientHeight}}return t?Yd.create(i):n(i,_d(e,r||o))},e.getBBox=r,e.getBoundingOffsetRect=i,e.toGeometryShape=o,e.translateAndAutoOrient=function(e,t,n,i){var o=Wd.create(t),a=Wd.create(n);i||(i=e instanceof SVGSVGElement?e:e.ownerSVGElement);var s=Sd(e);e.setAttribute("transform","");var l=r(e,{target:i}).scale(s.sx,s.sy),u=yd();u.setTranslate(-l.x-l.width/2,-l.y-l.height/2);var c=yd(),h=o.angleBetween(a,o.clone().translate(1,0));h&&c.setRotate(h,0,0);var f=yd(),d=o.clone().move(a,l.width/2);f.setTranslate(2*o.x-d.x,2*o.y-d.y);var g=_d(e,i),v=yd();v.setMatrix(f.matrix.multiply(c.matrix.multiply(u.matrix.multiply(g.scale(s.sx,s.sy))))),e.setAttribute("transform",wd(v.matrix))},e.findShapeNode=a,e.getBBoxV2=function(e){var t=a(e);if(!hf(t)){if(Ef(e)){var n=i(e),r=n.left,s=n.top,l=n.width,u=n.height;return new Yd(r,s,l,u)}return new Yd(0,0,0,0)}return o(t).bbox()||Yd.create()}}(rp||(rp={}));var up,cp={padding:3,rx:0,ry:0,attrs:{"stroke-width":3,stroke:"#FEB663"}},hp={highlight:function(e,t,n){var r=up.getHighlighterId(t,n);if(!up.hasCache(r)){n=Ze({},n,cp);var i,o,a=Xf.create(t);try{i=a.toPathData()}catch(w){o=rp.bbox(a.node,!0),i=ld(Object.assign(Object.assign({},n),o))}var s=vf("path");if(Tf(s,Object.assign({d:i,"pointer-events":"none","vector-effect":"non-scaling-stroke",fill:"none"},n.attrs?jf(n.attrs):null)),e.isEdgeElement(t))Tf(s,"d",e.getConnectionPathData());else{var l=a.getTransformToElement(e.container),u=n.padding;if(u){null==o&&(o=rp.bbox(a.node,!0));var c=o.x+o.width/2,h=o.y+o.height/2;o=rp.transformRectangle(o,l);var f=Math.max(o.width,1),d=Math.max(o.height,1),g=(f+u)/f,v=(d+u)/d,p=pd({a:g,b:0,c:0,d:v,e:c-g*c,f:h-v*h});l=l.multiply(p)}xd(s,l)}af(s,ip.prefix("highlight-stroke"));var y=e.cell,m=function(){return up.removeHighlighter(r)};y.on("removed",m),y.model&&y.model.on("reseted",m),e.container.appendChild(s),up.setCache(r,s)}},unhighlight:function(e,t,n){up.removeHighlighter(up.getHighlighterId(t,n))}};!function(e){e.getHighlighterId=function(e,t){return cf(e),e.id+JSON.stringify(t)};var t={};e.setCache=function(e,n){t[e]=n},e.hasCache=function(e){return null!=t[e]},e.removeHighlighter=function(e){var n=t[e];n&&(bf(n),delete t[e])}}(up||(up={}));var fp,dp=Object.freeze(Object.defineProperty({__proto__:null,className:ap,opacity:lp,stroke:hp},Symbol.toStringTag,{value:"Module"}));function gp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Wd(Lh(t.x,e.width),Lh(t.y,e.height))}function vp(e,t,n){return Object.assign({angle:t,position:e.toJSON()},n)}!function(e){e.check=function(e,t){if("function"!=typeof t.highlight)throw new Error("Highlighter '".concat(e,"' is missing required `highlight()` method"));if("function"!=typeof t.unhighlight)throw new Error("Highlighter '".concat(e,"' is missing required `unhighlight()` method"))}}(fp||(fp={})),function(e){e.presets=dp,e.registry=yg.create({type:"highlighter"}),e.registry.register(e.presets,!0)}(fp||(fp={}));function pp(e,t,n,r){var i=t.getCenter(),o=t.getTopCenter(),a=t.width/t.height,s=Xd.fromRect(t),l=e.length;return e.map((function(e,t){var u=n+r(t,l),c=o.clone().rotate(-u,i).scale(a,1,i),h=e.compensateRotate?-s.tangentTheta(c):0;return(e.dx||e.dy)&&c.translate(e.dx||0,e.dy||0),e.dr&&c.move(i,e.dr),vp(c.round(),h,e)}))}var yp=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function mp(e,t,n,r){var i=new Zd(t,n),o=e.length;return e.map((function(e,t){var n=e.strict,a=yp(e,["strict"]),s=n||r.strict?(t+1)/(o+1):(t+.5)/o,l=i.pointAt(s);return(a.dx||a.dy)&&l.translate(a.dx||0,a.dy||0),vp(l.round(),0,a)}))}var wp,bp=Object.freeze(Object.defineProperty({__proto__:null,absolute:function(e,t){return e.map((function(e){var n=e.x,r=e.y,i=e.angle;return vp(gp(t,{x:n,y:r}),i||0)}))},bottom:function(e,t,n){return mp(e,t.getBottomLeft(),t.getBottomRight(),n)},ellipse:function(e,t,n){var r=n.start||0,i=n.step||20;return pp(e,t,r,(function(e,t){return(e+.5-t/2)*i}))},ellipseSpread:function(e,t,n){var r=n.start||0,i=n.step||360/e.length;return pp(e,t,r,(function(e){return e*i}))},left:function(e,t,n){return mp(e,t.getTopLeft(),t.getBottomLeft(),n)},line:function(e,t,n){return mp(e,gp(t,n.start||t.getOrigin()),gp(t,n.end||t.getCorner()),n)},right:function(e,t,n){return mp(e,t.getTopRight(),t.getBottomRight(),n)},top:function(e,t,n){return mp(e,t.getTopLeft(),t.getTopRight(),n)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=bp,e.registry=yg.create({type:"port layout"}),e.registry.register(e.presets,!0)}(wp||(wp={}));var kp={position:{x:0,y:0},angle:0,attrs:{".":{y:"0","text-anchor":"start"}}};function xp(e,t){var n=t||{},r=n.x,i=n.y,o=n.angle,a=n.attrs;return Ze({},{angle:o,attrs:a,position:{x:r,y:i}},e,kp)}function Cp(e,t,n,r){var i,o,a,s,l=null!=r.offset?r.offset:15,u=t.getCenter().theta(e),c=Sp(t),h=0;return u<c[1]||u>c[2]?(i=".3em",o=l,a=0,s="start"):u<c[0]?(i="0",o=0,a=-l,n?(h=-90,s="start"):s="middle"):u<c[3]?(i=".3em",o=-l,a=0,s="end"):(i=".6em",o=0,a=l,n?(h=90,s="start"):s="middle"),xp({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:i,"text-anchor":s}}},r)}function Ep(e,t,n,r){var i,o,a,s,l=null!=r.offset?r.offset:15,u=t.getCenter().theta(e),c=Sp(t),h=0;return u<c[1]||u>c[2]?(i=".3em",o=-l,a=0,s="end"):u<c[0]?(i=".6em",o=0,a=l,n?(h=90,s="start"):s="middle"):u<c[3]?(i=".3em",o=l,a=0,s="start"):(i="0em",o=0,a=-l,n?(h=-90,s="start"):s="middle"),xp({position:{x:Math.round(o),y:Math.round(a)},angle:h,attrs:{".":{y:i,"text-anchor":s}}},r)}function Sp(e){var t=e.getCenter(),n=t.theta(e.getTopLeft()),r=t.theta(e.getBottomLeft()),i=t.theta(e.getBottomRight());return[n,t.theta(e.getTopRight()),i,r]}function _p(e,t,n){var r,i=null!=n.offset?n.offset:20,o=new Wd(0,0),a=-e.theta(o),s=".3em",l=a;return(a+90)%180==0?(r=t?"end":"middle",t||-270!==a||(s="0em")):a>-270&&a<-90?(r="start",l=a-180):r="end",xp({position:e.clone().move(o,i).diff(e).round().round().toJSON(),angle:t?l:0,attrs:{".":{y:s,"text-anchor":r}}},n)}var Ap,Mp=Object.freeze(Object.defineProperty({__proto__:null,bottom:function(e,t,n){return xp({position:{x:0,y:15},attrs:{".":{y:".6em","text-anchor":"middle"}}},n)},inside:function(e,t,n){return Ep(e,t,!1,n)},insideOriented:function(e,t,n){return Ep(e,t,!0,n)},left:function(e,t,n){return xp({position:{x:-15,y:0},attrs:{".":{y:".3em","text-anchor":"end"}}},n)},manual:function(e,t,n){return xp({position:t.getTopLeft()},n)},outside:function(e,t,n){return Cp(e,t,!1,n)},outsideOriented:function(e,t,n){return Cp(e,t,!0,n)},radial:function(e,t,n){return _p(e.diff(t.getCenter()),!1,n)},radialOriented:function(e,t,n){return _p(e.diff(t.getCenter()),!0,n)},right:function(e,t,n){return xp({position:{x:15,y:0},attrs:{".":{y:".3em","text-anchor":"start"}}},n)},top:function(e,t,n){return xp({position:{x:0,y:-15},attrs:{".":{"text-anchor":"middle"}}},n)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Mp,e.registry=yg.create({type:"port label layout"}),e.registry.register(e.presets,!0)}(Ap||(Ap={}));var Pp,Op=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Tp=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.call(this)).cid=Pp.uniqueId(),n.views[e.cid]=f(e),e}return P(n,[{key:"priority",get:function(){return 2}},{key:"disposeContainer",get:function(){return!0}},{key:"confirmUpdate",value:function(e,t){return 0}},{key:"empty",value:function(){return kf(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container),this}},{key:"unmount",value:function(){return bf(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container),this}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container;return e===this.container?(this.removeEventListeners(document),this.onRemove(),delete n.views[this.cid],this.disposeContainer&&this.unmount(e)):this.unmount(e),this}},{key:"onRemove",value:function(){}},{key:"setClass",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container).classList.value=Array.isArray(e)?e.join(" "):e}},{key:"addClass",value:function(e){return af(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,Array.isArray(e)?e.join(" "):e),this}},{key:"removeClass",value:function(e){return sf(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,Array.isArray(e)?e.join(" "):e),this}},{key:"setStyle",value:function(e){return Jf(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,e),this}},{key:"setAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;return null!=e&&null!=t&&Tf(t,e),this}},{key:"findAttr",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;t&&1===t.nodeType;){var n=t.getAttribute(e);if(null!=n)return n;if(t===this.container)return null;t=t.parentNode}return null}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors;return n.find(e,t,r).elems}},{key:"findOne",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.selectors,r=this.find(e,t,n);return r.length>0?r[0]:null}},{key:"findByAttr",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;t&&t.getAttribute;){var n=t.getAttribute(e);if((null!=n||t===this.container)&&"false"!==n)return t;t=t.parentNode}return null}},{key:"getSelector",value:function(e,t){var n;if(e===this.container)return"string"==typeof t&&(n="> ".concat(t)),n;if(e){var r=yf(e)+1;n="".concat(e.tagName.toLowerCase(),":nth-child(").concat(r,")"),t&&(n+=" > ".concat(t)),n=this.getSelector(e.parentNode,n)}return n}},{key:"prefixClassName",value:function(e){return ip.prefix(e)}},{key:"delegateEvents",value:function(e,t){var n=this;if(null==e)return this;t||this.undelegateEvents();var r=/^(\S+)\s*(.*)$/;return Object.keys(e).forEach((function(t){var i=t.match(r);if(null!=i){var o=n.getEventHandler(e[t]);"function"==typeof o&&n.delegateEvent(i[1],i[2],o)}})),this}},{key:"undelegateEvents",value:function(){return Pd.off(this.container,this.getEventNamespace()),this}},{key:"delegateDocumentEvents",value:function(e,t){return this.addEventListeners(document,e,t),this}},{key:"undelegateDocumentEvents",value:function(){return this.removeEventListeners(document),this}},{key:"delegateEvent",value:function(e,t,n){return Pd.on(this.container,e+this.getEventNamespace(),t,n),this}},{key:"undelegateEvent",value:function(e,t,n){var r=e+this.getEventNamespace();return null==t?Pd.off(this.container,r):"string"==typeof t?Pd.off(this.container,r,t,n):Pd.off(this.container,r,t),this}},{key:"addEventListeners",value:function(e,t,n){var r=this;if(null==t)return this;var i=this.getEventNamespace();return Object.keys(t).forEach((function(o){var a=r.getEventHandler(t[o]);"function"==typeof a&&Pd.on(e,o+i,n,a)})),this}},{key:"removeEventListeners",value:function(e){return null!=e&&Pd.off(e,this.getEventNamespace()),this}},{key:"getEventNamespace",value:function(){return".".concat(ip.prefixCls,"-event-").concat(this.cid)}},{key:"getEventHandler",value:function(e){var t,n=this;if("string"==typeof e){var r=this[e];"function"==typeof r&&(t=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r.call.apply(r,[n].concat(t))})}else t=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.call.apply(e,[n].concat(r))};return t}},{key:"getEventTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.target,r=e.type,i=e.clientX,o=void 0===i?0:i,a=e.clientY,s=void 0===a?0:a;return t.fromPoint||"touchmove"===r||"touchend"===r?document.elementFromPoint(o,s):n}},{key:"stopPropagation",value:function(e){return this.setEventData(e,{propagationStopped:!0}),this}},{key:"isPropagationStopped",value:function(e){return!0===this.getEventData(e).propagationStopped}},{key:"getEventData",value:function(e){return this.eventData(e)}},{key:"setEventData",value:function(e,t){return this.eventData(e,t)}},{key:"eventData",value:function(e,t){if(null==e)throw new TypeError("Event object required");var n=e.data,r="__".concat(this.cid,"__");return null==t?null==n?{}:n[r]||{}:(null==n&&(n=e.data={}),null==n[r]?n[r]=Object.assign({},t):n[r]=Object.assign(Object.assign({},n[r]),t),n[r])}},{key:"normalizeEvent",value:function(e){return n.normalizeEvent(e)}},{key:"dispose",value:function(){this.remove()}}]),n}(Eh);Op([Tp.dispose()],Tp.prototype,"dispose",null),function(e){e.createElement=function(e,t){return t?vf(e||"g"):gf(e||"div")},e.find=function(e,t,n){if(!e||"."===e)return{elems:[t]};if(n){var r=n[e];if(r)return{elems:Array.isArray(r)?r:[r]}}var i=e.includes(">")?":scope ".concat(e):e;return{isCSSSelector:!0,elems:Array.prototype.slice.call(t.querySelectorAll(i))}},e.normalizeEvent=function(e){var t=e,n=e.originalEvent,r=n&&n.changedTouches&&n.changedTouches[0];if(r){for(var i in e)void 0===r[i]&&(r[i]=e[i]);t=r}return t}}(Tp||(Tp={})),function(e){e.views={},e.getView=function(t){return e.views[t]||null}}(Tp||(Tp={})),function(e){var t=0;e.uniqueId=function(){var e="v".concat(t);return t+=1,e}}(Pp||(Pp={}));var Lp,jp=function(){function e(t){A(this,e),this.view=t,this.clean()}return P(e,[{key:"clean",value:function(){this.elemCache&&this.elemCache.dispose(),this.elemCache=new Hd,this.pathCache={}}},{key:"get",value:function(e){return this.elemCache.has(e)||this.elemCache.set(e,{}),this.elemCache.get(e)}},{key:"getData",value:function(e){var t=this.get(e);return t.data||(t.data={}),t.data}},{key:"getMatrix",value:function(e){var t=this.get(e);if(null==t.matrix){var n=this.view.container;t.matrix=function(e,t){var n=pd();if(hf(t)&&hf(e)){for(var r=e,i=[];r&&r!==t;){var o=md(r.getAttribute("transform")||null);i.push(o),r=r.parentNode}i.reverse().forEach((function(e){n=n.multiply(e)}))}return n}(e,n)}return pd(t.matrix)}},{key:"getShape",value:function(e){var t=this.get(e);return null==t.shape&&(t.shape=rp.toGeometryShape(e)),t.shape.clone()}},{key:"getBoundingRect",value:function(e){var t=this.get(e);return null==t.boundingRect&&(t.boundingRect=rp.getBBoxV2(e)),t.boundingRect.clone()}}]),e}();!function(e){function t(e){return null!=e&&"string"==typeof e}function n(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:ff.svg},n=document.createDocumentFragment(),r={},i={},o=[{markup:Array.isArray(e)?e:[e],parent:n,ns:t.ns}],a=function(){var e=o.pop(),t=e.ns||ff.svg,n=e.markup,a=e.parent;n.forEach((function(e){var n=e.tagName;if(!n)throw new TypeError("Invalid tagName");e.ns&&(t=e.ns);var s=t?gf(n,t):df(n),l=e.attrs;l&&Tf(s,jf(l));var u=e.style;u&&Jf(s,u);var c=e.className;null!=c&&s.setAttribute("class",Array.isArray(c)?c.join(" "):c),e.textContent&&(s.textContent=e.textContent);var h=e.selector;if(null!=h){if(i[h])throw new TypeError("Selector must be unique");i[h]=s}if(e.groupSelector){var f=e.groupSelector;Array.isArray(f)||(f=[f]),f.forEach((function(e){r[e]||(r[e]=[]),r[e].push(s)}))}a.appendChild(s);var d=e.children;Array.isArray(d)&&o.push({ns:t,markup:d,parent:s})}))};o.length>0;)a();return Object.keys(r).forEach((function(e){if(i[e])throw new Error("Ambiguous group selector");i[e]=r[e]})),{fragment:n,selectors:i,groups:r}}function r(e){return e instanceof SVGElement?vf("g"):df("div")}e.isJSONMarkup=function(e){return null!=e&&!t(e)},e.isStringMarkup=t,e.clone=function(e){return null==e||t(e)?e:Xe(e)},e.sanitize=function(e){return"".concat(e).trim().replace(/[\r|\n]/g," ").replace(/>\s+</g,"><")},e.parseJSONMarkup=n,e.renderMarkup=function(e){if(t(e)){var i=Xf.createVectors(e),o=i.length;if(1===o)return{elem:i[0].node};if(o>1){var a=r(i[0].node);return i.forEach((function(e){a.appendChild(e.node)})),{elem:a}}return{}}var s=n(e),l=s.fragment,u=null;return l.childNodes.length>1?(u=r(l.firstChild)).appendChild(l):u=l.firstChild,{elem:u,selectors:s.selectors}},e.parseLabelStringMarkup=function(e){for(var t=Xf.createVectors(e),n=document.createDocumentFragment(),r=0,i=t.length;r<i;r+=1){var o=t[r].node;n.appendChild(o)}return{fragment:n,selectors:{}}}}(Lp||(Lp={})),function(e){e.getSelector=function e(t,n,r){if(null!=t){var i,o=t.tagName.toLowerCase();if(t===n)return i="string"==typeof r?"> ".concat(o," > ").concat(r):"> ".concat(o);var a=t.parentNode;if(a&&a.childNodes.length>1){var s=yf(t)+1;i="".concat(o,":nth-child(").concat(s,")")}else i=o;return r&&(i+=" > ".concat(r)),e(t.parentNode,n,i)}return r}}(Lp||(Lp={})),function(e){e.getPortContainerMarkup=function(){return"g"},e.getPortMarkup=function(){return{tagName:"circle",selector:"circle",attrs:{r:10,fill:"#FFFFFF",stroke:"#000000"}}},e.getPortLabelMarkup=function(){return{tagName:"text",selector:"text",attrs:{fill:"#000000"}}}}(Lp||(Lp={})),function(e){e.getEdgeMarkup=function(){return[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}]}}(Lp||(Lp={})),function(e){e.getForeignObjectMarkup=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{tagName:"foreignObject",selector:"fo",children:[{ns:ff.xhtml,tagName:"body",selector:"foBody",attrs:{xmlns:ff.xhtml},style:{width:"100%",height:"100%",background:"transparent"},children:e?[]:[{tagName:"div",selector:"foContent",style:{width:"100%",height:"100%"}}]}]}}}(Lp||(Lp={}));var Np=function(){function e(t){A(this,e),this.view=t}return P(e,[{key:"cell",get:function(){return this.view.cell}},{key:"getDefinition",value:function(e){return this.cell.getAttrDefinition(e)}},{key:"processAttrs",value:function(e,t){var n,r,i,o,a=this,s=[];return Object.keys(t).forEach((function(r){var i=t[r],o=a.getDefinition(r),l=hh(tp.isValidDefinition,a.view,o,i,{elem:e,attrs:t,cell:a.cell,view:a.view});if(o&&l)"string"==typeof o?(null==n&&(n={}),n[o]=i):null!==i&&s.push({name:r,definition:o});else{null==n&&(n={});var u=Af.includes(r)?r:_h(r);n[u]=i}})),s.forEach((function(e){var n=e.name,a=e.definition,s=t[n];"function"==typeof a.set&&(null==r&&(r={}),r[n]=s),"function"==typeof a.offset&&(null==i&&(i={}),i[n]=s),"function"==typeof a.position&&(null==o&&(o={}),o[n]=s)})),{raw:t,normal:n,set:r,offset:i,position:o}}},{key:"mergeProcessedAttrs",value:function(e,t){e.set=Object.assign(Object.assign({},e.set),t.set),e.position=Object.assign(Object.assign({},e.position),t.position),e.offset=Object.assign(Object.assign({},e.offset),t.offset);var n=e.normal&&e.normal.transform;null!=n&&t.normal&&(t.normal.transform=n),e.normal=t.normal}},{key:"findAttrs",value:function(e,t,n,r){var i=[],o=new Hd;return Object.keys(e).forEach((function(a){var s=e[a];if(Ye(s)){var l=Tp.find(a,t,r),u=l.isCSSSelector,c=l.elems;n[a]=c;for(var h=0,f=c.length;h<f;h+=1){var d=c[h],g=r&&r[a]===d,v=o.get(d);if(v){v.array||(i.push(d),v.array=!0,v.attrs=[v.attrs],v.priority=[v.priority]);var p=v.attrs,y=v.priority;if(g)p.unshift(s),y.unshift(-1);else{var m=Ke(y,u?-1:f);p.splice(m,0,s),y.splice(m,0,f)}}else o.set(d,{elem:d,attrs:s,priority:g?-1:f,array:!1})}}})),i.forEach((function(e){var t=o.get(e),n=t.attrs;t.attrs=n.reduceRight((function(e,t){return $e(e,t)}),{})})),o}},{key:"updateRelativeAttrs",value:function(e,t,n){var r=this,i=t.raw||{},o=t.normal||{},a=t.set,s=t.position,l=t.offset,u=function(){return{elem:e,cell:r.cell,view:r.view,attrs:i,refBBox:n.clone()}};if(null!=a&&Object.keys(a).forEach((function(e){var t=a[e],n=r.getDefinition(e);if(null!=n){var i=hh(n.set,r.view,t,u());"object"===v(i)?o=Object.assign(Object.assign({},o),i):null!=i&&(o[e]=i)}})),e instanceof HTMLElement)this.view.setAttrs(o,e);else{var c=o.transform,h=md(c?"".concat(c):null),f=new Wd(h.e,h.f);c&&(delete o.transform,h.e=0,h.f=0);var d=!1;null!=s&&Object.keys(s).forEach((function(e){var t=s[e],n=r.getDefinition(e);if(null!=n){var i=hh(n.position,r.view,t,u());null!=i&&(d=!0,f.translate(Wd.create(i)))}})),this.view.setAttrs(o,e);var g=!1;if(null!=l){var p=this.view.getBoundingRectOfElement(e);if(p.width>0&&p.height>0){var y=rp.transformRectangle(p,h);Object.keys(l).forEach((function(t){var n=l[t],o=r.getDefinition(t);if(null!=o){var a=hh(o.offset,r.view,n,{elem:e,cell:r.cell,view:r.view,attrs:i,refBBox:y});null!=a&&(g=!0,f.translate(Wd.create(a)))}}))}}(null!=c||d||g)&&(f.round(1),h.e=f.x,h.f=f.y,e.setAttribute("transform",wd(h)))}}},{key:"update",value:function(e,t,n){var r=this,i={},o=this.findAttrs(n.attrs||t,e,i,n.selectors),a=n.attrs?this.findAttrs(t,e,i,n.selectors):o,s=[];o.each((function(t){var o=t.elem,l=t.attrs,u=r.processAttrs(o,l);if(null==u.set&&null==u.position&&null==u.offset)r.view.setAttrs(u.normal,o);else{var c,h=a.get(o),f=h?h.attrs:null,d=f&&null==l.ref?f.ref:l.ref;if(d){if(!(c=(i[d]||r.view.find(d,e,n.selectors))[0]))throw new Error('"'.concat(d,'" reference does not exist.'))}else c=null;var g={node:o,refNode:c,attributes:f,processedAttributes:u},v=s.findIndex((function(e){return e.refNode===o}));v>-1?s.splice(v,0,g):s.push(g)}}));var l,u=new Hd;s.forEach((function(t){var i,o,a=t.node,s=t.refNode,c=null!=s&&null!=n.rotatableNode&&wf(n.rotatableNode,s);if(s&&(i=u.get(s)),!i){var h=c?n.rotatableNode:e;i=s?rp.getBBox(s,{target:h}):n.rootBBox,s&&u.set(s,i)}n.attrs&&t.attributes?(o=r.processAttrs(a,t.attributes),r.mergeProcessedAttrs(o,t.processedAttributes)):o=t.processedAttributes;var f=i;c&&null!=n.rotatableNode&&!n.rotatableNode.contains(a)&&(l||(l=md(Tf(n.rotatableNode,"transform"))),f=rp.transformRectangle(i,l)),r.updateRelativeAttrs(a,o,f)}))}}]),e}(),Rp=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];A(this,e),this.view=t;var i={},o={},a=0;Object.keys(n).forEach((function(e){var t=n[e];Array.isArray(t)||(t=[t]),t.forEach((function(t){var n=i[t];n||(a+=1,n=i[t]=1<<a),o[e]|=n}))}));var s=r;if(Array.isArray(s)||(s=[s]),s.forEach((function(e){i[e]||(a+=1,i[e]=1<<a)})),a>25)throw new Error("Maximum number of flags exceeded.");this.flags=i,this.attrs=o,this.bootstrap=r}return P(e,[{key:"cell",get:function(){return this.view.cell}},{key:"getFlag",value:function(e){var t=this.flags;return null==t?0:Array.isArray(e)?e.reduce((function(e,n){return e|t[n]}),0):0|t[e]}},{key:"hasAction",value:function(e,t){return e&this.getFlag(t)}},{key:"removeAction",value:function(e,t){return e^e&this.getFlag(t)}},{key:"getBootstrapFlag",value:function(){return this.getFlag(this.bootstrap)}},{key:"getChangedFlag",value:function(){var e=this,t=0;return this.attrs?(Object.keys(this.attrs).forEach((function(n){e.cell.hasChanged(n)&&(t|=e.attrs[n])})),t):t}}]),e}(),Dp=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ip=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Bp=function(e,t){l(r,e);var n=c(r);function r(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return A(this,r),(t=n.call(this)).cell=e,t.options=t.ensureOptions(i),t.graph=t.options.graph,t.attr=new Np(f(t)),t.flag=new Rp(f(t),t.options.actions,t.options.bootstrap),t.cache=new jp(f(t)),t.setContainer(t.ensureContainer()),t.setup(),t.init(),t}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"init",value:function(){}},{key:"onRemove",value:function(){this.removeTools()}},{key:"priority",get:function(){return this.options.priority}},{key:"rootSelector",get:function(){return this.options.rootSelector}},{key:"getConstructor",value:function(){return this.constructor}},{key:"ensureOptions",value:function(e){return this.getConstructor().getOptions(e)}},{key:"getContainerTagName",value:function(){return this.options.isSvgElement?"g":"div"}},{key:"getContainerStyle",value:function(){}},{key:"getContainerAttrs",value:function(){return{"data-cell-id":this.cell.id,"data-shape":this.cell.shape}}},{key:"getContainerClassName",value:function(){return this.prefixClassName("cell")}},{key:"ensureContainer",value:function(){return Tp.createElement(this.getContainerTagName(),this.options.isSvgElement)}},{key:"setContainer",value:function(e){if(this.container!==e){this.undelegateEvents(),this.container=e,null!=this.options.events&&this.delegateEvents(this.options.events);var t=this.getContainerAttrs();null!=t&&this.setAttrs(t,e);var n=this.getContainerStyle();null!=n&&this.setStyle(n,e);var r=this.getContainerClassName();null!=r&&this.addClass(r,e)}return this}},{key:"isNodeView",value:function(){return!1}},{key:"isEdgeView",value:function(){return!1}},{key:"render",value:function(){return this}},{key:"confirmUpdate",value:function(e){return 0}},{key:"getBootstrapFlag",value:function(){return this.flag.getBootstrapFlag()}},{key:"getFlag",value:function(e){return this.flag.getFlag(e)}},{key:"hasAction",value:function(e,t){return this.flag.hasAction(e,t)}},{key:"removeAction",value:function(e,t){return this.flag.removeAction(e,t)}},{key:"handleAction",value:function(e,t,n,r){if(this.hasAction(e,t)){n();var i=[t];return r&&("string"==typeof r?i.push(r):i.push.apply(i,p(r))),this.removeAction(e,i)}return e}},{key:"setup",value:function(){this.cell.on("changed",this.onCellChanged,this)}},{key:"onCellChanged",value:function(e){var t=e.options;this.onAttrsChange(t)}},{key:"onAttrsChange",value:function(e){var t=this.flag.getChangedFlag();!e.updated&&t&&(e.dirty&&this.hasAction(t,"update")&&(t|=this.getFlag("render")),e.toolId&&(e.async=!1),null!=this.graph&&this.graph.renderer.requestViewUpdate(this,t,e))}},{key:"parseJSONMarkup",value:function(e,t){var n=Lp.parseJSONMarkup(e),r=n.selectors,i=this.rootSelector;if(t&&i){if(r[i])throw new Error("Invalid root selector");r[i]=t}return n}},{key:"can",value:function(e){var t=this.graph.options.interacting;if("function"==typeof t&&(t=hh(t,this.graph,this)),"object"===v(t)){var n=t[e];return"function"==typeof n&&(n=hh(n,this.graph,this)),!1!==n}return"boolean"==typeof t&&t}},{key:"cleanCache",value:function(){return this.cache.clean(),this}},{key:"getCache",value:function(e){return this.cache.get(e)}},{key:"getDataOfElement",value:function(e){return this.cache.getData(e)}},{key:"getMatrixOfElement",value:function(e){return this.cache.getMatrix(e)}},{key:"getShapeOfElement",value:function(e){return this.cache.getShape(e)}},{key:"getBoundingRectOfElement",value:function(e){return this.cache.getBoundingRect(e)}},{key:"getBBoxOfElement",value:function(e){var t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),r=this.getRootRotatedMatrix(),i=this.getRootTranslatedMatrix();return rp.transformRectangle(t,i.multiply(r).multiply(n))}},{key:"getUnrotatedBBoxOfElement",value:function(e){var t=this.getBoundingRectOfElement(e),n=this.getMatrixOfElement(e),r=this.getRootTranslatedMatrix();return rp.transformRectangle(t,r.multiply(n))}},{key:"getBBox",value:function(){var e;if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useCellGeometry){var t=this.cell,n=t.isNode()?t.getAngle():0;e=t.getBBox().bbox(n)}else e=this.getBBoxOfElement(this.container);return this.graph.coord.localToGraphRect(e)}},{key:"getRootTranslatedMatrix",value:function(){var e=this.cell,t=e.isNode()?e.getPosition():{x:0,y:0};return pd().translate(t.x,t.y)}},{key:"getRootRotatedMatrix",value:function(){var e=pd(),t=this.cell,n=t.isNode()?t.getAngle():0;if(n){var r=t.getBBox(),i=r.width/2,o=r.height/2;e=e.translate(i,o).rotate(n).translate(-i,-o)}return e}},{key:"findMagnet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.container;return this.findByAttr("magnet",e)}},{key:"updateAttrs",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null==n.rootBBox&&(n.rootBBox=new Yd),null==n.selectors&&(n.selectors=this.selectors),this.attr.update(e,t,n)}},{key:"isEdgeElement",value:function(e){return this.cell.isEdge()&&(null==e||e===this.container)}},{key:"prepareHighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e||this.container;return t.partial=n===this.container,n}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.prepareHighlight(e,t);return this.notify("cell:highlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isEdgeView()?this.notify("edge:highlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}):this.isNodeView()&&this.notify("node:highlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}),this}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.prepareHighlight(e,t);return this.notify("cell:unhighlight",{magnet:n,options:t,view:this,cell:this.cell}),this.isNodeView()?this.notify("node:unhighlight",{magnet:n,options:t,view:this,node:this.cell,cell:this.cell}):this.isEdgeView()&&this.notify("edge:unhighlight",{magnet:n,options:t,view:this,edge:this.cell,cell:this.cell}),this}},{key:"notifyUnhighlight",value:function(e,t){}},{key:"getEdgeTerminal",value:function(e,t,n,r,i){var o=this.cell,a=this.findAttr("port",e),s=e.getAttribute("data-selector"),l={cell:o.id};return null!=s&&(l.magnet=s),null!=a?(l.port=a,o.isNode()&&(o.hasPort(a)||null!=s||(l.selector=this.getSelector(e)))):null==s&&this.container!==e&&(l.selector=this.getSelector(e)),l}},{key:"getMagnetFromEdgeTerminal",value:function(e){var t,n=this.cell,r=this.container,i=e.port,o=e.magnet;return null!=i&&n.isNode()&&n.hasPort(i)?t=this.findPortElem(i,o)||r:(o||(o=e.selector),o||null==i||(o='[port="'.concat(i,'"]')),t=this.findOne(o,r,this.selectors)),t}},{key:"hasTools",value:function(e){var t=this.tools;return null!=t&&(null==e||t.name===e)}},{key:"addTools",value:function(e){if(this.removeTools(),e){if(!this.can("toolsAddable"))return this;var t=zp.isToolsView(e)?e:new zp(e);this.tools=t,t.config({view:this}),t.mount()}return this}},{key:"updateTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.tools&&this.tools.update(e),this}},{key:"removeTools",value:function(){return this.tools&&(this.tools.remove(),this.tools=null),this}},{key:"hideTools",value:function(){return this.tools&&this.tools.hide(),this}},{key:"showTools",value:function(){return this.tools&&this.tools.show(),this}},{key:"renderTools",value:function(){var e=this.cell.getTools();return this.addTools(e),this}},{key:"notify",value:function(e,t){return this.trigger(e,t),this.graph.trigger(e,t),this}},{key:"getEventArgs",value:function(e,t,n){var r=this,i=r.cell;return null==t||null==n?{e:e,view:r,cell:i}:{e:e,x:t,y:n,view:r,cell:i}}},{key:"onClick",value:function(e,t,n){this.notify("cell:click",this.getEventArgs(e,t,n))}},{key:"onDblClick",value:function(e,t,n){this.notify("cell:dblclick",this.getEventArgs(e,t,n))}},{key:"onContextMenu",value:function(e,t,n){this.notify("cell:contextmenu",this.getEventArgs(e,t,n))}},{key:"onMouseDown",value:function(e,t,n){this.cell.model&&(this.cachedModelForMouseEvent=this.cell.model,this.cachedModelForMouseEvent.startBatch("mouse")),this.notify("cell:mousedown",this.getEventArgs(e,t,n))}},{key:"onMouseUp",value:function(e,t,n){this.notify("cell:mouseup",this.getEventArgs(e,t,n)),this.cachedModelForMouseEvent&&(this.cachedModelForMouseEvent.stopBatch("mouse",{cell:this.cell}),this.cachedModelForMouseEvent=null)}},{key:"onMouseMove",value:function(e,t,n){this.notify("cell:mousemove",this.getEventArgs(e,t,n))}},{key:"onMouseOver",value:function(e){this.notify("cell:mouseover",this.getEventArgs(e))}},{key:"onMouseOut",value:function(e){this.notify("cell:mouseout",this.getEventArgs(e))}},{key:"onMouseEnter",value:function(e){this.notify("cell:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){this.notify("cell:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,t,n,r){this.notify("cell:mousewheel",Object.assign({delta:r},this.getEventArgs(e,t,n)))}},{key:"onCustomEvent",value:function(e,t,n,r){this.notify("cell:customevent",Object.assign({name:t},this.getEventArgs(e,n,r))),this.notify(t,Object.assign({},this.getEventArgs(e,n,r)))}},{key:"onMagnetMouseDown",value:function(e,t,n,r){}},{key:"onMagnetDblClick",value:function(e,t,n,r){}},{key:"onMagnetContextMenu",value:function(e,t,n,r){}},{key:"onLabelMouseDown",value:function(e,t,n){}},{key:"checkMouseleave",value:function(e){var t=this.getEventTarget(e,{fromPoint:!0}),n=this.graph.findViewByElem(t);n!==this&&(this.onMouseLeave(e),n&&n.onMouseEnter(e))}},{key:"dispose",value:function(){this.cell.off("changed",this.onCellChanged,this)}}],[{key:"getDefaults",value:function(){return this.defaults}},{key:"config",value:function(e){this.defaults=this.getOptions(e)}},{key:"getOptions",value:function(e){var t=function(e,t){return null!=t?Qe([].concat(p(Array.isArray(e)?e:[e]),p(Array.isArray(t)?t:[t]))):Array.isArray(e)?p(e):[e]},n=Xe(this.getDefaults()),r=e.bootstrap,i=e.actions,o=e.events,a=e.documentEvents,s=Ip(e,["bootstrap","actions","events","documentEvents"]);return r&&(n.bootstrap=t(n.bootstrap,r)),i&&Object.entries(i).forEach((function(e){var r=m(e,2),i=r[0],o=r[1],a=n.actions[i];o&&a?n.actions[i]=t(a,o):o&&(n.actions[i]=t(o))})),o&&(n.events=Object.assign(Object.assign({},n.events),o)),e.documentEvents&&(n.documentEvents=Object.assign(Object.assign({},n.documentEvents),a)),$e(n,s)}}]),r}(Tp,Symbol.toStringTag);Bp.defaults={isSvgElement:!0,rootSelector:"root",priority:0,bootstrap:[],actions:{}},Dp([Bp.dispose()],Bp.prototype,"dispose",null),function(e){e.Flag=Rp,e.Attr=Np}(Bp||(Bp={})),function(e){e.toStringTag="X6.".concat(e.name),e.isCellView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNodeView&&"function"==typeof r.isEdgeView&&"function"==typeof r.confirmUpdate}}(Bp||(Bp={})),function(e){e.priority=function(e){return function(t){t.config({priority:e})}},e.bootstrap=function(e){return function(t){t.config({bootstrap:e})}}}(Bp||(Bp={})),function(e){e.registry=yg.create({type:"view"})}(Bp||(Bp={}));var zp=function(e,t){l(r,e);var n=c(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,r),(e=n.call(this)).svgContainer=e.createContainer(!0,t),e.htmlContainer=e.createContainer(!1,t),e.config(t),e}return P(r,[{key:"name",get:function(){return this.options.name}},{key:"graph",get:function(){return this.cellView.graph}},{key:"cell",get:function(){return this.cellView.cell}},{key:t,get:function(){return r.toStringTag}},{key:"createContainer",value:function(e,t){var n=e?Tp.createElement("g",!0):Tp.createElement("div",!1);return af(n,this.prefixClassName("cell-tools")),t.className&&af(n,t.className),n}},{key:"config",value:function(e){if(this.options=Object.assign(Object.assign({},this.options),e),!Bp.isCellView(e.view)||e.view===this.cellView)return this;this.cellView=e.view,this.cell.isEdge()?(af(this.svgContainer,this.prefixClassName("edge-tools")),af(this.htmlContainer,this.prefixClassName("edge-tools"))):this.cell.isNode()&&(af(this.svgContainer,this.prefixClassName("node-tools")),af(this.htmlContainer,this.prefixClassName("node-tools"))),this.svgContainer.setAttribute("data-cell-id",this.cell.id),this.htmlContainer.setAttribute("data-cell-id",this.cell.id),this.name&&(this.svgContainer.setAttribute("data-tools-name",this.name),this.htmlContainer.setAttribute("data-tools-name",this.name));var t=this.options.items;if(!Array.isArray(t))return this;this.tools=[];var n=[];t.forEach((function(e){r.ToolItem.isToolItem(e)?"vertices"===e.name?n.unshift(e):n.push(e):"vertices"===("object"===v(e)?e.name:e)?n.unshift(e):n.push(e)}));for(var i=0;i<n.length;i+=1){var o=n[i],a=void 0;if(r.ToolItem.isToolItem(o))a=o;else{var s="object"===v(o)?o.name:o,l="object"===v(o)&&o.args||{};if(s)if(this.cell.isNode()){var u=sy.registry.get(s);if(!u)return sy.registry.onNotFound(s);a=new u(l)}else if(this.cell.isEdge()){var c=ly.registry.get(s);if(!c)return ly.registry.onNotFound(s);a=new c(l)}}if(a)a.config(this.cellView,this),a.render(),(!1!==a.options.isSVGElement?this.svgContainer:this.htmlContainer).appendChild(a.container),this.tools.push(a)}return this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.tools;return t&&t.forEach((function(t){e.toolId!==t.cid&&t.isVisible()&&t.update()})),this}},{key:"focus",value:function(e){var t=this.tools;return t&&t.forEach((function(t){e===t?t.show():t.hide()})),this}},{key:"blur",value:function(e){var t=this.tools;return t&&t.forEach((function(t){t===e||t.isVisible()||(t.show(),t.update())})),this}},{key:"hide",value:function(){return this.focus(null)}},{key:"show",value:function(){return this.blur(null)}},{key:"remove",value:function(){var e=this.tools;return e&&(e.forEach((function(e){return e.remove()})),this.tools=null),bf(this.svgContainer),bf(this.htmlContainer),s(g(r.prototype),"remove",this).call(this)}},{key:"mount",value:function(){var e=this.tools,t=this.cellView;if(t&&e){var n=e.some((function(e){return!1!==e.options.isSVGElement})),r=e.some((function(e){return!1===e.options.isSVGElement}));if(n)(this.options.local?t.container:t.graph.view.decorator).appendChild(this.svgContainer);r&&this.graph.container.appendChild(this.htmlContainer)}return this}}]),r}(Tp,Symbol.toStringTag);!function(e){e.toStringTag="X6.".concat(e.name),e.isToolsView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&null!=r.graph&&null!=r.cell&&"function"==typeof r.config&&"function"==typeof r.update&&"function"==typeof r.focus&&"function"==typeof r.blur&&"function"==typeof r.show&&"function"==typeof r.hide}}(zp||(zp={})),function(e){var t=function(e,t){l(r,e);var n=c(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,r),(e=n.call(this)).visible=!0,e.options=e.getOptions(t),e.container=Tp.createElement(e.options.tagName||"g",!1!==e.options.isSVGElement),af(e.container,e.prefixClassName("cell-tool")),"string"==typeof e.options.className&&af(e.container,e.options.className),e.init(),e}return P(r,[{key:"graph",get:function(){return this.cellView.graph}},{key:"cell",get:function(){return this.cellView.cell}},{key:"name",get:function(){return this.options.name}},{key:t,get:function(){return r.toStringTag}},{key:"init",value:function(){}},{key:"getOptions",value:function(e){return this.constructor.getOptions(e)}},{key:"delegateEvents",value:function(){return this.options.events&&s(g(r.prototype),"delegateEvents",this).call(this,this.options.events),this}},{key:"config",value:function(e,t){return this.cellView=e,this.parent=t,this.stamp(this.container),this.cell.isEdge()?af(this.container,this.prefixClassName("edge-tool")):this.cell.isNode()&&af(this.container,this.prefixClassName("node-tool")),this.name&&this.container.setAttribute("data-tool-name",this.name),this.delegateEvents(),this}},{key:"render",value:function(){this.empty();var e=this.options.markup;if(e){var t=Lp.parseJSONMarkup(e);this.container.appendChild(t.fragment),this.childNodes=t.selectors}return this.onRender(),this}},{key:"onRender",value:function(){}},{key:"update",value:function(){return this}},{key:"stamp",value:function(e){e&&e.setAttribute("data-cell-id",this.cellView.cell.id)}},{key:"show",value:function(){return this.container.style.display="",this.visible=!0,this}},{key:"hide",value:function(){return this.container.style.display="none",this.visible=!1,this}},{key:"isVisible",value:function(){return this.visible}},{key:"focus",value:function(){var e=this.options.focusOpacity;return null!=e&&Number.isFinite(e)&&(this.container.style.opacity="".concat(e)),this.parent.focus(this),this}},{key:"blur",value:function(){return this.container.style.opacity="",this.parent.blur(this),this}},{key:"guard",value:function(e){return null==this.graph||null==this.cellView||this.graph.view.guard(e,this.cellView)}}],[{key:"getDefaults",value:function(){return this.defaults}},{key:"config",value:function(e){this.defaults=this.getOptions(e)}},{key:"getOptions",value:function(e){return $e(Xe(this.getDefaults()),e)}}]),r}(Tp,Symbol.toStringTag);t.defaults={isSVGElement:!0,tagName:"g"},e.ToolItem=t,function(e){var t=0;e.define=function(e){var n=mh(function(e){return e?Ah(e):"CustomTool".concat(t+=1)}(e.name),this);return n.config(e),n}}(t=e.ToolItem||(e.ToolItem={})),function(e){e.toStringTag="X6.".concat(e.name),e.isToolItem=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&null!=r.graph&&null!=r.cell&&"function"==typeof r.config&&"function"==typeof r.update&&"function"==typeof r.focus&&"function"==typeof r.blur&&"function"==typeof r.show&&"function"==typeof r.hide&&"function"==typeof r.isVisible}}(t=e.ToolItem||(e.ToolItem={}))}(zp||(zp={}));function Fp(e,t){return 0===t?"0%":"".concat(Math.round(e/t*100),"%")}function Vp(e){return function(t,n,r,i){return n.isEdgeElement(r)?function(e,t,n,r,i){var o=n.getConnection();if(!o)return t;var a=o.closestPointLength(i);if(e){var s=o.length();t.anchor={name:"ratio",args:{ratio:a/s}}}else t.anchor={name:"length",args:{length:a}};return t}(e,t,n,0,i):function(e,t,n,r,i){var o=n.cell,a=o.getAngle(),s=n.getUnrotatedBBoxOfElement(r),l=o.getBBox().getCenter(),u=Wd.create(i).rotate(a,l),c=u.x-s.x,h=u.y-s.y;e&&(c=Fp(c,s.width),h=Fp(h,s.height));return t.anchor={name:"topLeft",args:{dx:c,dy:h,rotate:!0}},t}(e,t,n,r,i)}}var Hp,Up=Vp(!0),qp=Vp(!1),Gp=Object.freeze(Object.defineProperty({__proto__:null,noop:function(e){return e},pinAbsolute:qp,pinRelative:Up},Symbol.toStringTag,{value:"Module"}));function Jp(e,t,n,r){return hh(Hp.presets.pinRelative,this.graph,{},t,n,e,this.cell,r,{}).anchor}function Wp(e,t){return t?e.cell.getBBox():e.cell.isEdge()?e.getConnection().bbox():e.getUnrotatedBBoxOfElement(e.container)}!function(e){e.presets=Gp,e.registry=yg.create({type:"connection strategy"}),e.registry.register(e.presets,!0)}(Hp||(Hp={}));var Yp=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"onRender",value:function(){af(this.container,this.prefixClassName("cell-tool-button")),this.update()}},{key:"update",value:function(){return this.updatePosition(),this}},{key:"updatePosition",value:function(){var e=this.cellView.cell.isEdge()?this.getEdgeMatrix():this.getNodeMatrix();xd(this.container,e,{absolute:!0})}},{key:"getNodeMatrix",value:function(){var e=this.cellView,t=this.options,n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,a=t.offset,s=t.useCellGeometry,l=t.rotate,u=Wp(e,s),c=e.cell.getAngle();l||(u=u.bbox(c));var h=0,f=0;"number"==typeof a?(h=a,f=a):"object"===v(a)&&(h=a.x,f=a.y),r=Lh(r,u.width),o=Lh(o,u.height);var d=pd().translate(u.x+u.width/2,u.y+u.height/2);return l&&(d=d.rotate(c)),d=d.translate(r+h-u.width/2,o+f-u.height/2)}},{key:"getEdgeMatrix",value:function(){var e,t,n,r=this.cellView,i=this.options,o=i.offset,a=void 0===o?0:o,s=i.distance,l=void 0===s?0:s,u=i.rotate,c=Lh(l,1);(e=c>=0&&c<=1?r.getTangentAtRatio(c):r.getTangentAtLength(c))?(t=e.start,n=e.vector().vectorAngle(new Wd(1,0))||0):(t=r.getConnection().start,n=0);var h=pd().translate(t.x,t.y).rotate(n);return h="object"===v(a)?h.translate(a.x||0,a.y||0):h.translate(0,a),u||(h=h.rotate(-n)),h}},{key:"onMouseDown",value:function(e){if(!this.guard(e)){e.stopPropagation(),e.preventDefault();var t=this.options.onClick;"function"==typeof t&&hh(t,this.cellView,{e:e,view:this.cellView,cell:this.cellView.cell,btn:this})}}}]),n}(zp.ToolItem);!function(e){e.config({name:"button",useCellGeometry:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"}})}(Yp||(Yp={})),function(e){e.Remove=e.define({name:"button-remove",markup:[{tagName:"circle",selector:"button",attrs:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attrs:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],distance:60,offset:0,useCellGeometry:!0,onClick:function(e){var t=e.view,n=e.btn;n.parent.remove(),t.cell.remove({ui:!0,toolId:n.cid})}})}(Yp||(Yp={}));var Zp=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Xp=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"onRender",value:function(){if(af(this.container,this.prefixClassName("cell-tool-boundary")),this.options.attrs){var e=this.options.attrs,t=e.class,n=Zp(e,["class"]);Tf(this.container,jf(n)),t&&af(this.container,t)}this.update()}},{key:"update",value:function(){var e=this.cellView,t=this.options,n=t.useCellGeometry,r=t.rotate,i=jh(t.padding),o=Wp(e,n).moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom}),a=e.cell;if(a.isNode()){var s=a.getAngle();if(s)if(r){var l=a.getBBox().getCenter();Ed(this.container,s,l.x,l.y,{absolute:!0})}else o=o.bbox(s)}return Tf(this.container,o.toJSON()),this}}]),n}(zp.ToolItem);!function(e){e.config({name:"boundary",tagName:"rect",padding:10,useCellGeometry:!0,attrs:{fill:"none",stroke:"#333","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"}})}(Xp||(Xp={}));var Kp=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).handles=[],e}return P(n,[{key:"vertices",get:function(){return this.cellView.cell.getVertices()}},{key:"onRender",value:function(){return this.addClass(this.prefixClassName("edge-tool-vertices")),this.options.addable&&this.updatePath(),this.resetHandles(),this.renderHandles(),this}},{key:"update",value:function(){return this.vertices.length===this.handles.length?this.updateHandles():(this.resetHandles(),this.renderHandles()),this.options.addable&&this.updatePath(),this}},{key:"resetHandles",value:function(){var e=this,t=this.handles;this.handles=[],t&&t.forEach((function(t){e.stopHandleListening(t),t.remove()}))}},{key:"renderHandles",value:function(){for(var e=this,t=this.vertices,n=0,r=t.length;n<r;n+=1){var i=t[n],o=this.options.createHandle,a=this.options.processHandle,s=o({index:n,graph:this.graph,guard:function(t){return e.guard(t)},attrs:this.options.attrs||{}});a&&a(s),s.updatePosition(i.x,i.y),this.stamp(s.container),this.container.appendChild(s.container),this.handles.push(s),this.startHandleListening(s)}}},{key:"updateHandles",value:function(){for(var e=this.vertices,t=0,n=e.length;t<n;t+=1){var r=e[t],i=this.handles[t];i&&i.updatePosition(r.x,r.y)}}},{key:"updatePath",value:function(){var e=this.childNodes.connection;e&&e.setAttribute("d",this.cellView.getConnectionPathData())}},{key:"startHandleListening",value:function(e){var t=this.cellView;t.can("vertexMovable")&&(e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.on("remove",this.onHandleRemove,this)}},{key:"stopHandleListening",value:function(e){var t=this.cellView;t.can("vertexMovable")&&(e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)),t.can("vertexDeletable")&&e.off("remove",this.onHandleRemove,this)}},{key:"getNeighborPoints",value:function(e){var t=this.cellView,n=this.vertices,r=e>0?n[e-1]:t.sourceAnchor,i=e<n.length-1?n[e+1]:t.targetAnchor;return{prev:Wd.create(r),next:Wd.create(i)}}},{key:"getMouseEventArgs",value:function(e){var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);return{e:t,x:n.x,y:n.y}}},{key:"onHandleChange",value:function(e){var t=e.e;this.focus();var n=this.cellView;if(n.cell.startBatch("move-vertex",{ui:!0,toolId:this.cid}),!this.options.stopPropagation){var r=this.getMouseEventArgs(t),i=r.e,o=r.x,a=r.y;this.eventData(i,{start:{x:o,y:a}}),n.notifyMouseDown(i,o,a)}}},{key:"onHandleChanging",value:function(e){var t=e.handle,n=e.e,r=this.cellView,i=t.options.index,o=this.getMouseEventArgs(n),a=o.e,s=o.x,l=o.y,u={x:s,y:l};this.snapVertex(u,i),r.cell.setVertexAt(i,u,{ui:!0,toolId:this.cid}),t.updatePosition(u.x,u.y),this.options.stopPropagation||r.notifyMouseMove(a,s,l)}},{key:"stopBatch",value:function(e){this.cell.stopBatch("move-vertex",{ui:!0,toolId:this.cid}),e&&this.cell.stopBatch("add-vertex",{ui:!0,toolId:this.cid})}},{key:"onHandleChanged",value:function(e){var t=e.e,n=this.options,r=this.cellView;if(n.addable&&this.updatePath(),n.removeRedundancies){r.removeRedundantLinearVertices({ui:!0,toolId:this.cid})&&this.render(),this.blur(),this.stopBatch(this.eventData(t).vertexAdded);var i=this.getMouseEventArgs(t),o=i.e,a=i.x,s=i.y;if(!this.options.stopPropagation){r.notifyMouseUp(o,a,s);var l=this.eventData(o).start;if(l){var u=l.x,c=l.y;u===a&&c===s&&r.onClick(o,a,s)}}r.checkMouseleave(o),n.onChanged&&n.onChanged({edge:r.cell,edgeView:r})}else this.stopBatch(this.eventData(t).vertexAdded)}},{key:"snapVertex",value:function(e,t){var n=this.options.snapRadius||0;if(n>0){var r=this.getNeighborPoints(t),i=r.prev,o=r.next;Math.abs(e.x-i.x)<n?e.x=i.x:Math.abs(e.x-o.x)<n&&(e.x=o.x),Math.abs(e.y-i.y)<n?e.y=r.prev.y:Math.abs(e.y-o.y)<n&&(e.y=o.y)}}},{key:"onHandleRemove",value:function(e){var t=e.handle,n=e.e;if(this.options.removable){var r=t.options.index,i=this.cellView;i.cell.removeVertexAt(r,{ui:!0}),this.options.addable&&this.updatePath(),i.checkMouseleave(this.normalizeEvent(n))}}},{key:"allowAddVertex",value:function(e){var t=this.guard(e),n=this.options.addable&&this.cellView.can("vertexAddable"),r=!this.options.modifiers||zd.isMatch(e,this.options.modifiers);return!t&&n&&r}},{key:"onPathMouseDown",value:function(e){var t=this.cellView;if(this.allowAddVertex(e)){e.stopPropagation(),e.preventDefault();var n=this.normalizeEvent(e),r=this.graph.snapToGrid(n.clientX,n.clientY).toJSON();t.cell.startBatch("add-vertex",{ui:!0,toolId:this.cid});var i=t.getVertexIndex(r.x,r.y);this.snapVertex(r,i),t.cell.insertVertex(r,i,{ui:!0,toolId:this.cid}),this.render();var o=this.handles[i];this.eventData(n,{vertexAdded:!0}),o.onMouseDown(n)}}},{key:"onRemove",value:function(){this.resetHandles()}}]),n}(zp.ToolItem);!function(e){var t=function(t){l(r,t);var n=c(r);function r(e){var t;return A(this,r),(t=n.call(this)).options=e,t.render(),t.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDoubleClick"}),t}return P(r,[{key:"graph",get:function(){return this.options.graph}},{key:"render",value:function(){this.container=Tp.createElement("circle",!0);var t=this.options.attrs;if("function"==typeof t){var n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-vertex"))}},{key:"updatePosition",value:function(e,t){this.setAttrs({cx:e,cy:t})}},{key:"onMouseDown",value:function(e){this.options.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data),this.emit("change",{e:e,handle:this}))}},{key:"onMouseMove",value:function(e){this.emit("changing",{e:e,handle:this})}},{key:"onMouseUp",value:function(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.graph.view.delegateEvents()}},{key:"onDoubleClick",value:function(e){this.emit("remove",{e:e,handle:this})}}]),r}(Tp);e.Handle=t}(Kp||(Kp={})),function(e){var t=ip.prefix("edge-tool-vertex-path");e.config({name:"vertices",snapRadius:20,addable:!0,removable:!0,removeRedundancies:!0,stopPropagation:!0,attrs:{r:6,fill:"#333",stroke:"#fff",cursor:"move","stroke-width":2},createHandle:function(t){return new e.Handle(t)},markup:[{tagName:"path",selector:"connection",className:t,attrs:{fill:"none",stroke:"transparent","stroke-width":10,cursor:"pointer"}}],events:O(O({},"mousedown .".concat(t),"onPathMouseDown"),"touchstart .".concat(t),"onPathMouseDown")})}(Kp||(Kp={}));var $p=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).handles=[],e}return P(n,[{key:"vertices",get:function(){return this.cellView.cell.getVertices()}},{key:"update",value:function(){return this.render(),this}},{key:"onRender",value:function(){af(this.container,this.prefixClassName("edge-tool-segments")),this.resetHandles();var e=this.cellView,t=p(this.vertices);t.unshift(e.sourcePoint),t.push(e.targetPoint);for(var n=0,r=t.length;n<r-1;n+=1){var i=t[n],o=t[n+1],a=this.renderHandle(i,o,n);this.stamp(a.container),this.handles.push(a)}return this}},{key:"renderHandle",value:function(e,t,n){var r=this,i=this.options.createHandle({index:n,graph:this.graph,guard:function(e){return r.guard(e)},attrs:this.options.attrs||{}});return this.options.processHandle&&this.options.processHandle(i),this.updateHandle(i,e,t),this.container.appendChild(i.container),this.startHandleListening(i),i}},{key:"startHandleListening",value:function(e){e.on("change",this.onHandleChange,this),e.on("changing",this.onHandleChanging,this),e.on("changed",this.onHandleChanged,this)}},{key:"stopHandleListening",value:function(e){e.off("change",this.onHandleChange,this),e.off("changing",this.onHandleChanging,this),e.off("changed",this.onHandleChanged,this)}},{key:"resetHandles",value:function(){var e=this,t=this.handles;this.handles=[],t&&t.forEach((function(t){e.stopHandleListening(t),t.remove()}))}},{key:"shiftHandleIndexes",value:function(e){for(var t=this.handles,n=0,r=t.length;n<r;n+=1)t[n].options.index+=e}},{key:"resetAnchor",value:function(e,t){var n=this.cellView.cell,r={ui:!0,toolId:this.cid};t?n.prop([e,"anchor"],t,r):n.removeProp([e,"anchor"],r)}},{key:"snapHandle",value:function(e,t,n){var r=e.options.axis,i=e.options.index,o=this.cellView.cell.getVertices(),a=o[i-2]||n.sourceAnchor,s=o[i+1]||n.targetAnchor,l=this.options.snapRadius;return Math.abs(t[r]-a[r])<l?t[r]=a[r]:Math.abs(t[r]-s[r])<l&&(t[r]=s[r]),t}},{key:"onHandleChanging",value:function(e){var t=e.handle,n=e.e,r=this.graph,i=this.options,o=this.cellView,a=i.anchor,s=t.options.axis,l=t.options.index-1,u=this.getEventData(n),c=this.normalizeEvent(n),h=r.snapToGrid(c.clientX,c.clientY),f=this.snapHandle(t,h.clone(),u),d=Xe(this.vertices),g=d[l],v=d[l+1],p=o.sourceView,y=o.sourceBBox,m=!1,w=!1;if(g?0===l?y.containsPoint(g)?(d.shift(),this.shiftHandleIndexes(-1),m=!0):(g[s]=f[s],w=!0):g[s]=f[s]:((g=o.sourceAnchor.toJSON())[s]=f[s],y.containsPoint(g)?m=!0:(d.unshift(g),this.shiftHandleIndexes(1),w=!0)),"function"==typeof a&&p){if(m){var b=u.sourceAnchor.clone();b[s]=f[s];var k=hh(a,o,b,p,o.sourceMagnet||p.container,"source",o,this);this.resetAnchor("source",k)}w&&this.resetAnchor("source",u.sourceAnchorDef)}var x=o.targetView,C=o.targetBBox,E=!1,S=!1;if(v?l===d.length-2?C.containsPoint(v)?(d.pop(),E=!0):(v[s]=f[s],S=!0):v[s]=f[s]:((v=o.targetAnchor.toJSON())[s]=f[s],C.containsPoint(v)?E=!0:(d.push(v),S=!0)),"function"==typeof a&&x){if(E){var _=u.targetAnchor.clone();_[s]=f[s];var A=hh(a,o,_,x,o.targetMagnet||x.container,"target",o,this);this.resetAnchor("target",A)}S&&this.resetAnchor("target",u.targetAnchorDef)}Wd.equalPoints(d,this.vertices)||this.cellView.cell.setVertices(d,{ui:!0,toolId:this.cid}),this.updateHandle(t,g,v,0),i.stopPropagation||o.notifyMouseMove(c,h.x,h.y)}},{key:"onHandleChange",value:function(e){var t=e.handle,n=e.e,r=this.options,i=this.handles,o=this.cellView,a=t.options.index;if(Array.isArray(i)){for(var s=0,l=i.length;s<l;s+=1)s!==a&&i[s].hide();if(this.focus(),this.setEventData(n,{sourceAnchor:o.sourceAnchor.clone(),targetAnchor:o.targetAnchor.clone(),sourceAnchorDef:Xe(this.cell.prop(["source","anchor"])),targetAnchorDef:Xe(this.cell.prop(["target","anchor"]))}),this.cell.startBatch("move-segment",{ui:!0,toolId:this.cid}),!r.stopPropagation){var u=this.normalizeEvent(n),c=this.graph.snapToGrid(u.clientX,u.clientY);o.notifyMouseDown(u,c.x,c.y)}}}},{key:"onHandleChanged",value:function(e){var t=e.e,n=this.options,r=this.cellView;n.removeRedundancies&&r.removeRedundantLinearVertices({ui:!0,toolId:this.cid});var i=this.normalizeEvent(t),o=this.graph.snapToGrid(i.clientX,i.clientY);this.render(),this.blur(),this.cell.stopBatch("move-segment",{ui:!0,toolId:this.cid}),n.stopPropagation||r.notifyMouseUp(i,o.x,o.y),r.checkMouseleave(i),n.onChanged&&n.onChanged({edge:r.cell,edgeView:r})}},{key:"updateHandle",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=this.options.precision||0,o=Math.abs(t.x-n.x)<i,a=Math.abs(t.y-n.y)<i;if(o||a){var s=new Zd(t,n);if(s.length()<this.options.threshold)e.hide();else{var l=s.getCenter(),u=o?"x":"y";l[u]+=r||0;var c=s.vector().vectorAngle(new Wd(1,0));e.updatePosition(l.x,l.y,c,this.cellView),e.show(),e.options.axis=u}}else e.hide()}},{key:"onRemove",value:function(){this.resetHandles()}}]),n}(zp.ToolItem);!function(e){var t=function(t){l(r,t);var n=c(r);function r(e){var t;return A(this,r),(t=n.call(this)).options=e,t.render(),t.delegateEvents({mousedown:"onMouseDown",touchstart:"onMouseDown"}),t}return P(r,[{key:"render",value:function(){this.container=Tp.createElement("rect",!0);var t=this.options.attrs;if("function"==typeof t){var n=e.getDefaults();this.setAttrs(Object.assign(Object.assign({},n.attrs),t(this)))}else this.setAttrs(t);this.addClass(this.prefixClassName("edge-tool-segment"))}},{key:"updatePosition",value:function(e,t,n,r){var i=r.getClosestPoint(new Wd(e,t))||new Wd(e,t),o=pd().translate(i.x,i.y);if(i.equals({x:e,y:t}))o=o.rotate(n);else{var a=new Zd(e,t,i.x,i.y).vector().vectorAngle(new Wd(1,0));0!==a&&(a+=90),o=o.rotate(a)}this.setAttrs({transform:wd(o),cursor:n%180==0?"row-resize":"col-resize"})}},{key:"onMouseDown",value:function(e){this.options.guard(e)||(this.trigger("change",{e:e,handle:this}),e.stopPropagation(),e.preventDefault(),this.options.graph.view.undelegateEvents(),this.delegateDocumentEvents({mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},e.data))}},{key:"onMouseMove",value:function(e){this.emit("changing",{e:e,handle:this})}},{key:"onMouseUp",value:function(e){this.emit("changed",{e:e,handle:this}),this.undelegateDocumentEvents(),this.options.graph.view.delegateEvents()}},{key:"show",value:function(){this.container.style.display=""}},{key:"hide",value:function(){this.container.style.display="none"}}]),r}(Tp);e.Handle=t}($p||($p={})),function(e){e.config({name:"segments",precision:.5,threshold:40,snapRadius:10,stopPropagation:!0,removeRedundancies:!0,attrs:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#333",stroke:"#fff","stroke-width":2},createHandle:function(t){return new e.Handle(t)},anchor:Jp})}($p||($p={}));var Qp=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"type",get:function(){return this.options.type}},{key:"onRender",value:function(){af(this.container,this.prefixClassName("edge-tool-".concat(this.type,"-anchor"))),this.toggleArea(!1),this.update()}},{key:"update",value:function(){var e=this.type;return this.cellView.getTerminalView(e)?(this.updateAnchor(),this.updateArea(),this.container.style.display=""):this.container.style.display="none",this}},{key:"updateAnchor",value:function(){var e=this.childNodes;if(e){var t=e.anchor;if(t){var n=this.type,r=this.cellView,i=this.options,o=r.getTerminalAnchor(n),a=r.cell.prop([n,"anchor"]);t.setAttribute("transform","translate(".concat(o.x,", ").concat(o.y,")"));var s=a?i.customAnchorAttrs:i.defaultAnchorAttrs;s&&Object.keys(s).forEach((function(e){t.setAttribute(e,s[e])}))}}}},{key:"updateArea",value:function(){var e=this.childNodes;if(e){var t=e.area;if(t){var n=this.type,r=this.cellView,i=r.getTerminalView(n);if(i){var o,a,s,l=i.cell,u=r.getTerminalMagnet(n),c=this.options.areaPadding||0;Number.isFinite(c)||(c=0),i.isEdgeElement(u)?(a=0,s=(o=i.getBBox()).getCenter()):(o=i.getUnrotatedBBoxOfElement(u),a=l.getAngle(),s=o.getCenter(),a&&s.rotate(-a,l.getBBox().getCenter())),o.inflate(c),Tf(t,{x:-o.width/2,y:-o.height/2,width:o.width,height:o.height,transform:"translate(".concat(s.x,", ").concat(s.y,") rotate(").concat(a,")")})}}}}},{key:"toggleArea",value:function(e){if(this.childNodes){var t=this.childNodes.area;t&&(t.style.display=e?"":"none")}}},{key:"onMouseDown",value:function(e){this.guard(e)||(e.stopPropagation(),e.preventDefault(),this.graph.view.undelegateEvents(),this.options.documentEvents&&this.delegateDocumentEvents(this.options.documentEvents),this.focus(),this.toggleArea(this.options.restrictArea),this.cell.startBatch("move-anchor",{ui:!0,toolId:this.cid}))}},{key:"resetAnchor",value:function(e){var t=this.type,n=this.cell;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,toolId:this.cid}):n.removeProp([t,"anchor"],{ui:!0,toolId:this.cid})}},{key:"onMouseMove",value:function(e){var t=this.type,n=this.cellView,r=n.getTerminalView(t);if(null!=r){var i,o=this.normalizeEvent(e),a=r.cell,s=n.getTerminalMagnet(t),l=this.graph.coord.clientToLocalPoint(o.clientX,o.clientY),u=this.options.snap;if("function"==typeof u){var c=hh(u,n,l,r,s,t,n,this);l=Wd.create(c)}if(this.options.restrictArea)if(r.isEdgeElement(s)){var h=r.getClosestPoint(l);h&&(l=h)}else{var f=r.getUnrotatedBBoxOfElement(s),d=a.getAngle(),g=a.getBBox().getCenter(),v=l.clone().rotate(d,g);f.containsPoint(v)||(l=f.getNearestPointToPoint(v).rotate(-d,g))}var p=this.options.anchor;"function"==typeof p&&(i=hh(p,n,l,r,s,t,n,this)),this.resetAnchor(i),this.update()}}},{key:"onMouseUp",value:function(e){this.graph.view.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleArea(!1);var t=this.cellView;this.options.removeRedundancies&&t.removeRedundantLinearVertices({ui:!0,toolId:this.cid}),this.cell.stopBatch("move-anchor",{ui:!0,toolId:this.cid})}},{key:"onDblClick",value:function(){var e=this.options.resetAnchor;e&&this.resetAnchor(!0===e?void 0:e),this.update()}}]),n}(zp.ToolItem);!function(e){e.config({tagName:"g",markup:[{tagName:"circle",selector:"anchor",attrs:{cursor:"pointer"}},{tagName:"rect",selector:"area",attrs:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onMouseDown",touchstart:"onMouseDown",dblclick:"onDblClick"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"},customAnchorAttrs:{"stroke-width":4,stroke:"#33334F",fill:"#FFFFFF",r:5},defaultAnchorAttrs:{"stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6},areaPadding:6,snapRadius:10,resetAnchor:!0,restrictArea:!0,removeRedundancies:!0,anchor:Jp,snap:function(e,t,n,r,i,o){var a=o.options.snapRadius||0,s="source"===r,l=s?0:-1,u=this.cell.getVertexAt(l)||this.getTerminalAnchor(s?"target":"source");return u&&(Math.abs(u.x-e.x)<a&&(e.x=u.x),Math.abs(u.y-e.y)<a&&(e.y=u.y)),e}})}(Qp||(Qp={}));var ey=Qp.define({name:"source-anchor",type:"source"}),ty=Qp.define({name:"target-anchor",type:"target"}),ny=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},ry=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"type",get:function(){return this.options.type}},{key:"ratio",get:function(){return this.options.ratio}},{key:"init",value:function(){if(this.options.attrs){var e=this.options.attrs,t=e.class,n=ny(e,["class"]);this.setAttrs(n,this.container),t&&af(this.container,t)}}},{key:"onRender",value:function(){af(this.container,this.prefixClassName("edge-tool-".concat(this.type,"-arrowhead"))),this.update()}},{key:"update",value:function(){var e=this.ratio,t=this.cellView,n=t.getTangentAtRatio(e),r=n?n.start:t.getPointAtRatio(e),i=n&&n.vector().vectorAngle(new Wd(1,0))||0;if(!r)return this;var o=pd().translate(r.x,r.y).rotate(i);return xd(this.container,o,{absolute:!0}),this}},{key:"onMouseDown",value:function(e){if(!this.guard(e)){e.stopPropagation(),e.preventDefault();var t=this.cellView;if(t.can("arrowheadMovable")){t.cell.startBatch("move-arrowhead",{ui:!0,toolId:this.cid});var n=this.graph.snapToGrid(e.clientX,e.clientY),r=t.prepareArrowheadDragging(this.type,{x:n.x,y:n.y,options:Object.assign(Object.assign({},this.options),{toolId:this.cid})});this.cellView.setEventData(e,r),this.delegateDocumentEvents(this.options.documentEvents,e.data),t.graph.view.undelegateEvents(),this.container.style.pointerEvents="none"}this.focus()}}},{key:"onMouseMove",value:function(e){var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY);this.cellView.onMouseMove(t,n.x,n.y),this.update()}},{key:"onMouseUp",value:function(e){this.undelegateDocumentEvents();var t=this.normalizeEvent(e),n=this.cellView,r=this.graph.snapToGrid(t.clientX,t.clientY);n.onMouseUp(t,r.x,r.y),this.graph.view.delegateEvents(),this.blur(),this.container.style.pointerEvents="",n.cell.stopBatch("move-arrowhead",{ui:!0,toolId:this.cid})}}]),n}(zp.ToolItem);!function(e){e.config({tagName:"path",isSVGElement:!0,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}})}(ry||(ry={}));var iy=ry.define({name:"source-arrowhead",type:"source",ratio:0,attrs:{d:"M 10 -8 -10 0 10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),oy=ry.define({name:"target-arrowhead",type:"target",ratio:1,attrs:{d:"M -10 -8 10 0 -10 8 Z",fill:"#333",stroke:"#fff","stroke-width":2,cursor:"move"}}),ay=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).labelIndex=-1,e.distance=.5,e.dblClick=e.onCellDblClick.bind(f(e)),e}return P(n,[{key:"onRender",value:function(){var e=this.cellView;e&&e.on("cell:dblclick",this.dblClick)}},{key:"createElement",value:function(){var e=[this.prefixClassName("".concat(this.cell.isEdge()?"edge":"node","-tool-editor")),this.prefixClassName("cell-tool-editor")];this.editor=zp.createElement("div",!1),this.addClass(e,this.editor),this.editor.contentEditable="true",this.container.appendChild(this.editor)}},{key:"removeElement",value:function(){this.undelegateDocumentEvents(),this.editor&&(this.container.removeChild(this.editor),this.editor=null)}},{key:"updateEditor",value:function(){var e=this.cell,t=this.editor;if(t){var n=t.style;e.isNode()?this.updateNodeEditorTransform():e.isEdge()&&this.updateEdgeEditorTransform();var r=this.options.attrs;n.fontSize="".concat(r.fontSize,"px"),n.fontFamily=r.fontFamily,n.color=r.color,n.backgroundColor=r.backgroundColor;var i=this.getCellText()||"";return t.innerText=i,this.setCellText(""),this}}},{key:"updateNodeEditorTransform",value:function(){var e=this.graph,t=this.cell,n=this.editor;if(n){var r=Wd.create(),i=20,o="",a=this.options,s=a.x,l=a.y,u=this.options,c=u.width,h=u.height;if(void 0!==s&&void 0!==l){var f=t.getBBox();s=Lh(s,f.width),l=Lh(l,f.height),r=f.topLeft.translate(s,l),i=f.width-2*s}else{var d=t.getBBox();r=d.center,i=d.width-4,o="translate(-50%, -50%)"}var g=e.scale(),v=n.style;r=e.localToGraph(r),v.left="".concat(r.x,"px"),v.top="".concat(r.y,"px"),v.transform="scale(".concat(g.sx,", ").concat(g.sy,") ").concat(o),v.minWidth="".concat(i,"px"),"number"==typeof c&&(v.width="".concat(c,"px")),"number"==typeof h&&(v.height="".concat(h,"px"))}}},{key:"updateEdgeEditorTransform",value:function(){if(this.event){var e=this.graph,t=this.editor;if(t){var n=Wd.create(),r=20,i=t.style,o=this.event.target,a=o.parentElement;if(a&&of(a,this.prefixClassName("edge-label"))){var s=a.getAttribute("data-index")||"0";this.labelIndex=parseInt(s,10);var l=bd(a.getAttribute("transform")).translation;n=new Wd(l.tx,l.ty),r=rp.getBBox(o).width}else{if(!this.options.labelAddable)return this;n=e.clientToLocal(Wd.create(this.event.clientX,this.event.clientY));var u=this.cellView.path.closestPointLength(n);this.distance=u,this.labelIndex=-1}n=e.localToGraph(n);var c=e.scale();i.left="".concat(n.x,"px"),i.top="".concat(n.y,"px"),i.minWidth="".concat(r,"px"),i.transform="scale(".concat(c.sx,", ").concat(c.sy,") translate(-50%, -50%)")}}}},{key:"onDocumentMouseUp",value:function(e){if(this.editor&&e.target!==this.editor){var t=this.editor.innerText.replace(/\n$/,"")||"";this.setCellText(""!==t?t:null),this.removeElement()}}},{key:"onCellDblClick",value:function(e){var t=e.e;this.editor||(t.stopPropagation(),this.removeElement(),this.event=t,this.createElement(),this.updateEditor(),this.autoFocus(),this.delegateDocumentEvents(this.options.documentEvents))}},{key:"onMouseDown",value:function(e){e.stopPropagation()}},{key:"autoFocus",value:function(){var e=this;setTimeout((function(){e.editor&&(e.editor.focus(),e.selectText())}))}},{key:"selectText",value:function(){if(window.getSelection&&this.editor){var e=document.createRange(),t=window.getSelection();e.selectNodeContents(this.editor),t.removeAllRanges(),t.addRange(e)}}},{key:"getCellText",value:function(){var e=this.options.getText;if("function"==typeof e)return hh(e,this.cellView,{cell:this.cell,index:this.labelIndex});if("string"==typeof e){if(this.cell.isNode())return this.cell.attr(e);if(this.cell.isEdge()&&-1!==this.labelIndex)return this.cell.prop("labels/".concat(this.labelIndex,"/attrs/").concat(e))}}},{key:"setCellText",value:function(e){var t=this.options.setText;if("function"!=typeof t){if("string"==typeof t){if(this.cell.isNode())return void(null!==e&&this.cell.attr(t,e));if(this.cell.isEdge()){var n=this.cell;if(-1===this.labelIndex){if(e){var r={position:{distance:this.distance},attrs:{}};kh(r,"attrs/".concat(t),e),n.appendLabel(r)}}else null!==e?n.prop("labels/".concat(this.labelIndex,"/attrs/").concat(t),e):"number"==typeof this.labelIndex&&n.removeLabelAt(this.labelIndex)}}}else hh(t,this.cellView,{cell:this.cell,value:e,index:this.labelIndex,distance:this.distance})}},{key:"onRemove",value:function(){var e=this.cellView;e&&e.off("cell:dblclick",this.dblClick),this.removeElement()}}]),n}(zp.ToolItem);!function(e){e.config({tagName:"div",isSVGElement:!1,events:{mousedown:"onMouseDown",touchstart:"onMouseDown"},documentEvents:{mouseup:"onDocumentMouseUp",touchend:"onDocumentMouseUp",touchcancel:"onDocumentMouseUp"}})}(ay||(ay={})),function(e){e.NodeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},getText:"text/text",setText:"text/text"}),e.EdgeEditor=e.define({attrs:{fontSize:14,fontFamily:"Arial, helvetica, sans-serif",color:"#000",backgroundColor:"#fff"},labelAddable:!0,getText:"label/text",setText:"label/text"})}(ay||(ay={}));var sy,ly,uy=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){e.presets={boundary:Xp,button:Yp,"button-remove":Yp.Remove,"node-editor":ay.NodeEditor},e.registry=yg.create({type:"node tool",process:function(e,t){if("function"==typeof t)return t;var n=zp.ToolItem,r=t.inherit,i=uy(t,["inherit"]);if(r){var o=this.get(r);null==o?this.onNotFound(r,"inherited"):n=o}return null==i.name&&(i.name=e),n.define.call(n,i)}}),e.registry.register(e.presets,!0)}(sy||(sy={})),function(e){e.presets={boundary:Xp,vertices:Kp,segments:$p,button:Yp,"button-remove":Yp.Remove,"source-anchor":ey,"target-anchor":ty,"source-arrowhead":iy,"target-arrowhead":oy,"edge-editor":ay.EdgeEditor},e.registry=yg.create({type:"edge tool",process:function(e,t){if("function"==typeof t)return t;var n=zp.ToolItem,r=t.inherit,i=uy(t,["inherit"]);if(r){var o=this.get(r);null==o?this.onNotFound(r,"inherited"):n=o}return null==i.name&&(i.name=e),n.define.call(n,i)}}),e.registry.register(e.presets,!0)}(ly||(ly={}));var cy=wy("center"),hy=wy("topCenter"),fy=wy("bottomCenter"),dy=wy("leftMiddle"),gy=wy("rightMiddle"),vy=wy("topLeft"),py=wy("topRight"),yy=wy("bottomLeft"),my=wy("bottomRight");function wy(e){return function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i.rotate?t.getUnrotatedBBoxOfElement(n):t.getBBoxOfElement(n),a=o[e];a.x+=Lh(i.dx,o.width),a.y+=Lh(i.dy,o.height);var s=t.cell;return i.rotate?a.rotate(-s.getAngle(),s.getBBox().getCenter()):a}}function by(e){return function(t,n,r,i){if(r instanceof Element){var o,a=this.graph.findViewByElem(r);if(a)if(a.isEdgeElement(r))o=ky(a,null!=i.fixedAt?i.fixedAt:"50%");else o=a.getBBoxOfElement(r).getCenter();else o=new Wd;return e.call(this,t,n,o,i)}return e.apply(this,arguments)}}function ky(e,t){var n=Th(t),r="string"==typeof t?parseFloat(t):t;return n?e.getPointAtRatio(r/100):e.getPointAtLength(r)}var xy,Cy=by((function(e,t,n,r){var i=Ud.normalize(e.cell.getAngle()),o=e.getBBoxOfElement(t),a=o.getCenter(),s=o.getTopLeft(),l=o.getBottomRight(),u=r.padding;if(Number.isFinite(u)||(u=0),s.y+u<=n.y&&n.y<=l.y-u){var c=n.y-a.y;a.x+=0===i||180===i?0:1*c/Math.tan(Ud.toRad(i)),a.y+=c}else if(s.x+u<=n.x&&n.x<=l.x-u){var h=n.x-a.x;a.y+=90===i||270===i?0:h*Math.tan(Ud.toRad(i)),a.x+=h}return a})),Ey=by((function(e,t,n,r){var i,o,a=0,s=e.cell;r.rotate?(i=e.getUnrotatedBBoxOfElement(t),o=s.getBBox().getCenter(),a=s.getAngle()):i=e.getBBoxOfElement(t);var l=r.padding;null!=l&&Number.isFinite(l)&&i.inflate(l),r.rotate&&n.rotate(a,o);var u,c=i.getNearestSideToPoint(n);switch(c){case"left":u=i.getLeftMiddle();break;case"right":u=i.getRightMiddle();break;case"top":u=i.getTopCenter();break;case"bottom":u=i.getBottomCenter()}var h=r.direction;return"H"===h?"top"!==c&&"bottom"!==c||(u=n.x<=i.x+i.width?i.getLeftMiddle():i.getRightMiddle()):"V"===h&&(u=n.y<=i.y+i.height?i.getTopCenter():i.getBottomCenter()),r.rotate?u.rotate(-a,o):u})),Sy=Object.freeze(Object.defineProperty({__proto__:null,bottom:fy,bottomLeft:yy,bottomRight:my,center:cy,left:dy,midSide:Ey,nodeCenter:function(e,t,n,r,i){var o=e.cell.getConnectionPoint(this.cell,i);return(r.dx||r.dy)&&o.translate(r.dx||0,r.dy||0),o},orth:Cy,right:gy,top:hy,topLeft:vy,topRight:py},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Sy,e.registry=yg.create({type:"node endpoint"}),e.registry.register(e.presets,!0)}(xy||(xy={}));var _y,Ay=function(e,t,n,r){var i=e.getClosestPoint(n);return null!=i?i:new Wd},My=by(Ay),Py=by((function(e,t,n,r){var i=1e6,o=e.getConnection(),a=e.getConnectionSubdivisions(),s=new Zd(n.clone().translate(0,i),n.clone().translate(0,-i)),l=new Zd(n.clone().translate(i,0),n.clone().translate(-i,0)),u=s.intersect(o,{segmentSubdivisions:a}),c=l.intersect(o,{segmentSubdivisions:a}),h=[];return u&&h.push.apply(h,p(u)),c&&h.push.apply(h,p(c)),h.length>0?n.closest(h):null!=r.fallbackAt?ky(e,r.fallbackAt):hh(Ay,this,e,t,n,r)})),Oy=Object.freeze(Object.defineProperty({__proto__:null,closest:My,length:function(e,t,n,r){var i=null!=r.length?r.length:20;return e.getPointAtLength(i)},orth:Py,ratio:function(e,t,n,r){var i=null!=r.ratio?r.ratio:.5;return i>1&&(i/=100),e.getPointAtRatio(i)}},Symbol.toStringTag,{value:"Module"}));function Ty(e,t,n){var r;if("object"===v(n)){if(Number.isFinite(n.y)){var i=new Zd(t,e).parallel(n.y);t=i.start,e=i.end}r=n.x}else r=n;if(null==r||!Number.isFinite(r))return e;var o=e.distance(t);return 0===r&&o>0?e:e.move(t,-Math.min(r,o-1))}function Ly(e){var t=e.getAttribute("stroke-width");return null===t?0:parseFloat(t)||0}!function(e){e.presets=Oy,e.registry=yg.create({type:"edge endpoint"}),e.registry.register(e.presets,!0)}(_y||(_y={}));var jy=function(e,t,n,r){var i=t.getBBoxOfElement(n);r.stroked&&i.inflate(Ly(n)/2);var o=e.intersect(i);return Ty(o&&o.length?e.start.closest(o):e.end,e.start,r.offset)};var Ny,Ry=Object.freeze(Object.defineProperty({__proto__:null,anchor:function(e,t,n,r){var i=r.alignOffset,o=r.align;return o&&function(e,t){var n,r,i,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=e.start,l=e.end;switch(t){case"left":o="x",n=l,r=s,i=-1;break;case"right":o="x",n=s,r=l,i=1;break;case"top":o="y",n=l,r=s,i=-1;break;case"bottom":o="y",n=s,r=l,i=1;break;default:return}s[o]<l[o]?n[o]=r[o]:r[o]=n[o],Number.isFinite(a)&&(n[o]+=i*a,r[o]+=i*a)}(e,o,i),Ty(e.end,e.start,r.offset)},bbox:jy,boundary:function(e,t,n,r){var i,o,a=e.end,s=r.selector;if(i="string"==typeof s?t.findOne(s):Array.isArray(s)?bh(n,s):function(e){if(null==e)return null;var t=e;do{var n=t.tagName;if("string"!=typeof n)return null;if("G"===(n=n.toUpperCase()))t=t.firstElementChild;else{if("TITLE"!==n)break;t=t.nextElementSibling}}while(t);return t}(n),!hf(i)){if(i===n||!hf(n))return a;i=n}var l,u=t.getShapeOfElement(i),c=t.getMatrixOfElement(i),h=t.getRootTranslatedMatrix(),f=t.getRootRotatedMatrix(),d=h.multiply(f).multiply(c),g=d.inverse(),p=rp.transformLine(e,g),y=p.start.clone(),m=t.getDataOfElement(i);if(!1===r.insideout){null==m.shapeBBox&&(m.shapeBBox=u.bbox());var w=m.shapeBBox;if(null!=w&&w.containsPoint(y))return a}if(!0===r.extrapolate&&p.setLength(1e6),pg.isPath(u)){var b=r.precision||2;null==m.segmentSubdivisions&&(m.segmentSubdivisions=u.getSegmentSubdivisions({precision:b})),l={precision:b,segmentSubdivisions:m.segmentSubdivisions},o=p.intersect(u,l)}else o=p.intersect(u);o?Array.isArray(o)&&(o=y.closest(o)):!0===r.sticky&&(o=Yd.isRectangle(u)?u.getNearestPointToPoint(y):Xd.isEllipse(u)?u.intersectsWithLineFromCenterToPoint(y):u.closestPoint(y,l));var k=o?rp.transformPoint(o,d):a,x=r.offset||0;return!1!==r.stroked&&("object"===v(x)?(null==(x=Object.assign({},x)).x&&(x.x=0),x.x+=Ly(i)/2):x+=Ly(i)/2),Ty(k,e.start,x)},rect:function(e,t,n,r,i){var o=t.cell,a=o.isNode()?o.getAngle():0;if(0===a)return hh(jy,this,e,t,n,r,i);var s=t.getUnrotatedBBoxOfElement(n);r.stroked&&s.inflate(Ly(n)/2);var l=s.getCenter(),u=e.clone().rotate(a,l),c=u.setLength(1e6).intersect(s);return Ty(c&&c.length?u.start.closest(c).rotate(-a,l):e.end,e.start,r.offset)}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=Ry,e.registry=yg.create({type:"connection point"}),e.registry.register(e.presets,!0)}(Ny||(Ny={}));function Dy(e){return new Yd(e.x,e.y,0,0)}function Iy(){var e=jh((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).padding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function By(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sourceBBox.clone().moveAndExpand(Iy(t))}function zy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.targetBBox.clone().moveAndExpand(Iy(t))}var Fy,Vy=function(e,t,n){var r=By(n,t),i=zy(n,t),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.sourceAnchor?e.sourceAnchor:By(e,t).getCenter()}(n,t),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.targetAnchor?e.targetAnchor:zy(e,t).getCenter()}(n,t);r=r.union(Dy(o)),i=i.union(Dy(a));var s=e.map((function(e){return Wd.create(e)}));s.unshift(o),s.push(a);for(var l=null,u=[],c=0,h=s.length-1;c<h;c+=1){var f=null,d=s[c],g=s[c+1],v=null!=Fy.getBearing(d,g);if(0===c)c+1===h?r.intersectsWithRect(i.clone().inflate(1))?f=Fy.insideNode(d,g,r,i):v||(f=Fy.nodeToNode(d,g,r,i)):r.containsPoint(g)?f=Fy.insideNode(d,g,r,Dy(g).moveAndExpand(Iy(t))):v||(f=Fy.nodeToVertex(d,g,r));else if(c+1===h){var y=v&&Fy.getBearing(g,d)===l;i.containsPoint(d)||y?f=Fy.insideNode(d,g,Dy(d).moveAndExpand(Iy(t)),i,l):v||(f=Fy.vertexToNode(d,g,i,l))}else v||(f=Fy.vertexToVertex(d,g,l));f?(u.push.apply(u,p(f.points)),l=f.direction):l=Fy.getBearing(d,g),c+1<h&&u.push(g)}return u};!function(e){var t={N:"S",S:"N",E:"W",W:"E"},n={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function r(e,t,n){var r=new Wd(e.x,t.y);return n.containsPoint(r)&&(r=new Wd(t.x,e.y)),r}function i(e,t){return e["W"===t||"E"===t?"width":"height"]}function o(e,t){return e.x===t.x?e.y>t.y?"N":"S":e.y===t.y?e.x>t.x?"W":"E":null}function a(e,n,r){var i=new Wd(e.x,n.y),a=new Wd(n.x,e.y),s=o(e,i),l=o(e,a),u=r?t[r]:null,c=s===r||s!==u&&(l===u||l!==r)?i:a;return{points:[c],direction:o(c,n)}}function s(e,t,n){var i=r(e,t,n);return{points:[i],direction:o(i,t)}}e.getBBoxSize=i,e.getBearing=o,e.vertexToVertex=a,e.nodeToVertex=s,e.vertexToNode=function(e,t,n,a){var s,l=[new Wd(e.x,t.y),new Wd(t.x,e.y)],u=l.filter((function(e){return!n.containsPoint(e)})),c=u.filter((function(t){return o(t,e)!==a}));if(c.length>0)return{points:[s=(s=c.filter((function(t){return o(e,t)===a})).pop())||c[0]],direction:o(s,t)};s=et(l,u)[0];var h=Wd.create(t).move(s,-i(n,a)/2);return{points:[r(h,e,n),h],direction:o(h,t)}},e.nodeToNode=function(e,t,n,r){var l=s(t,e,r),u=l.points[0];if(n.containsPoint(u)){var c=(l=s(e,t,n)).points[0];if(r.containsPoint(c)){var h=Wd.create(e).move(c,-i(n,o(e,c))/2),f=Wd.create(t).move(u,-i(r,o(t,u))/2),d=new Zd(h,f).getCenter(),g=s(e,d,n),v=a(d,t,g.direction);l.points=[g.points[0],v.points[0]],l.direction=v.direction}}return l},e.insideNode=function(e,t,i,a,s){var l,u,c,h,f=i.union(a).inflate(1),d=f.getCenter(),g=d.distance(t)>d.distance(e),v=g?t:e,p=g?e:t;return s?(l=Wd.fromPolar(f.width+f.height,n[s],v),l=f.getNearestPointToPoint(l).move(l,-1)):l=f.getNearestPointToPoint(v).move(v,1),u=r(l,p,f),l.round().equals(u.round())?(u=Wd.fromPolar(f.width+f.height,Ud.toRad(l.theta(v))+Math.PI/2,p),c=r(l,u=f.getNearestPointToPoint(u).move(p,1).round(),f),h=g?[u,c,l]:[l,c,u]):h=g?[u,l]:[l,u],{points:h,direction:o(g?l:u,t)}}}(Fy||(Fy={}));var Hy={step:10,maxLoopCount:2e3,precision:1,maxDirectionChange:90,perpendicular:!0,excludeTerminals:[],excludeNodes:[],excludeShapes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return Uy(this.step,this)},directions:function(){var e=Uy(this.step,this),t=Uy(this.cost,this);return[{cost:t,offsetX:e,offsetY:0},{cost:t,offsetX:-e,offsetY:0},{cost:t,offsetX:0,offsetY:e},{cost:t,offsetX:0,offsetY:-e}]},penalties:function(){var e=Uy(this.step,this);return{0:0,45:e/2,90:e/2}},paddingBox:function(){var e=Uy(this.step,this);return{x:-e,y:-e,width:2*e,height:2*e}},fallbackRouter:Vy,draggingRouter:null,snapToGrid:!0};function Uy(e,t){return"function"==typeof e?e.call(t):e}var qy=function(){function e(){A(this,e),this.items=[],this.hash={},this.values={}}return P(e,[{key:"add",value:function(e,t){var n=this;this.hash[e]?this.items.splice(this.items.indexOf(e),1):this.hash[e]=1,this.values[e]=t;var r=tt(this.items,e,(function(e){return n.values[e]}));this.items.splice(r,0,e)}},{key:"pop",value:function(){var e=this.items.shift();return e&&(this.hash[e]=2),e}},{key:"isOpen",value:function(e){return 1===this.hash[e]}},{key:"isClose",value:function(e){return 2===this.hash[e]}},{key:"isEmpty",value:function(){return 0===this.items.length}}]),e}(),Gy=function(){function e(t){A(this,e),this.options=t,this.mapGridSize=100,this.map={}}return P(e,[{key:"build",value:function(e,t){var n=this.options,r=n.excludeTerminals.reduce((function(n,r){var i=t[r];if(i){var o=e.getCell(i.cell);o&&n.push(o)}return n}),[]),i=[],o=e.getCell(t.getSourceCellId());o&&(i=nt(i,o.getAncestors().map((function(e){return e.id}))));var a=e.getCell(t.getTargetCellId());a&&(i=nt(i,a.getAncestors().map((function(e){return e.id}))));var s=this.mapGridSize;return e.getNodes().reduce((function(e,t){var o=r.some((function(e){return e.id===t.id})),a=!!t.shape&&n.excludeShapes.includes(t.shape),l=n.excludeNodes.some((function(e){return"string"==typeof e?t.id===e:e===t})),u=i.includes(t.id),c=a||o||l||u;if(t.isVisible()&&!c)for(var h=t.getBBox().moveAndExpand(n.paddingBox),f=h.getOrigin().snapToGrid(s),d=h.getCorner().snapToGrid(s),g=f.x;g<=d.x;g+=s)for(var v=f.y;v<=d.y;v+=s){var p=new Wd(g,v).toString();null==e[p]&&(e[p]=[]),e[p].push(h)}return e}),this.map),this}},{key:"isAccessible",value:function(e){var t=e.clone().snapToGrid(this.mapGridSize).toString(),n=this.map[t];return!n||n.every((function(t){return!t.containsPoint(e)}))}}]),e}();function Jy(e,t){var n=e.sourceBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function Wy(e,t){var n=e.targetBBox.clone();return t&&t.paddingBox?n.moveAndExpand(t.paddingBox):n}function Yy(e,t){return e.sourceAnchor?e.sourceAnchor:Jy(e,t).getCenter()}function Zy(e,t,n,r,i){var o=360/n,a=e.theta(function(e,t,n,r){var i=r.step,o=t.x-e.x,a=t.y-e.y,s=o/n.x,l=a/n.y,u=s*i,c=l*i;return new Wd(e.x+u,e.y+c)}(e,t,r,i)),s=Ud.normalize(a+o/2);return o*Math.floor(s/o)}function Xy(e,t){var n=Math.abs(e-t);return n>180?360-n:n}function Ky(e,t){if(!e)return t;var n=Math.abs(e),r=Math.round(n/t);return r?t+(n-r*t)/r:n}function $y(e,t){return e.round(t)}function Qy(e,t,n){return $y(function(e,t){var n=t.source,r=qd.snapToGrid(e.x-n.x,t.x)+n.x,i=qd.snapToGrid(e.y-n.y,t.y)+n.y;return new Wd(r,i)}(e.clone(),t),n)}function em(e){return e.toString()}function tm(e){return new Wd(0===e.x?0:Math.abs(e.x)/e.x,0===e.y?0:Math.abs(e.y)/e.y)}function nm(e,t){for(var n=1/0,r=0,i=t.length;r<i;r+=1){var o=e.manhattanDistance(t[r]);o<n&&(n=o)}return n}function rm(e,t,n,r,i){var o=i.precision,a=i.directionMap,s=e.diff(t.getCenter()),l=Object.keys(a).reduce((function(i,l){if(n.includes(l)){for(var u,c=a[l],h=new Wd(e.x+c.x*(Math.abs(s.x)+t.width),e.y+c.y*(Math.abs(s.y)+t.height)),f=new Zd(e,h).intersect(t)||[],d=null,g=0;g<f.length;g+=1){var v=f[g],p=e.squaredDistance(v);(null==u||p>u)&&(u=p,d=v)}if(d){var y=Qy(d,r,o);t.containsPoint(y)&&(y=Qy(y.translate(c.x*r.x,c.y*r.y),r,o)),i.push(y)}}return i}),[]);return t.containsPoint(e)||l.push(Qy(e,r,o)),l}function im(e,t,n,r,i){for(var o,a=[],s=tm(i.diff(n)),l=em(n),u=e[l];u;){var c=tm((o=t[l]).diff(u));c.equals(s)||(a.unshift(o),s=c),u=e[l=em(u)]}var h=t[l];return tm(h.diff(r)).equals(s)||a.unshift(h),a}function om(e,t,n,r,i){var o,a,s=i.precision;o=Yd.isRectangle(t)?$y(Yy(e,i).clone(),s):$y(t.clone(),s),a=Yd.isRectangle(n)?$y(function(e,t){return e.targetAnchor?e.targetAnchor:Wy(e,t).getCenter()}(e,i).clone(),s):$y(n.clone(),s);var l,u,c,h,f,d=(l=i.step,c=a,{source:(u=o).clone(),x:Ky(c.x-u.x,l),y:Ky(c.y-u.y,l)}),g=o,v=a;if(h=Yd.isRectangle(t)?rm(g,t,i.startDirections,d,i):[g],f=Yd.isRectangle(n)?rm(a,n,i.endDirections,d,i):[v],h=h.filter((function(e){return r.isAccessible(e)})),f=f.filter((function(e){return r.isAccessible(e)})),h.length>0&&f.length>0){for(var p=new qy,y={},m={},w={},b=0,k=h.length;b<k;b+=1){var x=h[b],C=em(x);p.add(C,nm(x,f)),y[C]=x,w[C]=0}for(var E,S,_=i.previousDirectionAngle,A=void 0===_,M=function(e,t){var n=t.step;return t.directions.forEach((function(t){t.gridOffsetX=t.offsetX/n*e.x,t.gridOffsetY=t.offsetY/n*e.y})),t.directions}(d,i),P=M.length,O=f.reduce((function(e,t){var n=em(t);return e.push(n),e}),[]),T=Wd.equalPoints(h,f),L=i.maxLoopCount;!p.isEmpty()&&L>0;){var j=p.pop(),N=y[j],R=m[j],D=w[j],I=N.equals(g),B=null==R,z=void 0;if(z=B?A?I?null:Zy(g,N,P,d,i):_:Zy(R,N,P,d,i),!(B&&T)&&O.indexOf(j)>=0)return i.previousDirectionAngle=z,im(m,y,N,g,v);for(var F=0;F<P;F+=1){var V=(E=M[F]).angle;if(S=Xy(z,V),A&&I||!(S>i.maxDirectionChange)){var H=Qy(N.clone().translate(E.gridOffsetX||0,E.gridOffsetY||0),d,s),U=em(H);if(!p.isClose(U)&&r.isAccessible(H)){if(O.indexOf(U)>=0)if(!H.equals(v))if(Xy(V,Zy(H,v,P,d,i))>i.maxDirectionChange)continue;var q=D+E.cost+(I?0:i.penalties[S]);(!p.isOpen(U)||q<w[U])&&(y[U]=H,m[U]=N,w[U]=q,p.add(U,q+nm(H,f)))}}}L-=1}}return i.fallbackRoute?hh(i.fallbackRoute,this,g,v,i):null}var am=function(e,t,n){for(var r,i,o=function(e){var t=Object.keys(e).reduce((function(t,n){return t[n]="fallbackRouter"===n||"draggingRouter"===n||"fallbackRoute"===n?e[n]:Uy(e[n],e),t}),{});if(t.padding){var n=jh(t.padding);t.paddingBox={x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom}}return t.directions.forEach((function(e){var t=new Wd(0,0),n=new Wd(e.offsetX,e.offsetY);e.angle=Ud.normalize(t.theta(n))})),t}(t),a=Jy(n,o),s=Wy(n,o),l=Yy(n,o),u=new Gy(o).build(n.graph.model,n.cell),c=e.map((function(e){return Wd.create(e)})),h=[],f=l,d=0,g=c.length;d<=g;d+=1){var v=null;if(r=i||a,null==(i=c[d])){i=s;var y=n.cell;if((null==y.getSourceCellId()||null==y.getTargetCellId())&&"function"==typeof o.draggingRouter){var m=r===a?l:r,w=i.getOrigin();v=hh(o.draggingRouter,n,m,w,o)}}if(null==v&&(v=om(n,r,i,u,o)),null===v)return console.warn("Unable to execute manhattan algorithm, use orth instead"),hh(o.fallbackRouter,this,e,o,n);var b=v[0];b&&b.equals(f)&&v.shift(),f=v[v.length-1]||f,h.push.apply(h,p(v))}return o.snapToGrid?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(e.length<=1)return e;for(var n=0,r=e.length;n<r-1;n+=1){var i=e[n],o=e[n+1];if(i.x===o.x){var a=t*Math.round(i.x/t);i.x!==a&&(i.x=a,o.x=a)}else if(i.y===o.y){var s=t*Math.round(i.y/t);i.y!==s&&(i.y=s,o.y=s)}}return e}(h,n.graph.grid.getGridSize()):h},sm=function(e,t,n){return hh(am,this,e,Object.assign(Object.assign({},Hy),t),n)},lm={maxDirectionChange:45,directions:function(){var e=Uy(this.step,this),t=Uy(this.cost,this),n=Math.ceil(Math.sqrt(e*e<<1));return[{cost:t,offsetX:e,offsetY:0},{cost:n,offsetX:e,offsetY:e},{cost:t,offsetX:0,offsetY:e},{cost:n,offsetX:-e,offsetY:e},{cost:t,offsetX:-e,offsetY:0},{cost:n,offsetX:-e,offsetY:-e},{cost:t,offsetX:0,offsetY:-e},{cost:n,offsetX:e,offsetY:-e}]},fallbackRoute:function(e,t,n){var r=e.theta(t),i=[],o={x:t.x,y:e.y},a={x:e.x,y:t.y};if(r%180>90){var s=o;o=a,a=s}var l=r%90<45?o:a,u=new Zd(e,l),c=90*Math.ceil(r/90),h=Wd.fromPolar(u.squaredLength(),Ud.toRad(c+135),l),f=new Zd(t,h),d=u.intersectsWithLine(f),g=d||t,v=d?g:e,p=360/n.directions.length,y=v.theta(t),m=Ud.normalize(y+p/2),w=p*Math.floor(m/p);return n.previousDirectionAngle=w,g&&i.push(g.round()),i.push(t),i}};function um(e,t){if(null!=t&&!1!==t){var n="boolean"==typeof t?0:t;if(n>0){var r=Wd.create(e[1]).move(e[2],n),i=Wd.create(e[1]).move(e[0],n);return[r.toJSON()].concat(p(e),[i.toJSON()])}var o=e[1];return[Object.assign({},o)].concat(p(e),[Object.assign({},o)])}return e}var cm,hm=Object.freeze(Object.defineProperty({__proto__:null,er:function(e,t,n){var r,i,o,a=t.offset||32,s=null==t.min?16:t.min,l=0,u=t.direction,c=n.sourceBBox,h=n.targetBBox,f=c.getCenter(),d=h.getCenter();if("number"==typeof a&&(l=a),null==u){var g=h.left-c.right,v=h.top-c.bottom;g>=0&&v>=0?u=g>=v?"L":"T":g<=0&&v>=0?u=(g=c.left-h.right)>=0&&g>=v?"R":"T":g>=0&&v<=0?u=(v=c.top-h.bottom)>=0?g>=v?"L":"B":"L":(g=c.left-h.right,v=c.top-h.bottom,u=g>=0&&v>=0?g>=v?"R":"B":g<=0&&v>=0?"B":g>=0&&v<=0||Math.abs(g)>Math.abs(v)?"R":"B")}"H"===u?u=d.x-f.x>=0?"L":"R":"V"===u&&(u=d.y-f.y>=0?"T":"B"),"center"===a&&("L"===u?l=(h.left-c.right)/2:"R"===u?l=(c.left-h.right)/2:"T"===u?l=(h.top-c.bottom)/2:"B"===u&&(l=(c.top-h.bottom)/2));var y="L"===u||"R"===u;if(y){if(d.y===f.y)return p(e);o="L"===u?1:-1,r="x",i="width"}else{if(d.x===f.x)return p(e);o="T"===u?1:-1,r="y",i="height"}var m=f.clone(),w=d.clone();if(m[r]+=o*(c[i]/2+l),w[r]-=o*(h[i]/2+l),y){var b=m.x,k=w.x,x=c.width/2+s,C=h.width/2+s;d.x>f.x?k<=b&&(m.x=Math.max(k,f.x+x),w.x=Math.min(b,d.x-C)):k>=b&&(m.x=Math.min(k,f.x-x),w.x=Math.max(b,d.x+C))}else{var E=m.y,S=w.y,_=c.height/2+s,A=h.height/2+s;d.y>f.y?S<=E&&(m.y=Math.max(S,f.y+_),w.y=Math.min(E,d.y-A)):S>=E&&(m.y=Math.min(S,f.y-_),w.y=Math.max(E,d.y+A))}return[m.toJSON()].concat(p(e),[w.toJSON()])},loop:function(e,t,n){var r=t.width||50,i=(t.height||80)/2,o=t.angle||"auto",a=n.sourceAnchor,s=n.targetAnchor,l=n.sourceBBox,u=n.targetBBox;if(a.equals(s)){var c=function(e){var t=Ud.toRad(e),n=Math.sin(t),o=Math.cos(t),s=new Wd(a.x+o*r,a.y+n*r),l=new Wd(s.x-o*i,s.y-n*i),u=l.clone().rotate(-90,s),c=l.clone().rotate(90,s);return[u.toJSON(),s.toJSON(),c.toJSON()]},h=function(e){var t=a.clone().move(e,-1),n=new Zd(t,e);return!l.containsPoint(e)&&!l.intersectsWithLine(n)},f=[0,90,180,270,45,135,225,315];if("number"==typeof o)return um(c(o),t.merge);var d=l.getCenter();if(d.equals(a))return um(c(0),t.merge);var g=d.angleBetween(a,d.clone().translate(1,0)),v=c(g);if(h(v[1]))return um(v,t.merge);for(var y=1,m=f.length;y<m;y+=1)if(h((v=c(g+f[y]))[1]))return um(v,t.merge);return um(v,t.merge)}var w=new Zd(a,s),b=w.parallel(-r),k=b.getCenter(),x=b.start.clone().move(b.end,i),C=b.end.clone().move(b.start,i),E=w.parallel(-1),S=new Zd(E.start,k),_=new Zd(E.end,k);if((l.containsPoint(k)||u.containsPoint(k)||l.intersectsWithLine(S)||l.intersectsWithLine(_)||u.intersectsWithLine(S)||u.intersectsWithLine(_))&&(k=(b=w.parallel(r)).getCenter(),x=b.start.clone().move(b.end,i),C=b.end.clone().move(b.start,i)),t.merge){var A=new Zd(a,s),M=new Zd(k,A.center).setLength(Number.MAX_SAFE_INTEGER),P=l.intersectsWithLine(M),O=u.intersectsWithLine(M),T=P?Array.isArray(P)?P:[P]:[];O&&(Array.isArray(O)?T.push.apply(T,p(O)):T.push(O));var L=A.center.closest(T);L?(n.sourceAnchor=L.clone(),n.targetAnchor=L.clone()):(n.sourceAnchor=A.center.clone(),n.targetAnchor=A.center.clone())}return um([x.toJSON(),k.toJSON(),C.toJSON()],t.merge)},manhattan:sm,metro:function(e,t,n){return hh(sm,this,e,Object.assign(Object.assign({},lm),t),n)},normal:function(e){return p(e)},oneSide:function(e,t,n){var r,i,o,a=t.side||"bottom",s=jh(t.padding||40),l=n.sourceBBox,u=n.targetBBox,c=l.getCenter(),h=u.getCenter();switch(a){case"top":o=-1,r="y",i="height";break;case"left":o=-1,r="x",i="width";break;case"right":o=1,r="x",i="width";break;default:o=1,r="y",i="height"}return c[r]+=o*(l[i]/2+s[a]),h[r]+=o*(u[i]/2+s[a]),o*(c[r]-h[r])>0?h[r]=c[r]:c[r]=h[r],[c.toJSON()].concat(p(e),[h.toJSON()])},orth:Vy},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=hm,e.registry=yg.create({type:"router"}),e.registry.register(e.presets,!0)}(cm||(cm={}));var fm,dm,gm=1/3,vm=2/3;function pm(e,t){var n=[e].concat(p(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]),[t]),r=[];return n.forEach((function(e,t){var i=n[t+1];null!=i&&r.push(new Zd(e,i))})),r}function ym(e,t){return new Zd(e,t).squaredLength()}function mm(e,t,n,r){var i,o=new pg;return i=pg.createSegment("M",e[0].start),o.appendSegment(i),e.forEach((function(a,s){if(fm.includes(a)){var l,u,c,h;if("arc"===n){l=-90,((u=a.start.diff(a.end)).x<0||0===u.x&&u.y<0)&&(l+=180);var f,d=a.getCenter(),g=new Zd(d,a.end).rotate(l,d);c=(f=new Zd(a.start,d)).pointAt(2/3).rotate(l,a.start),h=g.pointAt(1/3).rotate(-l,g.end),i=pg.createSegment("C",c,h,g.end),o.appendSegment(i),f=new Zd(d,a.end),c=g.pointAt(1/3).rotate(l,g.end),h=f.pointAt(1/3).rotate(-l,a.end),i=pg.createSegment("C",c,h,a.end),o.appendSegment(i)}else if("gap"===n)i=pg.createSegment("M",a.end),o.appendSegment(i);else if("cubic"===n){l=a.start.theta(a.end);var v=.6*t,p=1.35*t;((u=a.start.diff(a.end)).x<0||0===u.x&&u.y<0)&&(p*=-1),c=new Wd(a.start.x+v,a.start.y+p).rotate(l,a.start),h=new Wd(a.end.x-v,a.end.y+p).rotate(l,a.end),i=pg.createSegment("C",c,h,a.end),o.appendSegment(i)}}else{var y=e[s+1];0===r||!y||fm.includes(y)?(i=pg.createSegment("L",a.end),o.appendSegment(i)):function(e,t,n,r,i){var o,a=n.distance(r)/2,s=n.distance(i)/2,l=-Math.min(e,a),u=-Math.min(e,s),c=n.clone().move(r,l).round(),h=n.clone().move(i,u).round(),f=new Wd(gm*c.x+vm*n.x,vm*n.y+gm*c.y),d=new Wd(gm*h.x+vm*n.x,vm*n.y+gm*h.y);o=pg.createSegment("L",c),t.appendSegment(o),o=pg.createSegment("C",f,d,h),t.appendSegment(o)}(r,o,a.end,a.start,y.end)}})),o}var wm,bm=Object.freeze(Object.defineProperty({__proto__:null,jumpover:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};fm=[],dm=[],function(e){var t=e.graph._jumpOverUpdateList;if(null==t&&(t=e.graph._jumpOverUpdateList=[],e.graph.on("cell:mouseup",(function(){var t=e.graph._jumpOverUpdateList;setTimeout((function(){for(var e=0;e<t.length;e+=1)t[e].update()}))})),e.graph.on("model:reseted",(function(){t=e.graph._jumpOverUpdateList=[]}))),t.indexOf(e)<0){t.push(e);var n=function(){return t.splice(t.indexOf(e),1)};e.cell.once("change:connector",n),e.cell.once("removed",n)}}(this);var o=i.size||5,a=i.type||"arc",s=i.radius||0,l=i.ignoreConnectors||["smooth"],u=this.graph,c=u.model.getEdges();if(1===c.length)return mm(pm(e,t,n),o,a,s);var h=this.cell,f=c.indexOf(h),d=u.options.connecting.connector||{},g=c.filter((function(e,t){var n=e.getConnector()||d;return!l.includes(n.name)&&(!(t>f)||"jumpover"!==n.name)})),v=g.map((function(e){return u.findViewByCell(e)})),y=pm(e,t,n),m=v.map((function(e){return null==e?[]:e===r?y:pm(e.sourcePoint,e.targetPoint,e.routePoints)})),w=[];y.forEach((function(e){var t=g.reduce((function(t,n,r){if(n!==h){var i=function(e,t){var n=[];return t.forEach((function(t){var r=e.intersectsWithLine(t);r&&n.push(r)})),n}(e,m[r]);t.push.apply(t,p(i))}return t}),[]).sort((function(t,n){return ym(e.start,t)-ym(e.start,n)}));t.length>0?w.push.apply(w,p(function(e,t,n){return t.reduce((function(r,i,o){if(dm.includes(i))return r;var a=r.pop()||e,s=Wd.create(i).move(a.start,-n),l=Wd.create(i).move(a.start,+n),u=t[o+1];if(null!=u){var c=l.distance(u);c<=n&&(l=u.move(a.start,c),dm.push(u))}else if(s.distance(a.end)<2*n+1)return r.push(a),r;if(l.distance(a.start)<2*n+1)return r.push(a),r;var h=new Zd(s,l);return fm.push(h),r.push(new Zd(a.start,s),h,new Zd(l,a.end)),r}),[])}(e,t,o))):w.push(e)}));var b=mm(w,o,a,s);return fm=[],dm=[],i.raw?b:b.serialize()},loop:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=3===n.length?0:1,o=Wd.create(n[0+i]),a=Wd.create(n[2+i]),s=Wd.create(n[1+i]);if(!Wd.equals(e,t)){var l=new Wd((e.x+t.x)/2,(e.y+t.y)/2),u=l.angleBetween(Wd.create(e).rotate(90,l),s);u>1&&(o.rotate(180-u,l),a.rotate(180-u,l),s.rotate(180-u,l))}var c="\n     M ".concat(e.x," ").concat(e.y,"\n     Q ").concat(o.x," ").concat(o.y," ").concat(s.x," ").concat(s.y,"\n     Q ").concat(a.x," ").concat(a.y," ").concat(t.x," ").concat(t.y,"\n  ");return r.raw?pg.parse(c):c},normal:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=[e].concat(p(n),[t]),o=new rg(i),a=new pg(o);return r.raw?a:a.serialize()},rounded:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new pg;i.appendSegment(pg.createSegment("M",e));for(var o,a,s=1/3,l=2/3,u=r.radius||10,c=0,h=n.length;c<h;c+=1){var f=Wd.create(n[c]),d=n[c-1]||e,g=n[c+1]||t;o=a||f.distance(d)/2,a=f.distance(g)/2;var v=-Math.min(u,o),p=-Math.min(u,a),y=f.clone().move(d,v).round(),m=f.clone().move(g,p).round(),w=new Wd(s*y.x+l*f.x,l*f.y+s*y.y),b=new Wd(s*m.x+l*f.x,l*f.y+s*m.y);i.appendSegment(pg.createSegment("L",y)),i.appendSegment(pg.createSegment("C",w,b,m))}return i.appendSegment(pg.createSegment("L",t)),r.raw?i:i.serialize()},smooth:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i.direction;if(n&&0!==n.length){var a=[e].concat(p(n),[t]),s=ig.throughPoints(a);r=new pg(s)}else if((r=new pg).appendSegment(pg.createSegment("M",e)),o||(o=Math.abs(e.x-t.x)>=Math.abs(e.y-t.y)?"H":"V"),"H"===o){var l=(e.x+t.x)/2;r.appendSegment(pg.createSegment("C",l,e.y,l,t.y,t.x,t.y))}else{var u=(e.y+t.y)/2;r.appendSegment(pg.createSegment("C",e.x,u,t.x,u,t.x,t.y))}return i.raw?r:r.serialize()}},Symbol.toStringTag,{value:"Module"}));!function(e){e.presets=bm,e.registry=yg.create({type:"connector"}),e.registry.register(e.presets,!0)}(wm||(wm={}));var km=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xm=function(e){l(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,n),(e=t.call(this)).pending=!1,e.changing=!1,e.data={},e.mutate(Xe(r)),e.changed={},e}return P(n,[{key:"mutate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!0===n.unset,i=!0===n.silent,o=[],a=this.changing;this.changing=!0,a||(this.previous=Xe(this.data),this.changed={});var s=this.data,l=this.previous,u=this.changed;if(Object.keys(e).forEach((function(t){var n=t,i=e[n];rt(s[n],i)||o.push(n),rt(l[n],i)?delete u[n]:u[n]=i,r?delete s[n]:s[n]=i})),!i&&o.length>0&&(this.pending=!0,this.pendingOptions=n,o.forEach((function(e){t.emit("change:*",{key:e,options:n,store:t,current:s[e],previous:l[e]})}))),a)return this;if(!i)for(;this.pending;)this.pending=!1,this.emit("changed",{current:s,previous:l,store:this,options:this.pendingOptions});return this.pending=!1,this.changing=!1,this.pendingOptions=null,this}},{key:"get",value:function(e,t){if(null==e)return this.data;var n=this.data[e];return null==n?t:n}},{key:"getPrevious",value:function(e){if(this.previous){var t=this.previous[e];return null==t?void 0:t}}},{key:"set",value:function(e,t,n){return null!=e&&("object"===v(e)?this.mutate(e,t):this.mutate(O({},e,t),n)),this}},{key:"remove",value:function(e,t){var n,r=void 0,i={};if("string"==typeof e)i[e]=r,n=t;else if(Array.isArray(e))e.forEach((function(e){return i[e]=r})),n=t;else{for(var o in this.data)i[o]=r;n=e}return this.mutate(i,Object.assign(Object.assign({},n),{unset:!0})),this}},{key:"getByPath",value:function(e){return bh(this.data,e,"/")}},{key:"setByPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="/",i=Array.isArray(e)?p(e):e.split(r),o=Array.isArray(e)?e.join(r):e,a=i[0],s=i.length;if(n.propertyPath=o,n.propertyValue=t,n.propertyPathArray=i,1===s)this.set(a,t,n);else{for(var l={},u=l,c=a,h=1;h<s;h+=1){var f=i[h],d=Number.isFinite(Number(f));u=u[c]=d?[]:{},c=f}kh(l,i,t,r);var g=Xe(this.data);n.rewrite&&xh(g,e,r);var v=$e(g,l);this.set(a,v[a],n)}return this}},{key:"removeByPath",value:function(e,t){var n=Array.isArray(e)?e:e.split("/"),r=n[0];if(1===n.length)this.remove(r,t);else{var i=n.slice(1),o=Xe(this.get(r));o&&xh(o,i),this.set(r,o,t)}return this}},{key:"hasChanged",value:function(e){return null==e?Object.keys(this.changed).length>0:e in this.changed}},{key:"getChanges",value:function(e){if(null==e)return this.hasChanged()?Xe(this.changed):null;var t,n=this.changing?this.previous:this.data,r={};for(var i in e){var o=e[i];rt(n[i],o)||(r[i]=o,t=!0)}return t?Xe(r):null}},{key:"toJSON",value:function(){return Xe(this.data)}},{key:"clone",value:function(){return new(0,this.constructor)(this.data)}},{key:"dispose",value:function(){this.off(),this.data={},this.previous={},this.changed={},this.pending=!1,this.changing=!1,this.pendingOptions=null,this.trigger("disposed",{store:this})}}]),n}(Eh);km([Eh.dispose()],xm.prototype,"dispose",null);var Cm=function(){function e(t){A(this,e),this.cell=t,this.ids={},this.cache={}}return P(e,[{key:"get",value:function(){return Object.keys(this.ids)}},{key:"start",value:function(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",a=this.cell.getPropByPath(t),s=it(i,e.defaultOptions),l=this.getTiming(s.timing),u=this.getInterp(s.interp,a,n),c=0,h=Array.isArray(t)?t.join(o):t,f=Array.isArray(t)?t:t.split(o),d=function e(){var t=(new Date).getTime();0===c&&(c=t);var n=(t-c)/s.duration;n<1?r.ids[h]=requestAnimationFrame(e):n=1;var o=u(l(n));r.cell.setPropByPath(f,o),i.progress&&i.progress(Object.assign({progress:n,currentValue:o},r.getArgs(h))),1===n&&(r.cell.notify("transition:complete",r.getArgs(h)),i.complete&&i.complete(r.getArgs(h)),r.cell.notify("transition:finish",r.getArgs(h)),i.finish&&i.finish(r.getArgs(h)),r.clean(h))};return setTimeout((function(){r.stop(t,void 0,o),r.cache[h]={startValue:a,targetValue:n,options:s},r.ids[h]=requestAnimationFrame(d),r.cell.notify("transition:start",r.getArgs(h)),i.start&&i.start(r.getArgs(h))}),i.delay),this.stop.bind(this,t,o,i)}},{key:"stop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",i=Array.isArray(e)?e:e.split(r);return Object.keys(this.ids).filter((function(e){return rt(i,e.split(r).slice(0,i.length))})).forEach((function(e){cancelAnimationFrame(t.ids[e]);var r=t.cache[e],i=t.getArgs(e),o=Object.assign(Object.assign({},r.options),n),a=o.jumpedToEnd;a&&null!=r.targetValue&&(t.cell.setPropByPath(e,r.targetValue),t.cell.notify("transition:end",Object.assign({},i)),t.cell.notify("transition:complete",Object.assign({},i)),o.complete&&o.complete(Object.assign({},i)));var s=Object.assign({jumpedToEnd:a},i);t.cell.notify("transition:stop",Object.assign({},s)),o.stop&&o.stop(Object.assign({},s)),t.cell.notify("transition:finish",Object.assign({},i)),o.finish&&o.finish(Object.assign({},i)),t.clean(e)})),this}},{key:"clean",value:function(e){delete this.ids[e],delete this.cache[e]}},{key:"getTiming",value:function(e){return"string"==typeof e?Fd[e]:e}},{key:"getInterp",value:function(e,t,n){return e?e(t,n):"number"==typeof n?Vd.number(t,n):"string"==typeof n?"#"===n[0]?Vd.color(t,n):Vd.unit(t,n):Vd.object(t,n)}},{key:"getArgs",value:function(e){var t=this.cache[e];return{path:e,startValue:t.startValue,targetValue:t.targetValue,cell:this.cell}}}]),e}();!function(e){e.defaultOptions={delay:10,duration:100,timing:"linear"}}(Cm||(Cm={}));var Em,Sm=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_m=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Am=function(e,t){l(r,e);var n=c(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};A(this,r);var i=(e=n.call(this)).constructor.getDefaults(!0),o=$e({},e.preprocess(i),e.preprocess(t));return e.id=o.id||Ph(),e.store=new xm(o),e.animation=new Cm(f(e)),e.setup(),e.init(),e.postprocess(t),e}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"init",value:function(){}},{key:"model",get:function(){return this._model}},{key:"model",set:function(e){this._model!==e&&(this._model=e)}},{key:"preprocess",value:function(e,t){var n=e.id,r=this.constructor.applyPropHooks(this,e);return null==n&&!0!==t&&(r.id=Ph()),r}},{key:"postprocess",value:function(e){}},{key:"setup",value:function(){var e=this;this.store.on("change:*",(function(t){var n=t.key,r=t.current,i=t.previous,o=t.options;e.notify("change:*",{key:n,options:o,current:r,previous:i,cell:e}),e.notify("change:".concat(n),{options:o,current:r,previous:i,cell:e});var a=n;"source"!==a&&"target"!==a||e.notify("change:terminal",{type:a,current:r,previous:i,options:o,cell:e})})),this.store.on("changed",(function(t){var n=t.options;return e.notify("changed",{options:n,cell:e})}))}},{key:"notify",value:function(e,t){this.trigger(e,t);var n=this.model;return n&&(n.notify("cell:".concat(e),t),this.isNode()?n.notify("node:".concat(e),Object.assign(Object.assign({},t),{node:this})):this.isEdge()&&n.notify("edge:".concat(e),Object.assign(Object.assign({},t),{edge:this}))),this}},{key:"isNode",value:function(){return!1}},{key:"isEdge",value:function(){return!1}},{key:"isSameStore",value:function(e){return this.store===e.store}},{key:"view",get:function(){return this.store.get("view")}},{key:"shape",get:function(){return this.store.get("shape","")}},{key:"getProp",value:function(e,t){return null==e?this.store.get():this.store.get(e,t)}},{key:"setProp",value:function(e,t,n){if("string"==typeof e)this.store.set(e,t,n);else{var r=this.preprocess(e,!0);this.store.set($e({},this.getProp(),r),t),this.postprocess(e)}return this}},{key:"removeProp",value:function(e,t){return"string"==typeof e||Array.isArray(e)?this.store.removeByPath(e,t):this.store.remove(t),this}},{key:"hasChanged",value:function(e){return null==e?this.store.hasChanged():this.store.hasChanged(e)}},{key:"getPropByPath",value:function(e){return this.store.getByPath(e)}},{key:"setPropByPath",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model&&("children"===e?this._children=t?t.map((function(e){return n.model.getCell(e)})).filter((function(e){return null!=e})):null:"parent"===e&&(this._parent=t?this.model.getCell(t):null)),this.store.setByPath(e,t,r),this}},{key:"removePropByPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:e.split("/");return"attrs"===n[0]&&(t.dirty=!0),this.store.removeByPath(n,t),this}},{key:"prop",value:function(e,t,n){return null==e?this.getProp():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getPropByPath(e):null==t?this.removePropByPath(e,n||{}):this.setPropByPath(e,t,n||{}):this.setProp(e,t||{})}},{key:"previous",value:function(e){return this.store.getPrevious(e)}},{key:"zIndex",get:function(){return this.getZIndex()}},{key:"zIndex",set:function(e){null==e?this.removeZIndex():this.setZIndex(e)}},{key:"getZIndex",value:function(){return this.store.get("zIndex")}},{key:"setZIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("zIndex",e,t),this}},{key:"removeZIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("zIndex",e),this}},{key:"toFront",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.model;if(t){var n,r=t.getMaxZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this],r=r-n.length+1;var i=t.total(),o=t.indexOf(this)!==i-n.length;o||(o=n.some((function(e,t){return e.getZIndex()!==r+t}))),o&&this.batchUpdate("to-front",(function(){r+=n.length,n.forEach((function(t,n){t.setZIndex(r+n,e)}))}))}return this}},{key:"toBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.model;if(t){var n,r=t.getMinZIndex();e.deep?(n=this.getDescendants({deep:!0,breadthFirst:!0})).unshift(this):n=[this];var i=0!==t.indexOf(this);i||(i=n.some((function(e,t){return e.getZIndex()!==r+t}))),i&&this.batchUpdate("to-back",(function(){r-=n.length,n.forEach((function(t,n){t.setZIndex(r+n,e)}))}))}return this}},{key:"markup",get:function(){return this.getMarkup()}},{key:"markup",set:function(e){null==e?this.removeMarkup():this.setMarkup(e)}},{key:"getMarkup",value:function(){var e=this.store.get("markup");null==e&&(e=this.constructor.getMarkup());return e}},{key:"setMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("markup",e,t),this}},{key:"removeMarkup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("markup",e),this}},{key:"attrs",get:function(){return this.getAttrs()}},{key:"attrs",set:function(e){null==e?this.removeAttrs():this.setAttrs(e)}},{key:"getAttrs",value:function(){var e=this.store.get("attrs");return e?Object.assign({},e):{}}},{key:"setAttrs",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)this.removeAttrs(n);else{var r=function(e){return t.store.set("attrs",e,n)};if(!0===n.overwrite)r(e);else{var i=this.getAttrs();!1===n.deep?r(Object.assign(Object.assign({},i),e)):r($e({},i,e))}}return this}},{key:"replaceAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setAttrs(e,Object.assign(Object.assign({},t),{overwrite:!0}))}},{key:"updateAttrs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setAttrs(e,Object.assign(Object.assign({},t),{deep:!1}))}},{key:"removeAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("attrs",e),this}},{key:"getAttrDefinition",value:function(e){if(!e)return null;var t=this.constructor.getAttrHooks()||{},n=t[e]||tp.registry.get(e);if(!n){var r=Ue(e);n=t[r]||tp.registry.get(r)}return n||null}},{key:"getAttrByPath",value:function(e){return null==e||""===e?this.getAttrs():this.getPropByPath(this.prefixAttrPath(e))}},{key:"setAttrByPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setPropByPath(this.prefixAttrPath(e),t,n),this}},{key:"removeAttrByPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removePropByPath(this.prefixAttrPath(e),t),this}},{key:"prefixAttrPath",value:function(e){return Array.isArray(e)?["attrs"].concat(e):"attrs/".concat(e)}},{key:"attr",value:function(e,t,n){return null==e?this.getAttrByPath():"string"==typeof e||Array.isArray(e)?1===arguments.length?this.getAttrByPath(e):null==t?this.removeAttrByPath(e,n||{}):this.setAttrByPath(e,t,n||{}):this.setAttrs(e,t||{})}},{key:"visible",get:function(){return this.isVisible()}},{key:"visible",set:function(e){this.setVisible(e)}},{key:"setVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("visible",e,t),this}},{key:"isVisible",value:function(){return!1!==this.store.get("visible")}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isVisible()||this.setVisible(!0,e),this}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isVisible()&&this.setVisible(!1,e),this}},{key:"toggleVisible",value:function(e){var t="boolean"==typeof e?arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}:e;return("boolean"==typeof e?e:!this.isVisible())?this.show(t):this.hide(t),this}},{key:"data",get:function(){return this.getData()}},{key:"data",set:function(e){this.setData(e)}},{key:"getData",value:function(){return this.store.get("data")}},{key:"setData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)this.removeData(n);else{var r=function(e){return t.store.set("data",e,n)};if(!0===n.overwrite)r(e);else{var i=this.getData();!1===n.deep?r("object"===v(e)?Object.assign(Object.assign({},i),e):e):r($e({},i,e))}}return this}},{key:"replaceData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setData(e,Object.assign(Object.assign({},t),{overwrite:!0}))}},{key:"updateData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.setData(e,Object.assign(Object.assign({},t),{deep:!1}))}},{key:"removeData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("data",e),this}},{key:"parent",get:function(){return this.getParent()}},{key:"children",get:function(){return this.getChildren()}},{key:"getParentId",value:function(){return this.store.get("parent")}},{key:"getParent",value:function(){var e=this.getParentId();if(e&&this.model){var t=this.model.getCell(e);return this._parent=t,t}return null}},{key:"getChildren",value:function(){var e=this,t=this.store.get("children");if(t&&t.length&&this.model){var n=t.map((function(t){var n;return null===(n=e.model)||void 0===n?void 0:n.getCell(t)})).filter((function(e){return null!=e}));return this._children=n,p(n)}return null}},{key:"hasParent",value:function(){return null!=this.parent}},{key:"isParentOf",value:function(e){return null!=e&&e.getParent()===this}},{key:"isChildOf",value:function(e){return null!=e&&this.getParent()===e}},{key:"eachChild",value:function(e,t){return this.children&&this.children.forEach(e,t),this}},{key:"filterChild",value:function(e,t){return this.children?this.children.filter(e,t):[]}},{key:"getChildCount",value:function(){return null==this.children?0:this.children.length}},{key:"getChildIndex",value:function(e){return null==this.children?-1:this.children.indexOf(e)}},{key:"getChildAt",value:function(e){return null!=this.children&&e>=0?this.children[e]:null}},{key:"getAncestors",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],n=this.getParent();n;)t.push(n),n=!1!==e.deep?n.getParent():null;return t}},{key:"getDescendants",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1!==e.deep){if(e.breadthFirst){for(var t=[],n=this.getChildren()||[];n.length>0;){var r=n.shift(),i=r.getChildren();t.push(r),i&&n.push.apply(n,p(i))}return t}var o=this.getChildren()||[];return o.forEach((function(t){o.push.apply(o,p(t.getDescendants(e)))})),o}return this.getChildren()||[]}},{key:"isDescendantOf",value:function(e){if(null==e)return!1;if(!1!==(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).deep){for(var t=this.getParent();t;){if(t===e)return!0;t=t.getParent()}return!1}return this.isChildOf(e)}},{key:"isAncestorOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=e&&e.isDescendantOf(this,t)}},{key:"contains",value:function(e){return this.isAncestorOf(e)}},{key:"getCommonAncestor",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.getCommonAncestor.apply(r,[this].concat(t))}},{key:"setParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._parent=e,e?this.store.set("parent",e.id,t):this.store.remove("parent",t),this}},{key:"setChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._children=e,null!=e?this.store.set("children",e.map((function(e){return e.id})),t):this.store.remove("children",t),this}},{key:"unembed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.children;if(null!=n&&null!=e){var r=this.getChildIndex(e);-1!==r&&(n.splice(r,1),e.setParent(null,t),this.setChildren(n,t))}return this}},{key:"embed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.addTo(this,t),this}},{key:"addTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.isCell(e)?e.addChild(this,t):e.addCell(this,t),this}},{key:"insertTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.insertChild(this,t,n),this}},{key:"addChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertChild(e,void 0,t)}},{key:"insertChild",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&e!==this){var r=e.getParent(),i=this!==r,o=t;if(null==o&&(o=this.getChildCount(),i||(o-=1)),r){var a=r.getChildren();if(a){var s=a.indexOf(e);s>=0&&(e.setParent(null,n),a.splice(s,1),r.setChildren(a,n))}}var l=this.children;if(null==l?(l=[]).push(e):l.splice(o,0,e),e.setParent(this,n),this.setChildren(l,n),i&&this.model){var u=this.model.getIncomingEdges(this),c=this.model.getOutgoingEdges(this);u&&u.forEach((function(e){return e.updateParent(n)})),c&&c.forEach((function(e){return e.updateParent(n)}))}this.model&&this.model.addCell(e,n)}return this}},{key:"removeFromParent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getParent();if(null!=t){var n=t.getChildIndex(this);t.removeChildAt(n,e)}return this}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getChildIndex(e);return this.removeChildAt(n,t)}},{key:"removeChildAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getChildAt(e);return null!=this.children&&null!=n&&(this.unembed(n,t),n.remove(t)),n}},{key:"remove",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.batchUpdate("remove",(function(){var n=e.getParent();n&&n.removeChild(e,t),!1!==t.deep&&e.eachChild((function(e){return e.remove(t)})),e.model&&e.model.removeCell(e,t)})),this}},{key:"transition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/";return this.animation.start(e,t,n,r)}},{key:"stopTransition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";return this.animation.stop(e,t,n),this}},{key:"getTransitions",value:function(){return this.animation.get()}},{key:"translate",value:function(e,t,n){return this}},{key:"scale",value:function(e,t,n,r){return this}},{key:"addTools",value:function(e,t,n){var r=Array.isArray(e)?e:[e],i="string"==typeof t?t:null,o="object"===v(t)?t:"object"===v(n)?n:{};if(o.reset)return this.setTools({name:i,items:r,local:o.local},o);var a=Xe(this.getTools());return null==a||null==i||a.name===i?(null==a&&(a={}),a.items||(a.items=[]),a.name=i,a.items=[].concat(p(a.items),p(r)),this.setTools(Object.assign({},a),o)):void 0}},{key:"setTools",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?this.removeTools():this.store.set("tools",r.normalizeTools(e),t),this}},{key:"getTools",value:function(){return this.store.get("tools")}},{key:"removeTools",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("tools",e),this}},{key:"hasTools",value:function(e){var t=this.getTools();return null!=t&&(null==e||t.name===e)}},{key:"hasTool",value:function(e){var t=this.getTools();return null!=t&&t.items.some((function(t){return"string"==typeof t?t===e:t.name===e}))}},{key:"removeTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Xe(this.getTools());if(n){var r=!1,i=n.items.slice(),o=function(e){i.splice(e,1),r=!0};if("number"==typeof e)o(e);else for(var a=i.length-1;a>=0;a-=1){var s=i[a];("string"==typeof s?s===e:s.name===e)&&o(a)}r&&(n.items=i,this.setTools(n,t))}return this}},{key:"getBBox",value:function(e){return new Yd}},{key:"getConnectionPoint",value:function(e,t){return new Wd}},{key:"toJSON",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},this.store.get()),r=Object.prototype.toString,i=this.isNode()?"node":this.isEdge()?"edge":"cell";if(!n.shape){var o=this.constructor;throw new Error("Unable to serialize ".concat(i,' missing "shape" prop, check the ').concat(i,' "').concat(o.name||r.call(o),'"'))}var a=this.constructor,s=!0===t.diff,l=n.attrs||{},u=a.getDefaults(!0),c=s?this.preprocess(u,!0):u,h=c.attrs||{},f={};Object.entries(n).forEach((function(t){var o=m(t,2),a=o[0],l=o[1];if(null!=l&&!Array.isArray(l)&&"object"===v(l)&&!Ye(l))throw new Error("Can only serialize ".concat(i,' with plain-object props, but got a "').concat(r.call(l),'" type of key "').concat(a,'" on ').concat(i,' "').concat(e.id,'"'));if("attrs"!==a&&"shape"!==a&&s){var u=c[a];rt(l,u)&&delete n[a]}})),Object.keys(l).forEach((function(e){var t=l[e],n=h[e];Object.keys(t).forEach((function(r){var i=t[r],o=n?n[r]:null;null==i||"object"!==v(i)||Array.isArray(i)?null!=n&&rt(o,i)||(null==f[e]&&(f[e]={}),f[e][r]=i):Object.keys(i).forEach((function(t){var a=i[t];null!=n&&null!=o&&qe(o)&&rt(o[t],a)||(null==f[e]&&(f[e]={}),null==f[e][r]&&(f[e][r]={}),f[e][r][t]=a)}))}))}));var d=Object.assign(Object.assign({},n),{attrs:ot(f)?void 0:f});null==d.attrs&&delete d.attrs;var g=d;return 0===g.angle&&delete g.angle,Xe(g)}},{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.deep){var t=Object.assign({},this.store.get());return e.keepId||delete t.id,delete t.parent,delete t.children,new(0,this.constructor)(t)}return r.deepClone(this)[this.id]}},{key:"findView",value:function(e){return e.findViewByCell(this)}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model;return this.notify("batch:start",{name:e,data:t,cell:this}),n&&n.startBatch(e,Object.assign(Object.assign({},t),{cell:this})),this}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.model;return n&&n.stopBatch(e,Object.assign(Object.assign({},t),{cell:this})),this.notify("batch:stop",{name:e,data:t,cell:this}),this}},{key:"batchUpdate",value:function(e,t,n){var r=this.model;this.startBatch(e,n,r);var i=t();return this.stopBatch(e,n,r),i}},{key:"dispose",value:function(){this.removeFromParent(),this.store.dispose()}}],[{key:"config",value:function(e){var t,n=this,r=e.markup,i=e.propHooks,o=e.attrHooks,a=_m(e,["markup","propHooks","attrHooks"]);(null!=r&&(this.markup=r),i)&&(this.propHooks=this.propHooks.slice(),Array.isArray(i)?(t=this.propHooks).push.apply(t,p(i)):"function"==typeof i?this.propHooks.push(i):Object.values(i).forEach((function(e){"function"==typeof e&&n.propHooks.push(e)})));o&&(this.attrHooks=Object.assign(Object.assign({},this.attrHooks),o)),this.defaults=$e({},this.defaults,a)}},{key:"getMarkup",value:function(){return this.markup}},{key:"getDefaults",value:function(e){return e?this.defaults:Xe(this.defaults)}},{key:"getAttrHooks",value:function(){return this.attrHooks}},{key:"applyPropHooks",value:function(e,t){return this.propHooks.reduce((function(t,n){return n?hh(n,e,t):t}),t)}}]),r}(Eh,Symbol.toStringTag);Am.defaults={},Am.attrHooks={},Am.propHooks=[],Sm([Eh.dispose()],Am.prototype,"dispose",null),function(e){e.normalizeTools=function(e){return"string"==typeof e?{items:[e]}:Array.isArray(e)?{items:e}:e.items?e:{items:[e]}}}(Am||(Am={})),function(e){e.toStringTag="X6.".concat(e.name),e.isCell=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNode&&"function"==typeof r.isEdge&&"function"==typeof r.prop&&"function"==typeof r.attr}}(Am||(Am={})),function(e){e.getCommonAncestor=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.filter((function(e){return null!=e})).map((function(e){return e.getAncestors()})).sort((function(e,t){return e.length-t.length}));return r.shift().find((function(e){return r.every((function(t){return t.includes(e)}))}))||null},e.getCellsBBox=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=0,i=e.length;r<i;r+=1){var o=e[r],a=o.getBBox(t);if(a){if(o.isNode()){var s=o.getAngle();null!=s&&0!==s&&(a=a.bbox(s))}n=null==n?a:n.union(a)}}return n},e.deepClone=function(t){var n=[t].concat(p(t.getDescendants({deep:!0})));return e.cloneCells(n)},e.cloneCells=function(e){var t=Qe(e),n=t.reduce((function(e,t){return e[t.id]=t.clone(),e}),{});return t.forEach((function(e){var t=n[e.id];if(t.isEdge()){var r=t.getSourceCellId(),i=t.getTargetCellId();r&&n[r]&&t.setSource(Object.assign(Object.assign({},t.getSource()),{cell:n[r].id})),i&&n[i]&&t.setTarget(Object.assign(Object.assign({},t.getTarget()),{cell:n[i].id}))}var o=e.getParent();o&&n[o.id]&&t.setParent(n[o.id]);var a=e.getChildren();if(a&&a.length){var s=a.reduce((function(e,t){return n[t.id]&&e.push(n[t.id]),e}),[]);s.length>0&&t.setChildren(s)}})),n}}(Am||(Am={})),function(e){e.config({propHooks:function(t){var n=t.tools,r=_m(t,["tools"]);return n&&(r.tools=e.normalizeTools(n)),r}})}(Am||(Am={})),function(e){var t,n;e.exist=function(e,r){return r?null!=t&&t.exist(e):null!=n&&n.exist(e)},e.setEdgeRegistry=function(e){t=e},e.setNodeRegistry=function(e){n=e}}(Em||(Em={}));var Mm=function(){function e(t){A(this,e),this.ports=[],this.groups={},this.init(Xe(t))}return P(e,[{key:"getPorts",value:function(){return this.ports}},{key:"getGroup",value:function(e){return null!=e?this.groups[e]:null}},{key:"getPortsByGroup",value:function(e){return this.ports.filter((function(t){return t.group===e||null==t.group&&null==e}))}},{key:"getPortsLayoutByGroup",value:function(e,t){var n,r=this,i=this.getPortsByGroup(e),o=e?this.getGroup(e):null,a=o?o.position:null,s=a?a.name:null;if(null!=s){var l=wp.registry.get(s);if(null==l)return wp.registry.onNotFound(s);n=l}else n=wp.presets.left;var u=i.map((function(e){return e&&e.position&&e.position.args||{}})),c=a&&a.args||{};return n(u,t,c).map((function(e,n){var o=i[n];return{portLayout:e,portId:o.id,portSize:o.size,portAttrs:o.attrs,labelSize:o.label.size,labelLayout:r.getPortLabelLayout(o,Wd.create(e.position),t)}}))}},{key:"init",value:function(e){var t=this,n=e.groups,r=e.items;null!=n&&Object.keys(n).forEach((function(e){t.groups[e]=t.parseGroup(n[e])})),Array.isArray(r)&&r.forEach((function(e){t.ports.push(t.parsePort(e))}))}},{key:"parseGroup",value:function(e){return Object.assign(Object.assign({},e),{label:this.getLabel(e,!0),position:this.getPortPosition(e.position,!0)})}},{key:"parsePort",value:function(e){var t=Object.assign({},e),n=this.getGroup(e.group)||{};return t.markup=t.markup||n.markup,t.attrs=$e({},n.attrs,t.attrs),t.position=this.createPosition(n,t),t.label=$e({},n.label,this.getLabel(t)),t.zIndex=this.getZIndex(n,t),t.size=Object.assign(Object.assign({},n.size),t.size),t}},{key:"getZIndex",value:function(e,t){return"number"==typeof t.zIndex?t.zIndex:"number"==typeof e.zIndex||"auto"===e.zIndex?e.zIndex:"auto"}},{key:"createPosition",value:function(e,t){return $e({name:"left",args:{}},e.position,{args:t.args})}},{key:"getPortPosition",value:function(e){if(null==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if(Array.isArray(e))return{name:"absolute",args:{x:e[0],y:e[1]}};if("object"===v(e))return e}return{args:{}}}},{key:"getPortLabelPosition",value:function(e){if(null==e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return{name:"left",args:{}}}else{if("string"==typeof e)return{name:e,args:{}};if("object"===v(e))return e}return{args:{}}}},{key:"getLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.label||{};return n.position=this.getPortLabelPosition(n.position,t),n}},{key:"getPortLabelLayout",value:function(e,t,n){var r=e.label.position.name||"left",i=e.label.position.args||{},o=Ap.registry.get(r)||Ap.presets.left;return o?o(t,n,i):null}}]),e}(),Pm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Om=function(e,t){l(r,e);var n=c(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,r),(e=n.call(this,t)).initPorts(),e}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"preprocess",value:function(e,t){var n=e.x,i=e.y,o=e.width,a=e.height,l=Pm(e,["x","y","width","height"]);if(null!=n||null!=i){var u=l.position;l.position=Object.assign(Object.assign({},u),{x:null!=n?n:u?u.x:0,y:null!=i?i:u?u.y:0})}if(null!=o||null!=a){var c=l.size;l.size=Object.assign(Object.assign({},c),{width:null!=o?o:c?c.width:0,height:null!=a?a:c?c.height:0})}return s(g(r.prototype),"preprocess",this).call(this,l,t)}},{key:"isNode",value:function(){return!0}},{key:"size",value:function(e,t,n){return void 0===e?this.getSize():"number"==typeof e?this.setSize(e,t,n):this.setSize(e,t)}},{key:"getSize",value:function(){var e=this.store.get("size");return e?Object.assign({},e):{width:1,height:1}}},{key:"setSize",value:function(e,t,n){return"object"===v(e)?this.resize(e.width,e.height,t):this.resize(e,t,n),this}},{key:"resize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.startBatch("resize",n);var r=n.direction;if(r){var i=this.getSize();switch(r){case"left":case"right":t=i.height;break;case"top":case"bottom":e=i.width}var o={right:0,"top-right":0,top:1,"top-left":1,left:2,"bottom-left":2,bottom:3,"bottom-right":3}[r],a=Ud.normalize(this.getAngle()||0);n.absolute&&(o+=Math.floor((a+45)/90),o%=4);var s=this.getBBox(),l=(0===o?s.getBottomLeft():1===o?s.getCorner():2===o?s.getTopRight():s.getOrigin()).clone().rotate(-a,s.getCenter()),u=Math.sqrt(e*e+t*t)/2,c=o*Math.PI/2;c+=Math.atan(o%2==0?t/e:e/t),c-=Ud.toRad(a);var h=Wd.fromPolar(u,c,l).clone().translate(e/-2,t/-2);this.store.set("size",{width:e,height:t},n),this.setPosition(h.x,h.y,n)}else this.store.set("size",{width:e,height:t},n);return this.stopBatch("resize",n),this}},{key:"scale",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.getBBox().scale(e,t,null==n?void 0:n);return this.startBatch("scale",r),this.setPosition(i.x,i.y,r),this.resize(i.width,i.height,r),this.stopBatch("scale"),this}},{key:"position",value:function(e,t,n){return"number"==typeof e?this.setPosition(e,t,n):this.getPosition(e)}},{key:"getPosition",value:function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).relative){var e=this.getParent();if(null!=e&&e.isNode()){var t=this.getPosition(),n=e.getPosition();return{x:t.x-n.x,y:t.y-n.y}}}var r=this.store.get("position");return r?Object.assign({},r):{x:0,y:0}}},{key:"setPosition",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"===v(e)?(n=e.x,r=e.y,i=t||{}):(n=e,r=t,i=o||{}),i.relative){var a=this.getParent();if(null!=a&&a.isNode()){var s=a.getPosition();n+=s.x,r+=s.y}}if(i.deep){var l=this.getPosition();this.translate(n-l.x,r-l.y,i)}else this.store.set("position",{x:n,y:r},i);return this}},{key:"translate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===e&&0===t)return this;n.translateBy=n.translateBy||this.id;var r=this.getPosition();if(null!=n.restrict&&n.translateBy===this.id){var i=this.getBBox({deep:!0}),o=n.restrict,a=r.x-i.x,s=r.y-i.y,l=Math.max(o.x+a,Math.min(o.x+o.width+a-i.width,r.x+e)),u=Math.max(o.y+s,Math.min(o.y+o.height+s-i.height,r.y+t));e=l-r.x,t=u-r.y}var c={x:r.x+e,y:r.y+t};return n.tx=e,n.ty=t,n.transition?("object"!==v(n.transition)&&(n.transition={}),this.transition("position",c,Object.assign(Object.assign({},n.transition),{interp:Vd.object})),this.eachChild((function(r){var i;(null===(i=n.exclude)||void 0===i?void 0:i.includes(r))||r.translate(e,t,n)}))):(this.startBatch("translate",n),this.store.set("position",c,n),this.eachChild((function(r){var i;(null===(i=n.exclude)||void 0===i?void 0:i.includes(r))||r.translate(e,t,n)})),this.stopBatch("translate",n)),this}},{key:"angle",value:function(e,t){return null==e?this.getAngle():this.rotate(e,t)}},{key:"getAngle",value:function(){return this.store.get("angle",0)}},{key:"rotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getAngle();if(t.center){var r=this.getSize(),i=this.getPosition(),o=this.getBBox().getCenter();o.rotate(n-e,t.center);var a=o.x-r.width/2-i.x,s=o.y-r.height/2-i.y;this.startBatch("rotate",{angle:e,options:t}),this.setPosition(i.x+a,i.y+s,t),this.rotate(e,Object.assign(Object.assign({},t),{center:null})),this.stopBatch("rotate")}else this.store.set("angle",t.absolute?e:(n+e)%360,t);return this}},{key:"getBBox",value:function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).deep){var e=this.getDescendants({deep:!0,breadthFirst:!0});return e.push(this),Am.getCellsBBox(e)}return Yd.fromPositionAndSize(this.getPosition(),this.getSize())}},{key:"getConnectionPoint",value:function(e,t){var n=this.getBBox(),r=n.getCenter(),i=e.getTerminal(t);if(null==i)return r;var o=i.port;if(!o||!this.hasPort(o))return r;var a=this.getPort(o);if(!a||!a.group)return r;var s=this.getPortsPosition(a.group)[o].position,l=Wd.create(s).translate(n.getOrigin()),u=this.getAngle();return u&&l.rotate(-u,r),l}},{key:"fit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(this.getChildren()||[]).filter((function(e){return e.isNode()}));if(0===t.length)return this;this.startBatch("fit-embeds",e),e.deep&&t.forEach((function(t){return t.fit(e)}));var n=Am.getCellsBBox(t),r=n.x,i=n.y,o=n.width,a=n.height,s=jh(e.padding);return r-=s.left,i-=s.top,o+=s.left+s.right,a+=s.bottom+s.top,this.store.set({position:{x:r,y:i},size:{width:o,height:a}},e),this.stopBatch("fit-embeds"),this}},{key:"portContainerMarkup",get:function(){return this.getPortContainerMarkup()}},{key:"portContainerMarkup",set:function(e){this.setPortContainerMarkup(e)}},{key:"getDefaultPortContainerMarkup",value:function(){return this.store.get("defaultPortContainerMarkup")||Lp.getPortContainerMarkup()}},{key:"getPortContainerMarkup",value:function(){return this.store.get("portContainerMarkup")||this.getDefaultPortContainerMarkup()}},{key:"setPortContainerMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portContainerMarkup",Lp.clone(e),t),this}},{key:"portMarkup",get:function(){return this.getPortMarkup()}},{key:"portMarkup",set:function(e){this.setPortMarkup(e)}},{key:"getDefaultPortMarkup",value:function(){return this.store.get("defaultPortMarkup")||Lp.getPortMarkup()}},{key:"getPortMarkup",value:function(){return this.store.get("portMarkup")||this.getDefaultPortMarkup()}},{key:"setPortMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portMarkup",Lp.clone(e),t),this}},{key:"portLabelMarkup",get:function(){return this.getPortLabelMarkup()}},{key:"portLabelMarkup",set:function(e){this.setPortLabelMarkup(e)}},{key:"getDefaultPortLabelMarkup",value:function(){return this.store.get("defaultPortLabelMarkup")||Lp.getPortLabelMarkup()}},{key:"getPortLabelMarkup",value:function(){return this.store.get("portLabelMarkup")||this.getDefaultPortLabelMarkup()}},{key:"setPortLabelMarkup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("portLabelMarkup",Lp.clone(e),t),this}},{key:"ports",get:function(){var e=this.store.get("ports",{items:[]});return null==e.items&&(e.items=[]),e}},{key:"getPorts",value:function(){return Xe(this.ports.items)}},{key:"getPortsByGroup",value:function(e){return this.getPorts().filter((function(t){return t.group===e}))}},{key:"getPort",value:function(e){return Xe(this.ports.items.find((function(t){return t.id&&t.id===e})))}},{key:"getPortAt",value:function(e){return this.ports.items[e]||null}},{key:"hasPorts",value:function(){return this.ports.items.length>0}},{key:"hasPort",value:function(e){return-1!==this.getPortIndex(e)}},{key:"getPortIndex",value:function(e){var t="string"==typeof e?e:e.id;return null!=t?this.ports.items.findIndex((function(e){return e.id===t})):-1}},{key:"getPortsPosition",value:function(e){var t=this.getSize();return this.port.getPortsLayoutByGroup(e,new Yd(0,0,t.width,t.height)).reduce((function(e,t){var n=t.portLayout;return e[t.portId]={position:Object.assign({},n.position),angle:n.angle||0},e}),{})}},{key:"getPortProp",value:function(e,t){return this.getPropByPath(this.prefixPortPath(e,t))}},{key:"setPortProp",value:function(e,t,n,r){if("string"==typeof t||Array.isArray(t)){var i=this.prefixPortPath(e,t),o=n;return this.setPropByPath(i,o,r)}var a=this.prefixPortPath(e),s=t;return this.setPropByPath(a,s,n)}},{key:"removePortProp",value:function(e,t,n){return"string"==typeof t||Array.isArray(t)?this.removePropByPath(this.prefixPortPath(e,t),n):this.removePropByPath(this.prefixPortPath(e),t)}},{key:"portProp",value:function(e,t,n,r){return null==t?this.getPortProp(e):"string"==typeof t||Array.isArray(t)?2===arguments.length?this.getPortProp(e,t):null==n?this.removePortProp(e,t,r):this.setPortProp(e,t,n,r):this.setPortProp(e,t,n)}},{key:"prefixPortPath",value:function(e,t){var n=this.getPortIndex(e);if(-1===n)throw new Error('Unable to find port with id: "'.concat(e,'"'));return null==t||""===t?["ports","items","".concat(n)]:Array.isArray(t)?["ports","items","".concat(n)].concat(p(t)):"ports/items/".concat(n,"/").concat(t)}},{key:"addPort",value:function(e,t){var n=p(this.ports.items);return n.push(e),this.setPropByPath("ports/items",n,t),this}},{key:"addPorts",value:function(e,t){return this.setPropByPath("ports/items",[].concat(p(this.ports.items),p(e)),t),this}},{key:"insertPort",value:function(e,t,n){var r=p(this.ports.items);return r.splice(e,0,t),this.setPropByPath("ports/items",r,n),this}},{key:"removePort",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.removePortAt(this.getPortIndex(e),t)}},{key:"removePortAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e>=0){var n=p(this.ports.items);n.splice(e,1),t.rewrite=!0,this.setPropByPath("ports/items",n,t)}return this}},{key:"removePorts",value:function(e,t){var n;if(Array.isArray(e)){if(n=t||{},e.length){n.rewrite=!0;var r=p(this.ports.items).filter((function(t){return!e.some((function(e){var n="string"==typeof e?e:e.id;return t.id===n}))}));this.setPropByPath("ports/items",r,n)}}else(n=e||{}).rewrite=!0,this.setPropByPath("ports/items",[],n);return this}},{key:"getParsedPorts",value:function(){return this.port.getPorts()}},{key:"getParsedGroups",value:function(){return this.port.groups}},{key:"getPortsLayoutByGroup",value:function(e,t){return this.port.getPortsLayoutByGroup(e,t)}},{key:"initPorts",value:function(){var e=this;this.updatePortData(),this.on("change:ports",(function(){e.processRemovedPort(),e.updatePortData()}))}},{key:"processRemovedPort",value:function(){var e=this.ports,t={};e.items.forEach((function(e){e.id&&(t[e.id]=!0)}));var n={};(this.store.getPrevious("ports")||{items:[]}).items.forEach((function(e){e.id&&!t[e.id]&&(n[e.id]=!0)}));var r=this.model;r&&!ot(n)&&(r.getConnectedEdges(this,{incoming:!0}).forEach((function(e){var t=e.getTargetPortId();t&&n[t]&&e.remove()})),r.getConnectedEdges(this,{outgoing:!0}).forEach((function(e){var t=e.getSourcePortId();t&&n[t]&&e.remove()})))}},{key:"validatePorts",value:function(){var e=this,t={},n=[];return this.ports.items.forEach((function(r){"object"!==v(r)&&n.push("Invalid port ".concat(r,".")),null==r.id&&(r.id=e.generatePortId()),t[r.id]&&n.push("Duplicitied port id."),t[r.id]=!0})),n}},{key:"generatePortId",value:function(){return Ph()}},{key:"updatePortData",value:function(){var e=this.validatePorts();if(e.length>0)throw this.store.set("ports",this.store.getPrevious("ports")),new Error(e.join(" "));var t=this.port?this.port.getPorts():null;this.port=new Mm(this.ports);var n=this.port.getPorts(),r=t?n.filter((function(e){return t.find((function(t){return t.id===e.id}))?null:e})):p(n),i=t?t.filter((function(e){return n.find((function(t){return t.id===e.id}))?null:e})):[];r.length>0&&this.notify("ports:added",{added:r,cell:this,node:this}),i.length>0&&this.notify("ports:removed",{removed:i,cell:this,node:this})}}]),r}(Am,Symbol.toStringTag);Om.defaults={angle:0,position:{x:0,y:0},size:{width:1,height:1}},function(e){e.toStringTag="X6.".concat(e.name),e.isNode=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNode&&"function"==typeof r.isEdge&&"function"==typeof r.prop&&"function"==typeof r.attr&&"function"==typeof r.size&&"function"==typeof r.position}}(Om||(Om={})),function(e){e.config({propHooks:function(e){var t=e.ports,n=Pm(e,["ports"]);return t&&(n.ports=Array.isArray(t)?{items:t}:t),n}})}(Om||(Om={})),function(e){e.registry=yg.create({type:"node",process:function(t,n){if(Em.exist(t,!0))throw new Error("Node with name '".concat(t,"' was registered by anthor Edge"));if("function"==typeof n)return n.config({shape:t}),n;var r=e,i=n.inherit,o=Pm(n,["inherit"]);if(i)if("string"==typeof i){var a=this.get(i);null==a?this.onNotFound(i,"inherited"):r=a}else r=i;null==o.constructorName&&(o.constructorName=t);var s=r.define.call(r,o);return s.config({shape:t}),s}}),Em.setNodeRegistry(e.registry)}(Om||(Om={})),function(e){var t=0;e.define=function(n){var r=n.constructorName,i=n.overwrite,o=Pm(n,["constructorName","overwrite"]),a=mh(function(e){return e?Ah(e):"CustomNode".concat(t+=1)}(r||o.shape),this);return a.config(o),o.shape&&e.registry.register(o.shape,a,i),a},e.create=function(t){var n=t.shape||"rect",r=e.registry.get(n);return r?new r(t):e.registry.onNotFound(n)}}(Om||(Om={}));var Tm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Lm=function(e,t){l(r,e);var n=c(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return A(this,r),n.call(this,e)}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"preprocess",value:function(e,t){var n=e.source,i=e.sourceCell,o=e.sourcePort,a=e.sourcePoint,l=e.target,u=e.targetCell,c=e.targetPort,h=e.targetPoint,f=Tm(e,["source","sourceCell","sourcePort","sourcePoint","target","targetCell","targetPort","targetPoint"]),d=function(e){return"string"==typeof e||"number"==typeof e};if(null!=n)if(Am.isCell(n))f.source={cell:n.id};else if(d(n))f.source={cell:n};else if(Wd.isPoint(n))f.source=n.toJSON();else if(Array.isArray(n))f.source={x:n[0],y:n[1]};else{var v=n.cell;Am.isCell(v)?f.source=Object.assign(Object.assign({},n),{cell:v.id}):f.source=n}if(null!=i||null!=o){var p=f.source;if(null!=i){var y=d(i)?i:i.id;p?p.cell=y:p=f.source={cell:y}}null!=o&&p&&(p.port=o)}else null!=a&&(f.source=Wd.create(a).toJSON());if(null!=l)if(Am.isCell(l))f.target={cell:l.id};else if(d(l))f.target={cell:l};else if(Wd.isPoint(l))f.target=l.toJSON();else if(Array.isArray(l))f.target={x:l[0],y:l[1]};else{var m=l.cell;Am.isCell(m)?f.target=Object.assign(Object.assign({},l),{cell:m.id}):f.target=l}if(null!=u||null!=c){var w=f.target;if(null!=u){var b=d(u)?u:u.id;w?w.cell=b:w=f.target={cell:b}}null!=c&&w&&(w.port=c)}else null!=h&&(f.target=Wd.create(h).toJSON());return s(g(r.prototype),"preprocess",this).call(this,f,t)}},{key:"setup",value:function(){var e=this;s(g(r.prototype),"setup",this).call(this),this.on("change:labels",(function(t){return e.onLabelsChanged(t)})),this.on("change:vertices",(function(t){return e.onVertexsChanged(t)}))}},{key:"isEdge",value:function(){return!0}},{key:"disconnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.set({source:{x:0,y:0},target:{x:0,y:0}},e),this}},{key:"source",get:function(){return this.getSource()}},{key:"source",set:function(e){this.setSource(e)}},{key:"getSource",value:function(){return this.getTerminal("source")}},{key:"getSourceCellId",value:function(){return this.source.cell}},{key:"getSourcePortId",value:function(){return this.source.port}},{key:"setSource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setTerminal("source",e,t,n)}},{key:"target",get:function(){return this.getTarget()}},{key:"target",set:function(e){this.setTarget(e)}},{key:"getTarget",value:function(){return this.getTerminal("target")}},{key:"getTargetCellId",value:function(){return this.target.cell}},{key:"getTargetPortId",value:function(){return this.target.port}},{key:"setTarget",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.setTerminal("target",e,t,n)}},{key:"getTerminal",value:function(e){return Object.assign({},this.store.get(e))}},{key:"setTerminal",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(Am.isCell(t))return this.store.set(e,$e({},n,{cell:t.id}),r),this;var i=t;return Wd.isPoint(t)||null!=i.x&&null!=i.y?(this.store.set(e,$e({},n,{x:i.x,y:i.y}),r),this):(this.store.set(e,Xe(t),r),this)}},{key:"getSourcePoint",value:function(){return this.getTerminalPoint("source")}},{key:"getTargetPoint",value:function(){return this.getTerminalPoint("target")}},{key:"getTerminalPoint",value:function(e){var t=this[e];if(Wd.isPointLike(t))return Wd.create(t);var n=this.getTerminalCell(e);return n?n.getConnectionPoint(this,e):new Wd}},{key:"getSourceCell",value:function(){return this.getTerminalCell("source")}},{key:"getTargetCell",value:function(){return this.getTerminalCell("target")}},{key:"getTerminalCell",value:function(e){if(this.model){var t="source"===e?this.getSourceCellId():this.getTargetCellId();if(t)return this.model.getCell(t)}return null}},{key:"getSourceNode",value:function(){return this.getTerminalNode("source")}},{key:"getTargetNode",value:function(){return this.getTerminalNode("target")}},{key:"getTerminalNode",value:function(e){for(var t=this,n={};t&&t.isEdge();){if(n[t.id])return null;n[t.id]=!0,t=t.getTerminalCell(e)}return t&&t.isNode()?t:null}},{key:"router",get:function(){return this.getRouter()}},{key:"router",set:function(e){null==e?this.removeRouter():this.setRouter(e)}},{key:"getRouter",value:function(){return this.store.get("router")}},{key:"setRouter",value:function(e,t,n){return"object"===v(e)?this.store.set("router",e,t):this.store.set("router",{name:e,args:t},n),this}},{key:"removeRouter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("router",e),this}},{key:"connector",get:function(){return this.getConnector()}},{key:"connector",set:function(e){null==e?this.removeConnector():this.setConnector(e)}},{key:"getConnector",value:function(){return this.store.get("connector")}},{key:"setConnector",value:function(e,t,n){return"object"===v(e)?this.store.set("connector",e,t):this.store.set("connector",{name:e,args:t},n),this}},{key:"removeConnector",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.store.remove("connector",e)}},{key:"getDefaultLabel",value:function(){var e=this.constructor,t=this.store.get("defaultLabel")||e.defaultLabel||{};return Xe(t)}},{key:"labels",get:function(){return this.getLabels()}},{key:"labels",set:function(e){this.setLabels(e)}},{key:"getLabels",value:function(){var e=this;return p(this.store.get("labels",[])).map((function(t){return e.parseLabel(t)}))}},{key:"setLabels",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.store.set("labels",Array.isArray(e)?e:[e],t),this}},{key:"insertLabel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getLabels(),i=r.length,o=null!=t&&Number.isFinite(t)?t:i;return o<0&&(o=i+o+1),r.splice(o,0,this.parseLabel(e)),this.setLabels(r,n)}},{key:"appendLabel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertLabel(e,-1,t)}},{key:"getLabelAt",value:function(e){var t=this.getLabels();return null!=e&&Number.isFinite(e)?this.parseLabel(t[e]):null}},{key:"setLabelAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&Number.isFinite(e)){var r=this.getLabels();r[e]=this.parseLabel(t),this.setLabels(r,n)}return this}},{key:"removeLabelAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getLabels(),r=null!=e&&Number.isFinite(e)?e:-1,i=n.splice(r,1);return this.setLabels(n,t),i.length?i[0]:null}},{key:"parseLabel",value:function(e){return"string"==typeof e?this.constructor.parseStringLabel(e):e}},{key:"onLabelsChanged",value:function(e){var t=e.previous,n=e.current,r=t&&n?n.filter((function(e){return t.find((function(t){return e===t||rt(e,t)}))?null:e})):n?p(n):[],i=t&&n?t.filter((function(e){return n.find((function(t){return e===t||rt(e,t)}))?null:e})):t?p(t):[];r.length>0&&this.notify("labels:added",{added:r,cell:this,edge:this}),i.length>0&&this.notify("labels:removed",{removed:i,cell:this,edge:this})}},{key:"vertices",get:function(){return this.getVertices()}},{key:"vertices",set:function(e){this.setVertices(e)}},{key:"getVertices",value:function(){return p(this.store.get("vertices",[]))}},{key:"setVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:[e];return this.store.set("vertices",n.map((function(e){return Wd.toJSON(e)})),t),this}},{key:"insertVertex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getVertices(),i=r.length,o=null!=t&&Number.isFinite(t)?t:i;return o<0&&(o=i+o+1),r.splice(o,0,Wd.toJSON(e)),this.setVertices(r,n)}},{key:"appendVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.insertVertex(e,-1,t)}},{key:"getVertexAt",value:function(e){return null!=e&&Number.isFinite(e)?this.getVertices()[e]:null}},{key:"setVertexAt",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=e&&Number.isFinite(e)){var r=this.getVertices();r[e]=t,this.setVertices(r,n)}return this}},{key:"removeVertexAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getVertices(),r=null!=e&&Number.isFinite(e)?e:-1;return n.splice(r,1),this.setVertices(n,t)}},{key:"onVertexsChanged",value:function(e){var t=e.previous,n=e.current,r=t&&n?n.filter((function(e){return t.find((function(t){return Wd.equals(e,t)}))?null:e})):n?p(n):[],i=t&&n?t.filter((function(e){return n.find((function(t){return Wd.equals(e,t)}))?null:e})):t?p(t):[];r.length>0&&this.notify("vertexs:added",{added:r,cell:this,edge:this}),i.length>0&&this.notify("vertexs:removed",{removed:i,cell:this,edge:this})}},{key:"getDefaultMarkup",value:function(){return this.store.get("defaultMarkup")||Lp.getEdgeMarkup()}},{key:"getMarkup",value:function(){return s(g(r.prototype),"getMarkup",this).call(this)||this.getDefaultMarkup()}},{key:"translate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.translateBy=n.translateBy||this.id,n.tx=e,n.ty=t,this.applyToPoints((function(n){return{x:(n.x||0)+e,y:(n.y||0)+t}}),n)}},{key:"scale",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.applyToPoints((function(r){return Wd.create(r).scale(e,t,n).toJSON()}),r)}},{key:"applyToPoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=this.getSource(),i=this.getTarget();Wd.isPointLike(r)&&(n.source=e(r)),Wd.isPointLike(i)&&(n.target=e(i));var o=this.getVertices();return o.length>0&&(n.vertices=o.map(e)),this.store.set(n,t),this}},{key:"getBBox",value:function(){return this.getPolyline().bbox()}},{key:"getConnectionPoint",value:function(){return this.getPolyline().pointAt(.5)}},{key:"getPolyline",value:function(){var e=[this.getSourcePoint()].concat(p(this.getVertices().map((function(e){return Wd.create(e)}))),[this.getTargetPoint()]);return new rg(e)}},{key:"updateParent",value:function(e){var t=null,n=this.getSourceCell(),r=this.getTargetCell(),i=this.getParent();return n&&r&&(t=n===r||n.isDescendantOf(r)?r:r.isDescendantOf(n)?n:Am.getCommonAncestor(n,r)),i&&t&&t.id!==i.id&&i.unembed(this,e),!t||i&&i.id===t.id||t.embed(this,e),t}},{key:"hasLoop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getSource(),n=this.getTarget(),r=t.cell,i=n.cell;if(!r||!i)return!1;var o=r===i;if(!o&&e.deep&&this._model){var a=this.getSourceCell(),s=this.getTargetCell();a&&s&&(o=a.isAncestorOf(s,e)||s.isAncestorOf(a,e))}return o}},{key:"getFragmentAncestor",value:function(){var e=[this,this.getSourceNode(),this.getTargetNode()].filter((function(e){return null!=e}));return this.getCommonAncestor.apply(this,p(e))}},{key:"isFragmentDescendantOf",value:function(e){var t=this.getFragmentAncestor();return!!t&&(t.id===e.id||t.isDescendantOf(e))}}]),r}(Am,Symbol.toStringTag);Lm.defaults={},function(e){e.equalTerminals=function(e,t){var n=e,r=t;return n.cell===r.cell&&(n.port===r.port||null==n.port&&null==r.port)}}(Lm||(Lm={})),function(e){e.defaultLabel={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{text:{fill:"#000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"label",fill:"#fff",rx:3,ry:3,refWidth:1,refHeight:1,refX:0,refY:0}},position:{distance:.5}},e.parseStringLabel=function(e){return{attrs:{label:{text:e}}}}}(Lm||(Lm={})),function(e){e.toStringTag="X6.".concat(e.name),e.isEdge=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNode&&"function"==typeof r.isEdge&&"function"==typeof r.prop&&"function"==typeof r.attr&&"function"==typeof r.disconnect&&"function"==typeof r.getSource&&"function"==typeof r.getTarget}}(Lm||(Lm={})),function(e){e.registry=yg.create({type:"edge",process:function(t,n){if(Em.exist(t,!1))throw new Error("Edge with name '".concat(t,"' was registered by anthor Node"));if("function"==typeof n)return n.config({shape:t}),n;var r=e,i=n.inherit,o=void 0===i?"edge":i,a=Tm(n,["inherit"]);if("string"==typeof o){var s=this.get(o||"edge");null==s&&o?this.onNotFound(o,"inherited"):r=s}else r=o;null==a.constructorName&&(a.constructorName=t);var l=r.define.call(r,a);return l.config({shape:t}),l}}),Em.setEdgeRegistry(e.registry)}(Lm||(Lm={})),function(e){var t=0;e.define=function(n){var r=n.constructorName,i=n.overwrite,o=Tm(n,["constructorName","overwrite"]),a=mh(function(e){return e?Ah(e):"CustomEdge".concat(t+=1)}(r||o.shape),this);return a.config(o),o.shape&&e.registry.register(o.shape,a,i),a},e.create=function(t){var n=t.shape||"edge",r=e.registry.get(n);return r?new r(t):e.registry.onNotFound(n)}}(Lm||(Lm={})),function(e){var t="basic.edge";e.config({shape:t,propHooks:function(t){var n=t.label,r=t.vertices,i=Tm(t,["label","vertices"]);if(n){null==i.labels&&(i.labels=[]);var o="string"==typeof n?e.parseStringLabel(n):n;i.labels.push(o)}return r&&Array.isArray(r)&&(i.vertices=r.map((function(e){return Wd.create(e).toJSON()}))),i}}),e.registry.register(t,e)}(Lm||(Lm={}));var jm=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Nm=function(e){l(n,e);var t=c(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return A(this,n),(r=t.call(this)).length=0,r.comparator=i.comparator||"zIndex",r.clean(),e&&r.reset(e,{silent:!0}),r}return P(n,[{key:"toJSON",value:function(){return this.cells.map((function(e){return e.toJSON()}))}},{key:"add",value:function(e,t,n){var r,i,o=this;"number"==typeof t?(r=t,i=Object.assign({merge:!1},n)):(r=this.length,i=Object.assign({merge:!1},t)),r>this.length&&(r=this.length),r<0&&(r+=this.length+1);var a,s=Array.isArray(e)?e:[e],l=this.comparator&&"number"!=typeof t&&!1!==i.sort,u=this.comparator||null,c=!1,h=[],f=[];(s.forEach((function(e){var t=o.get(e);t?i.merge&&!e.isSameStore(t)&&(t.setProp(e.getProp(),n),f.push(t),l&&!c&&(c=null==u||"function"==typeof u?t.hasChanged():"string"==typeof u?t.hasChanged(u):u.some((function(e){return t.hasChanged(e)})))):(h.push(e),o.reference(e))})),h.length)&&(l&&(c=!0),(a=this.cells).splice.apply(a,[r,0].concat(h)),this.length=this.cells.length);return c&&this.sort({silent:!0}),i.silent||(h.forEach((function(e,t){var n={cell:e,index:r+t,options:i};o.trigger("added",n),i.dryrun||e.notify("added",Object.assign({},n))})),c&&this.trigger("sorted"),(h.length||f.length)&&this.trigger("updated",{added:h,merged:f,removed:[],options:i})),this}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Array.isArray(e)?e:[e],r=this.removeCells(n,t);return!t.silent&&r.length>0&&this.trigger("updated",{options:t,removed:r,added:[],merged:[]}),Array.isArray(e)?r:r[0]}},{key:"removeCells",value:function(e,t){for(var n=[],r=0;r<e.length;r+=1){var i=this.get(e[r]);if(null!=i){var o=this.cells.indexOf(i);this.cells.splice(o,1),this.length-=1,delete this.map[i.id],n.push(i),this.unreference(i),t.dryrun||i.remove(),t.silent||(this.trigger("removed",{cell:i,index:o,options:t}),t.dryrun||i.notify("removed",{cell:i,index:o,options:t}))}}return n}},{key:"reset",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.cells.slice();if(r.forEach((function(e){return t.unreference(e)})),this.clean(),this.add(e,Object.assign({silent:!0},n)),!n.silent){var i=this.cells.slice();this.trigger("reseted",{options:n,previous:r,current:i});var o=[],a=[];i.forEach((function(e){r.some((function(t){return t.id===e.id}))||o.push(e)})),r.forEach((function(e){i.some((function(t){return t.id===e.id}))||a.push(e)})),this.trigger("updated",{options:n,added:o,removed:a,merged:[]})}return this}},{key:"push",value:function(e,t){return this.add(e,this.length,t)}},{key:"pop",value:function(e){var t=this.at(this.length-1);return this.remove(t,e)}},{key:"unshift",value:function(e,t){return this.add(e,0,t)}},{key:"shift",value:function(e){var t=this.at(0);return this.remove(t,e)}},{key:"get",value:function(e){if(null==e)return null;var t="string"==typeof e||"number"==typeof e?e:e.id;return this.map[t]||null}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"at",value:function(e){return e<0&&(e+=this.length),this.cells[e]||null}},{key:"first",value:function(){return this.at(0)}},{key:"last",value:function(){return this.at(-1)}},{key:"indexOf",value:function(e){return this.cells.indexOf(e)}},{key:"toArray",value:function(){return this.cells.slice()}},{key:"sort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return null!=this.comparator&&(this.cells=at(this.cells,this.comparator),e.silent||this.trigger("sorted")),this}},{key:"clone",value:function(){return new(0,this.constructor)(this.cells.slice(),{comparator:this.comparator})}},{key:"reference",value:function(e){this.map[e.id]=e,e.on("*",this.notifyCellEvent,this)}},{key:"unreference",value:function(e){e.off("*",this.notifyCellEvent,this),delete this.map[e.id]}},{key:"notifyCellEvent",value:function(e,t){var n=t.cell;this.trigger("cell:".concat(e),t),n&&(n.isNode()?this.trigger("node:".concat(e),Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&this.trigger("edge:".concat(e),Object.assign(Object.assign({},t),{edge:n})))}},{key:"clean",value:function(){this.length=0,this.cells=[],this.map={}}},{key:"dispose",value:function(){this.reset([])}}]),n}(Eh);jm([Nm.dispose()],Nm.prototype,"dispose",null);var Rm=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Dm=function(e,t){l(r,e);var n=c(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return A(this,r),(e=n.call(this)).batches={},e.addings=new WeakMap,e.nodes={},e.edges={},e.outgoings={},e.incomings={},e.collection=new Nm(t),e.setup(),e}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"notify",value:function(e,t){this.trigger(e,t);var n=this.graph;return n&&("sorted"===e||"reseted"===e||"updated"===e?n.trigger("model:".concat(e),t):n.trigger(e,t)),this}},{key:"setup",value:function(){var e=this,t=this.collection;t.on("sorted",(function(){return e.notify("sorted",null)})),t.on("updated",(function(t){return e.notify("updated",t)})),t.on("cell:change:zIndex",(function(){return e.sortOnChangeZ()})),t.on("added",(function(t){var n=t.cell;e.onCellAdded(n)})),t.on("removed",(function(t){var n=t.cell;e.onCellRemoved(n,t.options),e.notify("cell:removed",t),n.isNode()?e.notify("node:removed",Object.assign(Object.assign({},t),{node:n})):n.isEdge()&&e.notify("edge:removed",Object.assign(Object.assign({},t),{edge:n}))})),t.on("reseted",(function(t){e.onReset(t.current),e.notify("reseted",t)})),t.on("edge:change:source",(function(t){var n=t.edge;return e.onEdgeTerminalChanged(n,"source")})),t.on("edge:change:target",(function(t){var n=t.edge;e.onEdgeTerminalChanged(n,"target")}))}},{key:"sortOnChangeZ",value:function(){this.collection.sort()}},{key:"onCellAdded",value:function(e){var t=e.id;e.isEdge()?(e.updateParent(),this.edges[t]=!0,this.onEdgeTerminalChanged(e,"source"),this.onEdgeTerminalChanged(e,"target")):this.nodes[t]=!0}},{key:"onCellRemoved",value:function(e,t){var n=e.id;if(e.isEdge()){delete this.edges[n];var r=e.getSource(),i=e.getTarget();if(r&&r.cell){var o=this.outgoings[r.cell],a=o?o.indexOf(n):-1;a>=0&&(o.splice(a,1),0===o.length&&delete this.outgoings[r.cell])}if(i&&i.cell){var s=this.incomings[i.cell],l=s?s.indexOf(n):-1;l>=0&&(s.splice(l,1),0===s.length&&delete this.incomings[i.cell])}}else delete this.nodes[n];t.clear||(t.disconnectEdges?this.disconnectConnectedEdges(e,t):this.removeConnectedEdges(e,t)),e.model===this&&(e.model=null)}},{key:"onReset",value:function(e){var t=this;this.nodes={},this.edges={},this.outgoings={},this.incomings={},e.forEach((function(e){return t.onCellAdded(e)}))}},{key:"onEdgeTerminalChanged",value:function(e,t){var n="source"===t?this.outgoings:this.incomings,r=e.previous(t);if(r&&r.cell){var i=Am.isCell(r.cell)?r.cell.id:r.cell,o=n[i],a=o?o.indexOf(e.id):-1;a>=0&&(o.splice(a,1),0===o.length&&delete n[i])}var s=e.getTerminal(t);if(s&&s.cell){var l=Am.isCell(s.cell)?s.cell.id:s.cell,u=n[l]||[];-1===u.indexOf(e.id)&&u.push(e.id),n[l]=u}}},{key:"prepareCell",value:function(e,t){return e.model||t&&t.dryrun||(e.model=this),null==e.zIndex&&e.setZIndex(this.getMaxZIndex()+1,{silent:!0}),e}},{key:"resetCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map((function(e){return t.prepareCell(e,Object.assign(Object.assign({},n),{dryrun:!0}))})),this.collection.reset(e,n),e.map((function(e){return t.prepareCell(e,{options:n})})),this}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getCells();if(0===t.length)return this;var n=Object.assign(Object.assign({},e),{clear:!0});return this.batchUpdate("clear",(function(){for(var e=t.sort((function(e,t){return(e.isEdge()?1:2)-(t.isEdge()?1:2)}));e.length>0;){var r=e.shift();r&&r.remove(n)}}),n),this}},{key:"addNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Om.isNode(e)?e:this.createNode(e);return this.addCell(n,t),n}},{key:"updateNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.createNode(e),r=n.getProp();return n.dispose(),this.updateCell(r,t)}},{key:"createNode",value:function(e){return Om.create(e)}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Lm.isEdge(e)?e:this.createEdge(e);return this.addCell(n,t),n}},{key:"createEdge",value:function(e){return Lm.create(e)}},{key:"updateEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.createEdge(e),r=n.getProp();return n.dispose(),this.updateCell(r,t)}},{key:"addCell",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(e)?this.addCells(e,n):(this.collection.has(e)||this.addings.has(e)||(this.addings.set(e,!0),this.collection.add(this.prepareCell(e,n),n),e.eachChild((function(e){return t.addCell(e,n)})),this.addings.delete(e)),this)}},{key:"addCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.length;if(0===r)return this;var i=Object.assign(Object.assign({},n),{position:r-1,maxPosition:r-1});return this.startBatch("add",Object.assign(Object.assign({},i),{cells:e})),e.forEach((function(e){t.addCell(e,i),i.position-=1})),this.stopBatch("add",Object.assign(Object.assign({},i),{cells:e})),this}},{key:"updateCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.id&&this.getCell(e.id);return!!n&&this.batchUpdate("update",(function(){return Object.entries(e).forEach((function(e){var r=m(e,2),i=r[0],o=r[1];return n.setProp(i,o,t)})),!0}),e)}},{key:"removeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?this.getCell(e):e;return n&&this.has(n)?this.collection.remove(n,t):null}},{key:"updateCellId",value:function(e,t){if(e.id!==t){this.startBatch("update",{id:t}),e.prop("id",t);var n=e.clone({keepId:!0});return this.addCell(n),this.getConnectedEdges(e).forEach((function(n){var r=n.getSourceCell(),i=n.getTargetCell();r===e&&n.setSource(Object.assign(Object.assign({},n.getSource()),{cell:t})),i===e&&n.setTarget(Object.assign(Object.assign({},n.getTarget()),{cell:t}))})),this.removeCell(e),this.stopBatch("update",{id:t}),n}}},{key:"removeCells",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.length?this.batchUpdate("remove",(function(){return e.map((function(e){return t.removeCell(e,n)}))})):[]}},{key:"removeConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getConnectedEdges(e);return n.forEach((function(e){e.remove(t)})),n}},{key:"disconnectConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="string"==typeof e?e:e.id;this.getConnectedEdges(e).forEach((function(e){var r=e.getSourceCellId(),i=e.getTargetCellId();r===n&&e.setSource({x:0,y:0},t),i===n&&e.setTarget({x:0,y:0},t)}))}},{key:"has",value:function(e){return this.collection.has(e)}},{key:"total",value:function(){return this.collection.length}},{key:"indexOf",value:function(e){return this.collection.indexOf(e)}},{key:"getCell",value:function(e){return this.collection.get(e)}},{key:"getCells",value:function(){return this.collection.toArray()}},{key:"getFirstCell",value:function(){return this.collection.first()}},{key:"getLastCell",value:function(){return this.collection.last()}},{key:"getMinZIndex",value:function(){var e=this.collection.first();return e&&e.getZIndex()||0}},{key:"getMaxZIndex",value:function(){var e=this.collection.last();return e&&e.getZIndex()||0}},{key:"getCellsFromCache",value:function(e){var t=this;return e?Object.keys(e).map((function(e){return t.getCell(e)})).filter((function(e){return null!=e})):[]}},{key:"getNodes",value:function(){return this.getCellsFromCache(this.nodes)}},{key:"getEdges",value:function(){return this.getCellsFromCache(this.edges)}},{key:"getOutgoingEdges",value:function(e){var t=this,n="string"==typeof e?e:e.id,r=this.outgoings[n];return r?r.map((function(e){return t.getCell(e)})).filter((function(e){return e&&e.isEdge()})):null}},{key:"getIncomingEdges",value:function(e){var t=this,n="string"==typeof e?e:e.id,r=this.incomings[n];return r?r.map((function(e){return t.getCell(e)})).filter((function(e){return e&&e.isEdge()})):null}},{key:"getConnectedEdges",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i="string"==typeof e?this.getCell(e):e;if(null==i)return r;var o={},a=n.indirect,s=n.incoming,l=n.outgoing;null==s&&null==l&&(s=l=!0);var u=function e(n,i){var u=i?t.getOutgoingEdges(n):t.getIncomingEdges(n);if(null!=u&&u.forEach((function(t){o[t.id]||(r.push(t),o[t.id]=!0,a&&(s&&e(t,!1),l&&e(t,!0)))})),a&&n.isEdge()){var c=i?n.getTargetCell():n.getSourceCell();c&&c.isEdge()&&(o[c.id]||(r.push(c),e(c,i)))}};if(l&&u(i,!0),s&&u(i,!1),n.deep){var c=i.getDescendants({deep:!0}),h={};c.forEach((function(e){e.isNode()&&(h[e.id]=!0)}));var f=function(e,i){var a=i?t.getOutgoingEdges(e.id):t.getIncomingEdges(e.id);null!=a&&a.forEach((function(e){if(!o[e.id]){var t=e.getSourceCell(),i=e.getTargetCell();if(!n.enclosed&&t&&h[t.id]&&i&&h[i.id])return;r.push(e),o[e.id]=!0}}))};c.forEach((function(e){e.isEdge()||(l&&f(e,!0),s&&f(e,!1))}))}return r}},{key:"isBoundary",value:function(e,t){var n="string"==typeof e?this.getCell(e):e,r=t?this.getIncomingEdges(n):this.getOutgoingEdges(n);return null==r||0===r.length}},{key:"getBoundaryNodes",value:function(e){var t=this,n=[];return Object.keys(this.nodes).forEach((function(r){if(t.isBoundary(r,e)){var i=t.getCell(r);i&&n.push(i)}})),n}},{key:"getRoots",value:function(){return this.getBoundaryNodes(!0)}},{key:"getLeafs",value:function(){return this.getBoundaryNodes(!1)}},{key:"isRoot",value:function(e){return this.isBoundary(e,!0)}},{key:"isLeaf",value:function(e){return this.isBoundary(e,!1)}},{key:"getNeighbors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.incoming,r=t.outgoing;null==n&&null==r&&(n=r=!0);var i=this.getConnectedEdges(e,t).reduce((function(i,o){var a=o.hasLoop(t),s=o.getSourceCell(),l=o.getTargetCell();return n&&s&&s.isNode()&&!i[s.id]&&(!a&&(s===e||t.deep&&s.isDescendantOf(e))||(i[s.id]=s)),r&&l&&l.isNode()&&!i[l.id]&&(!a&&(l===e||t.deep&&l.isDescendantOf(e))||(i[l.id]=l)),i}),{});if(e.isEdge()){if(n){var o=e.getSourceCell();o&&o.isNode()&&!i[o.id]&&(i[o.id]=o)}if(r){var a=e.getTargetCell();a&&a.isNode()&&!i[a.id]&&(i[a.id]=a)}}return Object.keys(i).map((function(e){return i[e]}))}},{key:"isNeighbor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.incoming,i=n.outgoing;return null==r&&null==i&&(r=i=!0),this.getConnectedEdges(e,n).some((function(e){var n=e.getSourceCell(),o=e.getTargetCell();return!(!r||!n||n.id!==t.id)||!(!i||!o||o.id!==t.id)}))}},{key:"getSuccessors",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return this.search(e,(function(i,o){i!==e&&t.matchDistance(o,n.distance)&&r.push(i)}),Object.assign(Object.assign({},n),{outgoing:!0})),r}},{key:"isSuccessor",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!1;return this.search(e,(function(o,a){if(o===t&&o!==e&&n.matchDistance(a,r.distance))return i=!0,!1}),Object.assign(Object.assign({},r),{outgoing:!0})),i}},{key:"getPredecessors",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[];return this.search(e,(function(i,o){i!==e&&t.matchDistance(o,n.distance)&&r.push(i)}),Object.assign(Object.assign({},n),{incoming:!0})),r}},{key:"isPredecessor",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!1;return this.search(e,(function(o,a){if(o===t&&o!==e&&n.matchDistance(a,r.distance))return i=!0,!1}),Object.assign(Object.assign({},r),{incoming:!0})),i}},{key:"matchDistance",value:function(e,t){return null==t||("function"==typeof t?t(e):!(!Array.isArray(t)||!t.includes(e))||e===t)}},{key:"getCommonAncestor",value:function(){for(var e,t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.forEach((function(e){e&&(Array.isArray(e)?t.push.apply(t,p(e)):t.push(e))})),(e=Am).getCommonAncestor.apply(e,t)}},{key:"getSubGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i={},o=[],a=[],s=function(e){i[e.id]||(r.push(e),i[e.id]=e,e.isEdge()&&a.push(e),e.isNode()&&o.push(e))};return e.forEach((function(e){(s(e),n.deep)&&e.getDescendants({deep:!0}).forEach((function(e){return s(e)}))})),a.forEach((function(e){var t=e.getSourceCell(),n=e.getTargetCell();t&&!i[t.id]&&(r.push(t),i[t.id]=t,t.isNode()&&o.push(t)),n&&!i[n.id]&&(r.push(n),i[n.id]=n,n.isNode()&&o.push(n))})),o.forEach((function(e){t.getConnectedEdges(e,n).forEach((function(e){var t=e.getSourceCell(),n=e.getTargetCell();!i[e.id]&&t&&i[t.id]&&n&&i[n.id]&&(r.push(e),i[e.id]=e)}))})),r}},{key:"cloneSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getSubGraph(e,t);return this.cloneCells(n)}},{key:"cloneCells",value:function(e){return Am.cloneCells(e)}},{key:"getNodesFromPoint",value:function(e,t){var n="number"==typeof e?{x:e,y:t||0}:e;return this.getNodes().filter((function(e){return e.getBBox().containsPoint(n)}))}},{key:"getNodesInArea",value:function(e,t,n,r,i){var o="number"==typeof e?new Yd(e,t,n,r):Yd.create(e),a="number"==typeof e?i:t,s=a&&a.strict;return this.getNodes().filter((function(e){var t=e.getBBox();return s?o.containsRect(t):o.isIntersectWithRect(t)}))}},{key:"getEdgesInArea",value:function(e,t,n,r,i){var o="number"==typeof e?new Yd(e,t,n,r):Yd.create(e),a="number"==typeof e?i:t,s=a&&a.strict;return this.getEdges().filter((function(e){var t=e.getBBox();return 0===t.width?t.inflate(1,0):0===t.height&&t.inflate(0,1),s?o.containsRect(t):o.isIntersectWithRect(t)}))}},{key:"getNodesUnderNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getBBox();return(null==t.by||"bbox"===t.by?this.getNodesInArea(n):this.getNodesFromPoint(n[t.by])).filter((function(t){return e.id!==t.id&&!t.isDescendantOf(e)}))}},{key:"getAllCellsBBox",value:function(){return this.getCellsBBox(this.getCells())}},{key:"getCellsBBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Am.getCellsBBox(e,t)}},{key:"search",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.breadthFirst?this.breadthFirstSearch(e,t,n):this.depthFirstSearch(e,t,n)}},{key:"breadthFirstSearch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],o={},a={};i.push(e),a[e.id]=0;for(var s=function(){var e=i.shift();return null==e||o[e.id]?0:(o[e.id]=!0,!1===hh(t,n,e,a[e.id])?0:void n.getNeighbors(e,r).forEach((function(t){a[t.id]=a[e.id]+1,i.push(t)})))};i.length>0;)s()}},{key:"depthFirstSearch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],o={},a={};i.push(e),a[e.id]=0;for(var s=function(){var e=i.pop();if(null==e||o[e.id])return 0;if(o[e.id]=!0,!1===hh(t,n,e,a[e.id]))return 0;var s=n.getNeighbors(e,r),l=i.length;s.forEach((function(t){a[t.id]=a[e.id]+1,i.splice(l,0,t)}))};i.length>0;)s()}},{key:"getShortestPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};this.getEdges().forEach((function(e){var t=e.getSourceCellId(),i=e.getTargetCellId();t&&i&&(r[t]||(r[t]=[]),r[i]||(r[i]=[]),r[t].push(i),n.directed||r[i].push(t))}));var i="string"==typeof e?e:e.id,o=Dd.run(r,i,n.weight),a=[],s="string"==typeof t?t:t.id;for(o[s]&&a.push(s);s=o[s];)a.unshift(s);return a}},{key:"translate",value:function(e,t,n){return this.getCells().filter((function(e){return!e.hasParent()})).forEach((function(r){return r.translate(e,t,n)})),this}},{key:"resize",value:function(e,t,n){return this.resizeCells(e,t,this.getCells(),n)}},{key:"resizeCells",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.getCellsBBox(n);if(i){var o=Math.max(e/i.width,0),a=Math.max(t/i.height,0),s=i.getOrigin();n.forEach((function(e){return e.scale(o,a,s,r)}))}return this}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.toJSON(this.getCells(),e)}},{key:"parseJSON",value:function(e){return r.fromJSON(e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.parseJSON(e);return this.resetCells(n,t),this}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.batches[e]=(this.batches[e]||0)+1,this.notify("batch:start",{name:e,data:t}),this}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.batches[e]=(this.batches[e]||0)-1,this.notify("batch:stop",{name:e,data:t}),this}},{key:"batchUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.startBatch(e,n);var r=t();return this.stopBatch(e,n),r}},{key:"hasActiveBatch",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(this.batches);return(Array.isArray(t)?t:[t]).some((function(t){return e.batches[t]>0}))}},{key:"dispose",value:function(){this.collection.dispose()}}]),r}(Eh,Symbol.toStringTag);Rm([Dm.dispose()],Dm.prototype,"dispose",null),function(e){e.toStringTag="X6.".concat(e.name),e.isModel=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.addNode&&"function"==typeof r.addEdge&&null!=r.collection}}(Dm||(Dm={})),function(e){e.toJSON=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{cells:e.map((function(e){return e.toJSON(t)}))}},e.fromJSON=function(e){var t=[];return Array.isArray(e)?t.push.apply(t,p(e)):(e.cells&&t.push.apply(t,p(e.cells)),e.nodes&&e.nodes.forEach((function(e){null==e.shape&&(e.shape="rect"),t.push(e)})),e.edges&&e.edges.forEach((function(e){null==e.shape&&(e.shape="edge"),t.push(e)}))),t.map((function(e){var t=e.shape;if(t){if(Om.registry.exist(t))return Om.create(e);if(Lm.registry.exist(t))return Lm.create(e)}throw new Error("The `shape` should be specified when creating a node/edge instance")}))}}(Dm||(Dm={}));var Im=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Bm=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"label",get:function(){return this.getLabel()},set:function(e){this.setLabel(e)}},{key:"getLabel",value:function(){return this.getAttrByPath("text/text")}},{key:"setLabel",value:function(e,t){return null==e?this.removeLabel():this.setAttrByPath("text/text",e,t),this}},{key:"removeLabel",value:function(){return this.removeAttrByPath("text/text"),this}}]),n}(Om);!function(e){e.bodyAttr={fill:"#ffffff",stroke:"#333333",strokeWidth:2},e.labelAttr={fontSize:14,fill:"#000000",refX:.5,refY:.5,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"Arial, helvetica, sans-serif"},e.config({attrs:{text:Object.assign({},e.labelAttr)},propHooks:function(e){var t=e.label,n=Im(e,["label"]);return t&&kh(n,"attrs/text/text",t),n},visible:!0})}(Bm||(Bm={}));var zm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Fm(e){return[{tagName:e,selector:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"body"},{tagName:"text",selector:"label"}]}function Vm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={constructorName:e,markup:Fm(e,n.selector),attrs:O({},e,Object.assign({},Bm.bodyAttr))};return(n.parent||Bm).define($e(r,t,{shape:e}))}Vm("rect",{attrs:{body:{refWidth:"100%",refHeight:"100%"}}});var Hm=Lm.define({shape:"edge",markup:[{tagName:"path",selector:"wrap",groupSelector:"lines",attrs:{fill:"none",cursor:"pointer",stroke:"transparent",strokeLinecap:"round"}},{tagName:"path",selector:"line",groupSelector:"lines",attrs:{fill:"none",pointerEvents:"none"}}],attrs:{lines:{connection:!0,strokeLinejoin:"round"},wrap:{strokeWidth:10},line:{stroke:"#333",strokeWidth:2,targetMarker:"classic"}}});Vm("ellipse",{attrs:{body:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%"}}});var Um=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},qm=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"points",get:function(){return this.getPoints()},set:function(e){this.setPoints(e)}},{key:"getPoints",value:function(){return this.getAttrByPath("body/refPoints")}},{key:"setPoints",value:function(e,t){return null==e?this.removePoints():this.setAttrByPath("body/refPoints",n.pointsToString(e),t),this}},{key:"removePoints",value:function(){return this.removeAttrByPath("body/refPoints"),this}}]),n}(Bm);!function(e){function t(e){return"string"==typeof e?e:e.map((function(e){return Array.isArray(e)?e.join(","):Wd.isPointLike(e)?"".concat(e.x,", ").concat(e.y):""})).join(" ")}e.pointsToString=t,e.config({propHooks:function(e){var n=e.points,r=Um(e,["points"]);if(n){var i=t(n);i&&kh(r,"attrs/body/refPoints",i)}return r}})}(qm||(qm={})),Vm("polygon",{},{parent:qm}),Vm("polyline",{},{parent:qm});var Gm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};Bm.define({shape:"path",markup:[{tagName:"rect",selector:"bg"},{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}],attrs:{bg:{refWidth:"100%",refHeight:"100%",fill:"none",stroke:"none",pointerEvents:"all"},body:{fill:"none",stroke:"#000",strokeWidth:2}},propHooks:function(e){var t=e.path,n=Gm(e,["path"]);return t&&kh(n,"attrs/body/refD",t),n}});var Jm=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};Bm.define({shape:"text-block",markup:[{tagName:"rect",selector:"body"},Nh.SUPPORT_FOREIGNOBJECT?{tagName:"foreignObject",selector:"foreignObject",children:[{tagName:"div",ns:ff.xhtml,selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]}:{tagName:"text",selector:"label",attrs:{textAnchor:"middle"}}],attrs:{body:Object.assign(Object.assign({},Bm.bodyAttr),{refWidth:"100%",refHeight:"100%"}),foreignObject:{refWidth:"100%",refHeight:"100%"},label:{style:{fontSize:14}}},propHooks:function(e){var t=e.text,n=Jm(e,["text"]);return t&&kh(n,"attrs/label/text",t),n},attrHooks:{text:{set:function(e,t){var n=t.cell,r=t.view,i=t.refBBox,o=t.elem,a=t.attrs;if(!(o instanceof HTMLElement)){var s=a.style||{},l={text:e,width:-5,height:"100%"},u=Object.assign({textVerticalAnchor:"middle"},s);return hh(tp.presets.textWrap.set,this,l,{cell:n,view:r,elem:o,refBBox:i,attrs:u}),{fill:s.color||null}}o.textContent=e},position:function(e,t){var n=t.refBBox;if(t.elem instanceof SVGElement)return n.getCenter()}}}}),Vm("image",{attrs:{image:{refWidth:"100%",refHeight:"100%"}},propHooks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xlink:href";return function(t){var n=t.imageUrl,r=t.imageWidth,i=t.imageHeight,o=zm(t,["imageUrl","imageWidth","imageHeight"]);if(null!=n||null!=r||null!=i){var a=function(){if(o.attrs){var t=o.attrs.image;null!=n&&(t[e]=n),null!=r&&(t.width=r),null!=i&&(t.height=i),o.attrs.image=t}};o.attrs?(null==o.attrs.image&&(o.attrs.image={}),a()):(o.attrs={image:{}},a())}return o}}()},{selector:"image"}),Vm("circle",{attrs:{body:{refCx:"50%",refCy:"50%",refR:"50%"}}});var Wm=function(e,t){l(r,e);var n=c(r);function r(){var e;return A(this,r),(e=n.apply(this,arguments)).portsCache={},e}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"getContainerClassName",value:function(){var e=[s(g(r.prototype),"getContainerClassName",this).call(this),this.prefixClassName("node")];return this.can("nodeMovable")||e.push(this.prefixClassName("node-immovable")),e.join(" ")}},{key:"updateClassName",value:function(e){var t=e.target;if(t.hasAttribute("magnet")){var n=this.prefixClassName("port-unconnectable");this.can("magnetConnectable")?sf(t,n):af(t,n)}else{var r=this.prefixClassName("node-immovable");this.can("nodeMovable")?this.removeClass(r):this.addClass(r)}}},{key:"isNodeView",value:function(){return!0}},{key:"confirmUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;return this.hasAction(r,"ports")&&(this.removePorts(),this.cleanPortsCache()),this.hasAction(r,"render")?(this.render(),r=this.removeAction(r,["render","update","resize","translate","rotate","ports","tools"])):(r=this.handleAction(r,"resize",(function(){return t.resize()}),"update"),r=this.handleAction(r,"update",(function(){return t.update()}),"ports"),r=this.handleAction(r,"translate",(function(){return t.translate()})),r=this.handleAction(r,"rotate",(function(){return t.rotate()})),r=this.handleAction(r,"ports",(function(){return t.renderPorts()})),r=this.handleAction(r,"tools",(function(){t.getFlag("tools")===e?t.renderTools():t.updateTools(n)}))),r}},{key:"update",value:function(e){this.cleanCache(),this.removePorts();var t=this.cell,n=t.getSize(),r=t.getAttrs();this.updateAttrs(this.container,r,{attrs:e===r?null:e,rootBBox:new Yd(0,0,n.width,n.height),selectors:this.selectors}),this.renderPorts()}},{key:"renderMarkup",value:function(){var e=this.cell.markup;if(e){if("string"==typeof e)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid node markup.")}},{key:"renderJSONMarkup",value:function(e){var t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.appendChild(t.fragment)}},{key:"render",value:function(){return this.empty(),this.renderMarkup(),this.resize(),this.updateTransform(),this.renderTools(),this}},{key:"resize",value:function(){this.cell.getAngle()&&this.rotate(),this.update()}},{key:"translate",value:function(){this.updateTransform()}},{key:"rotate",value:function(){this.updateTransform()}},{key:"getTranslationString",value:function(){var e=this.cell.getPosition();return"translate(".concat(e.x,",").concat(e.y,")")}},{key:"getRotationString",value:function(){var e=this.cell.getAngle();if(e){var t=this.cell.getSize();return"rotate(".concat(e,",").concat(t.width/2,",").concat(t.height/2,")")}}},{key:"updateTransform",value:function(){var e=this.getTranslationString(),t=this.getRotationString();t&&(e+=" ".concat(t)),this.container.setAttribute("transform",e)}},{key:"findPortElem",value:function(e,t){var n=e?this.portsCache[e]:null;if(!n)return null;var r=n.portContentElement,i=n.portContentSelectors||{};return this.findOne(t,r,i)}},{key:"cleanPortsCache",value:function(){this.portsCache={}}},{key:"removePorts",value:function(){Object.values(this.portsCache).forEach((function(e){bf(e.portElement)}))}},{key:"renderPorts",value:function(){var e=this,t=this.container,n=[];t.childNodes.forEach((function(e){n.push(e)}));var r=this.cell.getParsedPorts(),i=st(r,"zIndex"),o="auto";i[o]&&i[o].forEach((function(r){var i=e.getPortElement(r);t.append(i),n.push(i)})),Object.keys(i).forEach((function(t){if(t!==o){var r=parseInt(t,10);e.appendPorts(i[t],r,n)}})),this.updatePorts()}},{key:"appendPorts",value:function(e,t,n){var r=this,i=e.map((function(e){return r.getPortElement(e)}));n[t]||t<0?Cf(n[Math.max(t,0)],i):xf(this.container,i)}},{key:"getPortElement",value:function(e){var t=this.portsCache[e.id];return t?t.portElement:this.createPortElement(e)}},{key:"createPortElement",value:function(e){var t=Lp.renderMarkup(this.cell.getPortContainerMarkup()),n=t.elem;if(null==n)throw new Error("Invalid port container markup.");var r=(t=Lp.renderMarkup(this.getPortMarkup(e))).elem,i=t.selectors;if(null==r)throw new Error("Invalid port markup.");this.setAttrs({port:e.id,"port-group":e.group},r);var o="x6-port";e.group&&(o+=" x6-port-".concat(e.group)),af(n,o),af(n,"x6-port"),af(r,"x6-port-body"),n.appendChild(r);var a,s,l=i;if(this.existPortLabel(e)){if(a=(t=Lp.renderMarkup(this.getPortLabelMarkup(e.label))).elem,s=t.selectors,null==a)throw new Error("Invalid port label markup.");if(i&&s){for(var u in s)if(i[u]&&u!==this.rootSelector)throw new Error("Selectors within port must be unique.");l=Object.assign(Object.assign({},i),s)}af(a,"x6-port-label"),n.appendChild(a)}return this.portsCache[e.id]={portElement:n,portSelectors:l,portLabelElement:a,portLabelSelectors:s,portContentElement:r,portContentSelectors:i},this.graph.options.onPortRendered&&this.graph.options.onPortRendered({port:e,node:this.cell,container:n,selectors:l,labelContainer:a,labelSelectors:s,contentContainer:r,contentSelectors:i}),n}},{key:"updatePorts",value:function(){var e=this,t=this.cell.getParsedGroups(),n=Object.keys(t);0===n.length?this.updatePortGroup():n.forEach((function(t){return e.updatePortGroup(t)}))}},{key:"updatePortGroup",value:function(e){for(var t=Yd.fromSize(this.cell.getSize()),n=this.cell.getPortsLayoutByGroup(e,t),r=0,i=n.length;r<i;r+=1){var o=n[r],a=o.portId,s=this.portsCache[a]||{},l=o.portLayout;if(this.applyPortTransform(s.portElement,l),null!=o.portAttrs){var u={selectors:s.portSelectors||{}};o.portSize&&(u.rootBBox=Yd.fromSize(o.portSize)),this.updateAttrs(s.portElement,o.portAttrs,u)}var c=o.labelLayout;if(c&&s.portLabelElement&&(this.applyPortTransform(s.portLabelElement,c,-(l.angle||0)),c.attrs)){var h={selectors:s.portLabelSelectors||{}};o.labelSize&&(h.rootBBox=Yd.fromSize(o.labelSize)),this.updateAttrs(s.portLabelElement,c.attrs,h)}}}},{key:"applyPortTransform",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t.angle,i=t.position;xd(e,pd().rotate(n).translate(i.x||0,i.y||0).rotate(r||0),{absolute:!0})}},{key:"getPortMarkup",value:function(e){return e.markup||this.cell.portMarkup}},{key:"getPortLabelMarkup",value:function(e){return e.markup||this.cell.portLabelMarkup}},{key:"existPortLabel",value:function(e){return e.attrs&&e.attrs.text}},{key:"getEventArgs",value:function(e,t,n){var r=this,i=r.cell;return null==t||null==n?{e:e,view:r,node:i,cell:i}:{e:e,x:t,y:n,view:r,node:i,cell:i}}},{key:"getPortEventArgs",value:function(e,t,n){var r=this,i=r.cell,o=i;return n?{e:e,x:n.x,y:n.y,view:r,node:i,cell:o,port:t}:{e:e,view:r,node:i,cell:o,port:t}}},{key:"notifyMouseDown",value:function(e,t,n){s(g(r.prototype),"onMouseDown",this).call(this,e,t,n),this.notify("node:mousedown",this.getEventArgs(e,t,n))}},{key:"notifyMouseMove",value:function(e,t,n){s(g(r.prototype),"onMouseMove",this).call(this,e,t,n),this.notify("node:mousemove",this.getEventArgs(e,t,n))}},{key:"notifyMouseUp",value:function(e,t,n){s(g(r.prototype),"onMouseUp",this).call(this,e,t,n),this.notify("node:mouseup",this.getEventArgs(e,t,n))}},{key:"notifyPortEvent",value:function(e,t,n){var r=this.findAttr("port",t.target);if(r){var i=t.type;"node:port:mouseenter"===e?t.type="mouseenter":"node:port:mouseleave"===e&&(t.type="mouseleave"),this.notify(e,this.getPortEventArgs(t,r,n)),t.type=i}}},{key:"onClick",value:function(e,t,n){s(g(r.prototype),"onClick",this).call(this,e,t,n),this.notify("node:click",this.getEventArgs(e,t,n)),this.notifyPortEvent("node:port:click",e,{x:t,y:n})}},{key:"onDblClick",value:function(e,t,n){s(g(r.prototype),"onDblClick",this).call(this,e,t,n),this.notify("node:dblclick",this.getEventArgs(e,t,n)),this.notifyPortEvent("node:port:dblclick",e,{x:t,y:n})}},{key:"onContextMenu",value:function(e,t,n){s(g(r.prototype),"onContextMenu",this).call(this,e,t,n),this.notify("node:contextmenu",this.getEventArgs(e,t,n)),this.notifyPortEvent("node:port:contextmenu",e,{x:t,y:n})}},{key:"onMouseDown",value:function(e,t,n){this.isPropagationStopped(e)||(this.notifyMouseDown(e,t,n),this.notifyPortEvent("node:port:mousedown",e,{x:t,y:n}),this.startNodeDragging(e,t,n))}},{key:"onMouseMove",value:function(e,t,n){var r=this.getEventData(e),i=r.action;if("magnet"===i)this.dragMagnet(e,t,n);else{if("move"===i){var o=r.targetView||this;o.dragNode(e,t,n),o.notify("node:moving",{e:e,x:t,y:n,view:o,cell:o.cell,node:o.cell})}this.notifyMouseMove(e,t,n),this.notifyPortEvent("node:port:mousemove",e,{x:t,y:n})}this.setEventData(e,r)}},{key:"onMouseUp",value:function(e,t,n){var r=this.getEventData(e),i=r.action;"magnet"===i?this.stopMagnetDragging(e,t,n):(this.notifyMouseUp(e,t,n),this.notifyPortEvent("node:port:mouseup",e,{x:t,y:n}),"move"===i&&(r.targetView||this).stopNodeDragging(e,t,n));var o=r.targetMagnet;o&&this.onMagnetClick(e,o,t,n),this.checkMouseleave(e)}},{key:"onMouseOver",value:function(e){s(g(r.prototype),"onMouseOver",this).call(this,e),this.notify("node:mouseover",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseenter",e),this.notifyPortEvent("node:port:mouseover",e)}},{key:"onMouseOut",value:function(e){s(g(r.prototype),"onMouseOut",this).call(this,e),this.notify("node:mouseout",this.getEventArgs(e)),this.notifyPortEvent("node:port:mouseleave",e),this.notifyPortEvent("node:port:mouseout",e)}},{key:"onMouseEnter",value:function(e){this.updateClassName(e),s(g(r.prototype),"onMouseEnter",this).call(this,e),this.notify("node:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){s(g(r.prototype),"onMouseLeave",this).call(this,e),this.notify("node:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,t,n,i){s(g(r.prototype),"onMouseWheel",this).call(this,e,t,n,i),this.notify("node:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}},{key:"onMagnetClick",value:function(e,t,n,r){var i=this.graph;i.view.getMouseMovedCount(e)>i.options.clickThreshold||this.notify("node:magnet:click",Object.assign({magnet:t},this.getEventArgs(e,n,r)))}},{key:"onMagnetDblClick",value:function(e,t,n,r){this.notify("node:magnet:dblclick",Object.assign({magnet:t},this.getEventArgs(e,n,r)))}},{key:"onMagnetContextMenu",value:function(e,t,n,r){this.notify("node:magnet:contextmenu",Object.assign({magnet:t},this.getEventArgs(e,n,r)))}},{key:"onMagnetMouseDown",value:function(e,t,n,r){this.startMagnetDragging(e,n,r)}},{key:"onCustomEvent",value:function(e,t,n,i){this.notify("node:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),s(g(r.prototype),"onCustomEvent",this).call(this,e,t,n,i)}},{key:"prepareEmbedding",value:function(e){var t=this.graph,n=this.getEventData(e).cell||this.cell,r=t.findViewByCell(n),i=t.snapToGrid(e.clientX,e.clientY);this.notify("node:embed",{e:e,node:n,view:r,cell:n,x:i.x,y:i.y,currentParent:n.getParent()})}},{key:"processEmbedding",value:function(e,t){var n=this,r=t.cell||this.cell,i=t.graph||this.graph,o=i.options.embedding,a=o.findParent,s="function"==typeof a?hh(a,i,{view:this,node:this.cell}).filter((function(e){return Am.isCell(e)&&n.cell.id!==e.id&&!e.isDescendantOf(n.cell)})):i.model.getNodesUnderNode(r,{by:a});if(o.frontOnly&&s.length>0){var l=st(s,"zIndex"),u=lt(Object.keys(l).map((function(e){return parseInt(e,10)})));u&&(s=l[u])}s=s.filter((function(e){return e.visible}));for(var c=null,h=t.candidateEmbedView,f=o.validate,d=s.length-1;d>=0;d-=1){var g=s[d];if(h&&h.cell.id===g.id){c=h;break}var v=g.findView(i);if(f&&hh(f,i,{child:this.cell,parent:v.cell,childView:this,parentView:v})){c=v;break}}this.clearEmbedding(t),c&&c.highlight(null,{type:"embedding"}),t.candidateEmbedView=c;var p=i.snapToGrid(e.clientX,e.clientY);this.notify("node:embedding",{e:e,cell:r,node:r,view:i.findViewByCell(r),x:p.x,y:p.y,currentParent:r.getParent(),candidateParent:c?c.cell:null})}},{key:"clearEmbedding",value:function(e){var t=e.candidateEmbedView;t&&(t.unhighlight(null,{type:"embedding"}),e.candidateEmbedView=null)}},{key:"finalizeEmbedding",value:function(e,t){this.graph.startBatch("embedding");var n=t.cell||this.cell,r=t.graph||this.graph,i=r.findViewByCell(n),o=n.getParent(),a=t.candidateEmbedView;if(a?(a.unhighlight(null,{type:"embedding"}),t.candidateEmbedView=null,null!=o&&o.id===a.cell.id||a.cell.insertChild(n,void 0,{ui:!0})):o&&o.unembed(n,{ui:!0}),r.model.getConnectedEdges(n,{deep:!0}).forEach((function(e){e.updateParent({ui:!0})})),i&&a){var s=r.snapToGrid(e.clientX,e.clientY);i.notify("node:embedded",{e:e,cell:n,x:s.x,y:s.y,node:n,view:r.findViewByCell(n),previousParent:o,currentParent:n.getParent()})}this.graph.stopBatch("embedding")}},{key:"getDelegatedView",value:function(){for(var e=this.cell,t=this;t&&!e.isEdge();){if(!e.hasParent()||t.can("stopDelegateOnDragging"))return t;e=e.getParent(),t=this.graph.findViewByCell(e)}return null}},{key:"validateMagnet",value:function(e,t,n){if("passive"!==t.getAttribute("magnet")){var r=this.graph.options.connecting.validateMagnet;return!r||hh(r,this.graph,{e:n,magnet:t,view:e,cell:e.cell})}return!1}},{key:"startMagnetDragging",value:function(e,t,n){if(this.can("magnetConnectable")){e.stopPropagation();var r=e.currentTarget,i=this.graph;this.setEventData(e,{targetMagnet:r}),this.validateMagnet(this,r,e)?(i.options.magnetThreshold<=0&&this.startConnectting(e,r,t,n),this.setEventData(e,{action:"magnet"}),this.stopPropagation(e)):this.onMouseDown(e,t,n),i.view.delegateDragEvents(e,this)}}},{key:"startConnectting",value:function(e,t,n,r){this.graph.model.startBatch("add-edge");var i=this.createEdgeFromMagnet(t,n,r);i.setEventData(e,i.prepareArrowheadDragging("target",{x:n,y:r,isNewEdge:!0,fallbackAction:"remove"})),this.setEventData(e,{edgeView:i}),i.notifyMouseDown(e,n,r)}},{key:"getDefaultEdge",value:function(e,t){var n,r=this.graph.options.connecting.createEdge;return r&&(n=hh(r,this.graph,{sourceMagnet:t,sourceView:e,sourceCell:e.cell})),n}},{key:"createEdgeFromMagnet",value:function(e,t,n){var r=this.graph,i=r.model,o=this.getDefaultEdge(this,e);return o.setSource(Object.assign(Object.assign({},o.getSource()),this.getEdgeTerminal(e,t,n,o,"source"))),o.setTarget(Object.assign(Object.assign({},o.getTarget()),{x:t,y:n})),o.addTo(i,{async:!1,ui:!0}),o.findView(r)}},{key:"dragMagnet",value:function(e,t,n){var r=this.getEventData(e),i=r.edgeView;if(i)i.onMouseMove(e,t,n),this.autoScrollGraph(e.clientX,e.clientY);else{var o=this.graph,a=o.options.magnetThreshold,s=this.getEventTarget(e),l=r.targetMagnet;if("onleave"===a){if(l===s||l.contains(s))return}else if(o.view.getMouseMovedCount(e)<=a)return;this.startConnectting(e,l,t,n)}}},{key:"stopMagnetDragging",value:function(e,t,n){var r=this.eventData(e).edgeView;r&&(r.onMouseUp(e,t,n),this.graph.model.stopBatch("add-edge"))}},{key:"notifyUnhandledMouseDown",value:function(e,t,n){this.notify("node:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,node:this.cell})}},{key:"notifyNodeMove",value:function(e,t,n,r,i){var o=this,a=[i],s=this.graph.getPlugin("selection");if(s&&s.isSelectionMovable()){var l=s.getSelectedCells();l.includes(i)&&(a=l.filter((function(e){return e.isNode()})))}a.forEach((function(i){o.notify(e,{e:t,x:n,y:r,cell:i,node:i,view:i.findView(o.graph)})}))}},{key:"getRestrictArea",value:function(e){var t=this.graph.options.translating.restrict,n="function"==typeof t?hh(t,this.graph,e):t;return"number"==typeof n?this.graph.transform.getGraphArea().inflate(n):!0===n?this.graph.transform.getGraphArea():n||null}},{key:"startNodeDragging",value:function(e,t,n){var r=this.getDelegatedView();if(null==r||!r.can("nodeMovable"))return this.notifyUnhandledMouseDown(e,t,n);this.setEventData(e,{targetView:r,action:"move"});var i=Wd.create(r.cell.getPosition());r.setEventData(e,{moving:!1,offset:i.diff(t,n),restrict:this.getRestrictArea(r)})}},{key:"dragNode",value:function(e,t,n){var r=this.cell,i=this.graph,o=i.getGridSize(),a=this.getEventData(e),s=a.offset,l=a.restrict;a.moving||(a.moving=!0,this.addClass("node-moving"),this.notifyNodeMove("node:move",e,t,n,this.cell)),this.autoScrollGraph(e.clientX,e.clientY);var u=qd.snapToGrid(t+s.x,o),c=qd.snapToGrid(n+s.y,o);r.setPosition(u,c,{restrict:l,deep:!0,ui:!0}),i.options.embedding.enabled&&(a.embedding||(this.prepareEmbedding(e),a.embedding=!0),this.processEmbedding(e,a))}},{key:"stopNodeDragging",value:function(e,t,n){var r=this.getEventData(e);r.embedding&&this.finalizeEmbedding(e,r),r.moving&&(this.removeClass("node-moving"),this.notifyNodeMove("node:moved",e,t,n,this.cell)),r.moving=!1,r.embedding=!1}},{key:"autoScrollGraph",value:function(e,t){var n=this.graph.getPlugin("scroller");n&&n.autoScroll(e,t)}}]),r}(Bp,Symbol.toStringTag);!function(e){e.toStringTag="X6.".concat(e.name),e.isNodeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNodeView&&"function"==typeof r.isEdgeView&&"function"==typeof r.confirmUpdate&&"function"==typeof r.update&&"function"==typeof r.findPortElem&&"function"==typeof r.resize&&"function"==typeof r.rotate&&"function"==typeof r.translate}}(Wm||(Wm={})),Wm.config({isSvgElement:!0,priority:0,bootstrap:["render"],actions:{view:["render"],markup:["render"],attrs:["update"],size:["resize","ports","tools"],angle:["rotate","tools"],position:["translate","tools"],ports:["ports"],tools:["tools"]}}),Wm.registry.register("node",Wm,!0);var Ym=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Zm=function(e,t){l(r,e);var n=c(r);function r(){var e;return A(this,r),(e=n.apply(this,arguments)).POINT_ROUNDING=2,e.labelDestroyFn={},e}return P(r,[{key:t,get:function(){return r.toStringTag}},{key:"getContainerClassName",value:function(){return[s(g(r.prototype),"getContainerClassName",this).call(this),this.prefixClassName("edge")].join(" ")}},{key:"sourceBBox",get:function(){var e=this.sourceView;if(!e){var t=this.cell.getSource();return new Yd(t.x,t.y)}var n=this.sourceMagnet;return e.isEdgeElement(n)?new Yd(this.sourceAnchor.x,this.sourceAnchor.y):e.getBBoxOfElement(n||e.container)}},{key:"targetBBox",get:function(){var e=this.targetView;if(!e){var t=this.cell.getTarget();return new Yd(t.x,t.y)}var n=this.targetMagnet;return e.isEdgeElement(n)?new Yd(this.targetAnchor.x,this.targetAnchor.y):e.getBBoxOfElement(n||e.container)}},{key:"isEdgeView",value:function(){return!0}},{key:"confirmUpdate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if(this.hasAction(r,"source")){if(!this.updateTerminalProperties("source"))return r;r=this.removeAction(r,"source")}if(this.hasAction(r,"target")){if(!this.updateTerminalProperties("target"))return r;r=this.removeAction(r,"target")}return this.hasAction(r,"render")?(this.render(),r=this.removeAction(r,["render","update","labels","tools"])):(r=this.handleAction(r,"update",(function(){return t.update(n)})),r=this.handleAction(r,"labels",(function(){return t.onLabelsChange(n)})),r=this.handleAction(r,"tools",(function(){return t.renderTools()})))}},{key:"render",value:function(){return this.empty(),this.renderMarkup(),this.labelContainer=null,this.renderLabels(),this.update(),this.renderTools(),this}},{key:"renderMarkup",value:function(){var e=this.cell.markup;if(e){if("string"==typeof e)throw new TypeError("Not support string markup.");return this.renderJSONMarkup(e)}throw new TypeError("Invalid edge markup.")}},{key:"renderJSONMarkup",value:function(e){var t=this.parseJSONMarkup(e,this.container);this.selectors=t.selectors,this.container.append(t.fragment)}},{key:"customizeLabels",value:function(){if(this.labelContainer)for(var e=this.cell,t=e.labels,n=0,r=t.length;n<r;n+=1){var i=t[n],o=this.labelCache[n],a=this.labelSelectors[n],s=this.graph.options.onEdgeLabelRendered;if(s){var l=s({edge:e,label:i,container:o,selectors:a});l&&(this.labelDestroyFn[n]=l)}}}},{key:"destroyCustomizeLabels",value:function(){var e=this.cell.labels;if(this.labelCache&&this.labelSelectors&&this.labelDestroyFn)for(var t=0,n=e.length;t<n;t+=1){var r=this.labelDestroyFn[t],i=this.labelCache[t],o=this.labelSelectors[t];r&&i&&o&&r({edge:this.cell,label:e[t],container:i,selectors:o})}this.labelDestroyFn={}}},{key:"renderLabels",value:function(){var e=this.cell,t=e.getLabels(),n=t.length,r=this.labelContainer;if(this.labelCache={},this.labelSelectors={},n<=0)return r&&r.parentNode&&r.parentNode.removeChild(r),this;r?this.empty(r):(r=vf("g"),this.addClass(this.prefixClassName("edge-labels"),r),this.labelContainer=r);for(var i=0,o=t.length;i<o;i+=1){var a=t[i],s=this.normalizeLabelMarkup(this.parseLabelMarkup(a.markup)),l=void 0,u=void 0;if(s)l=s.node,u=s.selectors;else{var c=e.getDefaultLabel(),h=this.normalizeLabelMarkup(this.parseLabelMarkup(c.markup));l=h.node,u=h.selectors}l.setAttribute("data-index","".concat(i)),r.appendChild(l);var f=this.rootSelector;if(u[f])throw new Error("Ambiguous label root selector.");u[f]=l,this.labelCache[i]=l,this.labelSelectors[i]=u}return null==r.parentNode&&this.container.appendChild(r),this.updateLabels(),this.customizeLabels(),this}},{key:"onLabelsChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.destroyCustomizeLabels(),this.shouldRerenderLabels(e)?this.renderLabels():this.updateLabels(),this.updateLabelPositions()}},{key:"shouldRerenderLabels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell.previous("labels");if(null==t)return!0;if("propertyPathArray"in e&&"propertyValue"in e){var n=e.propertyPathArray||[],r=n.length;if(r>1)if(t[n[1]]){if(2===r)return"object"===v(e.propertyValue)&&ut(e.propertyValue,"markup");if("markup"!==n[2])return!1}}return!0}},{key:"parseLabelMarkup",value:function(e){return e?"string"==typeof e?this.parseLabelStringMarkup(e):this.parseJSONMarkup(e):null}},{key:"parseLabelStringMarkup",value:function(e){for(var t=Xf.createVectors(e),n=document.createDocumentFragment(),r=0,i=t.length;r<i;r+=1){var o=t[r].node;n.appendChild(o)}return{fragment:n,selectors:{}}}},{key:"normalizeLabelMarkup",value:function(e){if(null!=e){var t,n=e.fragment;if(!(n instanceof DocumentFragment&&n.hasChildNodes()))throw new Error("Invalid label markup.");var r=n.childNodes;return(t=r.length>1||"G"!==r[0].nodeName.toUpperCase()?Xf.create("g").append(n):Xf.create(r[0])).addClass(this.prefixClassName("edge-label")),{node:t.node,selectors:e.selectors}}}},{key:"updateLabels",value:function(){if(this.labelContainer)for(var e=this.cell,t=e.labels,n=this.can("edgeLabelMovable"),r=e.getDefaultLabel(),i=0,o=t.length;i<o;i+=1){var a=this.labelCache[i],s=this.labelSelectors[i];a.setAttribute("cursor",n?"move":"default");var l=t[i],u=$e({},r.attrs,l.attrs);this.updateAttrs(a,u,{selectors:s,rootBBox:l.size?Yd.fromSize(l.size):void 0})}}},{key:"renderTools",value:function(){var e=this.cell.getTools();return this.addTools(e),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cleanCache(),this.updateConnection(e);var t=this.cell.getAttrs(),n=Ym(t,["text"]);return null!=n&&this.updateAttrs(this.container,n,{selectors:this.selectors}),this.updateLabelPositions(),this.updateTools(e),this}},{key:"removeRedundantLinearVertices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell,n=t.getVertices(),r=[this.sourceAnchor].concat(p(n),[this.targetAnchor]),i=r.length,o=new rg(r);o.simplify({threshold:.01});var a=o.points.map((function(e){return e.toJSON()})),s=a.length;return i===s?0:(t.setVertices(a.slice(1,s-1),e),i-s)}},{key:"getTerminalView",value:function(e){switch(e){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalAnchor",value:function(e){switch(e){case"source":return Wd.create(this.sourceAnchor);case"target":return Wd.create(this.targetAnchor);default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalConnectionPoint",value:function(e){switch(e){case"source":return Wd.create(this.sourcePoint);case"target":return Wd.create(this.targetPoint);default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"getTerminalMagnet",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case"source":if(t.raw)return this.sourceMagnet;var n=this.sourceView;return n?this.sourceMagnet||n.container:null;case"target":if(t.raw)return this.targetMagnet;var r=this.targetView;return r?this.targetMagnet||r.container:null;default:throw new Error("Unknown terminal type '".concat(e,"'"))}}},{key:"updateConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.cell;if(e.translateBy&&t.isFragmentDescendantOf(e.translateBy)){var n=e.tx||0,r=e.ty||0;this.routePoints=new rg(this.routePoints).translate(n,r).points,this.translateConnectionPoints(n,r),this.path.translate(n,r)}else{var i=t.getVertices(),o=this.findAnchors(i);this.sourceAnchor=o.source,this.targetAnchor=o.target,this.routePoints=this.findRoutePoints(i);var a=this.findConnectionPoints(this.routePoints,this.sourceAnchor,this.targetAnchor);this.sourcePoint=a.source,this.targetPoint=a.target;var s=this.findMarkerPoints(this.routePoints,this.sourcePoint,this.targetPoint);this.path=this.findPath(this.routePoints,s.source||this.sourcePoint,s.target||this.targetPoint)}this.cleanCache()}},{key:"findAnchors",value:function(e){var t=this.cell,n=t.source,r=t.target,i=e[0],o=e[e.length-1];return r.priority&&!n.priority?this.findAnchorsOrdered("target",o,"source",i):this.findAnchorsOrdered("source",i,"target",o)}},{key:"findAnchorsOrdered",value:function(e,t,n,r){var i,o,a,s=this.cell,l=s[e],u=s[n],c=this.getTerminalView(e),h=this.getTerminalView(n),f=this.getTerminalMagnet(e),d=this.getTerminalMagnet(n);c?(a=t?Wd.create(t):h?d:Wd.create(u),i=this.getAnchor(l.anchor,c,f,a,e)):i=Wd.create(l);if(h){var g=Wd.create(r||i);o=this.getAnchor(u.anchor,h,d,g,n)}else o=Wd.isPointLike(u)?Wd.create(u):new Wd;return O(O({},e,i),n,o)}},{key:"getAnchor",value:function(e,t,n,r,i){var o,a=t.isEdgeElement(n),s=this.graph.options.connecting,l="string"==typeof e?{name:e}:e;if(!l){var u=a?("source"===i?s.sourceEdgeAnchor:s.targetEdgeAnchor)||s.edgeAnchor:("source"===i?s.sourceAnchor:s.targetAnchor)||s.anchor;l="string"==typeof u?{name:u}:u}if(!l)throw new Error("Anchor should be specified.");var c=l.name;if(a){var h=_y.registry.get(c);if("function"!=typeof h)return _y.registry.onNotFound(c);o=hh(h,this,t,n,r,l.args||{},i)}else{var f=xy.registry.get(c);if("function"!=typeof f)return xy.registry.onNotFound(c);o=hh(f,this,t,n,r,l.args||{},i)}return o?o.round(this.POINT_ROUNDING):new Wd}},{key:"findRoutePoints",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.graph.options.connecting.router||cm.presets.normal,r=this.cell.getRouter()||n;if("function"==typeof r)e=hh(r,this,t,{},this);else{var i="string"==typeof r?r:r.name,o="string"==typeof r?{}:r.args||{},a=i?cm.registry.get(i):cm.presets.normal;if("function"!=typeof a)return cm.registry.onNotFound(i);e=hh(a,this,t,o,this)}return null==e?t.map((function(e){return Wd.create(e)})):e.map((function(e){return Wd.create(e)}))}},{key:"findConnectionPoints",value:function(e,t,n){var r,i,o=this.cell,a=this.graph.options.connecting,s=o.getSource(),l=o.getTarget(),u=this.sourceView,c=this.targetView,h=e[0],f=e[e.length-1];if(u&&!u.isEdgeElement(this.sourceMagnet)){var d=this.sourceMagnet||u.container,g=new Zd(h||n,t),v=s.connectionPoint||a.sourceConnectionPoint||a.connectionPoint;r=this.getConnectionPoint(v,u,d,g,"source")}else r=t;if(c&&!c.isEdgeElement(this.targetMagnet)){var p=this.targetMagnet||c.container,y=l.connectionPoint||a.targetConnectionPoint||a.connectionPoint,m=new Zd(f||t,n);i=this.getConnectionPoint(y,c,p,m,"target")}else i=n;return{source:r,target:i}}},{key:"getConnectionPoint",value:function(e,t,n,r,i){var o=r.end;if(null==e)return o;var a="string"==typeof e?e:e.name,s="string"==typeof e?{}:e.args,l=Ny.registry.get(a);if("function"!=typeof l)return Ny.registry.onNotFound(a);var u=hh(l,this,r,t,n,s||{},i);return u?u.round(this.POINT_ROUNDING):o}},{key:"findMarkerPoints",value:function(e,t,n){var r,i,o=this,a=function(e){for(var t=o.cell.getAttrs(),n=Object.keys(t),r=0,i=n.length;r<i;r+=1){var a=t[n[r]];if(a["".concat(e,"Marker")]||a["".concat(e,"-marker")]){var s=a.strokeWidth||a["stroke-width"];if(s)return parseFloat(s);break}}return null},s=e[0],l=e[e.length-1],u=a("source");u&&(r=t.clone().move(s||n,-u));var c=a("target");return c&&(i=n.clone().move(l||t,-c)),this.sourceMarkerPoint=r||t.clone(),this.targetMarkerPoint=i||n.clone(),{source:r,target:i}}},{key:"findPath",value:function(e,t,n){var r,i,o,a=this.cell.getConnector()||this.graph.options.connecting.connector;if("string"==typeof a?r=a:(r=a.name,i=a.args),r){var s=wm.registry.get(r);if("function"!=typeof s)return wm.registry.onNotFound(r);o=s}else o=wm.presets.normal;var l=hh(o,this,t,n,e,Object.assign(Object.assign({},i),{raw:!0}),this);return"string"==typeof l?pg.parse(l):l}},{key:"translateConnectionPoints",value:function(e,t){this.sourcePoint.translate(e,t),this.targetPoint.translate(e,t),this.sourceAnchor.translate(e,t),this.targetAnchor.translate(e,t),this.sourceMarkerPoint.translate(e,t),this.targetMarkerPoint.translate(e,t)}},{key:"updateLabelPositions",value:function(){if(null==this.labelContainer)return this;if(!this.path)return this;var e=this.cell,t=e.getLabels();if(0===t.length)return this;for(var n=e.getDefaultLabel(),r=this.normalizeLabelPosition(n.position),i=0,o=t.length;i<o;i+=1){var a=t[i],s=this.labelCache[i];if(s){var l=this.normalizeLabelPosition(a.position),u=$e({},r,l),c=this.getLabelTransformationMatrix(u);s.setAttribute("transform",wd(c))}}return this}},{key:"updateTerminalProperties",value:function(e){var t=this.cell,n=this.graph,r=t[e],i=r&&r.cell,o="".concat(e,"View");if(!i)return this[o]=null,this.updateTerminalMagnet(e),!0;var a=n.getCellById(i);if(!a)throw new Error("Edge's ".concat(e,' node with id "').concat(i,'" not exists'));var s=a.findView(n);return!!s&&(this[o]=s,this.updateTerminalMagnet(e),!0)}},{key:"updateTerminalMagnet",value:function(e){var t="".concat(e,"Magnet"),n=this.getTerminalView(e);if(n){var r=n.getMagnetFromEdgeTerminal(this.cell[e]);r===n.container&&(r=null),this[t]=r}else this[t]=null}},{key:"getLabelPositionAngle",value:function(e){var t=this.cell.getLabelAt(e);return t&&t.position&&"object"===v(t.position)&&t.position.angle||0}},{key:"getLabelPositionArgs",value:function(e){var t=this.cell.getLabelAt(e);if(t&&t.position&&"object"===v(t.position))return t.position.options}},{key:"getDefaultLabelPositionArgs",value:function(){var e=this.cell.getDefaultLabel();if(e&&e.position&&"object"===v(e.position))return e.position.options}},{key:"mergeLabelPositionArgs",value:function(e,t){return null===e?null:void 0===e?null===t?null:t:$e({},t,e)}},{key:"getConnection",value:function(){return null!=this.path?this.path.clone():null}},{key:"getConnectionPathData",value:function(){if(null==this.path)return"";var e=this.cache.pathCache;return ut(e,"data")||(e.data=this.path.serialize()),e.data||""}},{key:"getConnectionSubdivisions",value:function(){if(null==this.path)return null;var e=this.cache.pathCache;return ut(e,"segmentSubdivisions")||(e.segmentSubdivisions=this.path.getSegmentSubdivisions()),e.segmentSubdivisions}},{key:"getConnectionLength",value:function(){if(null==this.path)return 0;var e=this.cache.pathCache;return ut(e,"length")||(e.length=this.path.length({segmentSubdivisions:this.getConnectionSubdivisions()})),e.length}},{key:"getPointAtLength",value:function(e){return null==this.path?null:this.path.pointAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getPointAtRatio",value:function(e){return null==this.path?null:(Th(e)&&(e=parseFloat(e)/100),this.path.pointAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()}))}},{key:"getTangentAtLength",value:function(e){return null==this.path?null:this.path.tangentAtLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getTangentAtRatio",value:function(e){return null==this.path?null:this.path.tangentAt(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPoint",value:function(e){return null==this.path?null:this.path.closestPoint(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPointLength",value:function(e){return null==this.path?null:this.path.closestPointLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getClosestPointRatio",value:function(e){return null==this.path?null:this.path.closestPointNormalizedLength(e,{segmentSubdivisions:this.getConnectionSubdivisions()})}},{key:"getLabelPosition",value:function(e,t,n,r){var i,o={distance:0},a=0;"number"==typeof n?(a=n,i=r):i=n,null!=i&&(o.options=i);var s,l,u=i&&i.absoluteOffset,c=!(i&&i.absoluteDistance),h=i&&i.absoluteDistance&&i.reverseDistance,f=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},g=new Wd(e,t),v=f.closestPointT(g,d),p=this.getConnectionLength()||0,y=f.lengthAtT(v,d);if(c&&(y=p>0?y/p:0),h&&(y=-1*(p-y)||1),o.distance=y,u||(s=f.tangentAtT(v)),s)l=s.pointOffset(g);else{var m=f.pointAtT(v),w=g.diff(m);l={x:w.x,y:w.y}}return o.offset=l,o.angle=a,o}},{key:"normalizeLabelPosition",value:function(e){return"number"==typeof e?{distance:e}:e}},{key:"getLabelTransformationMatrix",value:function(e){var t=this.normalizeLabelPosition(e),n=t.options||{},r=t.angle||0,i=t.distance,o=i>0&&i<=1,a=0,s={x:0,y:0},l=t.offset;l&&("number"==typeof l?a=l:(null!=l.x&&(s.x=l.x),null!=l.y&&(s.y=l.y)));var u,c=0!==s.x||0!==s.y||0===a,h=n.keepGradient,f=n.ensureLegibility,d=this.path,g={segmentSubdivisions:this.getConnectionSubdivisions()},v=o?i*this.getConnectionLength():i,p=d.tangentAtLength(v,g),y=r;if(p){if(c)(u=p.start).translate(s);else{var m=p.clone();m.rotate(-90,p.start),m.setLength(a),u=m.end}h&&(y=p.angle()+r,f&&(y=Ud.normalize((y+90)%180-90)))}else u=d.start,c&&u.translate(s);return pd().translate(u.x,u.y).rotate(y)}},{key:"getVertexIndex",value:function(e,t){var n=this.cell.getVertices(),r=this.getClosestPointLength(new Wd(e,t)),i=0;if(null!=r)for(var o=n.length;i<o;i+=1){var a=n[i],s=this.getClosestPointLength(a);if(null!=s&&r<s)break}return i}},{key:"getEventArgs",value:function(e,t,n){var r=this,i=r.cell;return null==t||null==n?{e:e,view:r,edge:i,cell:i}:{e:e,x:t,y:n,view:r,edge:i,cell:i}}},{key:"notifyUnhandledMouseDown",value:function(e,t,n){this.notify("edge:unhandled:mousedown",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}},{key:"notifyMouseDown",value:function(e,t,n){s(g(r.prototype),"onMouseDown",this).call(this,e,t,n),this.notify("edge:mousedown",this.getEventArgs(e,t,n))}},{key:"notifyMouseMove",value:function(e,t,n){s(g(r.prototype),"onMouseMove",this).call(this,e,t,n),this.notify("edge:mousemove",this.getEventArgs(e,t,n))}},{key:"notifyMouseUp",value:function(e,t,n){s(g(r.prototype),"onMouseUp",this).call(this,e,t,n),this.notify("edge:mouseup",this.getEventArgs(e,t,n))}},{key:"onClick",value:function(e,t,n){s(g(r.prototype),"onClick",this).call(this,e,t,n),this.notify("edge:click",this.getEventArgs(e,t,n))}},{key:"onDblClick",value:function(e,t,n){s(g(r.prototype),"onDblClick",this).call(this,e,t,n),this.notify("edge:dblclick",this.getEventArgs(e,t,n))}},{key:"onContextMenu",value:function(e,t,n){s(g(r.prototype),"onContextMenu",this).call(this,e,t,n),this.notify("edge:contextmenu",this.getEventArgs(e,t,n))}},{key:"onMouseDown",value:function(e,t,n){this.notifyMouseDown(e,t,n),this.startEdgeDragging(e,t,n)}},{key:"onMouseMove",value:function(e,t,n){var r=this.getEventData(e);switch(r.action){case"drag-label":this.dragLabel(e,t,n);break;case"drag-arrowhead":this.dragArrowhead(e,t,n);break;case"drag-edge":this.dragEdge(e,t,n)}return this.notifyMouseMove(e,t,n),r}},{key:"onMouseUp",value:function(e,t,n){var r=this.getEventData(e);switch(r.action){case"drag-label":this.stopLabelDragging(e,t,n);break;case"drag-arrowhead":this.stopArrowheadDragging(e,t,n);break;case"drag-edge":this.stopEdgeDragging(e,t,n)}return this.notifyMouseUp(e,t,n),this.checkMouseleave(e),r}},{key:"onMouseOver",value:function(e){s(g(r.prototype),"onMouseOver",this).call(this,e),this.notify("edge:mouseover",this.getEventArgs(e))}},{key:"onMouseOut",value:function(e){s(g(r.prototype),"onMouseOut",this).call(this,e),this.notify("edge:mouseout",this.getEventArgs(e))}},{key:"onMouseEnter",value:function(e){s(g(r.prototype),"onMouseEnter",this).call(this,e),this.notify("edge:mouseenter",this.getEventArgs(e))}},{key:"onMouseLeave",value:function(e){s(g(r.prototype),"onMouseLeave",this).call(this,e),this.notify("edge:mouseleave",this.getEventArgs(e))}},{key:"onMouseWheel",value:function(e,t,n,i){s(g(r.prototype),"onMouseWheel",this).call(this,e,t,n,i),this.notify("edge:mousewheel",Object.assign({delta:i},this.getEventArgs(e,t,n)))}},{key:"onCustomEvent",value:function(e,t,n,i){if(mf(e.target,"edge-tool",this.container)){if(e.stopPropagation(),this.can("useEdgeTools")){if("edge:remove"===t)return void this.cell.remove({ui:!0});this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,i)))}this.notifyMouseDown(e,n,i)}else this.notify("edge:customevent",Object.assign({name:t},this.getEventArgs(e,n,i))),s(g(r.prototype),"onCustomEvent",this).call(this,e,t,n,i)}},{key:"onLabelMouseDown",value:function(e,t,n){this.notifyMouseDown(e,t,n),this.startLabelDragging(e,t,n),this.getEventData(e).stopPropagation&&e.stopPropagation()}},{key:"startEdgeDragging",value:function(e,t,n){this.can("edgeMovable")?this.setEventData(e,{x:t,y:n,moving:!1,action:"drag-edge"}):this.notifyUnhandledMouseDown(e,t,n)}},{key:"dragEdge",value:function(e,t,n){var r=this.getEventData(e);r.moving||(r.moving=!0,this.addClass("edge-moving"),this.notify("edge:move",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),this.cell.translate(t-r.x,n-r.y,{ui:!0}),this.setEventData(e,{x:t,y:n}),this.notify("edge:moving",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})}},{key:"stopEdgeDragging",value:function(e,t,n){var r=this.getEventData(e);r.moving&&(this.removeClass("edge-moving"),this.notify("edge:moved",{e:e,x:t,y:n,view:this,cell:this.cell,edge:this.cell})),r.moving=!1}},{key:"prepareArrowheadDragging",value:function(e,t){var n=this.getTerminalMagnet(e),r={action:"drag-arrowhead",x:t.x,y:t.y,isNewEdge:!0===t.isNewEdge,terminalType:e,initialMagnet:n,initialTerminal:ct(this.cell[e]),fallbackAction:t.fallbackAction||"revert",getValidateConnectionArgs:this.createValidateConnectionArgs(e),options:t.options};return this.beforeArrowheadDragging(r),r}},{key:"createValidateConnectionArgs",value:function(e){var t,n=[];n[4]=e,n[5]=this;var r=0,i=0;"source"===e?(r=2,t="target"):(i=2,t="source");var o=this.cell[t],a=o.cell;if(a){var s,l=n[r]=this.graph.findViewByCell(a);l&&(s=l.getMagnetFromEdgeTerminal(o))===l.container&&(s=void 0),n[r+1]=s}return function(e,t){return n[i]=e,n[i+1]=e.container===t?void 0:t,n}}},{key:"beforeArrowheadDragging",value:function(e){e.zIndex=this.cell.zIndex,this.cell.toFront();var t=this.container.style;e.pointerEvents=t.pointerEvents,t.pointerEvents="none",this.graph.options.connecting.highlight&&this.highlightAvailableMagnets(e)}},{key:"afterArrowheadDragging",value:function(e){null!=e.zIndex&&(this.cell.setZIndex(e.zIndex,{ui:!0}),e.zIndex=null),this.container.style.pointerEvents=e.pointerEvents||"",this.graph.options.connecting.highlight&&this.unhighlightAvailableMagnets(e)}},{key:"validateConnection",value:function(e,t,n,i,o,a,s){var l=this,u=this.graph.options.connecting,c=u.allowLoop,h=u.allowNode,f=u.allowEdge,d=u.allowPort,g=u.allowMulti,v=u.validateConnection,p=a?a.cell:null,y="target"===o?n:e,m="target"===o?i:t,w=!0,b=function(r){var u="source"===o?s?s.port:null:p?p.getSourcePortId():null,c="target"===o?s?s.port:null:p?p.getTargetPortId():null;return hh(r,l.graph,{edge:p,edgeView:a,sourceView:e,targetView:n,sourcePort:u,targetPort:c,sourceMagnet:t,targetMagnet:i,sourceCell:e?e.cell:null,targetCell:n?n.cell:null,type:o})};if(null!=c&&("boolean"==typeof c?c||e!==n||(w=!1):w=b(c)),w&&null!=d&&("boolean"==typeof d?!d&&m&&(w=!1):w=b(d)),w&&null!=f&&("boolean"==typeof f?!f&&r.isEdgeView(y)&&(w=!1):w=b(f)),w&&null!=h&&null==m&&("boolean"==typeof h?!h&&Wm.isNodeView(y)&&(w=!1):w=b(h)),w&&null!=g&&a){var k=a.cell,x="source"===o?s:k.getSource(),C="target"===o?s:k.getTarget(),E=s?this.graph.getCellById(s.cell):null;if(x&&C&&x.cell&&C.cell&&E)if("function"==typeof g)w=b(g);else{var S=this.graph.model.getConnectedEdges(E,{outgoing:"source"===o,incoming:"target"===o});if(S.length)if("withPort"===g){var _=S.some((function(e){var t=e.getSource(),n=e.getTarget();return t&&n&&t.cell===x.cell&&n.cell===C.cell&&null!=t.port&&t.port===x.port&&null!=n.port&&n.port===C.port}));_&&(w=!1)}else if(!g){var A=S.some((function(e){var t=e.getSource(),n=e.getTarget();return t&&n&&t.cell===x.cell&&n.cell===C.cell}));A&&(w=!1)}}}return w&&null!=v&&(w=b(v)),w}},{key:"allowConnectToBlank",value:function(e){var t=this.graph,n=t.options.connecting.allowBlank;if("function"!=typeof n)return!!n;var r=t.findViewByCell(e),i=e.getSourceCell(),o=e.getTargetCell(),a=t.findViewByCell(i),s=t.findViewByCell(o);return hh(n,t,{edge:e,edgeView:r,sourceCell:i,targetCell:o,sourceView:a,targetView:s,sourcePort:e.getSourcePortId(),targetPort:e.getTargetPortId(),sourceMagnet:r.sourceMagnet,targetMagnet:r.targetMagnet})}},{key:"validateEdge",value:function(e,t,n){var r=this.graph;if(!this.allowConnectToBlank(e)){var i=e.getSourceCellId(),o=e.getTargetCellId();if(!i||!o)return!1}var a=r.options.connecting.validateEdge;return!a||hh(a,r,{edge:e,type:t,previous:n})}},{key:"arrowheadDragging",value:function(e,t,n,r){r.x=t,r.y=n,r.currentTarget!==e&&(r.currentMagnet&&r.currentView&&r.currentView.unhighlight(r.currentMagnet,{type:"magnetAdsorbed"}),r.currentView=this.graph.findViewByElem(e),r.currentView?(r.currentMagnet=r.currentView.findMagnet(e),r.currentMagnet&&this.validateConnection.apply(this,p(r.getValidateConnectionArgs(r.currentView,r.currentMagnet)).concat([r.currentView.getEdgeTerminal(r.currentMagnet,t,n,this.cell,r.terminalType)]))?r.currentView.highlight(r.currentMagnet,{type:"magnetAdsorbed"}):r.currentMagnet=null):r.currentMagnet=null),r.currentTarget=e,this.cell.prop(r.terminalType,{x:t,y:n},Object.assign(Object.assign({},r.options),{ui:!0}))}},{key:"arrowheadDragged",value:function(e,t,n){var r=e.currentView,i=e.currentMagnet;if(i&&r){r.unhighlight(i,{type:"magnetAdsorbed"});var o=e.terminalType,a=r.getEdgeTerminal(i,t,n,this.cell,o);this.cell.setTerminal(o,a,{ui:!0})}}},{key:"snapArrowhead",value:function(e,t,n){var r=this,i=this.graph,o=i.options.connecting,a=o.snap,s=o.allowEdge,l="object"===v(a)&&a.radius||50,u="object"===v(a)&&a.anchor||"center",c=i.renderer.findViewsInArea({x:e-l,y:t-l,width:2*l,height:2*l},{nodeOnly:!0});if(s){var h=i.renderer.findEdgeViewsFromPoint({x:e,y:t},l).filter((function(e){return e!==r}));c.push.apply(c,p(h))}var f,d=n.closestView||null,g=n.closestMagnet||null;n.closestView=null,n.closestMagnet=null;var y,m=Number.MAX_SAFE_INTEGER,w=new Wd(e,t);c.forEach((function(i){if("false"!==i.container.getAttribute("magnet")){if(i.isNodeView())f="center"===u?i.cell.getBBox().getCenter().distance(w):i.cell.getBBox().getNearestPointToPoint(w).distance(w);else if(i.isEdgeView()){var o=i.getClosestPoint(w);f=o?o.distance(w):Number.MAX_SAFE_INTEGER}f<l&&f<m&&(g===i.container||r.validateConnection.apply(r,p(n.getValidateConnectionArgs(i,null)).concat([i.getEdgeTerminal(i.container,e,t,r.cell,n.terminalType)])))&&(m=f,n.closestView=i,n.closestMagnet=i.container)}i.container.querySelectorAll("[magnet]").forEach((function(o){if("false"!==o.getAttribute("magnet")){var a=i.getBBoxOfElement(o);(f=w.distance(a.getCenter()))<l&&f<m&&(g===o||r.validateConnection.apply(r,p(n.getValidateConnectionArgs(i,o)).concat([i.getEdgeTerminal(o,e,t,r.cell,n.terminalType)])))&&(m=f,n.closestView=i,n.closestMagnet=o)}}))}));var b=n.terminalType,k=n.closestView,x=n.closestMagnet,C=g!==x;if(d&&C&&d.unhighlight(g,{type:"magnetAdsorbed"}),k){if(!C)return;k.highlight(x,{type:"magnetAdsorbed"}),y=k.getEdgeTerminal(x,e,t,this.cell,b)}else y={x:e,y:t};this.cell.setTerminal(b,y,{},Object.assign(Object.assign({},n.options),{ui:!0}))}},{key:"snapArrowheadEnd",value:function(e){var t=e.closestView,n=e.closestMagnet;t&&n&&(t.unhighlight(n,{type:"magnetAdsorbed"}),e.currentMagnet=t.findMagnet(n)),e.closestView=null,e.closestMagnet=null}},{key:"finishEmbedding",value:function(e){this.graph.options.embedding.enabled&&this.cell.updateParent()&&(e.zIndex=null)}},{key:"fallbackConnection",value:function(e){if("remove"===e.fallbackAction)this.cell.remove({ui:!0});else this.cell.prop(e.terminalType,e.initialTerminal,{ui:!0})}},{key:"notifyConnectionEvent",value:function(e,t){var n=e.terminalType,r=e.initialTerminal,i=this.cell[n];if(i&&!Lm.equalTerminals(r,i)){var o=this.graph,a=r,s=a.cell?o.getCellById(a.cell):null,l=a.port,u=s?o.findViewByCell(s):null,c=s||e.isNewEdge?null:Wd.create(r).toJSON(),h=i,f=h.cell?o.getCellById(h.cell):null,d=h.port,g=f?o.findViewByCell(f):null,v=f?null:Wd.create(i).toJSON();this.notify("edge:connected",{e:t,previousCell:s,previousPort:l,previousView:u,previousPoint:c,currentCell:f,currentView:g,currentPort:d,currentPoint:v,previousMagnet:e.initialMagnet,currentMagnet:e.currentMagnet,edge:this.cell,view:this,type:n,isNew:e.isNewEdge})}}},{key:"highlightAvailableMagnets",value:function(e){var t=this,n=this.graph,r=n.model.getCells();e.marked={};for(var i=function(){var i=n.findViewByCell(r[o]);if(!i||i.cell.id===t.cell.id)return 1;var a=Array.prototype.slice.call(i.container.querySelectorAll("[magnet]"));"false"!==i.container.getAttribute("magnet")&&a.push(i.container);var s=a.filter((function(n){return t.validateConnection.apply(t,p(e.getValidateConnectionArgs(i,n)).concat([i.getEdgeTerminal(n,e.x,e.y,t.cell,e.terminalType)]))}));if(s.length>0){for(var l=0,u=s.length;l<u;l+=1)i.highlight(s[l],{type:"magnetAvailable"});i.highlight(null,{type:"nodeAvailable"}),e.marked[i.cell.id]=s}},o=0,a=r.length;o<a;o+=1)i()}},{key:"unhighlightAvailableMagnets",value:function(e){var t=this,n=e.marked||{};Object.keys(n).forEach((function(e){var r=t.graph.findViewByCell(e);r&&(n[e].forEach((function(e){r.unhighlight(e,{type:"magnetAvailable"})})),r.unhighlight(null,{type:"nodeAvailable"}))})),e.marked=null}},{key:"startArrowheadDragging",value:function(e,t,n){if(this.can("arrowheadMovable")){var r=e.target.getAttribute("data-terminal"),i=this.prepareArrowheadDragging(r,{x:t,y:n});this.setEventData(e,i)}else this.notifyUnhandledMouseDown(e,t,n)}},{key:"dragArrowhead",value:function(e,t,n){var r=this.getEventData(e);this.graph.options.connecting.snap?this.snapArrowhead(t,n,r):this.arrowheadDragging(this.getEventTarget(e),t,n,r)}},{key:"stopArrowheadDragging",value:function(e,t,n){var r=this.graph,i=this.getEventData(e);r.options.connecting.snap?this.snapArrowheadEnd(i):this.arrowheadDragged(i,t,n),this.validateEdge(this.cell,i.terminalType,i.initialTerminal)?(this.finishEmbedding(i),this.notifyConnectionEvent(i,e)):this.fallbackConnection(i),this.afterArrowheadDragging(i)}},{key:"startLabelDragging",value:function(e,t,n){if(this.can("edgeLabelMovable")){var r=e.currentTarget,i=parseInt(r.getAttribute("data-index"),10),o=this.getLabelPositionAngle(i),a=this.getLabelPositionArgs(i),s=this.getDefaultLabelPositionArgs(),l=this.mergeLabelPositionArgs(a,s);this.setEventData(e,{index:i,positionAngle:o,positionArgs:l,stopPropagation:!0,action:"drag-label"})}else this.setEventData(e,{stopPropagation:!0});this.graph.view.delegateDragEvents(e,this)}},{key:"dragLabel",value:function(e,t,n){var r=this.getEventData(e),i=this.cell.getLabelAt(r.index),o=$e({},i,{position:this.getLabelPosition(t,n,r.positionAngle,r.positionArgs)});this.cell.setLabelAt(r.index,o)}},{key:"stopLabelDragging",value:function(e,t,n){}}]),r}(Bp,Symbol.toStringTag);!function(e){e.toStringTag="X6.".concat(e.name),e.isEdgeView=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag],r=t;return(null==n||n===e.toStringTag)&&"function"==typeof r.isNodeView&&"function"==typeof r.isEdgeView&&"function"==typeof r.confirmUpdate&&"function"==typeof r.update&&"function"==typeof r.getConnection}}(Zm||(Zm={})),Zm.config({isSvgElement:!0,priority:1,bootstrap:["render","source","target"],actions:{view:["render"],markup:["render"],attrs:["update"],source:["source","update"],target:["target","update"],router:["update"],connector:["update"],labels:["labels"],defaultLabel:["labels"],tools:["tools"],vertices:["vertices","update"]}}),Zm.registry.register("edge",Zm,!0);var Xm=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Km=function(e){l(n,e);var t=c(n);function n(e){var r;A(this,n),(r=t.call(this)).graph=e;var i=Lp.parseJSONMarkup(n.markup),o=i.selectors,a=i.fragment;return r.background=o.background,r.grid=o.grid,r.svg=o.svg,r.defs=o.defs,r.viewport=o.viewport,r.primer=o.primer,r.stage=o.stage,r.decorator=o.decorator,r.overlay=o.overlay,r.container=r.options.container,r.restore=n.snapshoot(r.container),af(r.container,r.prefixClassName("graph")),xf(r.container,a),r.delegateEvents(),r}return P(n,[{key:"disposeContainer",get:function(){return!1}},{key:"options",get:function(){return this.graph.options}},{key:"delegateEvents",value:function(){var e=this.constructor;return s(g(n.prototype),"delegateEvents",this).call(this,e.events),this}},{key:"guard",value:function(e,t){return"mousedown"===e.type&&2===e.button||(!(!this.options.guard||!this.options.guard(e,t))||(e.data&&void 0!==e.data.guarded?e.data.guarded:!(t&&t.cell&&Am.isCell(t.cell))&&(this.svg!==e.target&&this.container!==e.target&&!this.svg.contains(e.target))))}},{key:"findView",value:function(e){return this.graph.findViewByElem(e)}},{key:"onDblClick",value:function(e){this.options.preventDefaultDblClick&&e.preventDefault();var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onDblClick(t,r.x,r.y):this.graph.trigger("blank:dblclick",{e:t,x:r.x,y:r.y})}}},{key:"onClick",value:function(e){if(this.getMouseMovedCount(e)<=this.options.clickThreshold){var t=this.normalizeEvent(e),n=this.findView(t.target);if(this.guard(t,n))return;var r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onClick(t,r.x,r.y):this.graph.trigger("blank:click",{e:t,x:r.x,y:r.y})}}},{key:"isPreventDefaultContextMenu",value:function(e){var t=this.options.preventDefaultContextMenu;return"function"==typeof t&&(t=hh(t,this.graph,{view:e})),t}},{key:"onContextMenu",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(this.isPreventDefaultContextMenu(n)&&e.preventDefault(),!this.guard(t,n)){var r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onContextMenu(t,r.x,r.y):this.graph.trigger("blank:contextmenu",{e:t,x:r.x,y:r.y})}}},{key:"delegateDragEvents",value:function(e,t){null==e.data&&(e.data={}),this.setEventData(e,{currentView:t||null,mouseMovedCount:0,startPosition:{x:e.clientX,y:e.clientY}});var n=this.constructor;this.delegateDocumentEvents(n.documentEvents,e.data),this.undelegateEvents()}},{key:"getMouseMovedCount",value:function(e){return this.getEventData(e).mouseMovedCount||0}},{key:"onMouseDown",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){this.options.preventDefaultMouseDown&&e.preventDefault();var r=this.graph.snapToGrid(t.clientX,t.clientY);n?n.onMouseDown(t,r.x,r.y):(this.options.preventDefaultBlankAction&&["touchstart"].includes(t.type)&&e.preventDefault(),this.graph.trigger("blank:mousedown",{e:t,x:r.x,y:r.y})),this.delegateDragEvents(t,n)}}},{key:"onMouseMove",value:function(e){var t=this.getEventData(e),n=t.startPosition;if((!n||n.x!==e.clientX||n.y!==e.clientY)&&(null==t.mouseMovedCount&&(t.mouseMovedCount=0),t.mouseMovedCount+=1,!(t.mouseMovedCount<=this.options.moveThreshold))){var r=this.normalizeEvent(e),i=this.graph.snapToGrid(r.clientX,r.clientY),o=t.currentView;o?o.onMouseMove(r,i.x,i.y):this.graph.trigger("blank:mousemove",{e:r,x:i.x,y:i.y}),this.setEventData(r,t)}}},{key:"onMouseUp",value:function(e){this.undelegateDocumentEvents();var t=this.normalizeEvent(e),n=this.graph.snapToGrid(t.clientX,t.clientY),r=this.getEventData(e).currentView;if(r?r.onMouseUp(t,n.x,n.y):this.graph.trigger("blank:mouseup",{e:t,x:n.x,y:n.y}),!e.isPropagationStopped()){var i=new Ad(e,{type:"click",data:e.data});this.onClick(i)}e.stopImmediatePropagation(),this.delegateEvents()}},{key:"onMouseOver",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOver(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseover",{e:t})}}},{key:"onMouseOut",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n))if(n)n.onMouseOut(t);else{if(this.container===t.target)return;this.graph.trigger("blank:mouseout",{e:t})}}},{key:"onMouseEnter",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var r=this.graph.findViewByElem(t.relatedTarget);if(n){if(r===n)return;n.onMouseEnter(t)}else{if(r)return;this.graph.trigger("graph:mouseenter",{e:t})}}}},{key:"onMouseLeave",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var r=this.graph.findViewByElem(t.relatedTarget);if(n){if(r===n)return;n.onMouseLeave(t)}else{if(r)return;this.graph.trigger("graph:mouseleave",{e:t})}}}},{key:"onMouseWheel",value:function(e){var t=this.normalizeEvent(e),n=this.findView(t.target);if(!this.guard(t,n)){var r=t.originalEvent,i=this.graph.snapToGrid(r.clientX,r.clientY),o=Math.max(-1,Math.min(1,r.wheelDelta||-r.detail));n?n.onMouseWheel(t,i.x,i.y,o):this.graph.trigger("blank:mousewheel",{e:t,delta:o,x:i.x,y:i.y})}}},{key:"onCustomEvent",value:function(e){var t=e.currentTarget,n=t.getAttribute("event")||t.getAttribute("data-event");if(n){var r=this.findView(t);if(r){var i=this.normalizeEvent(e);if(this.guard(i,r))return;var o=this.graph.snapToGrid(i.clientX,i.clientY);r.onCustomEvent(i,n,o.x,o.y)}}}},{key:"handleMagnetEvent",value:function(e,t){var n=e.currentTarget,r=n.getAttribute("magnet");if(r&&"false"!==r.toLowerCase()){var i=this.findView(n);if(i){var o=this.normalizeEvent(e);if(this.guard(o,i))return;var a=this.graph.snapToGrid(o.clientX,o.clientY);hh(t,this.graph,i,o,n,a.x,a.y)}}}},{key:"onMagnetMouseDown",value:function(e){this.handleMagnetEvent(e,(function(e,t,n,r,i){e.onMagnetMouseDown(t,n,r,i)}))}},{key:"onMagnetDblClick",value:function(e){this.handleMagnetEvent(e,(function(e,t,n,r,i){e.onMagnetDblClick(t,n,r,i)}))}},{key:"onMagnetContextMenu",value:function(e){var t=this.findView(e.target);this.isPreventDefaultContextMenu(t)&&e.preventDefault(),this.handleMagnetEvent(e,(function(e,t,n,r,i){e.onMagnetContextMenu(t,n,r,i)}))}},{key:"onLabelMouseDown",value:function(e){var t=e.currentTarget,n=this.findView(t);if(n){var r=this.normalizeEvent(e);if(this.guard(r,n))return;var i=this.graph.snapToGrid(r.clientX,r.clientY);n.onLabelMouseDown(r,i.x,i.y)}}},{key:"onImageDragStart",value:function(){return!1}},{key:"dispose",value:function(){this.undelegateEvents(),this.undelegateDocumentEvents(),this.restore(),this.restore=function(){}}}]),n}(Tp);Xm([Tp.dispose()],Km.prototype,"dispose",null),function(e){var t="".concat(ip.prefixCls,"-graph");e.markup=[{ns:ff.xhtml,tagName:"div",selector:"background",className:"".concat(t,"-background")},{ns:ff.xhtml,tagName:"div",selector:"grid",className:"".concat(t,"-grid")},{ns:ff.svg,tagName:"svg",selector:"svg",className:"".concat(t,"-svg"),attrs:{width:"100%",height:"100%","xmlns:xlink":ff.xlink},children:[{tagName:"defs",selector:"defs"},{tagName:"g",selector:"viewport",className:"".concat(t,"-svg-viewport"),children:[{tagName:"g",selector:"primer",className:"".concat(t,"-svg-primer")},{tagName:"g",selector:"stage",className:"".concat(t,"-svg-stage")},{tagName:"g",selector:"decorator",className:"".concat(t,"-svg-decorator")},{tagName:"g",selector:"overlay",className:"".concat(t,"-svg-overlay")}]}]}],e.snapshoot=function(e){var t=e.cloneNode();return e.childNodes.forEach((function(e){return t.appendChild(e)})),function(){for(kf(e);e.attributes.length>0;)e.removeAttribute(e.attributes[0].name);for(var n=0,r=t.attributes.length;n<r;n+=1){var i=t.attributes[n];e.setAttribute(i.name,i.value)}t.childNodes.forEach((function(t){return e.appendChild(t)}))}}}(Km||(Km={})),function(e,t){var n=ip.prefixCls;e.events=(O(O(O(O(O(O(O(O(O(O(t={dblclick:"onDblClick",contextmenu:"onContextMenu",touchstart:"onMouseDown",mousedown:"onMouseDown",mouseover:"onMouseOver",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mousewheel:"onMouseWheel",DOMMouseScroll:"onMouseWheel"},"mouseenter  .".concat(n,"-cell"),"onMouseEnter"),"mouseleave  .".concat(n,"-cell"),"onMouseLeave"),"mouseenter  .".concat(n,"-cell-tools"),"onMouseEnter"),"mouseleave  .".concat(n,"-cell-tools"),"onMouseLeave"),"mousedown   .".concat(n,"-cell [event]"),"onCustomEvent"),"touchstart  .".concat(n,"-cell [event]"),"onCustomEvent"),"mousedown   .".concat(n,"-cell [data-event]"),"onCustomEvent"),"touchstart  .".concat(n,"-cell [data-event]"),"onCustomEvent"),"dblclick    .".concat(n,"-cell [magnet]"),"onMagnetDblClick"),"contextmenu .".concat(n,"-cell [magnet]"),"onMagnetContextMenu"),O(O(O(O(O(O(O(O(O(t,"mousedown   .".concat(n,"-cell [magnet]"),"onMagnetMouseDown"),"touchstart  .".concat(n,"-cell [magnet]"),"onMagnetMouseDown"),"dblclick    .".concat(n,"-cell [data-magnet]"),"onMagnetDblClick"),"contextmenu .".concat(n,"-cell [data-magnet]"),"onMagnetContextMenu"),"mousedown   .".concat(n,"-cell [data-magnet]"),"onMagnetMouseDown"),"touchstart  .".concat(n,"-cell [data-magnet]"),"onMagnetMouseDown"),"dragstart   .".concat(n,"-cell image"),"onImageDragStart"),"mousedown   .".concat(n,"-edge .").concat(n,"-edge-label"),"onLabelMouseDown"),"touchstart  .".concat(n,"-edge .").concat(n,"-edge-label"),"onLabelMouseDown")),e.documentEvents={mousemove:"onMouseMove",touchmove:"onMouseMove",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"}}(Km||(Km={}));var $m=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this)).graph=e,r.init(),r}return P(n,[{key:"options",get:function(){return this.graph.options}},{key:"model",get:function(){return this.graph.model}},{key:"view",get:function(){return this.graph.view}},{key:"init",value:function(){}}]),n}(lh),Qm=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},ew=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"init",value:function(){!function(e,t){var n=Gd.find((function(t){return t.name===e}));if(!(n&&(n.loadTimes+=1,n.loadTimes>1)||Nh.isApplyingHMR())){var r=document.createElement("style");r.setAttribute("type","text/css"),r.textContent=t;var i=document.querySelector("head");i&&i.insertBefore(r,i.firstChild),Gd.push({name:e,loadTimes:1,styleElement:r})}}("core",".x6-graph {\n  position: relative;\n  overflow: hidden;\n  outline: none;\n  touch-action: none;\n}\n.x6-graph-background,\n.x6-graph-grid,\n.x6-graph-svg {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n}\n.x6-graph-background-stage,\n.x6-graph-grid-stage,\n.x6-graph-svg-stage {\n  user-select: none;\n}\n.x6-graph.x6-graph-pannable {\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n.x6-graph.x6-graph-panning {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  user-select: none;\n}\n.x6-node {\n  cursor: move;\n  /* stylelint-disable-next-line */\n}\n.x6-node.x6-node-immovable {\n  cursor: default;\n}\n.x6-node * {\n  -webkit-user-drag: none;\n}\n.x6-node .scalable * {\n  vector-effect: non-scaling-stroke;\n}\n.x6-node [magnet='true'] {\n  cursor: crosshair;\n  transition: opacity 0.3s;\n}\n.x6-node [magnet='true']:hover {\n  opacity: 0.7;\n}\n.x6-node foreignObject {\n  display: block;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-node foreignObject > body {\n  position: static;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  padding: 0;\n  overflow: visible;\n  background-color: transparent;\n}\n.x6-edge .source-marker,\n.x6-edge .target-marker {\n  vector-effect: non-scaling-stroke;\n}\n.x6-edge .connection {\n  stroke-linejoin: round;\n  fill: none;\n}\n.x6-edge .connection-wrap {\n  cursor: move;\n  opacity: 0;\n  fill: none;\n  stroke: #000;\n  stroke-width: 15;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n.x6-edge .connection-wrap:hover {\n  opacity: 0.4;\n  stroke-opacity: 0.4;\n}\n.x6-edge .vertices {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .vertices .vertex {\n  fill: #1abc9c;\n}\n.x6-edge .vertices .vertex :hover {\n  fill: #34495e;\n  stroke: none;\n}\n.x6-edge .vertices .vertex-remove {\n  cursor: pointer;\n  fill: #fff;\n}\n.x6-edge .vertices .vertex-remove-area {\n  cursor: pointer;\n  opacity: 0.1;\n}\n.x6-edge .vertices .vertex-group:hover .vertex-remove-area {\n  opacity: 1;\n}\n.x6-edge .arrowheads {\n  cursor: move;\n  opacity: 0;\n}\n.x6-edge .arrowheads .arrowhead {\n  fill: #1abc9c;\n}\n.x6-edge .arrowheads .arrowhead :hover {\n  fill: #f39c12;\n  stroke: none;\n}\n.x6-edge .tools {\n  cursor: pointer;\n  opacity: 0;\n}\n.x6-edge .tools .tool-options {\n  display: none;\n}\n.x6-edge .tools .tool-remove circle {\n  fill: #f00;\n}\n.x6-edge .tools .tool-remove path {\n  fill: #fff;\n}\n.x6-edge:hover .vertices,\n.x6-edge:hover .arrowheads,\n.x6-edge:hover .tools {\n  opacity: 1;\n}\n.x6-highlight-opacity {\n  opacity: 0.3;\n}\n.x6-cell-tool-editor {\n  position: relative;\n  display: inline-block;\n  min-height: 1em;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n  white-space: normal;\n  text-align: center;\n  vertical-align: top;\n  overflow-wrap: normal;\n  outline: none;\n  transform-origin: 0 0;\n  -webkit-user-drag: none;\n}\n.x6-edge-tool-editor {\n  border: 1px solid #275fc5;\n  border-radius: 2px;\n}\n")}},{key:"dispose",value:function(){!function(e){var t=Gd.findIndex((function(t){return t.name===e}));if(t>-1){var n=Gd[t];if(n.loadTimes-=1,n.loadTimes>0)return;var r=n.styleElement;r&&r.parentNode&&r.parentNode.removeChild(r),r=null,Gd.splice(t,1)}}("core")}}]),n}($m);Qm([ew.dispose()],ew.prototype,"dispose",null);var tw,nw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};!function(e){e.get=function(t){var n=t.grid,r=(t.panning,t.mousewheel,t.embedding,nw(t,["grid","panning","mousewheel","embedding"])),i=t.container;if(null==i)throw new Error("Ensure the container of the graph is specified and valid");null==r.width&&(r.width=i.clientWidth),null==r.height&&(r.height=i.clientHeight);var o=$e({},e.defaults,r),a={size:10,visible:!1};return o.grid="number"==typeof n?{size:n,visible:!1}:"boolean"==typeof n?Object.assign(Object.assign({},a),{visible:n}):Object.assign(Object.assign({},a),n),["panning","mousewheel","embedding"].forEach((function(e){var n=t[e];"boolean"==typeof n?o[e].enabled=n:o[e]=Object.assign(Object.assign({},o[e]),n)})),o}}(tw||(tw={})),function(e){e.defaults={x:0,y:0,scaling:{min:.01,max:16},grid:{size:10,visible:!1},background:!1,panning:{enabled:!1,eventTypes:["leftMouseDown"]},mousewheel:{enabled:!1,factor:1.2,zoomAtMousePosition:!0},highlighting:{default:{name:"stroke",args:{padding:3}},nodeAvailable:{name:"className",args:{className:ip.prefix("available-node")}},magnetAvailable:{name:"className",args:{className:ip.prefix("available-magnet")}}},connecting:{snap:!1,allowLoop:!0,allowNode:!0,allowEdge:!1,allowPort:!0,allowBlank:!0,allowMulti:!0,highlight:!1,anchor:"center",edgeAnchor:"ratio",connectionPoint:"boundary",router:"normal",connector:"normal",validateConnection:function(e){var t=e.type,n=e.sourceView,r=e.targetView;return null!=("target"===t?r:n)},createEdge:function(){return new Hm}},translating:{restrict:!1},embedding:{enabled:!1,findParent:"bbox",frontOnly:!0,validate:function(){return!0}},moveThreshold:0,clickThreshold:0,magnetThreshold:0,preventDefaultDblClick:!0,preventDefaultMouseDown:!1,preventDefaultContextMenu:!0,preventDefaultBlankAction:!0,interacting:{edgeLabelMovable:!1},async:!0,virtual:!1,guard:function(){return!1}}}(tw||(tw={}));var rw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},iw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},ow=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"elem",get:function(){return this.view.grid}},{key:"grid",get:function(){return this.options.grid}},{key:"init",value:function(){this.startListening(),this.draw(this.grid)}},{key:"startListening",value:function(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}},{key:"stopListening",value:function(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}},{key:"setVisible",value:function(e){this.grid.visible!==e&&(this.grid.visible=e,this.update())}},{key:"getGridSize",value:function(){return this.grid.size}},{key:"setGridSize",value:function(e){this.grid.size=Math.max(e,1),this.update()}},{key:"show",value:function(){this.setVisible(!0),this.update()}},{key:"hide",value:function(){this.setVisible(!1),this.update()}},{key:"clear",value:function(){this.elem.style.backgroundImage=""}},{key:"draw",value:function(e){this.clear(),this.instance=null,Object.assign(this.grid,e),this.patterns=this.resolveGrid(e),this.update()}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.grid.size;if(t<=1||!this.grid.visible)return this.clear();var n=this.graph.matrix(),r=this.getInstance(),i=Array.isArray(e)?e:[e];this.patterns.forEach((function(e,o){var a="pattern_".concat(o),s=n.a||1,l=n.d||1,u=e.update,c=e.markup,h=iw(e,["update","markup"]),f=Object.assign(Object.assign(Object.assign({},h),i[o]),{sx:s,sy:l,ox:n.e||0,oy:n.f||0,width:t*s,height:t*l});r.has(a)||r.add(a,Xf.create("pattern",{id:a,patternUnits:"userSpaceOnUse"},Xf.createVectors(c)).node);var d=r.get(a);"function"==typeof u&&u(d.childNodes[0],f);var g=f.ox%f.width;g<0&&(g+=f.width);var v=f.oy%f.height;v<0&&(v+=f.height),Tf(d,{x:g,y:v,width:f.width,height:f.height})}));var o=(new XMLSerializer).serializeToString(r.root),a="url(data:image/svg+xml;base64,".concat(btoa(o),")");this.elem.style.backgroundImage=a}},{key:"getInstance",value:function(){return this.instance||(this.instance=new Cg),this.instance}},{key:"resolveGrid",value:function(e){if(!e)return[];var t=e.type;if(null==t)return[Object.assign(Object.assign({},Cg.presets.dot),e.args)];var n=Cg.registry.get(t);if(n){var r=e.args||[];return Array.isArray(r)||(r=[r]),Array.isArray(n)?n.map((function(e,t){return Object.assign(Object.assign({},e),r[t])})):[Object.assign(Object.assign({},n),r[0])]}return Cg.registry.onNotFound(t)}},{key:"dispose",value:function(){this.stopListening(),this.clear()}}]),n}($m);rw([$m.dispose()],ow.prototype,"dispose",null);var aw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"container",get:function(){return this.graph.view.container}},{key:"viewport",get:function(){return this.graph.view.viewport}},{key:"stage",get:function(){return this.graph.view.stage}},{key:"init",value:function(){this.resize()}},{key:"getMatrix",value:function(){var e=this.viewport.getAttribute("transform");return e!==this.viewportTransformString&&(this.viewportMatrix=this.viewport.getCTM(),this.viewportTransformString=e),pd(this.viewportMatrix)}},{key:"setMatrix",value:function(e){var t=pd(e),n=wd(t);this.viewport.setAttribute("transform",n),this.viewportMatrix=t,this.viewportTransformString=n}},{key:"resize",value:function(e,t){var n=void 0===e?this.options.width:e,r=void 0===t?this.options.height:t;this.options.width=n,this.options.height=r,"number"==typeof n&&(n=Math.round(n)),"number"==typeof r&&(r=Math.round(r)),this.container.style.width=null==n?"":"".concat(n,"px"),this.container.style.height=null==r?"":"".concat(r,"px");var i=this.getComputedSize();return this.graph.trigger("resize",Object.assign({},i)),this}},{key:"getComputedSize",value:function(){var e=this.options.width,t=this.options.height;return ht(e)||(e=this.container.clientWidth),ht(t)||(t=this.container.clientHeight),{width:e,height:t}}},{key:"getScale",value:function(){return(e=this.getMatrix())?(t=null==e.a?1:e.a,i=null==e.d?1:e.d,n=e.b,r=e.c):t=i=1,{sx:n?Math.sqrt(t*t+n*n):t,sy:r?Math.sqrt(r*r+i*i):i};var e,t,n,r,i}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e=this.clampScale(e),t=this.clampScale(t),n||r){var i=this.getTranslation(),o=i.tx-n*(e-1),a=i.ty-r*(t-1);o===i.tx&&a===i.ty||this.translate(o,a)}var s=this.getMatrix();return s.a=e,s.d=t,this.setMatrix(s),this.graph.trigger("scale",{sx:e,sy:t,ox:n,oy:r}),this}},{key:"clampScale",value:function(e){var t=this.graph.options.scaling;return Ge(e,t.min||.01,t.max||16)}},{key:"getZoom",value:function(){return this.getScale().sx}},{key:"zoom",value:function(e,t){t=t||{};var n=e,r=e,i=this.getScale(),o=this.getComputedSize(),a=o.width/2,s=o.height/2;if(t.absolute||(n+=i.sx,r+=i.sy),t.scaleGrid&&(n=Math.round(n/t.scaleGrid)*t.scaleGrid,r=Math.round(r/t.scaleGrid)*t.scaleGrid),t.maxScale&&(n=Math.min(t.maxScale,n),r=Math.min(t.maxScale,r)),t.minScale&&(n=Math.max(t.minScale,n),r=Math.max(t.minScale,r)),t.center&&(a=t.center.x,s=t.center.y),n=this.clampScale(n),r=this.clampScale(r),a||s){var l=this.getTranslation(),u=a-(a-l.tx)*(n/i.sx),c=s-(s-l.ty)*(r/i.sy);u===l.tx&&c===l.ty||this.translate(u,c)}return this.scale(n,r),this}},{key:"getRotation",value:function(){return function(e){var t={x:0,y:1};e&&(t=kd(e,t));var n=180*Math.atan2(t.y,t.x)/Math.PI%360-90;return{angle:n%360+(n<0?360:0)}}(this.getMatrix())}},{key:"rotate",value:function(e,t,n){if(null==t||null==n){var r=rp.getBBox(this.stage);t=r.width/2,n=r.height/2}var i=this.getMatrix().translate(t,n).rotate(e).translate(-t,-n);return this.setMatrix(i),this}},{key:"getTranslation",value:function(){return{tx:(e=this.getMatrix())&&e.e||0,ty:e&&e.f||0};var e}},{key:"translate",value:function(e,t){var n=this.getMatrix();n.e=e||0,n.f=t||0,this.setMatrix(n);var r=this.getTranslation();return this.options.x=r.tx,this.options.y=r.ty,this.graph.trigger("translate",Object.assign({},r)),this}},{key:"setOrigin",value:function(e,t){return this.translate(e||0,t||0)}},{key:"fitToContent",value:function(e,t,n,r){if("object"===v(e)){var i=e;e=i.gridWidth||1,t=i.gridHeight||1,n=i.padding||0,r=i}else e=e||1,t=t||1,n=n||0,null==r&&(r={});var o=jh(n),a=r.border||0,s=r.contentArea?Yd.create(r.contentArea):this.getContentArea(r);a>0&&s.inflate(a);var l=this.getScale(),u=this.getTranslation(),c=l.sx,h=l.sy;s.x*=c,s.y*=h,s.width*=c,s.height*=h;var f=Math.max(Math.ceil((s.width+s.x)/e),1)*e,d=Math.max(Math.ceil((s.height+s.y)/t),1)*t,g=0,p=0;("negative"===r.allowNewOrigin&&s.x<0||"positive"===r.allowNewOrigin&&s.x>=0||"any"===r.allowNewOrigin)&&(g=Math.ceil(-s.x/e)*e,f+=g+=o.left),("negative"===r.allowNewOrigin&&s.y<0||"positive"===r.allowNewOrigin&&s.y>=0||"any"===r.allowNewOrigin)&&(p=Math.ceil(-s.y/t)*t,d+=p+=o.top),f+=o.right,d+=o.bottom,f=Math.max(f,r.minWidth||0),d=Math.max(d,r.minHeight||0),f=Math.min(f,r.maxWidth||Number.MAX_SAFE_INTEGER),d=Math.min(d,r.maxHeight||Number.MAX_SAFE_INTEGER);var y=this.getComputedSize(),m=f!==y.width||d!==y.height;return(g!==u.tx||p!==u.ty)&&this.translate(g,p),m&&this.resize(f,d),new Yd(-g/c,-p/h,f/c,d/h)}},{key:"scaleContentToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scaleContentToFitImpl(e)}},{key:"scaleContentToFitImpl",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(n.contentArea){var i=n.contentArea;e=this.graph.localToGraph(i),t=Wd.create(i)}else e=this.getContentBBox(n),t=this.graph.graphToLocal(e);if(e.width&&e.height){var o,a=jh(n.padding),s=n.minScale||0,l=n.maxScale||Number.MAX_SAFE_INTEGER,u=n.minScaleX||s,c=n.maxScaleX||l,h=n.minScaleY||s,f=n.maxScaleY||l;if(n.viewportArea)o=n.viewportArea;else{var d=this.getComputedSize(),g=this.getTranslation();o={x:g.tx,y:g.ty,width:d.width,height:d.height}}o=Yd.create(o).moveAndExpand({x:a.left,y:a.top,width:-a.left-a.right,height:-a.top-a.bottom});var v=this.getScale(),p=o.width/e.width*v.sx,y=o.height/e.height*v.sy;!1!==n.preserveAspectRatio&&(p=y=Math.min(p,y));var m=n.scaleGrid;if(m&&(p=m*Math.floor(p/m),y=m*Math.floor(y/m)),p=Ge(p,u,c),y=Ge(y,h,f),this.scale(p,y),r){var w=this.options,b=o.x-t.x*p-w.x,k=o.y-t.y*y-w.y;this.translate(b,k)}}}},{key:"getContentArea",value:function(){return!1!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useCellGeometry?this.model.getAllCellsBBox()||new Yd:rp.getBBox(this.stage)}},{key:"getContentBBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.graph.localToGraph(this.getContentArea(e))}},{key:"getGraphArea",value:function(){var e=Yd.fromSize(this.getComputedSize());return this.graph.graphToLocal(e)}},{key:"zoomToRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Yd.create(e),r=this.graph;t.contentArea=n,null==t.viewportArea&&(t.viewportArea={x:r.options.x,y:r.options.y,width:this.options.width,height:this.options.height}),this.scaleContentToFitImpl(t,!1);var i=n.getCenter();return this.centerPoint(i.x,i.y),this}},{key:"zoomToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.zoomToRect(this.getContentArea(e),e)}},{key:"centerPoint",value:function(e,t){var n=this.getComputedSize(),r=this.getScale(),i=this.getTranslation(),o=n.width/2,a=n.height/2;t="number"==typeof t?t:a,e=o-(e="number"==typeof e?e:o)*r.sx,t=a-t*r.sy,i.tx===e&&i.ty===t||this.translate(e,t)}},{key:"centerContent",value:function(e){var t=this.graph.getContentArea(e).getCenter();this.centerPoint(t.x,t.y)}},{key:"centerCell",value:function(e){return this.positionCell(e,"center")}},{key:"positionPoint",value:function(e,t,n){var r=this.getComputedSize();(t=Lh(t,Math.max(0,r.width)))<0&&(t=r.width+t),(n=Lh(n,Math.max(0,r.height)))<0&&(n=r.height+n);var i=this.getTranslation(),o=this.getScale(),a=t-e.x*o.sx,s=n-e.y*o.sy;i.tx===a&&i.ty===s||this.translate(a,s)}},{key:"positionRect",value:function(e,t){var n=Yd.create(e);switch(t){case"center":return this.positionPoint(n.getCenter(),"50%","50%");case"top":return this.positionPoint(n.getTopCenter(),"50%",0);case"top-right":return this.positionPoint(n.getTopRight(),"100%",0);case"right":return this.positionPoint(n.getRightMiddle(),"100%","50%");case"bottom-right":return this.positionPoint(n.getBottomRight(),"100%","100%");case"bottom":return this.positionPoint(n.getBottomCenter(),"50%","100%");case"bottom-left":return this.positionPoint(n.getBottomLeft(),0,"100%");case"left":return this.positionPoint(n.getLeftMiddle(),0,"50%");case"top-left":return this.positionPoint(n.getTopLeft(),0,0);default:return this}}},{key:"positionCell",value:function(e,t){var n=e.getBBox();return this.positionRect(n,t)}},{key:"positionContent",value:function(e,t){var n=this.graph.getContentArea(t);return this.positionRect(n,e)}}]),n}($m),sw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"elem",get:function(){return this.view.background}},{key:"init",value:function(){this.startListening(),this.options.background&&this.draw(this.options.background)}},{key:"startListening",value:function(){this.graph.on("scale",this.update,this),this.graph.on("translate",this.update,this)}},{key:"stopListening",value:function(){this.graph.off("scale",this.update,this),this.graph.off("translate",this.update,this)}},{key:"updateBackgroundImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.size||"auto auto",n=e.position||"center",r=this.graph.transform.getScale(),i=this.graph.translate();if("object"===v(n)){var o=i.tx+r.sx*(n.x||0),a=i.ty+r.sy*(n.y||0);n="".concat(o,"px ").concat(a,"px")}"object"===v(t)&&(t=Yd.fromSize(t).scale(r.sx,r.sy),t="".concat(t.width,"px ").concat(t.height,"px")),this.elem.style.backgroundSize=t,this.elem.style.backgroundPosition=n}},{key:"drawBackgroundImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e instanceof HTMLImageElement){var n=this.optionsCache;if(!n||n.image===t.image){var r,i=t.opacity,o=t.size,a=t.repeat||"no-repeat",s=Eg.registry.get(a);if("function"==typeof s){var l=t.quality||1;e.width*=l,e.height*=l;var u=s(e,t);if(!(u instanceof HTMLCanvasElement))throw new Error("Background pattern must return an HTML Canvas instance");r=u.toDataURL("image/png"),a=t.repeat&&a!==t.repeat?t.repeat:"repeat","object"===v(o)?(o.width*=u.width/e.width,o.height*=u.height/e.height):void 0===o&&(t.size={width:u.width/l,height:u.height/l})}else r=e.src,void 0===o&&(t.size={width:e.width,height:e.height});null!=n&&"object"===v(t.size)&&t.image===n.image&&t.repeat===n.repeat&&t.quality===n.quality&&(n.size=ct(t.size));var c=this.elem.style;c.backgroundImage="url(".concat(r,")"),c.backgroundRepeat=a,c.opacity=null==i||i>=1?"":"".concat(i),this.updateBackgroundImage(t)}}else this.elem.style.backgroundImage=""}},{key:"updateBackgroundColor",value:function(e){this.elem.style.backgroundColor=e||""}},{key:"updateBackgroundOptions",value:function(e){this.graph.options.background=e}},{key:"update",value:function(){this.optionsCache&&this.updateBackgroundImage(this.optionsCache)}},{key:"draw",value:function(e){var t=this,n=e||{};if(this.updateBackgroundOptions(e),this.updateBackgroundColor(n.color),n.image){this.optionsCache=ct(n);var r=document.createElement("img");r.onload=function(){return t.drawBackgroundImage(r,e)},r.setAttribute("crossorigin","anonymous"),r.src=n.image}else this.drawBackgroundImage(null),this.optionsCache=null}},{key:"clear",value:function(){this.draw()}},{key:"dispose",value:function(){this.clear(),this.stopListening()}}]),n}($m);sw([$m.dispose()],lw.prototype,"dispose",null);var uw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},cw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"widgetOptions",get:function(){return this.options.panning}},{key:"pannable",get:function(){return this.widgetOptions&&!0===this.widgetOptions.enabled}},{key:"init",value:function(){this.onRightMouseDown=this.onRightMouseDown.bind(this),this.onSpaceKeyDown=this.onSpaceKeyDown.bind(this),this.onSpaceKeyUp=this.onSpaceKeyUp.bind(this),this.startListening(),this.updateClassName()}},{key:"startListening",value:function(){this.graph.on("blank:mousedown",this.onMouseDown,this),this.graph.on("node:unhandled:mousedown",this.onMouseDown,this),this.graph.on("edge:unhandled:mousedown",this.onMouseDown,this),Pd.on(this.graph.container,"mousedown",this.onRightMouseDown),Pd.on(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle=new Ld(this.graph.container,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.mousewheelHandle.enable()}},{key:"stopListening",value:function(){this.graph.off("blank:mousedown",this.onMouseDown,this),this.graph.off("node:unhandled:mousedown",this.onMouseDown,this),this.graph.off("edge:unhandled:mousedown",this.onMouseDown,this),Pd.off(this.graph.container,"mousedown",this.onRightMouseDown),Pd.off(document.body,{keydown:this.onSpaceKeyDown,keyup:this.onSpaceKeyUp}),this.mousewheelHandle&&this.mousewheelHandle.disable()}},{key:"allowPanning",value:function(e,t){return e.spaceKey=this.isSpaceKeyPressed,this.pannable&&zd.isMatch(e,this.widgetOptions.modifiers,t)}},{key:"startPanning",value:function(e){var t=this.view.normalizeEvent(e);this.clientX=t.clientX,this.clientY=t.clientY,this.panning=!0,this.updateClassName(),Pd.on(document.body,{"mousemove.panning touchmove.panning":this.pan.bind(this),"mouseup.panning touchend.panning":this.stopPanning.bind(this),"mouseleave.panning":this.stopPanning.bind(this)}),Pd.on(window,"mouseup.panning",this.stopPanning.bind(this))}},{key:"pan",value:function(e){var t=this.view.normalizeEvent(e),n=t.clientX-this.clientX,r=t.clientY-this.clientY;this.clientX=t.clientX,this.clientY=t.clientY,this.graph.translateBy(n,r)}},{key:"stopPanning",value:function(e){this.panning=!1,this.updateClassName(),Pd.off(document.body,".panning"),Pd.off(window,".panning")}},{key:"updateClassName",value:function(){var e=this.view.container,t=this.view.prefixClassName("graph-panning"),n=this.view.prefixClassName("graph-pannable");this.pannable?this.panning?(af(e,t),sf(e,n)):(sf(e,t),af(e,n)):(sf(e,t),sf(e,n))}},{key:"onMouseDown",value:function(e){var t=e.e;if(this.allowBlankMouseDown(t)){var n=this.graph.getPlugin("selection"),r=n&&n.allowRubberband(t,!0);(this.allowPanning(t,!0)||this.allowPanning(t)&&!r)&&this.startPanning(t)}}},{key:"onRightMouseDown",value:function(e){var t=this.widgetOptions.eventTypes;(null==t?void 0:t.includes("rightMouseDown"))&&2===e.button&&this.allowPanning(e,!0)&&this.startPanning(e)}},{key:"onMouseWheel",value:function(e,t,n){this.graph.translateBy(-t,-n)}},{key:"onSpaceKeyDown",value:function(e){32===e.which&&(this.isSpaceKeyPressed=!0)}},{key:"onSpaceKeyUp",value:function(e){32===e.which&&(this.isSpaceKeyPressed=!1)}},{key:"allowBlankMouseDown",value:function(e){var t=this.widgetOptions.eventTypes;return(null==t?void 0:t.includes("leftMouseDown"))&&0===e.button||(null==t?void 0:t.includes("mouseWheelDown"))&&1===e.button}},{key:"allowMouseWheel",value:function(e){var t;return this.pannable&&!e.ctrlKey&&(null===(t=this.widgetOptions.eventTypes)||void 0===t?void 0:t.includes("mouseWheel"))}},{key:"autoPanning",value:function(e,t){var n=10,r=this.graph.getGraphArea(),i=0,o=0;e<=r.left+n&&(i=-10),t<=r.top+n&&(o=-10),e>=r.right-n&&(i=n),t>=r.bottom-n&&(o=n),0===i&&0===o||this.graph.translateBy(-i,-o)}},{key:"enablePanning",value:function(){this.pannable||(this.widgetOptions.enabled=!0,this.updateClassName())}},{key:"disablePanning",value:function(){this.pannable&&(this.widgetOptions.enabled=!1,this.updateClassName())}},{key:"dispose",value:function(){this.stopListening()}}]),n}($m);uw([$m.dispose()],cw.prototype,"dispose",null);var hw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fw=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).cumulatedFactor=1,e}return P(n,[{key:"widgetOptions",get:function(){return this.options.mousewheel}},{key:"init",value:function(){this.container=this.graph.container,this.target=this.widgetOptions.global?document:this.container,this.mousewheelHandle=new Ld(this.target,this.onMouseWheel.bind(this),this.allowMouseWheel.bind(this)),this.widgetOptions.enabled&&this.enable(!0)}},{key:"disabled",get:function(){return!0!==this.widgetOptions.enabled}},{key:"enable",value:function(e){(this.disabled||e)&&(this.widgetOptions.enabled=!0,this.mousewheelHandle.enable())}},{key:"disable",value:function(){this.disabled||(this.widgetOptions.enabled=!1,this.mousewheelHandle.disable())}},{key:"allowMouseWheel",value:function(e){var t=this.widgetOptions.guard;return(null==t||t(e))&&zd.isMatch(e,this.widgetOptions.modifiers)}},{key:"onMouseWheel",value:function(e){var t=this.widgetOptions.guard;if((null==t||t(e))&&zd.isMatch(e,this.widgetOptions.modifiers)){var n=this.widgetOptions.factor||1.2;null==this.currentScale&&(this.startPos={x:e.clientX,y:e.clientY},this.currentScale=this.graph.transform.getScale().sx),e.deltaY<0?this.currentScale<.15?this.cumulatedFactor=(this.currentScale+.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*n*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=1.05)):this.currentScale<=.15?this.cumulatedFactor=(this.currentScale-.01)/this.currentScale:(this.cumulatedFactor=Math.round(this.currentScale*(1/n)*20)/20/this.currentScale,1===this.cumulatedFactor&&(this.cumulatedFactor=.95)),this.cumulatedFactor=Math.max(.01,Math.min(this.currentScale*this.cumulatedFactor,160)/this.currentScale);var r=this.currentScale,i=this.graph.transform.clampScale(r*this.cumulatedFactor),o=this.widgetOptions.minScale||Number.MIN_SAFE_INTEGER,a=this.widgetOptions.maxScale||Number.MAX_SAFE_INTEGER;if((i=Ge(i,o,a))!==r)if(this.widgetOptions.zoomAtMousePosition){var s=!!this.graph.getPlugin("scroller")?this.graph.clientToLocal(this.startPos):this.graph.clientToGraph(this.startPos);this.graph.zoom(i,{absolute:!0,center:s.clone()})}else this.graph.zoom(i,{absolute:!0});this.currentScale=null,this.cumulatedFactor=1}}},{key:"dispose",value:function(){this.disable()}}]),n}($m);hw([lh.dispose()],fw.prototype,"dispose",null);var dw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},gw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"init",value:function(){this.resetRenderArea=ft(this.resetRenderArea,200,{leading:!0}),this.resetRenderArea(),this.startListening()}},{key:"startListening",value:function(){this.graph.on("translate",this.resetRenderArea,this),this.graph.on("scale",this.resetRenderArea,this),this.graph.on("resize",this.resetRenderArea,this)}},{key:"stopListening",value:function(){this.graph.off("translate",this.resetRenderArea,this),this.graph.off("scale",this.resetRenderArea,this),this.graph.off("resize",this.resetRenderArea,this)}},{key:"enableVirtualRender",value:function(){this.options.virtual=!0,this.resetRenderArea()}},{key:"disableVirtualRender",value:function(){this.options.virtual=!1,this.graph.renderer.setRenderArea(void 0)}},{key:"resetRenderArea",value:function(){if(this.options.virtual){var e=this.graph.getGraphArea();this.graph.renderer.setRenderArea(e)}}},{key:"dispose",value:function(){this.stopListening()}}]),n}($m);dw([$m.dispose()],gw.prototype,"dispose",null);var vw,pw=function(){function e(){A(this,e),this.isFlushing=!1,this.isFlushPending=!1,this.scheduleId=0,this.queue=[],this.frameInterval=33,this.initialTime=Date.now()}return P(e,[{key:"queueJob",value:function(e){if(e.priority&vw.PRIOR)e.cb();else{var t=this.findInsertionIndex(e);t>=0&&this.queue.splice(t,0,e)}}},{key:"queueFlush",value:function(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.scheduleJob())}},{key:"queueFlushSync",value:function(){this.isFlushing||this.isFlushPending||(this.isFlushPending=!0,this.flushJobsSync())}},{key:"clearJobs",value:function(){this.queue.length=0,this.isFlushing=!1,this.isFlushPending=!1,this.cancelScheduleJob()}},{key:"flushJobs",value:function(){this.isFlushPending=!1,this.isFlushing=!0;for(var e,t=this.getCurrentTime();(e=this.queue.shift())&&(e.cb(),!(this.getCurrentTime()-t>=this.frameInterval)););this.isFlushing=!1,this.queue.length&&this.queueFlush()}},{key:"flushJobsSync",value:function(){var e;for(this.isFlushPending=!1,this.isFlushing=!0;e=this.queue.shift();)try{e.cb()}catch(t){console.log(t)}this.isFlushing=!1}},{key:"findInsertionIndex",value:function(e){for(var t=0,n=this.queue.length,r=n-1,i=e.priority;t<=r;){var o=(r-t>>1)+t;i<=this.queue[o].priority?t=o+1:(n=o,r=o-1)}return n}},{key:"scheduleJob",value:function(){"requestIdleCallback"in window?(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.requestIdleCallback(this.flushJobs.bind(this),{timeout:100})):(this.scheduleId&&this.cancelScheduleJob(),this.scheduleId=window.setTimeout(this.flushJobs.bind(this)))}},{key:"cancelScheduleJob",value:function(){"cancelIdleCallback"in window?(this.scheduleId&&window.cancelIdleCallback(this.scheduleId),this.scheduleId=0):(this.scheduleId&&clearTimeout(this.scheduleId),this.scheduleId=0)}},{key:"getCurrentTime",value:function(){return"object"===("undefined"==typeof performance?"undefined":v(performance))&&"function"==typeof performance.now?performance.now():Date.now()-this.initialTime}}]),e}();!function(e){e[e.Update=2]="Update",e[e.RenderEdge=4]="RenderEdge",e[e.RenderNode=8]="RenderNode",e[e.PRIOR=1048576]="PRIOR"}(vw||(vw={}));var yw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},mw=function(e){l(n,e);var t=c(n);function n(e){var r;return A(this,n),(r=t.call(this)).views={},r.willRemoveViews={},r.queue=new pw,r.graph=e,r.init(),r}return P(n,[{key:"model",get:function(){return this.graph.model}},{key:"container",get:function(){return this.graph.view.stage}},{key:"init",value:function(){this.startListening(),this.renderViews(this.model.getCells())}},{key:"startListening",value:function(){this.model.on("reseted",this.onModelReseted,this),this.model.on("cell:added",this.onCellAdded,this),this.model.on("cell:removed",this.onCellRemoved,this),this.model.on("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.on("cell:change:visible",this.onCellVisibleChanged,this)}},{key:"stopListening",value:function(){this.model.off("reseted",this.onModelReseted,this),this.model.off("cell:added",this.onCellAdded,this),this.model.off("cell:removed",this.onCellRemoved,this),this.model.off("cell:change:zIndex",this.onCellZIndexChanged,this),this.model.off("cell:change:visible",this.onCellVisibleChanged,this)}},{key:"onModelReseted",value:function(e){var t=e.options;this.queue.clearJobs(),this.removeZPivots(),this.resetViews();var n=this.model.getCells();this.renderViews(n,Object.assign(Object.assign({},t),{queue:n.map((function(e){return e.id}))}))}},{key:"onCellAdded",value:function(e){var t=e.cell,n=e.options;this.renderViews([t],n)}},{key:"onCellRemoved",value:function(e){var t=e.cell;this.removeViews([t])}},{key:"onCellZIndexChanged",value:function(e){var t=e.cell,r=e.options,i=this.views[t.id];i&&this.requestViewUpdate(i.view,n.FLAG_INSERT,r,vw.Update,!0)}},{key:"onCellVisibleChanged",value:function(e){var t=e.cell,n=e.current;this.toggleVisible(t,!!n)}},{key:"requestViewUpdate",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vw.Update,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=e.cell.id,s=this.views[a];s&&(s.flag=t,s.options=r,(e.hasAction(t,["translate","resize","rotate"])||!1===r.async)&&(i=vw.PRIOR,o=!1),this.queue.queueJob({id:a,priority:i,cb:function(){n.renderViewInArea(e,t,r);var i=r.queue;if(i){var o=i.indexOf(e.cell.id);o>=0&&i.splice(o,1),0===i.length&&n.graph.trigger("render:done")}}}),this.getEffectedEdges(e).forEach((function(e){n.requestViewUpdate(e.view,e.flag,r,i,!1)})),o&&this.flush())}},{key:"setRenderArea",value:function(e){this.renderArea=e,this.flushWaitingViews()}},{key:"isViewMounted",value:function(e){if(null==e)return!1;var t=this.views[e.cell.id];return!!t&&t.state===n.ViewState.MOUNTED}},{key:"renderViews",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.sort((function(e,t){return e.isNode()&&t.isEdge()?-1:0})),e.forEach((function(e){var i=e.id,o=0,a=t.views[i];if(a)o=n.FLAG_INSERT;else{var s=t.createCellView(e);s&&(s.graph=t.graph,o=n.FLAG_INSERT|s.getBootstrapFlag(),a={view:s,flag:o,options:r,state:n.ViewState.CREATED},t.views[i]=a)}a&&t.requestViewUpdate(a.view,o,r,t.getRenderPriority(a.view),!1)})),this.flush()}},{key:"renderViewInArea",value:function(e,t){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.cell,a=o.id,s=this.views[a];if(s){var l=0;this.isUpdatable(e)||s.state===n.ViewState.MOUNTED?(l=this.updateView(e,t,i),s.flag=l):s.state=n.ViewState.WAITING,l&&o.isEdge()&&0==(l&e.getFlag(["source","target"]))&&this.queue.queueJob({id:a,priority:vw.RenderEdge,cb:function(){r.updateView(e,t,i)}})}}},{key:"removeViews",value:function(e){var t=this;e.forEach((function(e){var n=e.id,r=t.views[n];r&&(t.willRemoveViews[n]=r,delete t.views[n],t.queue.queueJob({id:n,priority:t.getRenderPriority(r.view),cb:function(){t.removeView(r.view)}}))})),this.flush()}},{key:"flush",value:function(){this.graph.options.async?this.queue.queueFlush():this.queue.queueFlushSync()}},{key:"flushWaitingViews",value:function(){var e=this;Object.values(this.views).forEach((function(t){if(t&&t.state===n.ViewState.WAITING){var r=t.view,i=t.flag,o=t.options;e.requestViewUpdate(r,i,o,e.getRenderPriority(r),!1)}})),this.flush()}},{key:"updateView",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==e)return 0;if(Bp.isCellView(e)){if(t&n.FLAG_REMOVE)return this.removeView(e.cell),0;t&n.FLAG_INSERT&&(this.insertView(e),t^=n.FLAG_INSERT)}return t?e.confirmUpdate(t,r):0}},{key:"insertView",value:function(e){var t=this.views[e.cell.id];if(t){var r=e.cell.getZIndex(),i=this.addZPivot(r);this.container.insertBefore(e.container,i),e.cell.isVisible()||this.toggleVisible(e.cell,!1),t.state=n.ViewState.MOUNTED,this.graph.trigger("view:mounted",{view:e})}}},{key:"resetViews",value:function(){var e=this;this.willRemoveViews=Object.assign(Object.assign({},this.views),this.willRemoveViews),Object.values(this.willRemoveViews).forEach((function(t){t&&e.removeView(t.view)})),this.views={},this.willRemoveViews={}}},{key:"removeView",value:function(e){var t=e.cell,n=this.willRemoveViews[t.id];n&&e&&(n.view.remove(),delete this.willRemoveViews[t.id],this.graph.trigger("view:unmounted",{view:e}))}},{key:"toggleVisible",value:function(e,t){for(var n=this.model.getConnectedEdges(e),r=0,i=n.length;r<i;r+=1){var o=n[r];if(t){var a=o.getSourceCell(),s=o.getTargetCell();if(a&&!a.isVisible()||s&&!s.isVisible())continue;this.toggleVisible(o,!0)}else this.toggleVisible(o,!1)}var l=this.views[e.id];l&&Jf(l.view.container,{display:t?"unset":"none"})}},{key:"addZPivot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null==this.zPivots&&(this.zPivots={});var t=this.zPivots,n=t[e];if(n)return n;n=t[e]=document.createComment("z-index:".concat(e+1));var r=-1/0;for(var i in t){var o=+i;o<e&&o>r&&(r=o)}var a=this.container;if(r!==-1/0){var s=t[r];a.insertBefore(n,s.nextSibling)}else a.insertBefore(n,a.firstChild);return n}},{key:"removeZPivots",value:function(){this.zPivots&&Object.values(this.zPivots).forEach((function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})),this.zPivots={}}},{key:"createCellView",value:function(e){var t={graph:this.graph},n=this.graph.options.createCellView;if(n){var r=hh(n,this.graph,e);if(r)return new r(e,t);if(null===r)return null}var i=e.view;if(null!=i&&"string"==typeof i){var o=Bp.registry.get(i);return o?new o(e,t):Bp.registry.onNotFound(i)}return e.isNode()?new Wm(e,t):e.isEdge()?new Zm(e,t):null}},{key:"getEffectedEdges",value:function(e){for(var t=[],n=e.cell,r=this.model.getConnectedEdges(n),i=0,o=r.length;i<o;i+=1){var a=r[i],s=this.views[a.id];if(s){var l=s.view;if(this.isViewMounted(l)){var u=["update"];a.getTargetCell()===n&&u.push("target"),a.getSourceCell()===n&&u.push("source"),t.push({id:a.id,view:l,flag:l.getFlag(u)})}}}return t}},{key:"isUpdatable",value:function(e){if(e.isNodeView())return!this.renderArea||this.renderArea.isIntersectWithRect(e.cell.getBBox());if(e.isEdgeView()){var t=e.cell,n=t.getSourceCell(),r=t.getTargetCell();if(this.renderArea&&n&&r)return this.renderArea.isIntersectWithRect(n.getBBox())||this.renderArea.isIntersectWithRect(r.getBBox())}return!0}},{key:"getRenderPriority",value:function(e){return e.cell.isNode()?vw.RenderNode:vw.RenderEdge}},{key:"dispose",value:function(){var e=this;this.stopListening(),Object.keys(this.views).forEach((function(t){e.views[t].view.dispose()})),this.views={}}}]),n}(lh);yw([lh.dispose()],mw.prototype,"dispose",null),function(e){e.FLAG_INSERT=1<<30,e.FLAG_REMOVE=1<<29,e.FLAG_RENDER=67108863}(mw||(mw={})),function(e){var t;(t=e.ViewState||(e.ViewState={}))[t.CREATED=0]="CREATED",t[t.MOUNTED=1]="MOUNTED",t[t.WAITING=2]="WAITING"}(mw||(mw={}));var ww=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},bw=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).schedule=new mw(e.graph),e}return P(n,[{key:"requestViewUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.schedule.requestViewUpdate(e,t,n)}},{key:"isViewMounted",value:function(e){return this.schedule.isViewMounted(e)}},{key:"setRenderArea",value:function(e){this.schedule.setRenderArea(e)}},{key:"findViewByElem",value:function(e){if(null==e)return null;var t=this.options.container,n="string"==typeof e?t.querySelector(e):e instanceof Element?e:e[0];if(n){var r=this.graph.view.findAttr("data-cell-id",n);if(r){var i=this.schedule.views;if(i[r])return i[r].view}}return null}},{key:"findViewByCell",value:function(e){if(null==e)return null;var t=Am.isCell(e)?e.id:e,n=this.schedule.views;return n[t]?n[t].view:null}},{key:"findViewsFromPoint",value:function(e){var t=this,n={x:e.x,y:e.y};return this.model.getCells().map((function(e){return t.findViewByCell(e)})).filter((function(e){return null!=e&&rp.getBBox(e.container,{target:t.view.stage}).containsPoint(n)}))}},{key:"findEdgeViewsFromPoint",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return this.model.getEdges().map((function(e){return t.findViewByCell(e)})).filter((function(t){if(null!=t){var r=t.getClosestPoint(e);if(r)return r.distance(e)<=n}return!1}))}},{key:"findViewsInArea",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Yd.create(e);return this.model.getCells().map((function(e){return t.findViewByCell(e)})).filter((function(e){if(e){if(n.nodeOnly&&!e.isNodeView())return!1;var i=rp.getBBox(e.container,{target:t.view.stage});return 0===i.width?i.inflate(1,0):0===i.height&&i.inflate(0,1),n.strict?r.containsRect(i):r.isIntersectWithRect(i)}return!1}))}},{key:"dispose",value:function(){this.schedule.dispose()}}]),n}($m);ww([$m.dispose()],bw.prototype,"dispose",null);var kw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},xw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"cid",get:function(){return this.graph.view.cid}},{key:"svg",get:function(){return this.view.svg}},{key:"defs",get:function(){return this.view.defs}},{key:"isDefined",value:function(e){return null!=this.svg.getElementById(e)}},{key:"filter",value:function(e){var t=e.id,n=e.name;if(t||(t="filter-".concat(n,"-").concat(this.cid,"-").concat(Mh(JSON.stringify(e)))),!this.isDefined(t)){var r=Tg.registry.get(n);if(null==r)return Tg.registry.onNotFound(n);var i=r(e.args||{}),o=Object.assign(Object.assign({x:-1,y:-1,width:3,height:3,filterUnits:"objectBoundingBox"},e.attrs),{id:t});Xf.create(Lp.sanitize(i),o).appendTo(this.defs)}return t}},{key:"gradient",value:function(e){var t=e.id,n=e.type;if(t||(t="gradient-".concat(n,"-").concat(this.cid,"-").concat(Mh(JSON.stringify(e)))),!this.isDefined(t)){var r=e.stops.map((function(e){var t=null!=e.opacity&&Number.isFinite(e.opacity)?e.opacity:1;return'<stop offset="'.concat(e.offset,'" stop-color="').concat(e.color,'" stop-opacity="').concat(t,'"/>')})),i="<".concat(n,">").concat(r.join(""),"</").concat(n,">"),o=Object.assign({id:t},e.attrs);Xf.create(i,o).appendTo(this.defs)}return t}},{key:"marker",value:function(e){var t=e.id,n=e.refX,r=e.refY,i=e.markerUnits,o=e.markerOrient,a=e.tagName,s=e.children,l=kw(e,["id","refX","refY","markerUnits","markerOrient","tagName","children"]),u=t;if(u||(u="marker-".concat(this.cid,"-").concat(Mh(JSON.stringify(e)))),!this.isDefined(u)){"path"!==a&&delete l.d;var c=Xf.create("marker",{refX:n,refY:r,id:u,overflow:"visible",orient:null!=o?o:"auto",markerUnits:i||"userSpaceOnUse"},s?s.map((function(e){var t=e.tagName,n=kw(e,["tagName"]);return Xf.create("".concat(t)||"path",jf(Object.assign(Object.assign({},l),n)))})):[Xf.create(a||"path",jf(l))]);this.defs.appendChild(c.node)}return u}},{key:"remove",value:function(e){var t=this.svg.getElementById(e);t&&t.parentNode&&t.parentNode.removeChild(t)}}]),n}($m),Cw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"getClientMatrix",value:function(){return pd(this.view.stage.getScreenCTM())}},{key:"getClientOffset",value:function(){var e=this.view.svg.getBoundingClientRect();return new Wd(e.left,e.top)}},{key:"getPageOffset",value:function(){return this.getClientOffset().translate(window.scrollX,window.scrollY)}},{key:"snapToGrid",value:function(e,t){return("number"==typeof e?this.clientToLocalPoint(e,t):this.clientToLocalPoint(e.x,e.y)).snapToGrid(this.graph.getGridSize())}},{key:"localToGraphPoint",value:function(e,t){var n=Wd.create(e,t);return rp.transformPoint(n,this.graph.matrix())}},{key:"localToClientPoint",value:function(e,t){var n=Wd.create(e,t);return rp.transformPoint(n,this.getClientMatrix())}},{key:"localToPagePoint",value:function(e,t){return("number"==typeof e?this.localToGraphPoint(e,t):this.localToGraphPoint(e)).translate(this.getPageOffset())}},{key:"localToGraphRect",value:function(e,t,n,r){var i=Yd.create(e,t,n,r);return rp.transformRectangle(i,this.graph.matrix())}},{key:"localToClientRect",value:function(e,t,n,r){var i=Yd.create(e,t,n,r);return rp.transformRectangle(i,this.getClientMatrix())}},{key:"localToPageRect",value:function(e,t,n,r){return("number"==typeof e?this.localToGraphRect(e,t,n,r):this.localToGraphRect(e)).translate(this.getPageOffset())}},{key:"graphToLocalPoint",value:function(e,t){var n=Wd.create(e,t);return rp.transformPoint(n,this.graph.matrix().inverse())}},{key:"clientToLocalPoint",value:function(e,t){var n=Wd.create(e,t);return rp.transformPoint(n,this.getClientMatrix().inverse())}},{key:"clientToGraphPoint",value:function(e,t){var n=Wd.create(e,t);return rp.transformPoint(n,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}},{key:"pageToLocalPoint",value:function(e,t){var n=Wd.create(e,t).diff(this.getPageOffset());return this.graphToLocalPoint(n)}},{key:"graphToLocalRect",value:function(e,t,n,r){var i=Yd.create(e,t,n,r);return rp.transformRectangle(i,this.graph.matrix().inverse())}},{key:"clientToLocalRect",value:function(e,t,n,r){var i=Yd.create(e,t,n,r);return rp.transformRectangle(i,this.getClientMatrix().inverse())}},{key:"clientToGraphRect",value:function(e,t,n,r){var i=Yd.create(e,t,n,r);return rp.transformRectangle(i,this.graph.matrix().multiply(this.getClientMatrix().inverse()))}},{key:"pageToLocalRect",value:function(e,t,n,r){var i=Yd.create(e,t,n,r),o=this.getPageOffset();return i.x-=o.x,i.y-=o.y,this.graphToLocalRect(i)}}]),n}($m),Ew=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Sw=function(e){l(n,e);var t=c(n);function n(){var e;return A(this,n),(e=t.apply(this,arguments)).highlights={},e}return P(n,[{key:"init",value:function(){this.startListening()}},{key:"startListening",value:function(){this.graph.on("cell:highlight",this.onCellHighlight,this),this.graph.on("cell:unhighlight",this.onCellUnhighlight,this)}},{key:"stopListening",value:function(){this.graph.off("cell:highlight",this.onCellHighlight,this),this.graph.off("cell:unhighlight",this.onCellUnhighlight,this)}},{key:"onCellHighlight",value:function(e){var t=e.view,n=e.magnet,r=e.options,i=void 0===r?{}:r,o=this.resolveHighlighter(i);if(o){var a=this.getHighlighterId(n,o);if(!this.highlights[a]){var s=o.highlighter;s.highlight(t,n,Object.assign({},o.args)),this.highlights[a]={cellView:t,magnet:n,highlighter:s,args:o.args}}}}},{key:"onCellUnhighlight",value:function(e){var t=e.magnet,n=e.options,r=void 0===n?{}:n,i=this.resolveHighlighter(r);if(i){var o=this.getHighlighterId(t,i);this.unhighlight(o)}}},{key:"resolveHighlighter",value:function(e){var t=this.options,n=e.highlighter;if(null==n){var r=e.type;n=r&&t.highlighting[r]||t.highlighting.default}if(null==n)return null;var i="string"==typeof n?{name:n}:n,o=i.name,a=fp.registry.get(o);return null==a?fp.registry.onNotFound(o):(fp.check(o,a),{name:o,highlighter:a,args:i.args||{}})}},{key:"getHighlighterId",value:function(e,t){return cf(e),t.name+e.id+JSON.stringify(t.args)}},{key:"unhighlight",value:function(e){var t=this.highlights[e];t&&(t.highlighter.unhighlight(t.cellView,t.magnet,t.args),delete this.highlights[e])}},{key:"dispose",value:function(){var e=this;Object.keys(this.highlights).forEach((function(t){return e.unhighlight(t)})),this.stopListening()}}]),n}($m);Ew([Sw.dispose()],Sw.prototype,"dispose",null);var _w=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Aw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"getScroller",value:function(){var e=this.graph.getPlugin("scroller");return e&&e.options.enabled?e:null}},{key:"getContainer",value:function(){var e=this.getScroller();return e?e.container.parentElement:this.graph.container.parentElement}},{key:"getSensorTarget",value:function(){var e=this.options.autoResize;if(e)return"boolean"==typeof e?this.getContainer():e}},{key:"init",value:function(){var e=this;if(this.options.autoResize){var t=this.getSensorTarget();t&&Nd.bind(t,(function(){var n=t.offsetWidth,r=t.offsetHeight;e.resize(n,r)}))}}},{key:"resize",value:function(e,t){var n=this.getScroller();n?n.resize(e,t):this.graph.transform.resize(e,t)}},{key:"dispose",value:function(){Nd.clear(this.graph.container)}}]),n}($m);_w([$m.dispose()],Aw.prototype,"dispose",null);var Mw=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Pw=function(e,t){l(r,e);var n=c(r);function r(e){var t;return A(this,r),(t=n.call(this)).installedPlugins=new Set,t.options=tw.get(e),t.css=new ew(f(t)),t.view=new Km(f(t)),t.defs=new xw(f(t)),t.coord=new Cw(f(t)),t.transform=new aw(f(t)),t.highlight=new Sw(f(t)),t.grid=new ow(f(t)),t.background=new lw(f(t)),t.options.model?t.model=t.options.model:(t.model=new Dm,t.model.graph=f(t)),t.renderer=new bw(f(t)),t.panning=new cw(f(t)),t.mousewheel=new fw(f(t)),t.virtualRender=new gw(f(t)),t.size=new Aw(f(t)),t}return P(r,[{key:"container",get:function(){return this.options.container}},{key:t,get:function(){return r.toStringTag}},{key:"isNode",value:function(e){return e.isNode()}},{key:"isEdge",value:function(e){return e.isEdge()}},{key:"resetCells",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.resetCells(e,t),this}},{key:"clearCells",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.model.clear(e),this}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.model.toJSON(e)}},{key:"parseJSON",value:function(e){return this.model.parseJSON(e)}},{key:"fromJSON",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.fromJSON(e,t),this}},{key:"getCellById",value:function(e){return this.model.getCell(e)}},{key:"addNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addNode(e,t)}},{key:"addNodes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addCell(e.map((function(e){return Om.isNode(e)?e:t.createNode(e)})),n)}},{key:"createNode",value:function(e){return this.model.createNode(e)}},{key:"removeNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addEdge(e,t)}},{key:"addEdges",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.addCell(e.map((function(e){return Lm.isEdge(e)?e:t.createEdge(e)})),n)}},{key:"removeEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"createEdge",value:function(e){return this.model.createEdge(e)}},{key:"addCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.addCell(e,t),this}},{key:"removeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCell(e,t)}},{key:"removeCells",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeCells(e,t)}},{key:"removeConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.removeConnectedEdges(e,t)}},{key:"disconnectConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.disconnectConnectedEdges(e,t),this}},{key:"hasCell",value:function(e){return this.model.has(e)}},{key:"getCells",value:function(){return this.model.getCells()}},{key:"getCellCount",value:function(){return this.model.total()}},{key:"getNodes",value:function(){return this.model.getNodes()}},{key:"getEdges",value:function(){return this.model.getEdges()}},{key:"getOutgoingEdges",value:function(e){return this.model.getOutgoingEdges(e)}},{key:"getIncomingEdges",value:function(e){return this.model.getIncomingEdges(e)}},{key:"getConnectedEdges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getConnectedEdges(e,t)}},{key:"getRootNodes",value:function(){return this.model.getRoots()}},{key:"getLeafNodes",value:function(){return this.model.getLeafs()}},{key:"isRootNode",value:function(e){return this.model.isRoot(e)}},{key:"isLeafNode",value:function(e){return this.model.isLeaf(e)}},{key:"getNeighbors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getNeighbors(e,t)}},{key:"isNeighbor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isNeighbor(e,t,n)}},{key:"getSuccessors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getSuccessors(e,t)}},{key:"isSuccessor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isSuccessor(e,t,n)}},{key:"getPredecessors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getPredecessors(e,t)}},{key:"isPredecessor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.isPredecessor(e,t,n)}},{key:"getCommonAncestor",value:function(){var e;return(e=this.model).getCommonAncestor.apply(e,arguments)}},{key:"getSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getSubGraph(e,t)}},{key:"cloneSubGraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.cloneSubGraph(e,t)}},{key:"cloneCells",value:function(e){return this.model.cloneCells(e)}},{key:"getNodesFromPoint",value:function(e,t){return this.model.getNodesFromPoint(e,t)}},{key:"getNodesInArea",value:function(e,t,n,r,i){return this.model.getNodesInArea(e,t,n,r,i)}},{key:"getNodesUnderNode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getNodesUnderNode(e,t)}},{key:"searchCell",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.search(e,t,n),this}},{key:"getShortestPath",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.model.getShortestPath(e,t,n)}},{key:"getAllCellsBBox",value:function(){return this.model.getAllCellsBBox()}},{key:"getCellsBBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.getCellsBBox(e,t)}},{key:"startBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.model.startBatch(e,t)}},{key:"stopBatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.model.stopBatch(e,t)}},{key:"batchUpdate",value:function(e,t,n){var r="string"==typeof e?e:"update",i="string"==typeof e?t:e,o="function"==typeof t?n:t;this.startBatch(r,o);var a=i();return this.stopBatch(r,o),a}},{key:"updateCellId",value:function(e,t){return this.model.updateCellId(e,t)}},{key:"findView",value:function(e){return Am.isCell(e)?this.findViewByCell(e):this.findViewByElem(e)}},{key:"findViews",value:function(e){return Yd.isRectangleLike(e)?this.findViewsInArea(e):Wd.isPointLike(e)?this.findViewsFromPoint(e):[]}},{key:"findViewByCell",value:function(e){return this.renderer.findViewByCell(e)}},{key:"findViewByElem",value:function(e){return this.renderer.findViewByElem(e)}},{key:"findViewsFromPoint",value:function(e,t){var n="number"==typeof e?{x:e,y:t}:e;return this.renderer.findViewsFromPoint(n)}},{key:"findViewsInArea",value:function(e,t,n,r,i){var o="number"==typeof e?{x:e,y:t,width:n,height:r}:e,a="number"==typeof e?i:t;return this.renderer.findViewsInArea(o,a)}},{key:"matrix",value:function(e){return void 0===e?this.transform.getMatrix():(this.transform.setMatrix(e),this)}},{key:"resize",value:function(e,t){var n=this.getPlugin("scroller");return n?n.resize(e,t):this.transform.resize(e,t),this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===e?this.transform.getScale():(this.transform.scale(e,t,n,r),this)}},{key:"zoom",value:function(e,t){var n=this.getPlugin("scroller");if(n){if(void 0===e)return n.zoom();n.zoom(e,t)}else{if(void 0===e)return this.transform.getZoom();this.transform.zoom(e,t)}return this}},{key:"zoomTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlugin("scroller");return n?n.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})):this.transform.zoom(e,Object.assign(Object.assign({},t),{absolute:!0})),this}},{key:"zoomToRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlugin("scroller");return n?n.zoomToRect(e,t):this.transform.zoomToRect(e,t),this}},{key:"zoomToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getPlugin("scroller");return t?t.zoomToFit(e):this.transform.zoomToFit(e),this}},{key:"rotate",value:function(e,t,n){return void 0===e?this.transform.getRotation():(this.transform.rotate(e,t,n),this)}},{key:"translate",value:function(e,t){return void 0===e?this.transform.getTranslation():(this.transform.translate(e,t),this)}},{key:"translateBy",value:function(e,t){var n=this.translate(),r=n.tx+e,i=n.ty+t;return this.translate(r,i)}},{key:"getGraphArea",value:function(){return this.transform.getGraphArea()}},{key:"getContentArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.getContentArea(e)}},{key:"getContentBBox",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.getContentBBox(e)}},{key:"fitToContent",value:function(e,t,n,r){return this.transform.fitToContent(e,t,n,r)}},{key:"scaleContentToFit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.transform.scaleContentToFit(e),this}},{key:"center",value:function(e){return this.centerPoint(e)}},{key:"centerPoint",value:function(e,t,n){var r=this.getPlugin("scroller");return r?r.centerPoint(e,t,n):this.transform.centerPoint(e,t),this}},{key:"centerContent",value:function(e){var t=this.getPlugin("scroller");return t?t.centerContent(e):this.transform.centerContent(e),this}},{key:"centerCell",value:function(e,t){var n=this.getPlugin("scroller");return n?n.centerCell(e,t):this.transform.centerCell(e),this}},{key:"positionPoint",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.getPlugin("scroller");return i?i.positionPoint(e,t,n,r):this.transform.positionPoint(e,t,n),this}},{key:"positionRect",value:function(e,t,n){var r=this.getPlugin("scroller");return r?r.positionRect(e,t,n):this.transform.positionRect(e,t),this}},{key:"positionCell",value:function(e,t,n){var r=this.getPlugin("scroller");return r?r.positionCell(e,t,n):this.transform.positionCell(e,t),this}},{key:"positionContent",value:function(e,t){var n=this.getPlugin("scroller");return n?n.positionContent(e,t):this.transform.positionContent(e,t),this}},{key:"snapToGrid",value:function(e,t){return this.coord.snapToGrid(e,t)}},{key:"pageToLocal",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.pageToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.pageToLocalRect(e,t,n,r):this.coord.pageToLocalPoint(e,t)}},{key:"localToPage",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.localToPageRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.localToPageRect(e,t,n,r):this.coord.localToPagePoint(e,t)}},{key:"clientToLocal",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.clientToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.clientToLocalRect(e,t,n,r):this.coord.clientToLocalPoint(e,t)}},{key:"localToClient",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.localToClientRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.localToClientRect(e,t,n,r):this.coord.localToClientPoint(e,t)}},{key:"localToGraph",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.localToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.localToGraphRect(e,t,n,r):this.coord.localToGraphPoint(e,t)}},{key:"graphToLocal",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.graphToLocalRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.graphToLocalRect(e,t,n,r):this.coord.graphToLocalPoint(e,t)}},{key:"clientToGraph",value:function(e,t,n,r){return Yd.isRectangleLike(e)?this.coord.clientToGraphRect(e):"number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r?this.coord.clientToGraphRect(e,t,n,r):this.coord.clientToGraphPoint(e,t)}},{key:"defineFilter",value:function(e){return this.defs.filter(e)}},{key:"defineGradient",value:function(e){return this.defs.gradient(e)}},{key:"defineMarker",value:function(e){return this.defs.marker(e)}},{key:"getGridSize",value:function(){return this.grid.getGridSize()}},{key:"setGridSize",value:function(e){return this.grid.setGridSize(e),this}},{key:"showGrid",value:function(){return this.grid.show(),this}},{key:"hideGrid",value:function(){return this.grid.hide(),this}},{key:"clearGrid",value:function(){return this.grid.clear(),this}},{key:"drawGrid",value:function(e){return this.grid.draw(e),this}},{key:"updateBackground",value:function(){return this.background.update(),this}},{key:"drawBackground",value:function(e,t){var n=this.getPlugin("scroller");return null==n||null!=this.options.background&&t?this.background.draw(e):n.drawBackground(e,t),this}},{key:"clearBackground",value:function(e){var t=this.getPlugin("scroller");return null==t||null!=this.options.background&&e?this.background.clear():t.clearBackground(e),this}},{key:"enableVirtualRender",value:function(){return this.virtualRender.enableVirtualRender(),this}},{key:"disableVirtualRender",value:function(){return this.virtualRender.disableVirtualRender(),this}},{key:"isMouseWheelEnabled",value:function(){return!this.mousewheel.disabled}},{key:"enableMouseWheel",value:function(){return this.mousewheel.enable(),this}},{key:"disableMouseWheel",value:function(){return this.mousewheel.disable(),this}},{key:"toggleMouseWheel",value:function(e){return null==e?this.isMouseWheelEnabled()?this.disableMouseWheel():this.enableMouseWheel():e?this.enableMouseWheel():this.disableMouseWheel(),this}},{key:"isPannable",value:function(){var e=this.getPlugin("scroller");return e?e.isPannable():this.panning.pannable}},{key:"enablePanning",value:function(){var e=this.getPlugin("scroller");return e?e.enablePanning():this.panning.enablePanning(),this}},{key:"disablePanning",value:function(){var e=this.getPlugin("scroller");return e?e.disablePanning():this.panning.disablePanning(),this}},{key:"togglePanning",value:function(e){return null==e?this.isPannable()?this.disablePanning():this.enablePanning():e!==this.isPannable()&&(e?this.enablePanning():this.disablePanning()),this}},{key:"use",value:function(e){if(!this.installedPlugins.has(e)){this.installedPlugins.add(e);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.init.apply(e,[this].concat(n))}return this}},{key:"getPlugin",value:function(e){return Array.from(this.installedPlugins).find((function(t){return t.name===e}))}},{key:"getPlugins",value:function(e){return Array.from(this.installedPlugins).filter((function(t){return e.includes(t.name)}))}},{key:"enablePlugins",value:function(e){var t=e;Array.isArray(t)||(t=[t]);var n=this.getPlugins(t);return null==n||n.forEach((function(e){var t;null===(t=null==e?void 0:e.enable)||void 0===t||t.call(e)})),this}},{key:"disablePlugins",value:function(e){var t=e;Array.isArray(t)||(t=[t]);var n=this.getPlugins(t);return null==n||n.forEach((function(e){var t;null===(t=null==e?void 0:e.disable)||void 0===t||t.call(e)})),this}},{key:"isPluginEnabled",value:function(e){var t,n=this.getPlugin(e);return null===(t=null==n?void 0:n.isEnabled)||void 0===t?void 0:t.call(n)}},{key:"disposePlugins",value:function(e){var t=this,n=e;Array.isArray(n)||(n=[n]);var r=this.getPlugins(n);return null==r||r.forEach((function(e){e.dispose(),t.installedPlugins.delete(e)})),this}},{key:"dispose",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.model.dispose(),this.css.dispose(),this.defs.dispose(),this.grid.dispose(),this.coord.dispose(),this.transform.dispose(),this.highlight.dispose(),this.background.dispose(),this.mousewheel.dispose(),this.panning.dispose(),this.view.dispose(),this.renderer.dispose(),this.installedPlugins.forEach((function(e){e.dispose()}))}}]),r}(Eh,Symbol.toStringTag);Mw([Eh.dispose()],Pw.prototype,"dispose",null),function(e){e.View=Km,e.Renderer=bw,e.MouseWheel=fw,e.DefsManager=xw,e.GridManager=ow,e.CoordManager=Cw,e.TransformManager=aw,e.HighlightManager=Sw,e.BackgroundManager=lw,e.PanningManager=cw}(Pw||(Pw={})),function(e){e.toStringTag="X6.".concat(e.name),e.isGraph=function(t){if(null==t)return!1;if(t instanceof e)return!0;var n=t[Symbol.toStringTag];return null==n||n===e.toStringTag}}(Pw||(Pw={})),function(e){e.render=function(t,n){var r=t instanceof HTMLElement?new e({container:t}):new e(t);return null!=n&&r.fromJSON(n),r}}(Pw||(Pw={})),function(e){e.registerNode=Om.registry.register,e.registerEdge=Lm.registry.register,e.registerView=Bp.registry.register,e.registerAttr=tp.registry.register,e.registerGrid=Cg.registry.register,e.registerFilter=Tg.registry.register,e.registerNodeTool=sy.registry.register,e.registerEdgeTool=ly.registry.register,e.registerBackground=Eg.registry.register,e.registerHighlighter=fp.registry.register,e.registerPortLayout=wp.registry.register,e.registerPortLabelLayout=Ap.registry.register,e.registerMarker=Tv.registry.register,e.registerRouter=cm.registry.register,e.registerConnector=wm.registry.register,e.registerAnchor=xy.registry.register,e.registerEdgeAnchor=_y.registry.register,e.registerConnectionPoint=Ny.registry.register}(Pw||(Pw={})),function(e){e.unregisterNode=Om.registry.unregister,e.unregisterEdge=Lm.registry.unregister,e.unregisterView=Bp.registry.unregister,e.unregisterAttr=tp.registry.unregister,e.unregisterGrid=Cg.registry.unregister,e.unregisterFilter=Tg.registry.unregister,e.unregisterNodeTool=sy.registry.unregister,e.unregisterEdgeTool=ly.registry.unregister,e.unregisterBackground=Eg.registry.unregister,e.unregisterHighlighter=fp.registry.unregister,e.unregisterPortLayout=wp.registry.unregister,e.unregisterPortLabelLayout=Ap.registry.unregister,e.unregisterMarker=Tv.registry.unregister,e.unregisterRouter=cm.registry.unregister,e.unregisterConnector=wm.registry.unregister,e.unregisterAnchor=xy.registry.unregister,e.unregisterEdgeAnchor=_y.registry.unregister,e.unregisterConnectionPoint=Ny.registry.unregister}(Pw||(Pw={}));var Ow=globalThis&&globalThis.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":v(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Tw=globalThis&&globalThis.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},Lw=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n)}(Om);!function(e){var t=function(t){l(r,t);var n=c(r);function r(){return A(this,r),n.apply(this,arguments)}return P(r,[{key:"init",value:function(){s(g(r.prototype),"init",this).call(this),this.cell.on("change:*",this.onCellChangeAny,this)}},{key:"onCellChangeAny",value:function(t){var n=t.key,r=e.shapeMaps[this.cell.shape];if(r){var i=r.effect;i&&!i.includes(n)||this.renderHTMLComponent()}}},{key:"confirmUpdate",value:function(e){var t=this,n=s(g(r.prototype),"confirmUpdate",this).call(this,e);return this.handleAction(n,r.action,(function(){return t.renderHTMLComponent()}))}},{key:"renderHTMLComponent",value:function(){var t=this.selectors&&this.selectors.foContent;if(t){kf(t);var n=e.shapeMaps[this.cell.shape];if(!n)return;var r=n.html;"function"==typeof r&&(r=r(this.cell)),r&&("string"==typeof r?t.innerHTML=r:xf(t,r))}}},{key:"dispose",value:function(){this.cell.off("change:*",this.onCellChangeAny,this)}}]),r}(Wm);Ow([t.dispose()],t.prototype,"dispose",null),e.View=t,function(e){e.action="html",e.config({bootstrap:[e.action],actions:{html:e.action}}),Wm.registry.register("html-view",e,!0)}(t=e.View||(e.View={}))}(Lw||(Lw={})),function(e){e.config({view:"html-view",markup:[{tagName:"rect",selector:"body"},Object.assign({},Lp.getForeignObjectMarkup()),{tagName:"text",selector:"label"}],attrs:{body:{fill:"none",stroke:"none",refWidth:"100%",refHeight:"100%"},fo:{refWidth:"100%",refHeight:"100%"}}}),Om.registry.register("html",e,!0)}(Lw||(Lw={})),function(e){e.shapeMaps={},e.register=function(t){var n=t.shape,r=t.html,i=t.effect,o=t.inherit,a=Tw(t,["shape","html","effect","inherit"]);if(!n)throw new Error("should specify shape in config");e.shapeMaps[n]={html:r,effect:i},Pw.registerNode(n,Object.assign({inherit:o||"html"},a),!0)}}(Lw||(Lw={}));o("c","undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{});function jw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Nw={assign:Object.assign,getHeight:function(e,t,n,r){return void 0===r&&(r="height"),"center"===n?(e[r]+t[r])/2:e.height}},Rw=Nw,Dw={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||18},getVGap:function(e){return e.vgap||18},getChildren:function(e){return e.children},getHeight:function(e){return e.height||36},getWidth:function(e){var t=e.label||" ";return e.width||18*t.split("").length}};function Iw(e,t){var n=this;if(n.vgap=n.hgap=0,e instanceof Iw)return e;n.data=e;var r=t.getHGap(e),i=t.getVGap(e);return n.preH=t.getPreH(e),n.preV=t.getPreV(e),n.width=t.getWidth(e),n.height=t.getHeight(e),n.width+=n.preH,n.height+=n.preV,n.id=t.getId(e),n.x=n.y=0,n.depth=0,n.children||(n.children=[]),n.addGap(r,i),n}Rw.assign(Iw.prototype,{isRoot:function(){return 0===this.depth},isLeaf:function(){return 0===this.children.length},addGap:function(e,t){var n=this;n.hgap+=e,n.vgap+=t,n.width+=2*e,n.height+=2*t},eachNode:function(e){for(var t,n=[this];t=n.shift();)e(t),n=t.children.concat(n)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var t,n=[this];t=n.shift();)e(t),n=n.concat(t.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode((function(t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.width=Math.max(e.width,t.x+t.width),e.height=Math.max(e.height,t.y+t.height)})),e},translate:function(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.eachNode((function(n){n.x+=e,n.y+=t,n.x+=n.preH,n.y+=n.preV}))},right2left:function(){var e=this,t=e.getBoundingBox();e.eachNode((function(e){e.x=e.x-2*(e.x-t.left)-e.width})),e.translate(t.width,0)},bottom2top:function(){var e=this,t=e.getBoundingBox();e.eachNode((function(e){e.y=e.y-2*(e.y-t.top)-e.height})),e.translate(0,t.height)}});var Bw=function(e,t,n){void 0===t&&(t={});var r,i=new Iw(e,t=Rw.assign({},Dw,t)),o=[i];if(!n&&!e.collapsed)for(;r=o.shift();)if(!r.data.collapsed){var a=t.getChildren(r.data),s=a?a.length:0;if(r.children=new Array(s),a&&s)for(var l=0;l<s;l++){var u=new Iw(a[l],t);r.children[l]=u,o.push(u),u.parent=r,u.depth=r.depth+1}}return i},zw=Bw,Fw=function(){function e(e,t){void 0===t&&(t={});this.options=t,this.rootNode=zw(e,t)}return e.prototype.execute=function(){throw new Error("please override this method")},e}(),Vw=Fw;function Hw(e,t,n,r){void 0===r&&(r=[]);var i=this;i.w=e||0,i.h=t||0,i.y=n||0,i.x=0,i.c=r||[],i.cs=r.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}function Uw(e,t,n){n?e.y+=t:e.x+=t,e.children.forEach((function(e){Uw(e,t,n)}))}function qw(e,t){var n=t?e.y:e.x;return e.children.forEach((function(e){n=Math.min(qw(e,t),n)})),n}function Gw(e,t){Uw(e,-qw(e,t),t)}function Jw(e,t,n){n?t.y=e.x:t.x=e.x,e.c.forEach((function(e,r){Jw(e,t.children[r],n)}))}function Ww(e,t,n){void 0===n&&(n=0),t?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach((function(e){Ww(e,t,n)}))}Hw.fromNode=function(e,t){if(!e)return null;var n=[];return e.children.forEach((function(e){n.push(Hw.fromNode(e,t))})),t?new Hw(e.height,e.width,e.x,n):new Hw(e.width,e.height,e.y,n)};var Yw=Bw,Zw=function(e,t){for(var n=Yw(e.data,t,!0),r=Yw(e.data,t,!0),i=e.children.length,o=Math.round(i/2),a=t.getSide||function(e,t){return t<o?"right":"left"},s=0;s<i;s++){var l=e.children[s];"right"===a(l,s)?r.children.push(l):n.children.push(l)}return n.eachNode((function(e){e.isRoot()||(e.side="left")})),r.eachNode((function(e){e.isRoot()||(e.side="right")})),{left:n,right:r}},Xw=Zw,Kw=["LR","RL","TB","BT","H","V"],$w=["LR","RL","H"],Qw=Kw[0],eb=function(e,t,n){var r=t.direction||Qw;if(t.isHorizontal=function(e){return $w.indexOf(e)>-1}(r),r&&-1===Kw.indexOf(r))throw new TypeError("Invalid direction: "+r);if(r===Kw[0])n(e,t);else if(r===Kw[1])n(e,t),e.right2left();else if(r===Kw[2])n(e,t);else if(r===Kw[3])n(e,t),e.bottom2top();else if(r===Kw[4]||r===Kw[5]){var i=Xw(e,t),o=i.left,a=i.right;n(o,t),n(a,t),t.isHorizontal?o.right2left():o.bottom2top(),a.translate(o.x-a.x,o.y-a.y),e.x=o.x,e.y=a.y;var s=e.getBoundingBox();t.isHorizontal?s.top<0&&e.translate(0,-s.top):s.left<0&&e.translate(-s.left,0)}var l=t.fixedRoot;return void 0===l&&(l=!0),l&&e.translate(-(e.x+e.width/2+e.hgap),-(e.y+e.height/2+e.vgap)),e};function tb(e,t){return tb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tb(e,t)}var nb=function(e,t){void 0===t&&(t={});var n=t.isHorizontal;function r(e){0===e.cs?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function i(e,t,n){for(var r=e.c[t-1],i=r.mod,u=e.c[t],c=u.mod;null!==r&&null!==u;){l(r)>n.low&&(n=n.nxt);var h=i+r.prelim+r.w-(c+u.prelim);h>0&&(c+=h,o(e,t,n.index,h));var f=l(r),d=l(u);f<=d&&null!==(r=s(r))&&(i+=r.mod),f>=d&&null!==(u=a(u))&&(c+=u.mod)}!r&&u?function(e,t,n,r){var i=e.c[0].el;i.tl=n;var o=r-n.mod-e.c[0].msel;i.mod+=o,i.prelim-=o,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}(e,t,u,c):r&&!u&&function(e,t,n,r){var i=e.c[t].er;i.tr=n;var o=r-n.mod-e.c[t].mser;i.mod+=o,i.prelim-=o,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}(e,t,r,i)}function o(e,t,n,r){e.c[t].mod+=r,e.c[t].msel+=r,e.c[t].mser+=r,function(e,t,n,r){if(n!==t-1){var i=t-n;e.c[n+1].shift+=r/i,e.c[t].shift-=r/i,e.c[t].change-=r-r/i}}(e,t,n,r)}function a(e){return 0===e.cs?e.tl:e.c[0]}function s(e){return 0===e.cs?e.tr:e.c[e.cs-1]}function l(e){return e.y+e.h}function u(e,t,n){for(;null!==n&&e>=n.low;)n=n.nxt;return{low:e,index:t,nxt:n}}Ww(e,n);var c=Hw.fromNode(e,n);return function e(t){if(0!==t.cs){e(t.c[0]);for(var n=u(l(t.c[0].el),0,null),o=1;o<t.cs;++o){e(t.c[o]);var a=l(t.c[o].er);i(t,o,n),n=u(a,o,n)}!function(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}(t),r(t)}else r(t)}(c),function e(t,n){n+=t.mod,t.x=t.prelim+n,function(e){for(var t=0,n=0,r=0;r<e.cs;r++)n+=(t+=e.c[r].shift)+e.c[r].change,e.c[r].mod+=n}(t);for(var r=0;r<t.cs;r++)e(t.c[r],n)}(c,0),Jw(c,e,n),Gw(e,n),e},rb=eb,ib=Nw,ob=function(e){function t(){return e.apply(this,arguments)||this}var n,r;return r=e,(n=t).prototype=Object.create(r.prototype),n.prototype.constructor=n,tb(n,r),t.prototype.execute=function(){return rb(this.rootNode,this.options,nb)},t}(Vw),ab={};var sb=function(e,t){return t=ib.assign({},ab,t),new ob(e,t).execute()},lb=Nw;function ub(e,t){void 0===t&&(t=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=t}var cb={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function hb(e,t,n){n?(t.x=e.x,t.y=e.y):(t.x=e.y,t.y=e.x),e.children.forEach((function(e,r){hb(e,t.children[r],n)}))}function fb(e,t){return fb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fb(e,t)}var db=function(e,t){void 0===t&&(t={}),t=lb.assign({},cb,t);var n,r=0;var i=function e(t){if(!t)return null;t.width=0,t.depth&&t.depth>r&&(r=t.depth);var n=t.children,i=n.length,o=new ub(t.height,[]);return n.forEach((function(t,n){var r=e(t);o.children.push(r),0===n&&(o.leftChild=r),n===i-1&&(o.rightChild=r)})),o.originNode=t,o.isLeaf=t.isLeaf(),o}(e);return function e(t){if(t.isLeaf||0===t.children.length)t.drawingDepth=r;else{var n=t.children.map((function(t){return e(t)})),i=Math.min.apply(null,n);t.drawingDepth=i-1}return t.drawingDepth}(i),function e(r){r.x=r.drawingDepth*t.rankSep,r.isLeaf?(r.y=0,n&&(r.y=n.y+n.height+t.nodeSep,r.originNode.parent!==n.originNode.parent&&(r.y+=t.subTreeSep)),n=r):(r.children.forEach((function(t){e(t)})),r.y=(r.leftChild.y+r.rightChild.y)/2)}(i),hb(i,e,t.isHorizontal),e},gb=eb,vb=Nw,pb=function(e){function t(){return e.apply(this,arguments)||this}var n,r;return r=e,(n=t).prototype=Object.create(r.prototype),n.prototype.constructor=n,fb(n,r),t.prototype.execute=function(){var e=this;return e.rootNode.width=0,gb(e.rootNode,e.options,db)},t}(Vw),yb={};var mb=function(e,t){return t=vb.assign({},yb,t),new pb(e,t).execute()},wb=Nw;function bb(e,t){return bb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bb(e,t)}var kb=Vw,xb=function(e,t,n,r){var i=null;e.eachNode((function(e){!function(e,t,n,r,i){var o="function"==typeof n?n(e):n*e.depth;if(!r)try{if(e.id===e.parent.children[0].id)return e.x+=o,void(e.y=t?t.y:0)}catch(Kk){}if(e.x+=o,t){if(e.y=t.y+wb.getHeight(t,e,i),t.parent&&e.parent.id!==t.parent.id){var a=t.parent,s=a.y+wb.getHeight(a,e,i);e.y=s>e.y?s:e.y}}else e.y=0}(e,i,t,n,r),i=e}))},Cb=Zw,Eb=Nw,Sb=["LR","RL","H"],_b=Sb[0],Ab=function(e){function t(){return e.apply(this,arguments)||this}var n,r;return r=e,(n=t).prototype=Object.create(r.prototype),n.prototype.constructor=n,bb(n,r),t.prototype.execute=function(){var e=this.options,t=this.rootNode;e.isHorizontal=!0;var n=e.indent,r=void 0===n?20:n,i=e.dropCap,o=void 0===i||i,a=e.direction,s=void 0===a?_b:a,l=e.align;if(s&&-1===Sb.indexOf(s))throw new TypeError("Invalid direction: "+s);if(s===Sb[0])xb(t,r,o,l);else if(s===Sb[1])xb(t,r,o,l),t.right2left();else if(s===Sb[2]){var u=Cb(t,e),c=u.left,h=u.right;xb(c,r,o,l),c.right2left(),xb(h,r,o,l);var f=c.getBoundingBox();h.translate(f.width,0),t.x=h.x-t.width/2}return t},t}(kb),Mb={};var Pb=function(e,t){return t=Eb.assign({},Mb,t),new Ab(e,t).execute()},Ob=Nw;function Tb(e,t){var n=0;return e.children.length?e.children.forEach((function(e){n+=Tb(e,t)})):n=e.height,e._subTreeSep=t.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}function Lb(e){var t=e.children,n=t.length;if(n){t.forEach((function(e){Lb(e)}));var r=t[0],i=t[n-1],o=i.y-r.y+i.height,a=0;if(t.forEach((function(e){a+=e.totalHeight})),o>e.height)e.y=r.y+o/2-e.height/2;else if(1!==t.length||e.height>a){var s=e.y+(e.height-o)/2-r.y;t.forEach((function(e){e.translate(0,s)}))}else e.y=(r.y+r.height/2+i.y+i.height/2)/2-e.height/2}}var jb={getSubTreeSep:function(){return 0}};function Nb(e,t){return Nb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nb(e,t)}var Rb=function(e,t){void 0===t&&(t={}),t=Ob.assign({},jb,t),e.parent={x:0,width:0,height:0,y:0},e.BFTraverse((function(e){e.x=e.parent.x+e.parent.width})),e.parent=null,Tb(e,t),e.startY=0,e.y=e.totalHeight/2-e.height/2,e.eachNode((function(e){var t=e.children,n=t.length;if(n){var r=t[0];if(r.startY=e.startY+e._subTreeSep,1===n)r.y=e.y+e.height/2-r.height/2;else{r.y=r.startY+r.totalHeight/2-r.height/2;for(var i=1;i<n;i++){var o=t[i];o.startY=t[i-1].startY+t[i-1].totalHeight,o.y=o.startY+o.totalHeight/2-o.height/2}}}})),Lb(e)},Db=eb,Ib=Nw,Bb=function(e){function t(){return e.apply(this,arguments)||this}var n,r;return r=e,(n=t).prototype=Object.create(r.prototype),n.prototype.constructor=n,Nb(n,r),t.prototype.execute=function(){return Db(this.rootNode,this.options,Rb)},t}(Vw),zb={};var Fb=function(e,t){return t=Ib.assign({},zb,t),new Bb(e,t).execute()},Vb=jw({compactBox:sb,dendrogram:mb,indented:Pb,mindmap:Fb}),Hb=function(){function e(t){A(this,e),O(this,"g",void 0),this.g=t}return P(e,[{key:"init",value:function(){return this.onInit()}},{key:"onInit",value:function(){}},{key:"onMessageChange",value:function(e){}},{key:"destroy",value:function(){}},{key:"load",value:function(){}},{key:"initData",value:function(e){var t=this;return e&&e.length?e.map((function(e){return"mind-map"===e.shape?t.getMindMap(e):e})):[]}},{key:"getMindMap",value:function(e){return Vb.mindmap(e,{direction:"H",getHeight:function(e){return e.height},getWidth:function(e){return e.width},getHGap:function(){return 40},getVGap:function(){return 20},getSide:function(){return"right"}})}}]),e}(),Ub=function(e){l(n,e);var t=c(n);function n(e,r,i){var o;return A(this,n),O(f(o=t.call(this,e)),"ns",void 0),O(f(o),"nodeModel",{}),O(f(o),"opt",{}),O(f(o),"items",[]),O(f(o),"nodeKey",void 0),O(f(o),"x6Ctrl",void 0),o.nodeModel=i,o.x6Ctrl=r,o.nodeKey=o.nodeModel.nodeKey,o.ns=o.nodeModel.ns,o.register(),o.init(),o}return P(n,[{key:"onInit",value:function(){s(g(n.prototype),"onInit",this).call(this)}},{key:"register",value:function(){var e=this,t=this,n=this.nodeModel.readonly;Lw.register(a(a({effect:["data"]},t.opt),{},{shape:"mind-map-".concat(t.nodeKey),html:function(e){var r=e.getData(),i=document.createElement("div");if(i.className=t.ns.b("custom-html-node"),!n){i.onclick=function(e){t.prevent(e),t.g.emit("mind-map:click",e,r)},i.ondblclick=function(e){t.prevent(e),t.g.emit("mind-map:dblclick",e,r)};var o=document.createElement("div");o.innerHTML='<svg t="1721380398285" class="add-node-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1711" width="1em" height="1em"><path d="M512 170.67c-23.56 0-42.67 19.1-42.67 42.67v256h-256c-23.56 0-42.67 19.1-42.67 42.67s19.1 42.67 42.67 42.67h256v256c0 23.56 19.1 42.67 42.67 42.67s42.67-19.1 42.67-42.67v-256h256c23.56 0 42.67-19.1 42.67-42.67s-19.1-42.67-42.67-42.67h-256v-256c0-23.57-19.11-42.67-42.67-42.67z" p-id="1712"></path></svg>',o.className=t.ns.be("custom-html-node","add-item-icon-box"),o.onclick=function(e){t.prevent(e),t.g.emit("mind-map:add-topic",e,r)},i.appendChild(o)}var a=t.createReadonlyNode.bind(t)(r);return i.append(a),i}})),this.g.on("mind-map:dblclick",(function(t,n){var r=t.target,i=r.parentNode;i.classList.add("is-activated");var o=e.createEditNode(n);o.onblur=function(t){e.prevent(t),e.onNodeEditBlur(t,n)},o.onclick=e.prevent,o.ondblclick=e.prevent,i.appendChild(o),o.focus(),o.focus(),o.setSelectionRange(0,n.label.length),r.remove(),r=null,i=null})),this.g.on("mind-map:click",(function(e){e.target.parentNode.classList.add("is-activated")}))}},{key:"load",value:function(){var e=this.x6Ctrl.getData();this.items=this.initData(e),this.g.addNodes(this.addNodes(this.items))}},{key:"addNodes",value:function(e){var t=this,n=[];return e.forEach((function(e){e.data&&"mind-map"===e.data.shape?t.createMindMapCell(e).forEach((function(e){n.push(e)})):n.push(e)})),n}},{key:"createMindMapCell",value:function(e){var t=this,n=[];if(e){var r=e.children;n.push(this.getMindMapCellItem(e)),r&&null!=r&&r.length&&r.forEach((function(e){n.push.apply(n,p(t.createMindMapCell(e)))}))}return n}},{key:"getMindMapCellItem",value:function(e){var t=e.data;return{id:t.id,shape:"mind-map-".concat(this.nodeKey),x:e.x,y:e.y,width:t.width,height:t.height,label:t.label,type:t.type,data:t,attrs:{body:{strokeWidth:1,fill:"#fff",rx:6,ry:6}}}}},{key:"getStyle",value:function(e,t){return{width:"".concat(e,"px"),height:"".concat(t,"px"),lineHeight:"".concat(t,"px")}}},{key:"createReadonlyNode",value:function(e){var t=e.label,n=e.width,r=e.height,i=this.getStyle(n,r),o=document.createElement("div");return o.className=this.ns.be("custom-html-node","readonly-node"),Object.assign(o.style,a({},i)),o.textContent=t,"".concat(t).length>5&&(o.title=t),o}},{key:"createEditNode",value:function(e){var t=document.createElement("input");return t.setAttribute("value",e.label),t.setAttribute("type","text"),Object.assign(t.style,a(a({},this.getStyle(e.width,e.height)),{},{textAlign:"center",lineHeight:"100%"})),t.className=this.ns.be("custom-html-node","edit-node"),t}},{key:"onNodeEditBlur",value:function(e,t){var n=e.target,r=n.value||"",i=n.parentNode;n.remove();var o=this.createReadonlyNode(t);o.textContent=r,this.g.emit("mind-map:blur",e,t,r),i.appendChild(o)}},{key:"prevent",value:function(e){e.stopPropagation(),e.preventDefault()}}]),n}(Hb),qb=function(e){l(n,e);var t=c(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return A(this,n),O(f(i=t.call(this,e)),"linkModel",{}),O(f(i),"opt",{inherit:"edge"}),O(f(i),"items",[]),O(f(i),"x6Ctrl",void 0),i.linkModel=o,i.x6Ctrl=r,i.register(),i}return P(n,[{key:"onInit",value:function(){s(g(n.prototype),"onInit",this).call(this)}},{key:"register",value:function(){Pw.registerEdge("mind-map-edge",a({connector:{name:"mind-map"},attrs:{line:{targetMarker:"",stroke:"var(--ibiz-color-primary)",strokeWidth:2}},zIndex:0},this.opt),!0),Pw.registerConnector("mind-map-connector",this.MindMapConnector,!0)}},{key:"MindMapConnector",value:function(e,t){var n=Math.abs(t.x-e.x),r=new pg;r.appendSegment(pg.createSegment("M",e.x,e.y)),r.appendSegment(pg.createSegment("L",e.x,e.y));var i=e.x<t.x?e.x+n/2:e.x-n/2,o=e.y,a=e.x<t.x?t.x-n/2:t.x+n/2,s=t.y;return r.appendSegment(pg.createSegment("C",i,o,a,s,t.x,t.y)),r.serialize()}},{key:"load",value:function(){var e=this.x6Ctrl.getData();this.items=this.initData(e);var t=this.addEdges(this.items);this.g.addEdges(t)}},{key:"addEdges",value:function(e){var t=this,n=[];return e.forEach((function(e){e.data&&"mind-map"===e.data.shape?e.children&&e.children.length&&n.push.apply(n,p(t.handleMindMap(e))):n.push(e)})),n}},{key:"handleMindMap",value:function(e){var t=this,n=[];return e&&e.children&&e.children.forEach((function(r){n.push(t.createMinMapCell(r,e)),r.children&&r.children&&n.push.apply(n,p(t.handleMindMap(r)))})),n}},{key:"createMinMapCell",value:function(e,t){if(e.data&&"mind-map"===e.data.shape){var n=e.id;return{shape:"mind-map-edge",source:{cell:t.id,anchor:{name:"right",args:{dx:0}}},target:{cell:n,anchor:{name:"left"}},connector:{name:"mind-map-connector"},data:e}}return e}}]),n}(Hb),Gb=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};A(this,e),O(this,"evt",new K(this.getEventArgs.bind(this))),O(this,"g",void 0),O(this,"node",void 0),O(this,"link",void 0),O(this,"defaultParams",void 0),O(this,"backupData",[]),O(this,"selection",[]),O(this,"internalFocus",!1),O(this,"defaultData",[]),O(this,"graphOptions",{connecting:{connectionPoint:"anchor"},interacting:{nodeMovable:!1},panning:!0}),this.defaultParams=r,this.defaultData=r.defaultData,this.backupData=Ne(this.defaultData),Object.assign(this.graphOptions,n),this.graphOptions.container=t,this.graphOptions.mousewheel={enabled:!0,global:!0,modifiers:["ctrl","meta"],zoomAtMousePosition:!0,guard:function(e){var t;return(null===(t=e.target)||void 0===t||null===(t=t.parentNode)||void 0===t?void 0:t.id)==="diagram-".concat(r.nodeKey)}},this.g=new Pw(this.graphOptions),this.link=new qb(this.g,this,{}),this.node=new Ub(this.g,this,{nodeKey:this.defaultParams.nodeKey,ns:this.defaultParams.ns,readonly:this.defaultParams.readonly}),this.defaultParams.readonly||this.g.disablePanning(),this.init()}var t,n;return P(e,[{key:"getEventArgs",value:function(){return{context:{},params:{},data:[],targetName:"",view:{}}}},{key:"init",value:function(){this.initEvents(),this.load()}},{key:"initEvents",value:function(){var e=this;this.g.on("mind-map:add-topic",(function(t,n){var r=n.id;e.addChildNode(r)&&e.refresh()})),this.g.on("mind-map:click",(function(t,n){e.clearSelection(),e.selection=[{data:n,node:t.target.parentNode}],t.target.parentNode.classList.add("is-activated"),e.internalFocus=!0})),this.g.on("mind-map:blur",(function(t,n,r){e.updateNode(n.id,r||"")||e.refresh(),e.internalFocus=!1,e.evt.emit("onNodeBlur",void 0)}))}},{key:"clearSelection",value:function(){this.selection&&this.selection.length>0&&(this.selection[0].node.classList.remove("is-activated"),this.selection[0].node=null,this.selection=[])}},{key:"addChildNode",value:function(e){var t=this.findItem(this.backupData,e),n=null==t?void 0:t.node;if(n){var r=n.children?n.children.length:0,i={id:"".concat(e,"-").concat(r+1),type:"topic-child",shape:"mind-map",label:"",width:120,height:30};if(i)return n.children?n.children.push(i):Object.assign(n,{children:[i]}),this.defaultData=Ne(this.backupData),i}return null}},{key:"updateNode",value:function(e,t){var n=this.findItem(this.backupData,e),r=null==n?void 0:n.parent;if(r&&r.children){var i=r.children,o=i.findIndex((function(t){return t.id===e}));return i[o].label=t,this.defaultData=Ne(this.backupData),!0}return!1}},{key:"findItem",value:function(e,t){var n=this,r=null;return e&&e.length&&e.forEach((function(e){if(e.id===t&&(r={parent:null,node:e}),e.children&&e.children){var i=n.findItem(e.children,t);i&&(r={parent:i.parent||e,node:i.node})}})),r}},{key:"removeNode",value:function(e){var t=this.findItem(this.backupData,e),n=null==t?void 0:t.parent;if(n&&n.children){var r=n.children,i=r.findIndex((function(t){return t.id===e}));return r.splice(i,1),this.defaultData=Ne(this.backupData),!0}return!1}},{key:"togglePanning",value:function(){this.g.togglePanning()}},{key:"disablePanning",value:function(){this.g.disablePanning()}},{key:"getData",value:function(){return this.defaultData}},{key:"load",value:(n=_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.node.load(),this.link.load(),this.g.centerContent();case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"refresh",value:(t=_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.g.clearCells({refresh:!0}),e.next=3,this.load();case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.g.dispose(),this.node.destroy(),this.link.destroy()}}]),e}(),Jb=d({name:"IBizDiagramBoard",props:bc(),emits:["change"],setup:function(e){var t,n=re("diagram-board"),r=C(),i=C(),o=C(!1),a=C();a.value=[{type:"panning",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g stroke-width="1" fill-rule="evenodd"><path d="M8.446.5c.628.01 1.101.34 1.416.843.035.056.067.112.096.167l.063.132.041-.018c.135-.056.282-.092.44-.106l.163-.008c.823 0 1.356.483 1.637 1.154.088.21.132.436.132.662l.002.479.08-.022c.096-.022.198-.036.304-.04l.163-.001c.63.024 1.082.338 1.326.82.143.282.19.551.19.772l-.107 6.715a3.688 3.688 0 0 1-.87 2.334 4.249 4.249 0 0 1-.364.377c-.695.637-1.403.894-1.968.94l-3.718-.02a3.014 3.014 0 0 1-.977-.333 3.486 3.486 0 0 1-.608-.398l-3.335-3.448a4.423 4.423 0 0 1-.597-.587c-.376-.443-.62-.9-.652-1.386a1.437 1.437 0 0 1 .28-.96c.242-.33.546-.547.892-.638.483-.128.952-.005 1.39.257.18.108.317.216.397.292l.352.318-.042-5.204.004-.131c.014-.228.065-.505.183-.792.251-.609.738-1.023 1.455-1.062a1.75 1.75 0 0 1 .623.073l.027.009c.021-.054.044-.108.07-.163l.085-.167C7.315.832 7.795.49 8.446.5zm-.02 1.2c-.158-.002-.263.072-.361.248-.025.044-.047.09-.064.13l-.052.126-.005.003-.001.954h.029V7.61h-1.2L6.77 3.338h-.027a.861.861 0 0 0-.044-.227l-.036-.092c-.074-.161-.166-.224-.386-.213-.208.012-.322.108-.41.321-.07.172-.096.36-.096.463l.064 7.935-2.417-2.19-.103-.075-.068-.043c-.187-.113-.355-.157-.466-.127-.072.019-.146.071-.231.188a.24.24 0 0 0-.05.172c.011.173.144.423.369.688.163.191.328.343.486.475l3.329 3.444c.026.02.063.047.109.077l.16.098.097.052c.209.11.412.183.506.201l3.584.017c.01 0 .022-.002.037-.005l.121-.028a2.606 2.606 0 0 0 1.048-.594c.09-.082.177-.172.26-.27.369-.433.576-.991.585-1.575l.108-6.702a.596.596 0 0 0-.061-.224c-.055-.107-.126-.156-.301-.163-.257-.01-.404.17-.462.454v2.132h-1.2V5.688h-.03l-.012-2.36a.513.513 0 0 0-.038-.2c-.114-.27-.276-.418-.531-.418-.208 0-.345.164-.413.403l.001 4.4h-1.2V3.288h-.037l-.028-.989-.025-.076a1.36 1.36 0 0 0-.07-.16l-.049-.084c-.116-.187-.245-.276-.417-.279z" id="arj形状结合"></path></g></svg>',text:"平移"},{type:"separator",text:"|"},{type:"delete",icon:'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g stroke-width="1" fill-rule="evenodd"><path d="M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z" id="azk删除"></path></g></svg>',text:"删除"}];var s=[{id:"1",type:"topic",shape:"mind-map",label:"思维导图",width:120,height:40,children:[{id:"1-1",type:"topic-child",shape:"mind-map",label:"新建节点",width:120,height:30},{id:"1-2",type:"topic-child",shape:"mind-map",label:"新建节点",width:120,height:30}]}];if(e.data){var l=e.data.data;s=l}var u=function(){var e=_(E().mark((function e(){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(n=t)||void 0===n||n.destroy();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var o;e.isFocus&&(null===(o=r.value)||void 0===o||o.focus());var a=r.value,l=a.offsetWidth,u=a.offsetHeight;(t=new Gb(i.value,{width:l,height:u},{ns:n,nodeKey:e.nodeKey,readonly:e.readonly,defaultData:s})).evt.on("onNodeBlur",(function(){var n;e.change({data:null===(n=t)||void 0===n?void 0:n.defaultData},{isUpdate:!0})}))},h=function(n){switch(n.type){case"delete":u(),t.internalFocus=!0,e.change("",{isDelete:!0});break;case"panning":t.togglePanning()}},f=function(){var e=_(E().mark((function e(){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.value||(o.value=!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=this,g=new ResizeObserver((function(){r.value&&0!==r.value.offsetWidth&&(c.bind(d)(),g.disconnect(),g=null)}));return L((function(){i.value&&(g.observe(i.value),r.value.addEventListener("click",(function(){var e;t.clearSelection(),null===(e=r.value)||void 0===e||e.focus()})),r.value.addEventListener("keydown",(function(e){t.internalFocus=!1,"Backspace"!==e.key&&"Delete"!==e.key||t&&t.selection&&t.selection.length>0&&t.removeNode(t.selection[0].data.id)&&(t.clearSelection(),t.refresh())})))})),z((function(){u()})),{ns:n,diagramRef:i,diagramBoxRef:r,diagramBoxActivate:o,onFocus:f,onBlur:function(){if(t){var n;if(t.clearSelection(),t.internalFocus)return;e.change({data:null===(n=t)||void 0===n?void 0:n.defaultData}),o.value=!1}},renderTopToolBar:function(){return N("div",{class:n.b("top-tool-bar")},[a.value.map((function(e){return N("div",{class:[n.be("top-tool-bar","item"),n.be("top-tool-bar","item-".concat(e.type))],title:e.text,onClick:function(){return h(e)}},[N("div",{class:n.bem("top-tool-bar","item","content"),innerHTML:e.icon||e.text},null)])}))])}}},render:function(){return N("div",{ref:"diagramBoxRef",class:[this.ns.b(),this.readonly?this.ns.m("readonly"):"",this.ns.is("activated",this.diagramBoxActivate)],tabindex:"0",onFocus:this.onFocus,onBlur:this.onBlur},[!this.readonly&&this.diagramBoxActivate?this.renderTopToolBar():"",N("div",{id:"diagram-".concat(this.nodeKey),ref:"diagramRef"},null)])}}),Wb=d({name:"IBizAudio",props:bc(),setup:function(e){var t=re("audio"),n=C(""),r=C(0),i=C("");if(e.data){var o=e.data,a=o.name,s=o.size,l=o.url;n.value=a,r.value=s,i.value=l}var u=C(!1),c=C("00:00"),h=C("00:00"),f=C(),d=C(),g=C(),v=C(0),p=C(0),y=C(0),m=I((function(){var e=r.value<=0?0:Math.round(r.value/1048576*10)/10;return"".concat(e," MB")})),w=function(){if(f.value){v.value=f.value.duration,Number.isNaN(v.value)&&(v.value=0);var e=parseInt((v.value/60).toString(),10),t=e.toString();e<10&&(t="0".concat(e.toString()));var n=Math.round(v.value%60),r=n.toString();n<10&&(r="0".concat(n.toString())),h.value="".concat(t,":").concat(r)}},b=function(){f.value.addEventListener("timeupdate",(function(){!function(){p.value=f.value.currentTime;var e=Math.floor(p.value),t=parseInt((e/60).toString(),10),n=t.toString();t<10&&(n="0".concat(t.toString()));var r=Math.round(e%60),i=r.toString();r<10&&(i="0".concat(r.toString())),c.value="".concat(n,":").concat(i),"00:00"===h.value&&w()}(),f.value&&(y.value=function(e,t){if(0===e||0===t)return 0;var n=e/t*100;return n<0?n=0:n>100&&(n=100),n}(p.value,v.value))}),!1),f.value.addEventListener("ended",(function(){u.value=!1,f.value.load(),c.value="00:00"})),f.value.oncanplaythrough=function(){w()}};L((function(){f.value&&b()}));return{ns:t,realAudioTime:c,totalAudioTime:h,isPlay:u,audioRef:f,bar:d,slid:g,percentage:y,fileName:n,fileSizeText:m,audioSrc:i,play:function(){f.value.paused?(f.value.play(),u.value=!0):(f.value.pause(),u.value=!1)},renderStop:function(){return N("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http:// www.w3.org/2000/svg","p-id":"3144",width:"1em",height:"1em"},[N("path",{d:"M209.645253 863.934444l201.049992 0 0-703.866842L209.645253 160.067602 209.645253 863.934444zM611.804588 863.934444l201.113437 0 0-703.866842L611.804588 160.067602 611.804588 863.934444z","p-id":"3145"},null)])},renderArrowSvg:function(){return N("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http:// www.w3.org/2000/svg","p-id":"2304",width:"1em",height:"1em"},[N("path",{d:"M768 512 256 0 256 1024Z","p-id":"2305"},null)])},renderAudioSvg:function(){return N("svg",{class:"icon audio-icon",viewBox:"0 0 1092 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4287",width:"1em",height:"1em"},[N("path",{d:"M394.24 429.056v378.368c0 83.456-67.584 150.528-150.528 150.528-83.456 0-150.528-67.584-150.528-150.528 0-83.456 67.584-150.528 150.528-150.528 25.6 0 49.152 6.144 70.144 17.408V395.776 194.048c0-19.456 13.824-36.352 33.28-39.424l550.4-95.232c24.576-4.096 47.104 14.848 47.104 39.424v611.84c0 83.456-67.584 150.528-150.528 150.528-83.456 0-150.528-67.584-150.528-150.528 0-83.456 67.584-150.528 150.528-150.528 25.6 0 49.152 6.144 70.144 17.408V347.648L394.24 429.056z m0-81.408L864.256 266.24V146.432L394.24 228.352v119.296zM243.2 877.568c38.912 0 70.144-31.744 70.144-70.144 0-38.912-31.744-70.144-70.144-70.144s-70.144 31.744-70.144 70.144c0 38.4 31.744 70.144 70.144 70.144z m550.912-96.256c38.912 0 70.144-31.744 70.144-70.144 0-38.912-31.744-70.144-70.144-70.144-38.912 0-70.144 31.744-70.144 70.144 0 38.4 31.232 70.144 70.144 70.144z","p-id":"4288"},null)])},onSliderChange:function(e){}}},render:function(){var e=this,t=N("div",{class:[this.ns.e("content")],ref:"componentRef"},[N("div",{class:this.ns.e("left")},[N("div",{class:[this.ns.e("play"),this.ns.is("active",this.isPlay)],onClick:function(){return e.play()}},[this.isPlay?this.renderStop():this.renderArrowSvg()])]),N("div",{class:this.ns.e("wrapper")},[N("div",{class:this.ns.em("wrapper","top")},[N("span",null,[this.fileName]),N("span",{class:this.ns.em("wrapper","file-size")},[this.fileSizeText])]),N("div",{class:this.ns.em("wrapper","time-bar")},[N("div",{class:this.ns.em("wrapper","time")},[this.realAudioTime]),N("div",{class:this.ns.em("wrapper","slider")},[N(R("el-slider"),{modelValue:this.percentage,"onUpdate:modelValue":function(t){return e.percentage=t},max:100,min:0,disabled:!0,onChange:this.onSliderChange},null)]),N("div",{class:this.ns.em("wrapper","time")},[this.totalAudioTime])])]),N("audio",{ref:"audioRef",src:this.audioSrc},null)]);return N("div",{ref:"audio",class:[this.ns.b(),this.disabled?this.ns.m("disabled"):"",this.readonly?this.ns.m("readonly"):""]},[t])}}),Yb=d({name:"IBizLayoutToolBar",props:{modal:{type:Object,required:!0}},setup:function(e){var t=re("layout-toolbar"),n=[{type:"delete",text:"删除",icon:"<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em'> <g stroke-width='1' fill-rule='evenodd'> <path d='M4.002 3.403V1a1 1 0 0 1 1-1h6.003a1 1 0 0 1 1 1v2.403h3.396a.6.6 0 1 1 0 1.2h-1.395V15a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4.603H.6a.6.6 0 1 1 0-1.2h3.4zm8.804 1.205H3.2V14.8h9.605V4.608zM5.202 1.2v2.155h5.603V1.2H5.202zm.6 6.417a.6.6 0 0 1 1.201 0v4.758a.6.6 0 0 1-1.2 0V7.617zm3.202 0a.6.6 0 0 1 1.2 0v4.758a.6.6 0 0 1-1.2 0V7.617z'></path> </g></svg>"}],r=function(){var t=_(E().mark((function t(){var n,r;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.modal&&(r={ok:!0,data:[{value:"",params:{isDelete:!0}}]},null===(n=e.modal)||void 0===n||n.dismiss(r));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{ns:t,renderToolBar:function(){return N("div",{class:t.e("content")},[n.map((function(e){return N("div",{class:[t.e("tool-item"),t.e("tool-item-".concat(e.type))],title:e.text,onClick:function(){return function(e){"separator"!==e.type&&"delete"===e.type&&r()}(e)}},[N("div",{class:t.em("tool-item","content"),innerHTML:e.icon||e.text},null)])}))])}}},render:function(){return N("div",{class:[this.ns.b()]},[this.renderToolBar()])}}),Zb=function(e){l(r,e);var t,n=c(r);function r(){var e;A(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return O(f(e=n.call.apply(n,[this].concat(i))),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),kc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a,s,l,u,c,h,f,d,g=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(r),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e){var t=new CustomEvent("dateElemEvent",{detail:{type:a,value:e},bubbles:!0,composed:!0});g.dispatchEvent(t)},null===(i=this.vueApp)||void 0===i||i.unmount(),this.vueApp=J(xc,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e){return f(e)}}),this.innerHTML="",(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.use(Ie,{locale:mc}),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),Xb=function(e){l(r,e);var t,n=c(r);function r(){var e;A(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return O(f(e=n.call.apply(n,[this].concat(i))),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),kc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a,s,l,u,c,h,f,d,g=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(r),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("labelElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});g.dispatchEvent(n)},null===(i=this.vueApp)||void 0===i||i.unmount(),this.vueApp=J(Cc,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),this.innerHTML="",(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.use(Ie),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),Kb=function(e){l(r,e);var t,n=c(r);function r(){var e;A(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return O(f(e=n.call.apply(n,[this].concat(i))),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a,s,l,u,c,h,f,d,g=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(r),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("promptBoxElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});g.dispatchEvent(n)},null===(i=this.vueApp)||void 0===i||i.unmount(),this.innerHTML="",this.vueApp=J(Ac,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.component(Be.name,Be),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),$b=function(e){l(r,e);var t,n=c(r);function r(){var e;A(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return O(f(e=n.call.apply(n,[this].concat(i))),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a,s,l,u,c,h,f,d,g,v=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=15;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(r),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).isUpdate,h=u.readonly,f=u.isAdd,d=function(e,t){var n=new CustomEvent("mindMapElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});v.dispatchEvent(n)},null===(i=this.vueApp)||void 0===i||i.unmount(),this.vueApp=J(Jb,{data:s,nodeKey:this.vueAppKey,isFocus:!!f||!!c,readonly:!!h,change:function(e,t){return d(e,t)}}),this.innerHTML="",(g=document.createElement("span")).classList.add("elem-box"),g.part.add("container"),this.vueApp.mount(g),this.appendChild(g);case 15:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),Qb=function(e){l(r,e);var t,n=c(r);function r(){var e;A(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return O(f(e=n.call.apply(n,[this].concat(i))),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount()}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a,s,l,u,c,h,f,d,g=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(r),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e){var t=new CustomEvent("audioElemEvent",{detail:{type:a,value:e},bubbles:!0,composed:!0});g.dispatchEvent(t)},null===(i=this.vueApp)||void 0===i||i.unmount(),this.innerHTML="",this.vueApp=J(Wb,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e){return f(e)}}),(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.component(ze.name,ze),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),ek=function(e){l(r,e);var t,n=c(r);function r(){var e;A(this,r);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return O(f(e=n.call.apply(n,[this].concat(i))),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),kc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a,s,l,u,c,h,f,d,g=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=16;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:o=JSON.parse(r),a=o.type,s=o.value,l=o.params,c=(u=void 0===l?{}:l).readonly,h=u.isAdd,f=function(e,t){var n=new CustomEvent("formulaElemEvent",{detail:{type:a,value:e,params:t},bubbles:!0,composed:!0});g.dispatchEvent(n)},null===(i=this.vueApp)||void 0===i||i.unmount(),this.vueApp=J(sh,{data:s,nodeKey:this.vueAppKey,isFocus:!!h,readonly:!!c,change:function(e,t){return f(e,t)}}),this.innerHTML="",(d=document.createElement("span")).classList.add("elem-box"),d.part.add("container"),this.vueApp.component(Fe.name,Fe),this.vueApp.mount(d),this.appendChild(d);case 16:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),tk=function(e){l(r,e);var t,n=c(r);function r(){var e;return A(this,r),O(f(e=n.call(this)),"readonly",!1),O(f(e),"overlay",void 0),e}return P(r,[{key:"handleMousedown",value:function(e){0===e.button&&this.classList.remove("is-activated")}},{key:"connectedCallback",value:function(){var e=this;if(this.classList.add("layout-elem"),!this.readonly){var t=this,n=function(){var n=_(E().mark((function n(r){var i,o,a,s;return E().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.overlay=wc(Yb,{placement:"top-start"}),n.next=3,t.overlay.present(r);case 3:return n.next=5,t.overlay.onWillDismiss();case 5:(i=n.sent).ok&&i.data&&i.data.length>0&&(o=i.data[0],a=o.value,s=o.params,l=void 0,l=new CustomEvent("labelElemEvent",{detail:{type:"insert-layout",value:a,params:s},bubbles:!0,composed:!0}),e.dispatchEvent(l)),t.overlay=null;case 8:case"end":return n.stop()}var l}),n)})));return function(e){return n.apply(this,arguments)}}();this.onclick=function(e){var t;"layout-elem"!==(null===(t="".concat(e.target.nodeName))||void 0===t?void 0:t.toLocaleLowerCase())||e.target.classList.contains("is-activated")||(e.target.classList.add("is-activated"),n(e.target))},document.addEventListener("mousedown",this.handleMousedown.bind(this))}}},{key:"disconnectedCallback",value:function(){this.overlay&&(this.overlay.dismiss(),this.overlay=null),document.removeEventListener("mousedown",this.handleMousedown.bind(this))}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){var i,o,a;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=7;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:i=JSON.parse(r),o=i.params,a=(void 0===o?{}:o).readonly,this.readonly=!!a;case 7:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),nk=function(e){l(r,e);var t,n=c(r);function r(){var e;return A(this,r),O(f(e=n.call(this)),"vueAppKey",ke()),O(f(e),"vueApp",void 0),e}return P(r,[{key:"connectedCallback",value:function(){this.classList.add("layout-column-elem")}},{key:"disconnectedCallback",value:function(){var e;null===(e=this.vueApp)||void 0===e||e.unmount(),kc(this.vueAppKey)}},{key:"attributeChangedCallback",value:(t=_(E().mark((function e(t,n,r){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("data-value"!==t){e.next=3;break}if(!r||n!==r){e.next=3;break}return e.abrupt("return");case 3:case"end":return e.stop()}}),e)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),r}(n(HTMLElement)),rk=function(){function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"quoteUrl",""),O(this,"quoteFieldMap",{id:"id",name:"name"}),O(this,"quoteCodelistMap",new Map),O(this,"quoteMethod","post"),O(this,"quoteParams",{}),O(this,"quoteScript","`#{id=${data.id},name=${data.name},identifier=${data.identifier},icon=${data.icon}}`"),O(this,"quoteInScript","value.replaceAll(/#{id=(.+?),name=(.+?),identifier=(.+?),icon=((.|[\\t\\r\\f\\n\\s])+?)}/g,(x, id, name, identifier, icon) => {return controller.getNodeInfo({ id, name, identifier, icon })})"),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"overlay",null),O(this,"evt",void 0),O(this,"execting",!1),O(this,"query",""),O(this,"curPage",0),O(this,"size",20),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"cleanup",Oe),this.registerNode()}var t,n,r,i;return P(e,[{key:"markerPlugin",value:function(e){var t=this,n=e.insertText,r=e.isInline,i=e.isVoid;return e.insertText=function(r){t.editor?t.editor.isFocused()?(pe.getSelectedElems(e).some((function(t){return e.isVoid(t)}))||"#"!==r||t.execting||(t.query="",t.showModal()),n(r)):n(r):n(r)},e.isInline=function(e){return"marker"===pe.getNodeType(e)||r(e)},e.isVoid=function(e){return"marker"===pe.getNodeType(e)||i(e)},e}},{key:"registerNode",value:function(){window.markerIsRegiter||(me.registerModule(Du),window.markerIsRegiter=!0),me.registerPlugin(this.markerPlugin.bind(this))}},{key:"init",value:(i=_(E().mark((function e(t,n){var r,i,o,a,s,l,u,c,h,f,d=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams,this.editorParams&&(r=this.editorParams,i=r.QUOTEURL,o=r.QUOTEFIELDMAP,a=r.QUOTEMETHOD,s=r.QUOTESCRIPT,l=r.QUOTEINSCRIPT,u=r.QUOTEPARAMS,c=r.QUOTECODELISTMAP,i&&(this.quoteUrl=i),o&&(this.quoteFieldMap=JSON.parse(o)),a&&(this.quoteMethod=a.toLowerCase()),u&&(this.quoteParams=JSON.parse(u)),s&&(this.quoteScript=s),l&&(this.quoteInScript=l),c&&(h=JSON.parse(c),this.setCodeListMap(h))),(f=this.editor.getEditableContainer())&&(this.cleanup=Pe(f,"keydown",(function(e){var t;d.execting&&d.presetPreventEvents.includes(e.keyCode)&&e.preventDefault(),d.execting&&d.presetPreventPropEvents.includes(e.keyCode)&&(e.stopPropagation(),null===(t=d.overlay)||void 0===t||t.dismiss())})));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"onDestroyed",value:function(){this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}},{key:"setCodeListMap",value:(r=_(E().mark((function e(t){var n,r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=E().keys(t);case 1:if((e.t1=e.t0()).done){e.next=9;break}return n=e.t1.value,e.next=5,this.loadCodeList(t[n]);case 5:(r=e.sent)&&this.quoteCodelistMap.set(n,r),e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"showModal",value:function(){var e=this;if(!this.quoteUrl)throw new Me("未配置提及工作项QUOTEURL编辑器参数！");var t=document.getSelection();if(t){var n=t.focusNode;n&&this.openPopover(n.parentNode).then((function(t){t.length>0&&e.insertNode(t[0])}))}}},{key:"findCodeListItem",value:function(e,t){if(e){var n=e.find((function(e){return e.value==t}));if(n)return n;for(var r=0;r<e.length;r++){var i=this.findCodeListItem(e[r].children,t);if(i)return i}}}},{key:"insertNode",value:function(e){if(this.quoteCodelistMap.has("type")&&e.type){var t=this.quoteCodelistMap.get("type"),n=this.findCodeListItem(t.codeListItems,e.type);n&&n.sysImage&&Object.assign(e,{icon:n.sysImage.rawContent})}var r={type:"marker",script:this.quoteScript,data:e,children:[{text:""}]};this.editor.restoreSelection(),this.editor.deleteBackward("character");for(var i=0;i<this.query.length;i++)this.editor.deleteBackward("character");this.editor.insertNode(r),this.editor.move(1)}},{key:"getNodeInfo",value:function(e){return Object.assign(e,{script:this.quoteScript}),'<span data-w-e-type="marker" data-w-e-is-void data-w-e-is-inline data-value="'.concat(encodeURIComponent(JSON.stringify(e)),'"></span>')}},{key:"parseNode",value:function(e){return Y.execScriptFn({value:e,controller:this},this.quoteInScript,{singleRowReturn:!0,isAsync:!1})}},{key:"handlePublicParams",value:function(e,t,n){var r=this.model,i=r.navigateContexts,o=r.navigateParams,a={};i&&e&&(a=$(i,e,n,t));var s=Object.assign(t.clone(),a),l={};return o&&e&&(l=$(o,e,n,t)),{context:s,params:l}}},{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.handlePublicParams(this.data,this.context,this.params),n=t.context,r=t.params,i=!0===e.isInitialLoad,o=!0===e.isLoadMore;i?this.curPage=0:o&&(this.curPage+=1);var s=Y.execScriptFn({data:this.data,context:n,params:r},this.quoteUrl,{singleRowReturn:!0,isAsync:!1}),l=a(a({},r),{},{query:this.query,size:this.size,page:this.curPage},this.quoteParams);return ibiz.net[this.quoteMethod](s,l)}},{key:"toUIData",value:function(e){var t=this;return e.map((function(e){var n={};return Object.keys(t.quoteFieldMap).forEach((function(r){n[r]=e[t.quoteFieldMap[r]]})),n}))}},{key:"openPopover",value:(n=_(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.overlay=ibiz.overlay.createPopover(this.createOverlayView(),void 0,{placement:"bottom-start",autoClose:!0,width:"300px",noArrow:!0}),e.next=3,this.overlay.present(t);case 3:return this.execting=!0,e.next=6,this.overlay.onWillDismiss();case 6:return n=e.sent,this.execting=!1,e.abrupt("return",n.data||[]);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"createOverlayView",value:function(){var e=this;return function(t){return G(Bu,{controller:e,modal:t})}}},{key:"loadCodeList",value:(t=_(E().mark((function e(t){var n,r,i;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ibiz.hub.getApp(this.context.srfappid),r=n.codeList.getCodeList(t),e.next=4,n.codeList.get(t,this.context,this.params);case 4:return i=e.sent,e.abrupt("return",{codeList:r,codeListItems:i});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();var ik={type:"mention",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,r=e.data,i=void 0===r?{}:r,o=Y.execScriptFn({data:i},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var ok={selector:'span[data-w-e-type="mention"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"mention",script:n.script,data:n,children:[{text:""}]}}};var ak={type:"mention",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,r={name:"@".concat(n.name),id:n.id};return wu("mention-elem",{dataset:{value:JSON.stringify(r)},props:{contentEditable:!1}},[])}},sk=function(){function e(){A(this,e),O(this,"title","提及成员"),O(this,"tag","button"),O(this,"iconSvg",'<svg t="1705979200437" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4218" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M23.7 555c0-339.3 247-550 533.8-550 295.6 0 442.8 165.9 442.8 401.6 0 210.8-93.5 361.7-237 361.7-63.6 0-108.5-26.2-137.2-78.6-48.6 51.1-96 79.8-174.6 79.8-116 0-178.4-77.3-178.4-193.3 0-209.5 131-323 251.9-323 64.9 0 102.3 24.9 122.2 68.6l11.2-58.6 114.7 1.2L727 510.1c-7.5 36.2-11.2 63.6-11.2 81.1 0 44.9 22.5 71.1 56.1 71.1 63.6 0 106-89.8 106-243.2 0-205.8-114.7-300.6-323-300.6-220.8 0-405.4 163.4-405.4 436.5 0 238.2 132.2 350.5 390.4 350.5 94.8 0 174.6-12.5 255.7-36.2v109.8c-88.6 26.2-177.1 39.9-263.2 39.9-329.1 0-508.7-168.4-508.7-464z m585-44.9c3.7-20 6.2-39.9 6.2-53.6 0-56.1-15-96-83.6-96-83.6 0-133.5 108.5-133.5 212 0 44.9 13.7 88.6 77.3 88.6 73.7-0.1 114.9-57.4 133.6-151z" fill="#333333" p-id="4219"></path></svg>')}return P(e,[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.insertText("@")}}]),e}(),lk={renderElems:[ak],elemsToHtml:[ik],parseElemsHtml:[ok],menus:[{key:"mention",factory:function(){return new sk}}]},uk=function(){function e(){A(this,e),O(this,"operatorMap",new Map),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"userUrl",""),O(this,"userFieldMap",{id:"id",name:"name"}),O(this,"userMethod","post"),O(this,"userScript","`@{userid=${data.id},name=${data.name}}`"),O(this,"userInScript","value.replaceAll(/@{userid=(.+?),name=(.+?)}/g,(x, id, name) => {return controller.getNodeInfo({ id, name })})"),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"overlay",null),O(this,"evt",void 0),O(this,"execting",!1),O(this,"query",""),O(this,"curPage",0),O(this,"size",20),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"cleanup",Oe),this.registerNode()}var t,n,r;return P(e,[{key:"mentionPlugin",value:function(e){var t=this,n=e.insertText,r=e.isInline,i=e.isVoid;return e.insertText=function(r){t.editor?t.editor.isFocused()?(pe.getSelectedElems(e).some((function(t){return e.isVoid(t)}))||"@"!==r||t.execting||(t.query="",t.showModal()),n(r)):n(r):n(r)},e.isInline=function(e){return"mention"===pe.getNodeType(e)||r(e)},e.isVoid=function(e){return"mention"===pe.getNodeType(e)||i(e)},e}},{key:"registerNode",value:function(){window.mentionIsRegiter||(me.registerModule(lk),window.mentionIsRegiter=!0),me.registerPlugin(this.mentionPlugin.bind(this))}},{key:"init",value:(r=_(E().mark((function e(t,n){var r,i,o,a,s,l,u,c=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams,this.editorParams&&(r=this.editorParams,i=r.USERURL,o=r.USERFIELDMAP,a=r.USERMETHOD,s=r.USERSCRIPT,l=r.USERINSCRIPT,i&&(this.userUrl=i),o&&(this.userFieldMap=JSON.parse(o)),a&&(this.userMethod=a.toLowerCase()),s&&(this.userScript=s),l&&(this.userInScript=l)),(u=this.editor.getEditableContainer())&&(this.cleanup=Pe(u,"keydown",(function(e){var t;c.execting&&c.presetPreventEvents.includes(e.keyCode)&&e.preventDefault(),c.execting&&c.presetPreventPropEvents.includes(e.keyCode)&&(e.stopPropagation(),null===(t=c.overlay)||void 0===t||t.dismiss())}))),e.next=12,this.getOperatorUserList();case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"getOperatorUserList",value:(n=_(E().mark((function e(){var t,n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ibiz.hub.getApp(this.context.srfappid);case 2:return t=e.sent,n=[],e.next=6,t.codeList.get("SysOperator",this.context,this.params);case 6:n=e.sent,this.operatorMap=new Map(n.map((function(e){return[e.value,e]})));case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onDestroyed",value:function(){this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}},{key:"showModal",value:function(){var e=this;if(!this.userUrl)throw new Me("未配置提及用户USERURL编辑器参数！");var t=document.getSelection();if(t){var n=t.focusNode;n&&this.openUserPopover(n.parentNode).then((function(t){t.length>0&&e.insertNode(t[0])}))}}},{key:"insertNode",value:function(e){var t={type:"mention",script:this.userScript,data:e,children:[{text:""}]};this.editor.restoreSelection(),this.editor.deleteBackward("character");for(var n=0;n<this.query.length;n++)this.editor.deleteBackward("character");this.editor.insertNode(t),this.editor.move(1)}},{key:"getNodeInfo",value:function(e){return Object.assign(e,{script:this.userScript}),'<span data-w-e-type="mention" data-w-e-is-void data-w-e-is-inline data-value="'.concat(encodeURIComponent(JSON.stringify(e)),'"></span>')}},{key:"parseNode",value:function(e){return Y.execScriptFn({value:e,controller:this},this.userInScript,{singleRowReturn:!0,isAsync:!1})}},{key:"handlePublicParams",value:function(e,t,n){var r=this.model,i=r.navigateContexts,o=r.navigateParams,a={};i&&e&&(a=$(i,e,n,t));var s=Object.assign(t.clone(),a),l={};return o&&e&&(l=$(o,e,n,t)),{context:s,params:l}}},{key:"getUsers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.handlePublicParams(this.data,this.context,this.params),n=t.context,r=t.params,i=!0===e.isInitialLoad,o=!0===e.isLoadMore;i?this.curPage=0:o&&(this.curPage+=1);var s=Y.execScriptFn({data:this.data,context:n,params:r},this.userUrl,{singleRowReturn:!0,isAsync:!1}),l=a(a({},r),{},{query:this.query,size:this.size,page:this.curPage});return ibiz.net[this.userMethod](s,l)}},{key:"toUIData",value:function(e){var t=this;return e.map((function(e){var n={};return Object.keys(t.userFieldMap).forEach((function(r){n[r]=e[t.userFieldMap[r]]})),n}))}},{key:"openUserPopover",value:(t=_(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.overlay=ibiz.overlay.createPopover(this.createOverlayView(),void 0,{placement:"bottom-start",autoClose:!0,width:"300px",noArrow:!0}),e.next=3,this.overlay.present(t);case 3:return this.execting=!0,e.next=6,this.overlay.onWillDismiss();case 6:return n=e.sent,this.execting=!1,e.abrupt("return",n.data||[]);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createOverlayView",value:function(){var e=this;return function(t){return G(Iu,{controller:e,modal:t})}}}]),e}();var ck={type:"page",elemToHtml:function(e){var t=e.script,n=void 0===t?"":t,r=e.data,i=void 0===r?{}:r,o=Y.execScriptFn({data:i},n,{singleRowReturn:!0,isAsync:!1});return"".concat(o)}};var hk={selector:'span[data-w-e-type="page"]',parseElemHtml:function(e){var t=decodeURIComponent(e.getAttribute("data-value")||""),n=JSON.parse(t);return{type:"page",script:n.script,data:n,children:[{text:""}]}}};var fk={type:"Page",renderElem:function(e){var t=e.data,n=void 0===t?{}:t,r={name:"".concat(n.name),id:n.id};return wu("mention-elem",{dataset:{value:JSON.stringify(r)},props:{contentEditable:!1}},[])}},dk=function(){function e(){A(this,e),O(this,"title","页面"),O(this,"tag","button"),O(this,"iconSvg",'<svg t="1707293566679" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6103" width="200" height="200"><path d="M288 512l256 0C561.92 512 576 497.92 576 480 576 462.08 561.92 448 544 448l-256 0C270.08 448 256 462.08 256 480 256 497.92 270.08 512 288 512zM768 64 192 64C121.6 64 64 121.6 64 192l0 576c0 70.4 57.6 128 128 128l576 0c70.4 0 128-57.6 128-128L896 192C896 121.6 838.4 64 768 64zM832 768c0 35.2-28.8 64-64 64L192 832c-35.2 0-64-28.8-64-64L128 192c0-35.2 28.8-64 64-64l576 0c35.2 0 64 28.8 64 64L832 768zM672 256l-384 0C270.08 256 256 270.08 256 288 256 305.92 270.08 320 288 320l384 0C689.92 320 704 305.92 704 288 704 270.08 689.92 256 672 256zM608 640l-320 0C270.08 640 256 654.08 256 672l0 0C256 689.92 270.08 704 288 704l320 0c17.92 0 32-14.08 32-32l0 0C640 654.08 625.92 640 608 640z" p-id="6104"></path></svg>')}return P(e,[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){throw new Me("暂未支持上传页面！")}}]),e}(),gk={renderElems:[fk],elemsToHtml:[ck],parseElemsHtml:[hk],menus:[{key:"page",factory:function(){return new dk}}]},vk=function(){function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"items",[]),O(this,"evt",void 0),O(this,"execting",!1),this.registerNode()}var t;return P(e,[{key:"registerNode",value:function(){window.pageIsRegiter||(me.registerModule(gk),window.pageIsRegiter=!0)}},{key:"init",value:(t=_(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.evt=n.evt,this.data=n.data,this.editor=t,this.editorParams=this.model.editorParams;case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"onDestroyed",value:function(){}},{key:"insertNode",value:function(e){}},{key:"parseNode",value:function(e){return e}}]),e}(),pk={type:"emoji",renderElem:function(e){var t=e.data,n=void 0===t?{}:t;return wu("emoji-elem",{dataset:{value:n.emoji?je(n.emoji):""},props:{contentEditable:!1}},[])}},yk=function(){function e(){A(this,e),O(this,"title","表情"),O(this,"tag","button"),O(this,"iconSvg","<svg viewBox='0 0 1040 1024' version='1.1' xmlns='http://www.w3.org/2000/svg' p-id='1490' width='1em' height='1em' stroke='var(--w-e-toolbar-color)' > <path stroke-width='38' d='M512.075261 1024A511.774217 511.774217 0 1 1 730.482434 48.769072a37.630457 37.630457 0 1 1-32.061149 68.035867 436.513303 436.513303 0 1 0 250.468323 395.270322 37.630457 37.630457 0 0 1 75.260914 0 512.526826 512.526826 0 0 1-512.075261 511.924739z' p-id='1491' ></path> <path stroke-width='38' d='M333.857416 344.0929a57.348817 57.348817 0 1 0 57.348817 57.348817 57.499339 57.499339 0 0 0-57.348817-57.348817zM686.53006 344.0929a57.348817 57.348817 0 1 0 57.348817 57.348817 57.348817 57.348817 0 0 0-57.348817-57.348817zM515.236219 783.165074c-162.864619 0-262.359547-141.942084-262.359547-219.159782a30.104366 30.104366 0 0 1 60.208731 0c0 48.618551 76.314567 158.951051 202.150816 158.951051s193.571072-134.114949 193.571072-158.951051a30.104366 30.104366 0 0 1 60.208731 0c0 54.488902-90.012054 219.159782-253.779803 219.159782zM1009.549904 207.720123h-67.132735V139.985301a30.104366 30.104366 0 1 0-60.208732 0v67.734822h-67.734822a30.104366 30.104366 0 0 0-30.104366 30.104366 30.104366 30.104366 0 0 0 30.104366 30.104366h67.734822v67.734823a30.104366 30.104366 0 0 0 60.208732 0v-67.734823h67.734823a30.104366 30.104366 0 0 0 30.104365-30.104366 30.104366 30.104366 0 0 0-30.706453-30.104366z' p-id='1492' ></path> </svg>")}return P(e,[{key:"isActive",value:function(){return!1}},{key:"getValue",value:function(){return!1}},{key:"isDisabled",value:function(){return!1}},{key:"exec",value:function(e){e.emit("openEmojiSelect")}}]),e}(),mk={renderElems:[pk],elemsToHtml:[{type:"emoji",elemToHtml:function(e){var t=e.data;return"<span data-w-e-type=\"emoji\" class='emoji'>".concat(t.emoji,"</span>")}}],parseElemsHtml:[{selector:'span[data-w-e-type="emoji"]',parseElemHtml:function(e){return{data:{emoji:e.innerHTML},type:"emoji",children:[{text:""}]}}}],menus:[{key:"emoji",factory:function(){return new yk}}]},wk=function(){function e(){A(this,e),O(this,"editor",void 0),O(this,"overlay",null),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"cleanup",Oe),this.registerNode()}var t,n;return P(e,[{key:"emojiPlugin",value:function(e){var t=e.isInline,n=e.isVoid;return e.isInline=function(e){return"emoji"===pe.getNodeType(e)||t(e)},e.isVoid=function(e){return"emoji"===pe.getNodeType(e)||n(e)},e}},{key:"registerNode",value:function(){window.emojiIsRegiter||(me.registerModule(mk),window.emojiIsRegiter=!0),me.registerPlugin(this.emojiPlugin.bind(this))}},{key:"init",value:(n=_(E().mark((function e(t){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.editor=t,this.listenEvent();case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"listenEvent",value:function(){var e=this,t=this.editor.getEditableContainer();this.editor.on("openEmojiSelect",(function(){return e.openEmojiSelect()})),this.cleanup=Pe(t,"keydown",(function(t){var n;(e.overlay&&e.presetPreventEvents.includes(t.keyCode)&&t.preventDefault(),e.overlay&&e.presetPreventPropEvents.includes(t.keyCode))&&(t.stopPropagation(),null===(n=e.overlay)||void 0===n||n.dismiss())}))}},{key:"openEmojiSelect",value:(t=_(E().mark((function e(){var t,n,r=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getSelection(),!(n=t.focusNode)){e.next=7;break}return this.overlay=ibiz.overlay.createPopover((function(e){return G(zu,{controller:r,modal:e})}),void 0,{width:"auto",noArrow:!0,autoClose:!0,placement:"bottom-start"}),e.next=6,this.overlay.present(n.parentNode);case 6:this.overlay.onWillDismiss().then((function(e){var t,n=e,i=null===(t=n.data)||void 0===t?void 0:t[0];n.ok&&i&&r.addEmojiNode(i),r.overlay=null}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"addEmojiNode",value:function(e){var t={data:e,type:"emoji",children:[{text:""}]};this.editor.restoreSelection(),this.editor.insertNode(t),this.editor.move(1)}},{key:"parseNode",value:function(e){return Y.execScriptFn({value:e,controller:this},'value.replaceAll(/\\{\\"\\emoji\\":\\"(.+?)\\"\\}/g,(x, emoji) => {return \'<span data-w-e-type="emoji" class="emoji">\'+emoji+\'</span>\'})',{singleRowReturn:!0,isAsync:!1})}},{key:"onDestroyed",value:function(){this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}}]),e}(),bk={type:"insert",renderElem:function(e,t){var n=e.data,r=void 0===n?{}:n;return wu("".concat(r.type||"","-elem"),{dataset:{value:JSON.stringify(r)},props:{contentEditable:!1}},t)}},kk={type:"insert",elemToHtml:function(e){var t=e.data,n=void 0===t?{}:t;return"<span data-w-e-type=\"insert\" class='insert'>".concat(JSON.stringify({type:n.type,value:n.value}),"</span>")}},xk={selector:'span[data-w-e-type="insert"]',parseElemHtml:function(e){return{data:JSON.parse(e.innerHTML)||{},type:"insert",children:[{text:""}]}}},Ck={type:"layout",renderElem:function(e,t){return wu("layout-elem",{props:{class:"layout"}},t||[])}},Ek={type:"layout-column",renderElem:function(e,t){return wu("layout-column-elem",{props:{class:"layout-column"}},t||[])}},Sk=function(){function e(){A(this,e),O(this,"title","插入"),O(this,"tag","button"),O(this,"iconSvg","<svg viewBox='0 0 16 16' xmlns='http://www.w3.org/2000/svg' height='1em' width='1em' class='insert-icon' fill='var(--ibiz-color-primary)'><g stroke-width='1' fill-rule='evenodd'> <path d='M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm-.6-8.6H4v1.2h3.4V12h1.2V8.6H12V7.4H8.6V4H7.4v3.4z'></path></g></svg>")}return P(e,[{key:"isActive",value:function(){return!1}},{key:"getValue",value:function(){return!1}},{key:"isDisabled",value:function(){return!1}},{key:"exec",value:function(e){e.emit("openInsertSelect")}}]),e}(),_k={renderElems:[bk,Ck,Ek],elemsToHtml:[kk,{type:"layout",elemToHtml:function(e,t){return"<layout-elem data-w-e-type=\"layout\" class='layout'>".concat(t,"</layout-elem>")}},{type:"layout-column",elemToHtml:function(e,t){return"<layout-column-elem data-w-e-type=\"layout-column\" class='layout-column'>".concat(t,"</layout-column-elem>")}}],parseElemsHtml:[xk,{selector:'layout-elem[data-w-e-type="layout"]',parseElemHtml:function(e,t){return{type:"layout",children:t}}},{selector:'layout-column-elem[data-w-e-type="layout-column"]',parseElemHtml:function(e,t){return{type:"layout-column",children:t}}}],menus:[{key:"insert",factory:function(){return new Sk}}]};function Ak(e,t,n){if(e.length>0){var r=t[e[0]];if(r&&r.type===n)return!0;if(r&&r.children)return e.splice(0,1),Ak(e,r.children,n)}return!1}function Mk(e,t){var n=e.selection,r=e.children;return!!n&&Ak(p(n.anchor.path),r,t)}function Pk(e,t,n){var r,i,o=!1,a=k(null===(r=ue)||void 0===r?void 0:r.nodes(e,{at:t,match:function(e){return pe.getNodeType(e)===n}}));try{for(a.s();!(i=a.n()).done;){i.value;o=!0}}catch(Qk){a.e(Qk)}finally{a.f()}return o}function Ok(e,t){if(e.length>0)for(var n=0;n<e.length;n++){var r=e[n];if(r.type===t||r.data&&r.data&&r.data.type===t)return r;if(r.children)return Ok(r.children||[],t)}}function Tk(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=k(e.values());try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.isInline===i&&Ok([n[t[0]]],a.type))return!0}}catch(Qk){o.e(Qk)}finally{o.f()}return!1}function Lk(e){var t=e.selection,n=e.children;if(t){var r=n[t.anchor.path[0]]||{};return r&&r.children&&1===r.children.length?!r.children[0].text:!(r&&r.children&&r.children.length>1)}return!0}function jk(e){var t=e.selection,n=e.children;if(t){var r=n[t.anchor.path[0]+1]||{};return r&&r.children&&1===r.children.length?!r.children[0].text:!(r&&r.children&&r.children.length>1)}return!0}function Nk(e,t){ge.removeNodes(e,{at:t});var n=setTimeout((function(){e.move(1),e.focus(),clearTimeout(n),n=null}),0)}function Rk(e,t){var n=e.selection;if(null==n)return!1;if(ve.isExpanded(n))return!1;var r=pe.getSelectedNodeByType(e,t);if(null===r)return!1;var i=r.children;return 1===i.length&&""===i[0].text}var Dk=function(e){var t=e.selection;return t&&ve.isCollapsed(t)?ue.above(e,{match:function(e){return ce.isElementType(e,"layout-column")}}):null},Ik=function(e){var t=Dk(e);if(t){var n=m(t,2)[1],r=ue.start(e,n);return ye.equals(e.selection.anchor,r)}return!1},Bk=function(){function e(){A(this,e),O(this,"model",void 0),O(this,"context",void 0),O(this,"params",void 0),O(this,"data",{}),O(this,"editor",void 0),O(this,"editorParams",void 0),O(this,"wangEditor",void 0),O(this,"container",void 0),O(this,"overlay",null),O(this,"presetPreventEvents",[13,38,40]),O(this,"presetPreventPropEvents",[27]),O(this,"insertMap",gc()),O(this,"cleanup",Oe),this.registerNode()}var t,n,r;return P(e,[{key:"insertPlugin",value:function(e){var t=this,n=e.isInline,r=e.isVoid,i=e.insertBreak,o=e.insertNode,a=e.deleteBackward,s=e.normalizeNode,l=e.deleteForward;return e.isInline=function(e){return"insert"===pe.getNodeType(e)||n(e)},e.isVoid=function(e){return"insert"===pe.getNodeType(e)||r(e)},e.insertBreak=function(){var t=pe.getSelectedNodeByType(e,"layout");if(t){var n=function(e,t){var n=t.selection;if(null==n)return"";var r=fe.string(e),i=n.anchor.offset,o=r.slice(0,i).split("\n"),a=o.length;return 0===a?"":o[a-1]}(t,e);if(n){var r=n.match(/^\s+/);if(null!==r&&null!=r[0]){var o=r[0];return void e.insertText("\n".concat(o))}}e.insertText("\n")}else i()},e.insertNode=function(n){var r=e.getConfig().maxLength,i=pe.getSelectedNodeByType(e,"layout");if(!i||!n.type||"layout"!==n.type){if(i){var a=t.insertMap.find((function(e){return e.type===n.data.type}));a&&a.isInline&&(function(e){var t=e.selection;if(t&&ve.isCollapsed(t)){var n=m(ue.node(e,t),1)[0];if(he.isText(n)&&/^(\s*\n\s*)+$/.test(n.text))return!0}return!1}(e)||Ik(e)&&function(e){var t=e.selection;if(t&&ve.isCollapsed(t)){var n=m(ue.node(e,t),1)[0];if(he.isText(n)&&""===n.text)return!0}return!1}(e))&&e.insertText(" ")}if(r){var s=pe.getLeftLengthOfMaxLength(e);if(!(s<=0))s<fe.string(n).length||o(n)}else o(n)}},e.normalizeNode=function(t){var n=m(t,2),r=n[0],i=n[1];if("layout"===pe.getNodeType(r)&&pe.isLastNode(e,r)){var o=pe.genEmptyParagraph();return void ge.insertNodes(e,o,{at:[i[0]+1]})}return s([r,i])},e.deleteBackward=function(n){var r=pe.getSelectedNodeByType(e,"layout"),i=e.selection;if(!r&&i){var o=ue.before(e,i);if(o)if(Pk(e,o,"layout")||!r&&Tk(t.insertMap,o.path,e.children))return void Nk(e,[o.path[0]])}r&&Rk(e,"layout-column")||Ik(e)||a(n)},e.deleteForward=function(n){var r=pe.getSelectedNodeByType(e,"layout"),i=e.selection;if(!r&&i){var o=ue.after(e,i);if(o){var a=Pk(e,o,"layout"),s=Lk(e),u=s?i.focus.path[0]:o.path[0];if(a)return void Nk(e,[u]);if(Tk(t.insertMap,o.path,e.children))return Nk(e,[u]),s&&e.moveReverse(1),void t.handleMove(39)}}r&&Rk(e,"layout-column")||function(e){var t=Dk(e);if(t){var n=m(t,2)[1],r=ue.end(e,n);return ye.equals(e.selection.anchor,r)}return!1}(e)||l(n)},e}},{key:"registerNode",value:function(){window.insertIsRegiter||(me.registerModule(_k),window.insertIsRegiter=!0),me.registerPlugin(this.insertPlugin.bind(this))}},{key:"init",value:(r=_(E().mark((function e(t,n){return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.model=n.model,this.context=n.context,this.params=n.params,this.data=n.data,this.editorParams=this.model.editorParams,this.wangEditor=t,this.listenEvent();case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"listenEvent",value:function(){var e=this,t=this.wangEditor.getEditableContainer();this.cleanup=Pe(t,"keydown",(function(t){var n;(e.overlay&&e.presetPreventEvents.includes(t.keyCode)&&t.preventDefault(),e.overlay&&e.presetPreventPropEvents.includes(t.keyCode))&&(t.stopPropagation(),null===(n=e.overlay)||void 0===n||n.dismiss())})),t.addEventListener("keyup",this.handleKeyup.bind(this)),t.addEventListener("mouseup",this.handleMouseup.bind(this)),this.wangEditor.on("openInsertSelect",(function(){return e.openInsertSelect()})),t.addEventListener("dateElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("labelElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("promptBoxElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("mindMapElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("audioElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("formulaElemEvent",this.handleInsertChange.bind(this)),t.addEventListener("layoutElemEvent",this.handleInsertChange.bind(this)),this.container=t}},{key:"handleKeyup",value:function(e){this.handleMove(e.keyCode)}},{key:"handleMouseup",value:function(){this.handleMove(39)}},{key:"handleMove",value:function(e){if([37,38,39,40].includes(e)&&this.wangEditor.selection){var t=this.wangEditor,n=t.children,r=t.selection;if(r&&r.focus.path&&!Pk(this.wangEditor,r.focus.path,"layout")&&Tk(this.insertMap,r.focus.path,n)){if([37,38].includes(e)?this.wangEditor.moveReverse(2):[39,40].includes(e)&&this.wangEditor.move(2),0===r.focus.path[0])return void this.handleMove(39);this.handleMove(e)}}}},{key:"handleInsertChange",value:function(e){var t=this.getCustomNodePath(e.target),n=e.detail.params;n&&n.isDelete?Nk(this.wangEditor,t):e.detail&&function(e,t,n){ge.setNodes(e,{children:[{text:""}],data:n,type:"insert"},{at:t}),e.move(1),e.focus()}(this.wangEditor,t,e.detail)}},{key:"getCustomNodePath",value:function(e){var t=pe.toSlateNode(this.wangEditor,e);return pe.findPath(this.wangEditor,t)}},{key:"openInsertSelect",value:(n=_(E().mark((function e(){var t,n,r,i,o,a=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=pe.getToolbar(this.wangEditor))&&(r=n.toolbarItems,i=r.find((function(e){var t=e.$elem[0].querySelectorAll("[data-menu-key]")[0];return"insert"===(t?t.getAttribute("data-menu-key"):"")&&t})),t=!!i&&i.$button[0]),!t){e.next=8;break}return e.next=5,this.openPopover(t);case 5:(o=e.sent).ok&&o.data&&o.data.length>0&&(o.data.length>1&&(this.wangEditor.focus(),jk(this.wangEditor)||Mk(this.wangEditor,"layout")||(this.wangEditor.insertBreak(),this.wangEditor.moveReverse(1))),o.data.forEach((function(e,t){setTimeout((function(){a.addNode(e,"insert")}),200*t)}))),this.overlay=null;case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"addNode",value:function(e,t){var n={data:e,type:t,children:[{text:""}]};switch(this.wangEditor.restoreSelection(),e.type){case"prompt-box":case"mind-map":case"audio":Lk(this.wangEditor)||Mk(this.wangEditor,"layout")||this.wangEditor.insertBreak(),this.wangEditor.insertNode(n),jk(this.wangEditor)&&!Mk(this.wangEditor,"layout")&&this.wangEditor.insertBreak();break;case"layout":Object.assign(n,{type:"layout",children:[{type:"layout-column",children:[{text:""}]},{type:"layout-column",children:[{text:""}]}]}),this.wangEditor.insertNode(n);break;default:this.wangEditor.insertNode(n),this.wangEditor.move(1)}this.handleMove(39)}},{key:"openPopover",value:(t=_(E().mark((function e(t){var n,r,i=arguments;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},this.overlay=ibiz.overlay.createPopover(this.createOverlayView(),void 0,a({width:"auto",noArrow:!0,autoClose:!0,placement:"bottom-start"},n)),e.next=4,this.overlay.present(t);case 4:return e.next=6,this.overlay.onWillDismiss();case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"createOverlayView",value:function(){var e=this;return function(t){return G(yc,{modal:t,context:e.context,viewParams:e.params,actionParams:e.editorParams})}}},{key:"parseNode",value:function(e){return e}},{key:"onDestroyed",value:function(){this.container&&(this.container.removeEventListener("keyup",this.handleKeyup.bind(this)),this.container.removeEventListener("mouseup",this.handleMouseup.bind(this)),this.container.removeEventListener("dateElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("labelElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("promptBoxElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("mindMapElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("audioElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("formulaElemEvent",this.handleInsertChange.bind(this)),this.container.removeEventListener("layoutElemEvent",this.handleInsertChange.bind(this)),this.container=null),this.cleanup!==Oe&&this.cleanup(),this.overlay&&this.overlay.dismiss()}}]),e}(),zk=function(){function e(){A(this,e)}return P(e,null,[{key:"init",value:function(e){var t=this;this.registerMap.set("mention",uk),this.registerMap.set("marker",rk),this.registerMap.set("attachments",Su),this.registerMap.set("codesnippet",Tu),this.registerMap.set("page",vk),this.registerMap.set("emoji",wk),this.registerMap.set("insert",Bk),this.presetNodes.forEach((function(n){t.registerPlugin({type:n,id:"".concat(n).concat(e)})}))}},{key:"registerPlugin",value:function(e){var t=e.type,n=e.id;if(this.customNodeMap.has(n))return this.customNodeMap.get(n);var r=this.registerMap.get(t);if(r){var i=new r;return this.customNodeMap.set(n,i),i}}},{key:"getPluginsById",value:function(e){var t=this,n=[];return this.presetNodes.forEach((function(r){t.customNodeMap.has("".concat(r).concat(e))&&n.push(t.customNodeMap.get("".concat(r).concat(e)))})),n}},{key:"unregisterPlugin",value:function(e){var t=e.id;this.customNodeMap.has(t)&&this.customNodeMap.delete(t)}},{key:"destroy",value:function(e){var t=this;this.presetNodes.forEach((function(n){t.unregisterPlugin({id:"".concat(n).concat(e)})})),this.registerMap.delete("mention"),this.registerMap.delete("marker"),this.registerMap.delete("attachments"),this.registerMap.delete("codesnippet"),this.registerMap.delete("page"),this.registerMap.delete("emoji"),this.registerMap.delete("insert")}}]),e}();O(zk,"customNodeMap",new Map),O(zk,"registerMap",new Map),O(zk,"presetNodes",["mention","marker","attachments","codesnippet","page","emoji","insert"]);var Fk=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"attributeChangedCallback",value:function(e,t,n){if("data-value"===e){if(n&&t===n)return;var r=JSON.parse(n),i=this.attachShadow({mode:"open"}),o=i.ownerDocument;if(r.icon){var a=o.createElement("span");a.part.add("svg"),a.innerHTML=r.icon,i.appendChild(a)}if(r.identifier){var s=o.createElement("span");s.part.add("identifier"),s.innerHTML=r.identifier,i.appendChild(s)}if(r.name){var l=o.createElement("span");l.part.add("name"),l.innerHTML=r.name,i.appendChild(l)}var u=o.createElement("style");u.innerHTML="\n      svg {\n        height: 1em;\n        width: 1em;\n      }\n    ",i.appendChild(u)}}}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),n}(n(HTMLElement)),Vk=function(e){l(n,e);var t=c(n);function n(){return A(this,n),t.apply(this,arguments)}return P(n,[{key:"attributeChangedCallback",value:function(e,t,n){if("data-value"===e){if(n&&t===n)return;var r=this.attachShadow({mode:"open"}),i=r.ownerDocument.createElement("span");i.innerHTML=n,i.part.add("box"),i.classList.add("emoji-elem_box"),r.appendChild(i)}}}],[{key:"observedAttributes",get:function(){return["data-value"]}}]),n}(n(HTMLElement)),Hk=function(){function e(){var t=this;A(this,e),O(this,"title","格式刷"),O(this,"tag","button"),O(this,"fragment",[]),O(this,"format",{}),O(this,"editor",null),O(this,"excting",!1),O(this,"iconSvg",'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fit="" height="1em" width="1em" preserveAspectRatio="xMidYMid meet" focusable="false"><g id="aqseditor/paintformat" stroke-width="1" fill-rule="evenodd"><path d="M3 5.24h10V2H3v3.24zM13.299 1H2.701A.701.701 0 0 0 2 1.701v3.838c0 .387.314.701.701.701h6.236L7.621 7.438h-.002v2.233h-.768v5.184L9.404 13.1V9.671h-.585V7.97l1.9-1.73h2.58A.701.701 0 0 0 14 5.539V1.701A.701.701 0 0 0 13.299 1z" id="aqsFill-1"></path></g></svg>'),O(this,"setPaintFormat",(function(){if(t.editor){var e=t.editor.getSelectionText();if(e&&Object.keys(t.format).length>0){var n=a(a({},t.format),{},{text:e});t.editor.insertNode(n),t.excting||t.clearFormat()}}})),O(this,"onPaintFormat",Se(this.setPaintFormat,500,!1)),O(this,"throttleHandle",this.throttle(this.handle,300))}return P(e,[{key:"isActive",value:function(e){return Object.keys(this.format).length>0}},{key:"getValue",value:function(e){return""}},{key:"isDisabled",value:function(e){return!1}},{key:"calcFormat",value:function(e){var t=this;e.length>0&&e[0].children.forEach((function(e){Object.assign(t.format,e)}))}},{key:"clearFormat",value:function(){this.format={};var e=this.editor.getEditableContainer();e&&e.classList.remove("is-paint-format");var t=document.querySelector("button[data-menu-key='paintformat']");t&&t.classList.remove("active")}},{key:"throttle",value:function(e,t){var n=null;return function(){for(var r=this,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];n||(n=setTimeout((function(){e.apply(r,o),n=null,r.excting=!0}),t))}}},{key:"handle",value:function(e){var t=this;if(this.excting)return this.clearFormat(),void(this.excting=!1);var n=e.getFragment();this.calcFormat(n),this.editor=e;var r=this.editor.getEditableContainer();r&&r.classList.add("is-paint-format"),e.deselect(),e.on("change",this.onPaintFormat),e.on("clickOutside",(function(){t.clearFormat(),t.excting=!1}))}},{key:"exec",value:function(e){this.throttleHandle(e)}}]),e}(),Uk={key:"paintformat",factory:function(){return new Hk}},qk=function(){function e(){A(this,e),O(this,"title","AI询问"),O(this,"iconSvg",'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"> <text x="0" y="13" font-size="16" fill="black">AI</text></svg>'),O(this,"tag","button")}return P(e,[{key:"isActive",value:function(e){return!1}},{key:"getValue",value:function(e){return"aichart"}},{key:"isDisabled",value:function(e){return!1}},{key:"exec",value:function(e,t){e.emit("aiClick")}}]),e}();var Gk={type:"link",elemToHtml:function(e){var t=e.url,n=e.children,r="_blank";return t.startsWith("./#/")&&(r="_self"),'<a href="'.concat(t,'" target="').concat(r,'">').concat(n[0].text,"</a>")}},Jk=function(){function e(){A(this,e),O(this,"title","查看连接"),O(this,"iconSvg",'<svg viewBox="0 0 1024 1024"><path d="M924.402464 1023.068211H0.679665V99.345412h461.861399v98.909208H99.596867v725.896389h725.896389V561.206811h98.909208z" p-id="10909"></path><path d="M930.805104 22.977336l69.965436 69.965436-453.492405 453.492404-69.965435-69.901489z" p-id="10910"></path><path d="M1022.464381 304.030081h-98.917201V99.345412H709.230573V0.428211h313.233808z"></path></svg>'),O(this,"tag","button")}return P(e,[{key:"getSelectedLinkElem",value:function(e){var t=pe.getSelectedNodeByType(e,"link");return null==t?null:t}},{key:"getValue",value:function(e){var t=this.getSelectedLinkElem(e);return t&&t.url||""}},{key:"isActive",value:function(){return!1}},{key:"isDisabled",value:function(e){return null==e.selection||null==this.getSelectedLinkElem(e)}},{key:"exec",value:function(e,t){if(!this.isDisabled(e)){if(!t||"string"!=typeof t)throw new Error("打开链接失败, 路径为 '".concat(t,"'"));t.toString().startsWith("./#/")?window.open("".concat(window.location.pathname).concat(t.slice(1)),"_self"):window.open(t,"_blank")}}}]),e}(),Wk={menus:[{key:"customViewLink",factory:function(){return new Jk}}],elemsToHtml:[Gk]},Yk=function(e){l(o,e);var t,n,r,i=c(o);function o(){var e;A(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return O(f(e=i.call.apply(i,[this].concat(n))),"userAvatar",""),O(f(e),"uploadParams",void 0),O(f(e),"exportParams",void 0),O(f(e),"minHeight",48),O(f(e),"maxHeight",315),O(f(e),"collapsed",C(!0)),O(f(e),"hidden",C(!1)),O(f(e),"reply",C("")),O(f(e),"replyScript",""),O(f(e),"mode","comment"),O(f(e),"insertKeys",[]),O(f(e),"renderMode","HTML"),O(f(e),"saveInterval",3e3),O(f(e),"emitMode","BUTTON"),O(f(e),"uuid",ke()),O(f(e),"enableRealtime",!1),O(f(e),"editor",void 0),O(f(e),"autoSaveInterval",3e4),O(f(e),"timer",null),O(f(e),"deService",void 0),O(f(e),"deACMode",void 0),O(f(e),"chatCompletion",!1),O(f(e),"evt",new K(e.getEventArgs.bind(f(e)))),e}return P(o,[{key:"getEventArgs",value:function(){return{context:this.context,params:this.params,data:[],eventArg:"",targetName:this.model.name,view:this.getView()}}},{key:"onInit",value:(r=_(E().mark((function e(){var t,n,r,i,a,l,u,c,h,f,d,v,p,y,m=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(g(o.prototype),"onInit",this).call(this);case 2:return e.next=4,this.getCurrentUserAvatar();case 4:if(!(t=this.model).appDEACModeId){e.next=15;break}return e.next=8,ee(t.appDEACModeId,t.appDataEntityId,this.context.srfappid);case 8:if(this.deACMode=e.sent,!this.deACMode){e.next=15;break}if("CHATCOMPLETION"!==this.deACMode.actype){e.next=15;break}return e.next=13,ibiz.hub.getApp(t.appId).deService.getService(this.context,t.appDataEntityId);case 13:this.deService=e.sent,this.chatCompletion=!0;case 15:if(this.registerCustomElem(),this.editorParams){if(n=this.editorParams,r=n.uploadParams,i=n.exportParams,a=n.MINHEIGHT,l=n.MAXHEIGHT,u=n.REPLYSCRIPT,c=n.MODE,h=n.INSERTKEYS,f=n.RENDERMODE,d=n.SAVEINTERVAL,v=n.EMITMODE,p=n.DEFAULTCOLLAPSE,y=n.ENABLEREALTIME,r)try{this.uploadParams=JSON.parse(r)}catch(w){ibiz.log.error("编辑器[".concat(ibiz.log.error(w),"]编辑器参数 uploadParams 非 json 格式"))}if(i)try{this.exportParams=JSON.parse(i)}catch(w){ibiz.log.error("编辑器[".concat(ibiz.log.error(w),"]编辑器参数 exportParams 非 json 格式"))}a&&(this.minHeight=Number(a)),l&&(this.maxHeight=Number(l)),u&&(this.replyScript=u),c&&(this.mode=c.toLowerCase()),h&&(this.insertKeys=JSON.parse(h)),f&&(this.renderMode=f),d&&(this.saveInterval=dt(d)),v&&(this.emitMode=v),p&&(this.collapsed.value=!Object.is(p,"TRUE")&&!Object.is(p,"true")),y&&(this.enableRealtime=Object.is(y,"TRUE")||Object.is(y,"true"))}zk.init(this.uuid),this.evt.on("onChange",(function(){if(!m.parent.form){var e=ibiz.uiDomainManager.get(m.context.srfsessionid);e&&e.dataChange()}})),this.listenViewDestroyed();case 20:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"registerCustomElem",value:function(){window.customElements.get("mention-elem")||window.customElements.define("mention-elem",Fk),window.customElements.get("emoji-elem")||window.customElements.define("emoji-elem",Vk),window.paintFormatIsRegiter||(me.registerMenu(Uk),window.paintFormatIsRegiter=!0),window.aichartRegister||(me.registerMenu({key:"aichart",factory:function(){return new qk}}),window.aichartRegister=!0),window.customLinkIsRegiter||(me.registerModule(Wk),window.customLinkIsRegiter=!0)}},{key:"onCreated",value:function(e,t,n){var r=this;zk.getPluginsById(this.uuid).forEach((function(i){i.init(e,{model:r.model,data:t,toolbarConfig:n,context:r.context,params:r.params,evt:r.evt})}))}},{key:"onDestroyed",value:function(){zk.getPluginsById(this.uuid).forEach((function(e){e.onDestroyed()})),zk.destroy(this.uuid)}},{key:"listenViewDestroyed",value:function(){var e=this,t=this.getView();t&&t.evt.on("onDestroyed",(function(){e.onDestroyed()}))}},{key:"parseNode",value:function(e){var t=e;return zk.getPluginsById(this.uuid).forEach((function(e){t=e.parseNode(t)})),t}},{key:"setValue",value:(n=_(E().mark((function e(t){var n;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.collapsed.value=!1,this.hidden.value=!0,e.next=4,j();case 4:return this.hidden.value=!1,e.next=7,j();case 7:n=this.parseNode(t),this.evt.emit("setHtml",{eventArg:n});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"setReply",value:function(e){this.reply.value=Ns.getEmojiCustomHtml("".concat(e.name,": ").concat(e.content)),this.evt.emit("onSetReply",{eventArg:this.reply.value})}},{key:"removeReply",value:function(){this.reply.value="",this.evt.emit("onRemoveReply",{eventArg:this.reply.value})}},{key:"clear",value:function(){this.reply.value="",this.evt.emit("onRemoveReply",{eventArg:this.reply.value}),this.evt.emit("clear",{eventArg:""}),this.collapsed.value=!0}},{key:"fileDownload",value:function(e){ibiz.net.request(e.url,{method:"get",responseType:"blob",baseURL:""}).then((function(t){if(200!==t.status)throw new Me("下载文件失败");if(!t.data)throw new Me("文件流数据不存在");var n=e.name;Re(t.data,n)}))}},{key:"toggleCollapse",value:function(e){this.collapsed.value=!e&&!this.collapsed.value}},{key:"jsonToHtml",value:function(e){var t="";try{var n=JSON.parse(e);t=we({content:n}).getHtml()}catch(r){t=e,ibiz.log.error("JSON字符串转换错误",r)}return t}},{key:"toJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t="";try{t=JSON.stringify(e)}catch(n){ibiz.log.error("JSON字符串转换错误")}return t}},{key:"getCurrentUserAvatar",value:(t=_(E().mark((function e(){var t,n,r,i,o=this;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ibiz.hub.getApp(this.context.srfappid);case 2:return t=e.sent,n=[],e.next=6,t.codeList.get("SysOperator",this.context,this.params);case 6:n=e.sent,this.context.srfuserid&&(r=n.filter((function(e){return e.value===o.context.srfuserid})))&&r.length>0&&(this.userAvatar=(null===(i=r[0])||void 0===i||null===(i=i.data)||void 0===i?void 0:i.iconurl)||"");case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getView",value:function(){var e=this.parent.form||this.parent.grid||this.parent.panel;if(e)return e.view}}]),o}(Q),Zk=function(){function e(){A(this,e),O(this,"formEditor","HtmlComment"),O(this,"gridEditor","HtmlComment")}var t;return P(e,[{key:"createController",value:(t=_(E().mark((function e(t,n){var r;return E().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Yk(t,n),e.next=3,r.init();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}(),Xk=o("I",ae(gu,(function(e){window.customElements.get("layout-elem")||window.customElements.define("layout-elem",tk),window.customElements.get("layout-column-elem")||window.customElements.define("layout-column-elem",nk),window.customElements.get("date-elem")||window.customElements.define("date-elem",Zb),window.customElements.get("label-elem")||window.customElements.define("label-elem",Xb),window.customElements.get("prompt-box-elem")||window.customElements.define("prompt-box-elem",Kb),window.customElements.get("mind-map-elem")||window.customElements.define("mind-map-elem",$b),window.customElements.get("audio-elem")||window.customElements.define("audio-elem",Qb),window.customElements.get("formula-elem")||window.customElements.define("formula-elem",ek),e.component(du.name,du),e.component(yt.name,yt),e.component(gu.name,gu),te("EDITOR_CUSTOMSTYLE_COMMENT",(function(){return new Zk}))})));o("i",{install:function(e){e.use(Xk),e.component("IBizHtmlContent",W((function(){return Promise.resolve().then((function(){return mt}))})))}})}}}))}();
