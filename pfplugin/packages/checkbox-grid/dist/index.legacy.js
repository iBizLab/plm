!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(t){var n=function(t,n){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==e(n)?n:n+""}function u(t,n,r){return n=s(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,l()?Reflect.construct(n,r||[],s(t).constructor):n.apply(t,r))}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}function c(e,t,n,r){var o=f(s(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof o?function(e){return o.apply(n,e)}:o}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},f.apply(null,arguments)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function p(e,t){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},p(e,t)}System.register(["@ibiz-template/vue3-util","@ibiz-template/runtime","vue","qx-util"],(function(e,n){"use strict";var o,f,s,d,y,v,h,m,b,g,P,S,k;return{setters:[function(e){o=e.useControlController,f=e.useNamespace,s=e.withInstall},function(e){d=e.GridController,y=e.registerControlProvider,v=e.ControlType},function(e){h=e.defineComponent,m=e.ref,b=e.watch,g=e.computed,P=e.createVNode,S=e.resolveComponent},function(e){k=e.createUUID}],execute:function(){var n=function(e){function n(){return r(this,n),u(this,n,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(n,e),i(n,[{key:"simpleList",get:function(){var e;return null===(e=this.view.parentView)||void 0===e?void 0:e.getController("simplelist")}},{key:"initState",value:function(){c(n,"initState",this,3)([]),this.state.enableSelectAll=!1}},{key:"handleControlParams",value:function(){c(n,"handleControlParams",this,3)([]),this.controlParams.enableselectall&&(this.state.enableSelectAll="true"===this.controlParams.enableselectall)}},{key:"handleSelection",value:function(e){var n=this.state,r=n.items,o=n.selectedData.filter((function(e){return!r.find((function(t){return t.srfkey===e.srfkey}))})),i=r.filter((function(t){return e.includes(t.srfkey)}));o.push.apply(o,t(i)),this.setSelection(o),this.handlePushSimpleListItems()}},{key:"handlePushSimpleListItems",value:function(){var e,n=t(this.state.selectedData);null===(e=this.simpleList)||void 0===e||e.setData(n)}}])}(d),C=h({name:"CheckboxGrid",props:{modelData:{type:Object,required:!0},context:{type:Object,required:!0},params:{type:Object,default:function(){return{}}},provider:{type:Object},mdctrlActiveMode:{type:Number,default:void 0},singleSelect:{type:Boolean,default:void 0},rowEditOpen:{type:Boolean,default:void 0},isSimple:{type:Boolean,required:!1},data:{type:Array,required:!1},loadDefault:{type:Boolean,default:!0}},setup:function(){var e=o((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,t,n){if(l())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&p(o,n.prototype),o}(n,t)})),r=f("checkbox-grid"),i=m([]),a={srfkey:k(),caption:"全选"},u=m(!1);b((function(){return e.state.selectedData}),(function(t){i.value=t.map((function(e){return e.srfkey})),e.state.enableSelectAll&&d(i.value)&&i.value.unshift(a.srfkey)}));var c=g((function(){var n=e.state;if(e.model.enableGroup){var r=[];return n.groups.forEach((function(e){if(!e.children.length)return[];var n=t(e.children),o=n.shift();r.push({srfkey:(null==o?void 0:o.srfkey)||e.caption,isGroupData:!0,caption:e.caption,first:o,children:n})})),r}return n.rows.map((function(e){return e.data}))})),s=g((function(){if(e.isMultistageHeader)return e.model.degridColumns||[];var t=[];return e.state.columnStates.forEach((function(n){var r,o;if(!n.hidden){var i=(null===(r=e.fieldColumns[n.key])||void 0===r?void 0:r.model)||(null===(o=e.uaColumns[n.key])||void 0===o?void 0:o.model);i&&t.push(i)}})),t}));e.state.enableSelectAll&&b((function(){return c.value}),(function(){var e=i.value.filter((function(e){return e!==a.srfkey}));u.value=d(e),u.value?i.value.unshift(a.srfkey):i.value=e}));var d=function(e){return c.value.length>0&&e.length>0&&c.value.every((function(t){return e.includes(t.srfkey)}))},y=function(t){u.value=t;var n=[];t&&(n=c.value.map((function(e){return e.srfkey}))),e.handleSelection(n)},v=function(e){e.preventDefault(),e.stopPropagation(),y(!u.value)},h=function(){return e.state.isLoaded&&P(S("iBizNoData"),{text:e.model.emptyText,emptyTextLanguageRes:e.model.emptyTextLanguageRes},null)};return{c:e,ns:r,onPageChange:function(t){t&&t!==e.state.curPage&&(e.state.curPage=t-1,e.load({isLoadMore:!0}))},onPageSizeChange:function(t){t&&t!==e.state.size&&(e.state.size=t,1===e.state.curPage&&e.load())},onPageRefresh:function(){e.load()},renderNoData:h,renderContent:function(){return c.value.length>0?P(S("el-checkbox-group"),{modelValue:i.value,"onUpdate:modelValue":function(e){return i.value=e},onChange:function(t){return function(t){var n=t.filter((function(e){return e!==a.srfkey}));if(e.state.enableSelectAll){if(d(n))return void y(!u.value);u.value=!1}e.handleSelection(n)}(t)}},{default:function(){return[[e.state.enableSelectAll&&P(S("el-checkbox"),{label:a.srfkey,checked:u.value,onClick:v},{default:function(){return[P("span",{class:r.em("content","item"),title:a.caption},[a.caption])]}}),c.value.map((function(e){return P(S("el-checkbox"),{label:e.srfkey},{default:function(){return[P("span",{class:r.em("content","item"),title:e[s.value[0].codeName]},[e[s.value[0].codeName]])]}})}))]]}}):h()}}},render:function(){var e=this;if(this.c.state.isCreated){var t=this.c.state,n=this.c.model.enablePagingBar;return P(S("iBizControlBase"),{class:[this.ns.is("enable-page",n),this.ns.is("enable-group",this.c.model.enableGroup),this.ns.b()],controller:this.c},{default:function(){return[P("div",{class:e.ns.e("content")},[e.renderContent()]),n&&P(S("iBizPagination"),{total:t.total,curPage:t.curPage,size:t.size,onChange:e.onPageChange,onPageSizeChange:e.onPageSizeChange,onPageRefresh:e.onPageRefresh},null)]}})}}}),w=i((function e(){var t,n,o;r(this,e),t=this,o="CheckboxGrid",(n=a(n="component"))in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o})),O=e("IBizCheckboxGrid",s(C,(function(e){e.component(C.name,C),y("".concat(v.GRID,"_RENDER_CHECKBOX_GRID"),(function(){return new w}))})));e("default",{install:function(e){e.use(O)}})}}}))}();
